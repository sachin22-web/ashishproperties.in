var cl=Object.defineProperty;var ol=(s,t,r)=>t in s?cl(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var ot=(s,t,r)=>ol(s,typeof t!="symbol"?t+"":t,r);import{r as a,t as dl,c as ml,j as e,V as ln,R as cn,a as va,A as on,C as dn,X as Ue,T as mn,D as xn,P as xl,b as hl,$ as ul,d as hn,e as pl,i as gl,g as jl,f as fl,h as vl,k as Nl,G as bl,l as yl,s as wl,o as Cl,m as un,n as pn,p as Sl,q as Ja,u as Wa,v as yr,w as kl,S as Pl,x as ur,y as rs,z as Oe,B as ds,E as Le,F as Ot,H as Pe,U as hs,L as Ms,I as gt,J as bs,M as Ce,K as xs,N as Ne,O as we,Q as Ae,W as as,Y as Ba,Z as Es,_ as ts,a0 as cs,a1 as He,a2 as gn,a3 as Ve,a4 as Al,a5 as Tl,a6 as El,a7 as Il,a8 as Fl,a9 as Ht,aa as Ft,ab as jn,ac as Ge,ad as Us,ae as Rs,af as js,ag as We,ah as Be,ai as $s,aj as ws,ak as nt,al as ns,am as it,an as Va,ao as Ss,ap as Mt,aq as Lt,ar as ea,as as fn,at as vn,au as Nn,av as bn,aw as ms,ax as be,ay as Is,az as yn,aA as Qe,aB as Gt,aC as Jt,aD as Dt,aE as Je,aF as Da,aG as Na,aH as Hs,aI as Ll,aJ as wn,aK as Dl,aL as Cn,aM as qa,aN as Sn,aO as Rl,aP as kn,aQ as $l,aR as Pn,aS as An,aT as Ul,aU as _l,aV as Tn,aW as Ol,aX as Ml,aY as Ds,aZ as pr,a_ as gr,a$ as at,b0 as zs,b1 as zl,b2 as Bl,b3 as En,b4 as In,b5 as Fn,b6 as Vl,b7 as Ra,b8 as Ys,b9 as Wt,ba as Qa,bb as ys,bc as xa,bd as ja,be as $a,bf as zt,bg as ql,bh as Ln,bi as Ks,bj as tt,bk as ha,bl as st,bm as Ws,bn as Ua,bo as rt,bp as jr,bq as Xs,br as ut,bs as Dn,bt as Hl,bu as Rn,bv as Gl,bw as $n,bx as Un,by as Jl,bz as Wl,bA as De,bB as Ql,bC as Kl,bD as Yl,bE as _n,bF as On,bG as Mn,bH as Xl,bI as zn,bJ as Bn,bK as Vn,bL as qn,bM as Hn,bN as Gn,bO as Jn,bP as Zl,bQ as ec,bR as fs,bS as lt,bT as Wn,bU as sc,bV as ls,bW as tc,bX as wr,bY as Ka,bZ as ac,b_ as rc,b$ as Qn,c0 as pt,c1 as Kn,c2 as mt,c3 as Yn,c4 as Qt,c5 as nc,c6 as Xn,c7 as ic,c8 as Zn,c9 as _a,ca as ei,cb as lc,cc,cd as oc,ce as Kt,cf as Ya,cg as dc,ch as mc,ci as xc,cj as ir,ck as fa,cl as hc,cm as uc,cn as pc,co as si,cp as gc,cq as ti,cr as ai,cs as ri,ct as ni,cu as ii,cv as jc,cw as fc,cx as ba,cy as Yt,cz as vc,cA as li,cB as Nc,cC as bc,cD as yc,cE as Cr,cF as wc,cG as Cc,cH as Sr,cI as Sc,cJ as kc,cK as Pc,cL as Ac,cM as Tc,cN as oe,cO as Ec,cP as Ic,cQ as Fc,cR as Lc}from"./vendor-J5NXqnG7.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const N of document.querySelectorAll('link[rel="modulepreload"]'))c(N);new MutationObserver(N=>{for(const y of N)if(y.type==="childList")for(const n of y.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function r(N){const y={};return N.integrity&&(y.integrity=N.integrity),N.referrerPolicy&&(y.referrerPolicy=N.referrerPolicy),N.crossOrigin==="use-credentials"?y.credentials="include":N.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(N){if(N.ep)return;N.ep=!0;const y=r(N);fetch(N.href,y)}})();const Dc=1,Rc=1e6;let Xa=0;function $c(){return Xa=(Xa+1)%Number.MAX_SAFE_INTEGER,Xa.toString()}const Za=new Map,kr=s=>{if(Za.has(s))return;const t=setTimeout(()=>{Za.delete(s),Bt({type:"REMOVE_TOAST",toastId:s})},Rc);Za.set(s,t)},Uc=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,Dc)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?kr(r):s.toasts.forEach(c=>{kr(c.id)}),{...s,toasts:s.toasts.map(c=>c.id===r||r===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},Aa=[];let Ta={toasts:[]};function Bt(s){Ta=Uc(Ta,s),Aa.forEach(t=>{t(Ta)})}function is({...s}){const t=$c(),r=N=>Bt({type:"UPDATE_TOAST",toast:{...N,id:t}}),c=()=>Bt({type:"DISMISS_TOAST",toastId:t});return Bt({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:N=>{N||c()}}}),{id:t,dismiss:c,update:r}}function ct(){const[s,t]=a.useState(Ta);return a.useEffect(()=>(Aa.push(t),()=>{const r=Aa.indexOf(t);r>-1&&Aa.splice(r,1)}),[s]),{...s,toast:is,dismiss:r=>Bt({type:"DISMISS_TOAST",toastId:r})}}function Pr(){Bt({type:"REMOVE_TOAST"})}function me(...s){return dl(ml(s))}const _c=xl,ci=a.forwardRef(({className:s,...t},r)=>e.jsx(ln,{ref:r,className:me("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ci.displayName=ln.displayName;const Oc=va("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),oi=a.forwardRef(({className:s,variant:t,...r},c)=>e.jsx(cn,{ref:c,className:me(Oc({variant:t}),s),...r}));oi.displayName=cn.displayName;const Mc=a.forwardRef(({className:s,...t},r)=>e.jsx(on,{ref:r,className:me("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Mc.displayName=on.displayName;const di=a.forwardRef(({className:s,...t},r)=>e.jsx(dn,{ref:r,className:me("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Ue,{className:"h-4 w-4"})}));di.displayName=dn.displayName;const mi=a.forwardRef(({className:s,...t},r)=>e.jsx(mn,{ref:r,className:me("text-sm font-semibold",s),...t}));mi.displayName=mn.displayName;const xi=a.forwardRef(({className:s,...t},r)=>e.jsx(xn,{ref:r,className:me("text-sm opacity-90",s),...t}));xi.displayName=xn.displayName;function zc(){const{toasts:s}=ct();return e.jsxs(_c,{children:[s.map(function({id:t,title:r,description:c,action:N,...y}){return e.jsxs(oi,{...y,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(mi,{children:r}),c&&e.jsx(xi,{children:c})]}),N,e.jsx(di,{})]},t)}),e.jsx(ci,{})]})}const Bc=({...s})=>{const{theme:t="system"}=hl();return e.jsx(ul,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Vc=pl,qc=a.forwardRef(({className:s,sideOffset:t=4,...r},c)=>e.jsx(hn,{ref:c,sideOffset:t,className:me("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));qc.displayName=hn.displayName;const Hc="/api";function Gc(){const s=["adminToken","sellerToken","userToken","authToken","token"];try{for(const t of s){const r=localStorage.getItem(t)||sessionStorage.getItem(t);if(r)return r}}catch{}return""}function Ea(){const s=["adminToken","sellerToken","userToken","authToken","token"];try{for(const t of s)localStorage.removeItem(t),sessionStorage.removeItem(t)}catch{}}function Jc(s){try{s?localStorage.setItem("adminToken",s):Ea()}catch{}}function Wc(s){try{const t=s.split(".");if(t.length!==3)return!1;const r=JSON.parse(atob(t[1])),c=r==null?void 0:r.exp;return c?Date.now()>=c*1e3:!1}catch{return!1}}function Qc(){if(typeof window>"u")return;const s=window.location.pathname||"",t=s.includes("/seller")?"/seller-login?reason=expired":s.includes("/admin")?"/admin/login?reason=expired":"/login?reason=expired";window.location.replace(t)}const yt={baseUrl:String(Hc),createUrl(s){const t=this.baseUrl.replace(/\/$/,""),r=String(s||"").replace(/^\/+/,"");return`${t}/${r}`.replace(/([^:]\/)\/+/g,"$1")},async request(s,t={}){const r=this.createUrl(s),c=new AbortController,N=setTimeout(()=>c.abort(),15e3);try{const y=t.headers||{};let n=Gc();n&&Wc(n)&&(Ea(),n="");const f={...t.body&&typeof FormData<"u"&&t.body instanceof FormData?{}:{"Content-Type":"application/json"},...y};n&&!("Authorization"in f)&&(f.Authorization=`Bearer ${n}`);const u=await fetch(r,{...t,headers:f,signal:c.signal});let S=null;try{S=await u.text()}catch{S=null}finally{clearTimeout(N)}let x=null;if(S&&S.length)try{x=JSON.parse(S)}catch{x=S}if(!u.ok){(u.status===401||u.status===403||typeof x=="object"&&x&&/invalid|expired token/i.test(String(x.message||x.error||"")))&&(Ea(),Qc());const A=new Error(x&&(x.message||x.error)||`HTTP ${u.status}`);throw A.status=u.status,A.data=x,A}return x??{}}catch(y){if(clearTimeout(N),(y==null?void 0:y.name)==="AbortError"){const n=new Error("Request timed out");throw n.status=0,n}throw y}},get(s){return this.request(s,{method:"GET"})},post(s,t){const r=typeof FormData<"u"&&t instanceof FormData;return this.request(s,{method:"POST",body:r?t:t?JSON.stringify(t):void 0})},put(s,t){const r=typeof FormData<"u"&&t instanceof FormData;return this.request(s,{method:"PUT",body:r?t:t?JSON.stringify(t):void 0})},delete(s){return this.request(s,{method:"DELETE"})},setToken(s){Jc(s)},clearToken(){Ea()}},hi=a.createContext(void 0),Ut="adminToken",aa="adminUser";function Kc(s){return(s==null?void 0:s.id)||(s==null?void 0:s._id)||(s==null?void 0:s.uid)||null}const Yc=({children:s})=>{const[t,r]=a.useState(null),[c,N]=a.useState(null),[y,n]=a.useState(!0);a.useEffect(()=>{try{const u=localStorage.getItem("token"),S=localStorage.getItem("user");!!!localStorage.getItem(Ut)&&u&&S&&(localStorage.setItem(Ut,u),localStorage.setItem(aa,S))}catch{}try{const u=localStorage.getItem(Ut),S=localStorage.getItem(aa);if(u&&S){const x=JSON.parse(S);if(u.length>10&&Kc(x))N(u),r(x),yt.setToken(u);else throw new Error("Invalid token or user data")}}catch(u){console.error("Auth boot error:",u),localStorage.removeItem(Ut),localStorage.removeItem(aa)}finally{n(!1)}},[]);const o=(u,S)=>{try{Pr()}catch{}localStorage.setItem(Ut,u),localStorage.setItem(aa,JSON.stringify(S)),N(u),r(S),yt.setToken(u)},f=()=>{var u;try{Pr()}catch{}localStorage.removeItem(Ut),localStorage.removeItem(aa),N(null),r(null),(u=yt.clearToken)==null||u.call(yt)};return e.jsx(hi.Provider,{value:{user:t,token:c,isAuthenticated:!!c&&!!t,login:o,logout:f,loading:y},children:s})},je=()=>{const s=a.useContext(hi);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},ft={apiKey:"AIzaSyAAB9dXWrymvyJSrE8Qg3Op4vXQMEtv2hw",authDomain:"aashish-properties.firebaseapp.com",projectId:"aashish-properties",storageBucket:"aashish-properties.appspot.com",messagingSenderId:"1074799820866",appId:"1:1074799820866:web:60035a614911eb876faddb",measurementId:"G-WJS8TWNW00"},ui=!0,ua=ui;console.log("[FB] isFirebaseConfigured:",ui);const xt={apiKey:ft.apiKey,authDomain:ft.authDomain,projectId:ft.projectId,storageBucket:ft.storageBucket,messagingSenderId:ft.messagingSenderId,appId:ft.appId,measurementId:ft.measurementId};let oa=null,Xc,lr=null,Ia=null;{if(oa=gl(xt),console.log("[FB] Initialized",{projectId:xt.projectId,authDomain:xt.authDomain}),lr=jl(oa),typeof window<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1")&&(lr.settings.appVerificationDisabledForTesting=!0,console.log("[FB][DEV] appVerificationDisabledForTesting = true")),Ia=fl(oa,{experimentalAutoDetectLongPolling:!0,experimentalLongPollingOptions:{timeoutSeconds:30}}),typeof window<"u"&&xt.measurementId)try{Xc=vl(oa)}catch(s){console.warn("[FB] Analytics init skipped:",(s==null?void 0:s.message)||s)}typeof window<"u"&&Ia&&Nl(Ia).catch(s=>{(s==null?void 0:s.code)==="failed-precondition"?console.warn("[FB] Persistence off (multiple tabs)."):(s==null?void 0:s.code)==="unimplemented"?console.warn("[FB] Persistence not supported in this browser."):console.warn("[FB] Persistence error:",(s==null?void 0:s.message)||s)})}const qs=lr,er=Ia,pi=new bl;pi.setCustomParameters({prompt:"select_account"});const Ha=async()=>{if(!qs)throw new Error("Firebase not configured");try{try{const c=await yl(qs);if(c!=null&&c.user){const N=c.user,y=await N.getIdToken(!0);return console.log("[FB][Google] Redirect sign-in OK:",{uid:N.uid,email:N.email}),{idToken:y,profile:{uid:N.uid,email:N.email,name:N.displayName,photoURL:N.photoURL}}}}catch(c){console.warn("[FB][Google] getRedirectResult warn:",(c==null?void 0:c.message)||c)}console.log("[FB][Google] Opening popupâ€¦");const t=(await wl(qs,pi)).user;console.log("[FB][Google] Signed in:",{uid:t.uid,email:t.email});const r=await t.getIdToken(!0);return console.log("[FB][Google] Got ID token length:",r.length),{idToken:r,profile:{uid:t.uid,email:t.email,name:t.displayName,photoURL:t.photoURL}}}catch(s){const t=s;let r="Google authentication failed";switch(t==null?void 0:t.code){case"auth/popup-closed-by-user":r="Authentication cancelled by user";break;case"auth/popup-blocked":r="Popup blocked. Allow popups and retry.";break;case"auth/cancelled-popup-request":r="Authentication cancelled (another popup requested).";break;case"auth/operation-not-allowed":r="Google auth is not enabled in Firebase Console.";break;case"auth/unauthorized-domain":r="Domain not authorized in Firebase Authentication settings.";break;case"auth/network-request-failed":r="Network error. Add your dev/preview domain to Authorized domains.";break;default:r=(t==null?void 0:t.message)||r}throw console.error("[FB][Google] Error:",t==null?void 0:t.code,r),new Error(r)}};class gi{constructor(){ot(this,"recaptcha",null);ot(this,"confirmation",null)}isBrowser(){return typeof window<"u"&&typeof document<"u"}ensureHiddenContainer(){if(!this.isBrowser())throw new Error("OTP is only available in browser");let t=document.getElementById("fb-recaptcha");return t||(t=document.createElement("div"),t.id="fb-recaptcha",t.style.position="fixed",t.style.left="-9999px",t.style.bottom="0",document.body.appendChild(t)),t}ensureRecaptcha(){if(!qs)throw new Error("Firebase not configured");if(this.recaptcha)return this.recaptcha;const t=this.ensureHiddenContainer();return this.recaptcha=new un(qs,t,{size:"invisible"}),this.recaptcha}toE164(t){const r=(t||"").replace(/\D/g,"");return t!=null&&t.startsWith("+")?t:`+91${r}`}async sendOTP(t){var r;if(!qs)throw new Error("Firebase not configured");try{const c=this.ensureRecaptcha(),N=this.toE164(t);console.log("[FB][OTP] Sending to:",N),this.confirmation=await pn(qs,N,c),console.log("[FB][OTP] OTP sent")}catch(c){try{(r=this.recaptcha)==null||r.clear()}catch{}this.recaptcha=null;const N=(c==null?void 0:c.code)||"";throw N==="auth/billing-not-enabled"?(console.error("[FB][OTP][SEND] billing-not-enabled â†’ ensure NO App Check Enterprise & Auth reCAPTCHA Enterprise is OFF."),new Error("Billing not enabled for reCAPTCHA Enterprise. Turn OFF Enterprise (use v2) or enable billing.")):N==="auth/too-many-requests"?new Error("Too many attempts. Please wait a minute and try again."):N==="auth/invalid-phone-number"?new Error("Invalid phone number. Use format +91XXXXXXXXXX."):(console.error("[FB][OTP][SEND]",N,(c==null?void 0:c.message)||c),c)}}async verifyOTP(t){if(!this.confirmation)throw new Error("OTP not sent yet");try{const r=await this.confirmation.confirm(t),c=await r.user.getIdToken(!0);return console.log("[FB][OTP] Verified"),{firebaseUser:r.user,idToken:c}}catch(r){const c=(r==null?void 0:r.code)||"";throw c==="auth/invalid-verification-code"?new Error("Invalid code. Please check and try again."):c==="auth/code-expired"?new Error("Code expired. Please request a new OTP."):(console.error("[FB][OTP][VERIFY]",c,(r==null?void 0:r.message)||r),r)}}reset(){var t;try{(t=this.recaptcha)==null||t.clear()}catch{}this.recaptcha=null,this.confirmation=null}}const ra=new gi,Zc=s=>qs?Cl(qs,s):()=>{},eo=async()=>{qs&&(await Sl(qs),console.log("[FB] Signed out"))};typeof window<"u"&&(window.testGoogle=async()=>{const s=await Ha();return console.log("[TEST] UID:",s.profile.uid,"| Email:",s.profile.email),s.idToken},window.showFbCfg=()=>{console.log("[FB][CFG]",{projectId:xt.projectId,authDomain:xt.authDomain,hasApiKey:!!xt.apiKey,hasAppId:!!xt.appId})});const so=oa,ji=a.createContext(void 0),to=({children:s})=>{const[t,r]=a.useState(null),[c,N]=a.useState(null),[y,n]=a.useState(null),[o,f]=a.useState(!0);a.useEffect(()=>{const v=localStorage.getItem("token"),j=localStorage.getItem("user");if(v&&j)try{const l=JSON.parse(j);if(v.length>10&&l.id)n(v),r(l);else throw new Error("Invalid token or user data")}catch(l){console.error("Error parsing stored user data:",l),localStorage.removeItem("token"),localStorage.removeItem("user")}if(!qs){console.warn("Firebase not configured - skipping auth state listener"),f(!1);return}const m=Zc(async l=>{if(console.log("Firebase auth state changed:",!!l),N(l),l)try{const b=await l.getIdToken(),T=Ja(er,"users",l.uid);let C=null;if(navigator.onLine)try{const P=await yr(T);P.exists()&&(C=P.data())}catch(P){(P==null?void 0:P.code)!=="unavailable"&&console.warn("Firestore getDoc failed:",(P==null?void 0:P.message)||P)}if(!C)try{const P=await kl(T);P.exists()&&(C=P.data())}catch{}if(!C){const P=localStorage.getItem("user");if(P)try{const k=JSON.parse(P);k&&k.id&&(C=k)}catch{}}C?(r(C),n(b),localStorage.setItem("token",b),localStorage.setItem("user",JSON.stringify(C))):console.log("No user profile found (new user or offline without cache)")}catch(b){console.error("Error handling Firebase auth state:",b)}else v||(r(null),n(null));f(!1)});return()=>m()},[]);const d={user:t,firebaseUser:c,token:y,isAuthenticated:!!y&&!!t,loading:o,login:(v,j)=>{localStorage.setItem("token",v),localStorage.setItem("user",JSON.stringify(j)),n(v),r(j)},loginWithFirebase:async(v,j="buyer")=>{try{f(!0);const m=await v.getIdToken();if(!navigator.onLine)throw new Error("You're offline. Please connect to the internet to sign in.");const l=Ja(er,"users",v.uid),b=await yr(l);let T;b.exists()?(T=b.data(),console.log("Existing Firebase user found")):(T={id:v.uid,firebaseUid:v.uid,name:v.displayName||ao(v.phoneNumber)||"User",email:v.email||"",phone:v.phoneNumber||"",userType:j,isFirstLogin:!0,lastLogin:new Date().toISOString()},await Wa(l,T),console.log("New Firebase user profile created")),T.lastLogin=new Date().toISOString(),await Wa(l,T,{merge:!0}),r(T),n(m),localStorage.setItem("token",m),localStorage.setItem("user",JSON.stringify(T)),console.log("Firebase login completed successfully")}catch(m){throw console.error("Error in Firebase login:",m),m}finally{f(!1)}},logout:async()=>{try{c&&await eo(),localStorage.removeItem("token"),localStorage.removeItem("user"),n(null),r(null),N(null),console.log("Logout completed successfully")}catch(v){throw console.error("Error during logout:",v),v}},updateUserProfile:async v=>{if(!t||!c)throw new Error("No user authenticated");try{const j={...t,...v};if(!navigator.onLine){r(j),localStorage.setItem("user",JSON.stringify(j)),console.warn("Offline: queued local profile update; will sync when online.");return}const m=Ja(er,"users",c.uid);await Wa(m,j,{merge:!0}),r(j),localStorage.setItem("user",JSON.stringify(j)),console.log("User profile updated successfully")}catch(j){throw console.error("Error updating user profile:",j),j}}};return e.jsx(ji.Provider,{value:d,children:s})},fr=()=>{const s=a.useContext(ji);if(s===void 0)throw new Error("useFirebaseAuth must be used within a FirebaseAuthProvider");return s},ao=s=>s?`User${s.slice(-4)}`:"User",vr=va("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),g=a.forwardRef(({className:s,variant:t,size:r,asChild:c=!1,...N},y)=>{const n=c?Pl:"button";return e.jsx(n,{className:me(vr({variant:t,size:r,className:s})),ref:y,...N})});g.displayName="Button";class ro extends ur.Component{constructor(r){super(r);ot(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,c){console.error("ðŸš¨ Error caught by boundary:",r),console.error("ðŸ“ Error info:",c),this.setState({errorInfo:c})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[e.jsx(rs,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error. You can try refreshing the page or go back to the previous page."}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(g,{onClick:this.handleRetry,className:"bg-[#C70000] hover:bg-[#A60000] text-white flex-1",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx(g,{onClick:()=>window.location.reload(),variant:"outline",className:"flex-1",children:"Refresh Page"})]})]})}):this.props.children}}function no(){const[s,t]=a.useState([]);a.useEffect(()=>{const o=S=>{const{pageId:x,title:A,slug:d}=S.detail||{};r({type:"page_published",title:"New Page Published",message:`"${A}" is now live and appears in the footer`,autoHide:!0})},f=S=>{const{pageId:x,title:A,slug:d}=S.detail||{};r({type:"page_unpublished",title:"Page Unpublished",message:`"${A}" has been removed from the footer`,autoHide:!0})},u=()=>{r({type:"footer_updated",title:"Footer Updated",message:"Footer links and content have been refreshed",autoHide:!0})};return window.addEventListener("pagePublished",o),window.addEventListener("pageUnpublished",f),window.addEventListener("footerUpdate",u),window.addEventListener("footerRefresh",u),()=>{window.removeEventListener("pagePublished",o),window.removeEventListener("pageUnpublished",f),window.removeEventListener("footerUpdate",u),window.removeEventListener("footerRefresh",u)}},[]);const r=o=>{const f={id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,timestamp:new Date,...o};t(u=>[...u,f]),o.autoHide&&setTimeout(()=>{c(f.id)},5e3)},c=o=>{t(f=>f.filter(u=>u.id!==o))},N=()=>{window.location.reload()},y=o=>{switch(o){case"page_published":case"footer_updated":return e.jsx(Le,{className:"h-4 w-4 text-green-500"});case"page_unpublished":return e.jsx(ds,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(ds,{className:"h-4 w-4 text-blue-500"})}},n=o=>{switch(o){case"page_published":case"footer_updated":return"border-green-200 bg-green-50";case"page_unpublished":return"border-orange-200 bg-orange-50";default:return"border-blue-200 bg-blue-50"}};return s.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm",children:s.map(o=>e.jsx("div",{className:`border rounded-lg p-4 shadow-lg transition-all duration-300 ${n(o.type)}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[y(o.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:o.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.message}),e.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[e.jsxs(g,{size:"sm",variant:"outline",onClick:N,className:"text-xs h-6 px-2",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"Refresh"]}),e.jsx("span",{className:"text-xs text-gray-400",children:o.timestamp.toLocaleTimeString()})]})]}),e.jsx("button",{onClick:()=>c(o.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ue,{className:"h-4 w-4"})})]})},o.id))})}const fi=()=>{if(typeof window>"u")return"server";const{hostname:s,port:t}=window.location;return s==="localhost"||s==="127.0.0.1"||t==="8080"?"development":s.includes(".fly.dev")?"fly":s.includes(".netlify.app")?"netlify":"production"},io=()=>{const s=fi();if(console.log("ðŸŽ¯ Detected environment:",s),typeof window<"u"){const{protocol:t,hostname:r,port:c}=window.location;switch(console.log("ðŸ“ Current location:",{protocol:t,hostname:r,port:c,href:window.location.href}),s){case"development":return"";case"fly":return"";case"netlify":return"";case"production":default:return c&&c!=="80"&&c!=="443"?`${t}//${r}`:""}}return""},lo=io(),vi=fi(),Bs={baseUrl:lo,timeout:vi==="development"?8e3:15e3,retryAttempts:2,retryDelay:1e3},Js=s=>{const t=s.startsWith("/")?s.slice(1):s;if(console.log("ðŸ”— API Config:",{baseUrl:Bs.baseUrl,endpoint:t,currentLocation:typeof window<"u"?window.location.href:"server"}),Bs.baseUrl)if(Bs.baseUrl.endsWith("/api")){const c=`${Bs.baseUrl}/${t}`;return console.log("ðŸŒ Full API URL (baseUrl has /api):",c),c}else{const c=`${Bs.baseUrl}/api/${t}`;return console.log("ðŸŒ Full API URL:",c),c}const r=`/api/${t}`;return console.log("ðŸ  Relative API URL:",r),console.log("ðŸŒ Environment:",vi),r},da=()=>{try{return localStorage.getItem("adminToken")||localStorage.getItem("token")}catch{return null}},Ps=async(s,t={},r=0)=>{const c=Js(s);typeof window<"u"&&window.location.hostname.includes("projects.builder.codes")&&!Bs.baseUrl&&console.warn("âš ï¸ Running inside Builder preview without VITE_API_BASE_URL. Attempting relative /api/* requests with reduced timeouts. For reliable operation set VITE_API_BASE_URL to your backend.");const y=new AbortController,n=s.includes("chat/unread-count")?Math.max(Bs.timeout,3e4):Bs.timeout;let u=["upload","categories","subcategories","create","delete"].some(x=>s.includes(x))?Math.max(n,45e3):n;typeof window<"u"&&window.location.hostname.includes("projects.builder.codes")&&!Bs.baseUrl&&(u=Math.min(u,8e3));const S=setTimeout(()=>{try{if(typeof y.abort=="function")try{y.abort(new Error("timeout"))}catch{y.abort()}else y.abort()}catch{}},u);try{const x=t.headers??{},A=da(),d={};t.body&&typeof FormData<"u"&&t.body instanceof FormData||(d["Content-Type"]="application/json"),A&&!("Authorization"in x)&&(d.Authorization=`Bearer ${A}`);const j=await fetch(c,{...t,signal:y.signal,headers:{...d,...x},credentials:"include"});clearTimeout(S);let m={};try{const b=await j.clone().text();if(b&&b.trim())try{m=JSON.parse(b)}catch{m={raw:b}}}catch{try{m=await j.json()}catch{m={}}}return j.ok||console.warn("âš ï¸ API responded with error",{url:c,status:j.status,data:m}),{data:m,status:j.status,ok:j.ok}}catch(x){return clearTimeout(S),((x==null?void 0:x.name)==="AbortError"||String((x==null?void 0:x.message)||"").toLowerCase().includes("timeout")||String((x==null?void 0:x.message)||"").toLowerCase().includes("failed to fetch")||String((x==null?void 0:x.message)||"").toLowerCase().includes("network error"))&&r<Bs.retryAttempts?(await new Promise(v=>setTimeout(v,Bs.retryDelay)),Ps(s,t,r+1)):typeof window<"u"&&window.location.hostname.includes("projects.builder.codes")&&!Bs.baseUrl?(console.warn("âš ï¸ apiRequest failed in Builder preview without API_BASE. Returning graceful failure.",(x==null?void 0:x.message)||x),{data:null,status:0,ok:!1}):(console.error("apiRequest network error:",(x==null?void 0:x.message)||x),{data:null,status:0,ok:!1})}},ce={get:async(s,t)=>{var N,y,n;const r=t??da(),c=r?{Authorization:`Bearer ${r}`}:{};try{const o=await Ps(s,{method:"GET",headers:c});if(!o.ok){if(o.status===401||o.status===403){try{localStorage.removeItem("token"),localStorage.removeItem("adminToken"),localStorage.removeItem("user")}catch{}return console.warn("api.get: authorization failed, redirecting to /auth"),typeof window<"u"&&setTimeout(()=>window.location.href="/auth",300),{data:null}}throw new Error(((N=o.data)==null?void 0:N.error)||((y=o.data)==null?void 0:y.message)||(typeof((n=o.data)==null?void 0:n.raw)=="string"?o.data.raw:"")||`HTTP ${o.status}`)}return{data:o.data}}catch(o){return console.warn(`api.get(${s}) failed:`,(o==null?void 0:o.message)||o),{data:null}}},post:async(s,t,r)=>{var n,o,f;const c=r??da(),N=c?{Authorization:`Bearer ${c}`}:{},y=await Ps(s,{method:"POST",body:t?JSON.stringify(t):void 0,headers:N});if(!y.ok){const u=((n=y.data)==null?void 0:n.error)||((o=y.data)==null?void 0:o.message)||(typeof((f=y.data)==null?void 0:f.raw)=="string"?y.data.raw:"")||`HTTP ${y.status}`,S=new Error(u);throw S.data=y.data,S.status=y.status,S}return{data:y.data}},put:async(s,t,r)=>{var n,o,f;const c=r??da(),N=c?{Authorization:`Bearer ${c}`}:{},y=await Ps(s,{method:"PUT",body:t?JSON.stringify(t):void 0,headers:N});if(!y.ok)throw new Error(((n=y.data)==null?void 0:n.error)||((o=y.data)==null?void 0:o.message)||(typeof((f=y.data)==null?void 0:f.raw)=="string"?y.data.raw:"")||`HTTP ${y.status}`);return{data:y.data}},delete:async(s,t)=>{var y,n,o;const r=t??da(),c=r?{Authorization:`Bearer ${r}`}:{},N=await Ps(s,{method:"DELETE",headers:c});if(!N.ok)throw new Error(((y=N.data)==null?void 0:y.error)||((n=N.data)==null?void 0:n.message)||(typeof((o=N.data)==null?void 0:o.raw)=="string"?N.data.raw:"")||`HTTP ${N.status}`);return{data:N.data}}},Vs=Object.freeze(Object.defineProperty({__proto__:null,API_CONFIG:Bs,api:ce,apiRequest:Ps,createApiUrl:Js},Symbol.toStringTag,{value:"Module"})),Cs=async s=>{let t={};try{const c=await s.clone().text().catch(()=>"");if(c&&c.trim())try{t=JSON.parse(c)}catch{t=c}}catch(r){console.warn("Could not parse response as JSON:",r),t={}}return{ok:s.ok,status:s.status,data:t}},Os=(s,t,r)=>s!=null&&s.error?s.error:`Failed to ${r} (${t})`,co=Object.freeze(Object.defineProperty({__proto__:null,getApiErrorMessage:Os,safeReadResponse:Cs},Symbol.toStringTag,{value:"Module"}));if(typeof window<"u"&&typeof window.fetch=="function"){const s=window.fetch.bind(window);window.fetch=(...t)=>{try{return s(...t).catch(c=>{const N=(c==null?void 0:c.message)||String(c);return(c==null?void 0:c.name)==="AbortError"||String(N).toLowerCase().includes("aborted")||String(N).toLowerCase().includes("timeout")?(console.debug("Fetch aborted/timeout (normalized):",N),Promise.resolve({ok:!1,status:408,async json(){return{error:"timeout"}},async text(){return""},clone(){return this}})):(console.error("Wrapped fetch network error:",N||c),{ok:!1,status:0,async json(){return{error:"Network error"}},async text(){return""},clone(){return this}})})}catch(r){return(r==null?void 0:r.name)==="AbortError"||String((r==null?void 0:r.message)||"").toLowerCase().includes("aborted")||String((r==null?void 0:r.message)||"").toLowerCase().includes("timeout")?Promise.reject(r):(console.error("Wrapped fetch unexpected error:",r),Promise.resolve({ok:!1,status:0,async json(){return{error:"Network error"}},async text(){return""},clone(){return this}}))}}}function oo(s,t={}){const r=localStorage.getItem("token"),c=Js(s);console.log("ðŸš€ Global API call:",{endpoint:s,url:c,method:t.method||"GET",hasToken:!!r,hasBody:!!t.body});let N;t.body&&(typeof t.body=="string"?N=t.body:N=JSON.stringify(t.body));const y=new AbortController,n=typeof t.timeout=="number"?t.timeout:15e3,o=setTimeout(()=>{try{y.abort()}catch{}console.warn(`â° API request timeout after ${n}ms:`,c)},n),f=(t.method||"GET").toUpperCase(),u={...t.headers||{},...r?{Authorization:`Bearer ${r}`}:{}};N&&!u["Content-Type"]&&(u["Content-Type"]="application/json");const S=async()=>{try{return await fetch(c,{method:f,headers:u,body:N,signal:y.signal,keepalive:!!t.keepalive,credentials:t.credentials||"include",cache:t.cache||"no-store",referrerPolicy:"no-referrer"})}catch(A){throw A}},x=()=>new Promise(A=>{try{const d=new XMLHttpRequest;d.open(f,c,!0),Object.entries(u).forEach(([v,j])=>d.setRequestHeader(v,j)),d.timeout=n,d.onreadystatechange=()=>{if(d.readyState===4){let v={};try{v=d.responseText?JSON.parse(d.responseText):{}}catch{v={raw:d.responseText}}A({ok:d.status>=200&&d.status<300,status:d.status,data:v})}},d.ontimeout=()=>A({ok:!1,status:408,data:{error:"Request timeout"}}),d.onerror=()=>A({ok:!1,status:0,data:{error:"Network error"}}),d.send(N||null)}catch(d){A({ok:!1,status:0,data:{error:(d==null?void 0:d.message)||"Network error"}})}});return t.transport==="xhr"?x().then(A=>({ok:A.ok,status:A.status,success:A.ok,data:A.data,json:A.data})):(async()=>{try{const A=await S();clearTimeout(o),console.log("âœ… Global API response",{url:c,status:A.status,ok:A.ok});const{ok:d,status:v,data:j}=await Cs(A);return{ok:d,status:v,success:d,data:j,json:j}}catch(A){try{console.warn("âš ï¸ fetch failed, attempting XHR fallback:",c,(A==null?void 0:A.message)||A);const d=await x();return clearTimeout(o),{ok:d.ok,status:d.status,success:d.ok,data:d.data,json:d.data}}catch(d){return clearTimeout(o),(A==null?void 0:A.name)==="AbortError"||String((A==null?void 0:A.message)||"").toLowerCase().includes("aborted")||String((d==null?void 0:d.message)||"").toLowerCase().includes("timeout")?{ok:!1,status:408,success:!1,data:{error:"timeout"},json:{error:"timeout"}}:{ok:!1,status:0,success:!1,data:{error:"Network error"},json:{error:"Network error"}}}}})()}window.api=oo;const cr=["Model Town","Sector 1","Sector 2","Sector 3","Sector 4","Sector 5","Sector 6","Sector 7","Sector 8","Sector 9","Sector 10","Sector 11","Sector 12","Sector 13","Sector 14","Sector 15","Sector 16","Sector 17","Sector 18","Sector 19","Sector 20","Delhi Road","Sonipat Road","Jind Road","Bhiwani Road","Hisar Road","Jhajjar Road","Panipat Road","Civil Lines","Old City","Railway Road","Jail Road","Bohar Road","Subhash Nagar","Shastri Nagar","Prem Nagar","DLF Colony","Ram Nagar","Krishan Nagar","Vikas Nagar","Ashok Nagar","Nehru Nagar","Gandhi Nagar","Indira Colony","Arya Nagar","Saraswati Nagar","Hanuman Nagar","Gayatri Nagar","Laxmi Nagar","Durga Colony","Shiv Colony","Rama Park","Bal Bhawan Road","Near Bus Stand","Near Railway Station","Gali Baldev Singh","Gali Toshan Singh","Main Market","Sunheri Gate","Kachha Bazar","Grain Market","Cloth Market","Hardware Market","Industrial Area","HUDA Sector","IMT Rohtak","Mansarovar Park","Pushpa Vihar","Ashoka Enclave","Green City","Omaxe City","Supertech Eco Village","TDI City","Ansal Royal Heritage","Near PGI Rohtak","Near AIIMS Rohtak","Near MDU","Near District Court","Near Government College","Near Rohtak Medical College","GPS Colony","Police Lines","ITI Road","College Road","Stadium Road","Hospital Road","Mini Secretariat","DC Office Area","SP Office Area","Collectorate Area","Bank Colony","Teacher Colony","Doctor Colony","Engineer Colony"],mo=va("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function re({className:s,variant:t,...r}){return e.jsx("div",{className:me(mo({variant:t}),s),...r})}function xo({onClose:s}){var j,m,l,b;const{user:t,logout:r}=je(),[c,N]=a.useState([]),[y,n]=a.useState(!0),[o,f]=a.useState({totalProperties:0,pendingApproval:0,approved:0,totalViews:0,totalInquiries:0,unreadNotifications:0,totalClients:0,closedDeals:0,commission:0,favorites:0,recentViews:0});a.useEffect(()=>{u()},[t]);const u=async()=>{var T,C,P;try{const k=localStorage.getItem("token");if(!k)return;if((t==null?void 0:t.userType)==="seller"){const h=await ce.get("/seller/stats",k);if((T=h==null?void 0:h.data)!=null&&T.success&&h.data.data){const E=h.data.data;f(L=>({...L,totalProperties:E.totalProperties||0,pendingApproval:E.pendingApproval||0,approved:E.approved||0,totalViews:E.totalViews||0,totalInquiries:E.totalInquiries||0,unreadNotifications:E.unreadNotifications||0}))}const w=await ce.get("/seller/properties",k);if((C=w==null?void 0:w.data)!=null&&C.success){const E=w.data.data;N(E)}}else if((t==null?void 0:t.userType)==="agent"){const h=await ce.get("/user/properties",k);if((P=h==null?void 0:h.data)!=null&&P.success){const w=h.data.data;N(w);const E=w.reduce((q,V)=>q+(V.views||0),0),L=w.reduce((q,V)=>q+(V.inquiries||0),0);f(q=>({...q,totalProperties:w.length,pendingApproval:w.filter(V=>V.approvalStatus==="pending").length,approved:w.filter(V=>V.approvalStatus==="approved").length,totalViews:E,totalInquiries:L}))}}(t==null?void 0:t.userType)==="agent"?f(h=>({...h,totalClients:25,closedDeals:12,commission:45e4})):(t==null?void 0:t.userType)==="buyer"&&f(h=>{var w;return{...h,favorites:((w=t==null?void 0:t.favorites)==null?void 0:w.length)||0,recentViews:5}})}catch(k){console.error("Error fetching dashboard data:",k)}finally{n(!1)}},S=()=>{r(),s(),window.location.href="/"},x=T=>{s(),window.location.href=T},A=()=>{switch(t==null?void 0:t.userType){case"seller":return e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.totalProperties}),e.jsx("div",{className:"text-xs text-blue-700",children:"Total Listings"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:o.approved}),e.jsx("div",{className:"text-xs text-green-700",children:"Approved"})]}),e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:o.pendingApproval}),e.jsx("div",{className:"text-xs text-yellow-700",children:"Pending"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:o.totalViews}),e.jsx("div",{className:"text-xs text-purple-700",children:"Total Views"})]})]});case"agent":return e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.totalProperties}),e.jsx("div",{className:"text-xs text-blue-700",children:"Active Listings"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:o.totalClients}),e.jsx("div",{className:"text-xs text-green-700",children:"Total Clients"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:o.closedDeals}),e.jsx("div",{className:"text-xs text-purple-700",children:"Closed Deals"})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-orange-600",children:["â‚¹",(o.commission/1e3).toFixed(0),"K"]}),e.jsx("div",{className:"text-xs text-orange-700",children:"Commission"})]})]});case"buyer":return e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:o.favorites}),e.jsx("div",{className:"text-xs text-red-700",children:"Favorites"})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.recentViews}),e.jsx("div",{className:"text-xs text-blue-700",children:"Recent Views"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:"2"}),e.jsx("div",{className:"text-xs text-green-700",children:"Saved Searches"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:"3"}),e.jsx("div",{className:"text-xs text-purple-700",children:"Inquiries"})]})]});default:return e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:o.totalProperties}),e.jsx("div",{className:"text-xs text-blue-700",children:"My Properties"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:o.approved}),e.jsx("div",{className:"text-xs text-green-700",children:"Approved"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:o.totalViews}),e.jsx("div",{className:"text-xs text-purple-700",children:"Total Views"})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:"0"}),e.jsx("div",{className:"text-xs text-orange-700",children:"Notifications"})]})]})}},d=()=>{const T=[{icon:e.jsx(bs,{className:"h-4 w-4"}),label:"Settings",path:"/settings"},{icon:e.jsx(Ce,{className:"h-4 w-4"}),label:"Messages",path:"/messages"}],P=[...{seller:[{icon:e.jsx(we,{className:"h-4 w-4"}),label:"Post Property",path:"/post-property"},{icon:e.jsx(Pe,{className:"h-4 w-4"}),label:"My Properties",path:"/my-properties"},{icon:e.jsx(as,{className:"h-4 w-4"}),label:"Blog",path:"/seller/blog"}],agent:[{icon:e.jsx(we,{className:"h-4 w-4"}),label:"Add Listing",path:"/post-property"},{icon:e.jsx(Ae,{className:"h-4 w-4"}),label:"Clients",path:"/clients"}],buyer:[{icon:e.jsx(xs,{className:"h-4 w-4"}),label:"Wishlist",path:"/wishlist"},{icon:e.jsx(Ne,{className:"h-4 w-4"}),label:"Recent Views",path:"/recent-views"}]}[t==null?void 0:t.userType]||[],...T];return e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick Actions"}),P.map((k,h)=>e.jsxs("button",{onClick:()=>x(k.path),className:"w-full flex items-center space-x-3 px-3 py-2 hover:bg-gray-100 rounded-lg text-left transition-colors",children:[k.icon,e.jsx("span",{className:"text-sm",children:k.label}),e.jsx(gt,{className:"h-3 w-3 ml-auto"})]},h))]})},v=()=>{switch(t==null?void 0:t.userType){case"seller":return"/enhanced-seller-dashboard";case"agent":return"/agent-dashboard";case"buyer":return"/buyer-dashboard";case"admin":return"/admin";default:return"/user-dashboard"}};return y?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[1,2,3,4].map(T=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},T))})]})}):e.jsxs("div",{className:"p-4 max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:"w-12 h-12 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-lg",children:(m=(j=t==null?void 0:t.name)==null?void 0:j.charAt(0))==null?void 0:m.toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t==null?void 0:t.name}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(re,{variant:"outline",className:"text-xs",children:[(t==null?void 0:t.userType)==="agent"&&e.jsx(Ot,{className:"h-3 w-3 mr-1"}),(t==null?void 0:t.userType)==="seller"&&e.jsx(Pe,{className:"h-3 w-3 mr-1"}),(t==null?void 0:t.userType)==="buyer"&&e.jsx(hs,{className:"h-3 w-3 mr-1"}),((l=t==null?void 0:t.userType)==null?void 0:l.charAt(0).toUpperCase())+((b=t==null?void 0:t.userType)==null?void 0:b.slice(1))]})})]})]}),A(),d(),((t==null?void 0:t.userType)==="seller"||(t==null?void 0:t.userType)==="agent")&&c.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Listings"}),e.jsx("div",{className:"space-y-2",children:c.slice(0,3).map(T=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center flex-shrink-0",children:e.jsx(Pe,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:T.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["â‚¹",T.price.toLocaleString()]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[T.views," views"]})]})]}),e.jsx(re,{variant:T.approvalStatus==="approved"?"default":"outline",className:"text-xs",children:T.approvalStatus})]},T._id))})]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>x(v()),className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white py-2 px-4 rounded-lg text-sm font-medium transition-colors",children:"View Full Dashboard"})}),e.jsxs("div",{className:"space-y-1 mb-4 border-t border-gray-200 pt-4",children:[e.jsx("button",{onClick:()=>x("/"),className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Home"}),e.jsx("button",{onClick:()=>x("/categories"),className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Categories"}),e.jsx("button",{onClick:()=>x("/properties"),className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded-lg text-sm",children:"Browse Properties"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("button",{onClick:S,className:"w-full flex items-center space-x-2 px-3 py-2 text-[#C70000] hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})})]})}const ho="modulepreload",uo=function(s){return"/"+s},Ar={},_s=function(t,r,c){let N=Promise.resolve();if(r&&r.length>0){let n=function(u){return Promise.all(u.map(S=>Promise.resolve(S).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),f=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));N=n(r.map(u=>{if(u=uo(u),u in Ar)return;Ar[u]=!0;const S=u.endsWith(".css"),x=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${x}`))return;const A=document.createElement("link");if(A.rel=S?"stylesheet":ho,S||(A.as="script"),A.crossOrigin="",A.href=u,f&&A.setAttribute("nonce",f),document.head.appendChild(A),S)return new Promise((d,v)=>{A.addEventListener("load",d),A.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function y(n){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n}return N.then(n=>{for(const o of n||[])o.status==="rejected"&&y(o.reason);return t().catch(y)})},po=()=>{const[s,t]=a.useState(0);return a.useEffect(()=>{let r=!0;const c=async()=>{try{const y=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!y)return;const n=await(await _s(async()=>{const{api:o}=await Promise.resolve().then(()=>Vs);return{api:o}},void 0)).api.get("notifications/unread-count",y);if(!n||!n.data||!n.data.data)return;r&&t(Number(n.data.data.unread||0))}catch(y){console.warn("notifications unread fetch failed:",(y==null?void 0:y.message)||y)}};c();const N=setInterval(c,1e4);return()=>{r=!1,clearInterval(N)}},[]),s};function Me(){const{user:s,isAuthenticated:t,logout:r}=je(),[c,N]=a.useState(""),[y,n]=a.useState(""),[o,f]=a.useState(!1),[u,S]=a.useState(!1),[x,A]=a.useState(-1),[d,v]=a.useState(()=>{try{return JSON.parse(localStorage.getItem("recent_searches")||"[]")}catch{return[]}}),j=po();a.useEffect(()=>{const h=setTimeout(()=>n(c.trim()),250);return()=>clearTimeout(h)},[c]);const m=h=>{const w=h.toLowerCase().match(/^(sec|sector)\s*-?\s*(\d+[a-zA-Z]?)$/);return w?`Sector-${w[2]}`:h},l=h=>{const w="Rohtak",E=m(h);try{const L={city:w,sector:E,lat:null,lng:null};sessionStorage.setItem("selected_location",JSON.stringify(L));const q=[h,...d.filter(V=>V!==h)].slice(0,5);v(q),localStorage.setItem("recent_searches",JSON.stringify(q))}catch{}window.location.href=`/properties?search=${encodeURIComponent(`${E}, ${w}`)}`},b=h=>{h.preventDefault(),c.trim()&&l(c.trim()),S(!1)},T=cr.filter(h=>h.toLowerCase().includes(y.toLowerCase())),C=(y?T:[...d,...cr.slice(0,5)]).slice(0,20),P=()=>{t?window.location.href="/wishlist":window.location.href=`/login?redirectTo=${encodeURIComponent("/wishlist")}`},k=()=>{f(!o)};return e.jsxs("header",{className:"bg-[#C70000] border-b border-red-800 sticky top-0 z-40",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:k,className:"p-2 hover:bg-red-700 rounded-lg transition-colors",children:e.jsx(Ba,{className:"h-6 w-6 text-white"})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"text-2xl font-bold text-white",children:"Ashish Properties"})}),e.jsxs("button",{onClick:()=>window.location.href="/notifications",className:"relative p-2 hover:bg-red-700 rounded-lg transition-colors text-white","aria-label":"Notifications",children:[e.jsx(Es,{className:"h-6 w-6"}),j>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-white text-[#C70000] text-xs font-bold rounded-full h-5 min-w-[1.25rem] px-1 flex items-center justify-center",children:j>9?"9+":j})]})]}),e.jsx("div",{className:"mt-3 relative",children:e.jsxs("form",{onSubmit:b,className:"relative",onKeyDown:h=>{!u||C.length===0||(h.key==="ArrowDown"&&(h.preventDefault(),A(w=>Math.min(w+1,C.length-1))),h.key==="ArrowUp"&&(h.preventDefault(),A(w=>Math.max(w-1,0))),h.key==="Enter"&&x>=0&&(h.preventDefault(),l(C[x]),S(!1)))},children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search properties in Rohtak...",value:c,onChange:h=>{N(h.target.value),A(-1),S(!0)},onFocus:()=>S(!0),onBlur:()=>setTimeout(()=>S(!1),120),className:"w-full pl-10 pr-12 py-3 border-2 border-white border-opacity-30 rounded-lg focus:border-white focus:outline-none text-white placeholder-white placeholder-opacity-70 bg-white bg-opacity-20 backdrop-blur-sm"}),e.jsx("button",{type:"button",onClick:P,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 hover:bg-white hover:bg-opacity-20 rounded transition-colors",children:e.jsx(xs,{className:"h-5 w-5 text-white opacity-70"})})]}),u&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-lg shadow-lg border z-50 max-h-64 overflow-y-auto w-full",children:[!y&&d.length>0&&e.jsxs("div",{className:"p-2 border-b border-gray-100",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2 px-2 flex items-center space-x-1",children:[e.jsx(cs,{className:"h-3 w-3"}),e.jsx("span",{children:"Recent"})]}),d.map(h=>e.jsxs("button",{type:"button",onClick:()=>l(h),className:"w-full text-left px-3 py-3 hover:bg-gray-50 rounded flex items-center space-x-2 min-h-11 whitespace-normal break-words",children:[e.jsx(He,{className:"h-4 w-4 text-[#C70000]"}),e.jsx("span",{className:"text-gray-900",children:h})]},`recent-${h}`))]}),e.jsxs("div",{className:"p-2",children:[!y&&e.jsx("div",{className:"text-xs text-gray-500 mb-2 px-2",children:"Popular nearby"}),C.map((h,w)=>e.jsxs("button",{type:"button",onMouseEnter:()=>A(w),onClick:()=>l(h),className:`w-full text-left px-3 py-3 rounded flex items-center space-x-2 min-h-11 whitespace-normal break-words ${x===w?"bg-gray-100":"hover:bg-gray-50"}`,children:[e.jsx(He,{className:"h-4 w-4 text-[#C70000]"}),e.jsx("span",{className:"text-gray-900",children:h})]},`sugg-${h}-${w}`))]})]})]})})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:()=>f(!1),children:e.jsxs("div",{className:"bg-white w-80 h-full",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t?"Dashboard":"Menu"}),e.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"âœ•"})]}),t?e.jsx(xo,{onClose:()=>f(!1)}):e.jsxs("div",{className:"p-4",children:[e.jsxs("nav",{className:"space-y-2 mb-8",children:[e.jsx("a",{href:"/",className:"block px-4 py-3 hover:bg-gray-100 rounded-lg text-gray-700",children:"Home"}),e.jsx("a",{href:"/categories",className:"block px-4 py-3 hover:bg-gray-100 rounded-lg text-gray-700",children:"Categories"}),e.jsx("a",{href:"/post-property",className:"block px-4 py-3 hover:bg-gray-100 rounded-lg text-gray-700",children:"Sell"}),e.jsx("a",{href:"/my-account",className:"block px-4 py-3 hover:bg-gray-100 rounded-lg text-gray-700",children:"My Account"})]}),e.jsx("div",{className:"pt-6 border-t border-gray-200",children:e.jsx("a",{href:"/auth",className:"block px-4 py-3 text-[#C70000] font-semibold hover:bg-red-50 rounded-lg",children:"Login / Sign Up"})})]})]})})]})}const U=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:me("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));U.displayName="Card";const K=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:me("flex flex-col space-y-1.5 p-6",s),...t}));K.displayName="CardHeader";const Y=a.forwardRef(({className:s,...t},r)=>e.jsx("h3",{ref:r,className:me("text-2xl font-semibold leading-none tracking-tight",s),...t}));Y.displayName="CardTitle";const Vt=a.forwardRef(({className:s,...t},r)=>e.jsx("p",{ref:r,className:me("text-sm text-muted-foreground",s),...t}));Vt.displayName="CardDescription";const _=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:me("p-6 pt-0",s),...t}));_.displayName="CardContent";const go=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:me("flex items-center p-6 pt-0",s),...t}));go.displayName="CardFooter";class jo extends a.Component{constructor(r){super(r);ot(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,c){console.error("API Error Boundary caught an error:",r,c),this.setState({error:r,errorInfo:c}),(r.message.includes("Failed to fetch")||r.message.includes("Network error")||r.message.includes("timeout"))&&console.warn("ðŸŒ Network connectivity issue detected:",r.message)}render(){var r,c,N,y,n,o;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const f=((c=(r=this.state.error)==null?void 0:r.message)==null?void 0:c.includes("Failed to fetch"))||((y=(N=this.state.error)==null?void 0:N.message)==null?void 0:y.includes("Network error"))||((o=(n=this.state.error)==null?void 0:n.message)==null?void 0:o.includes("timeout"));return e.jsxs(U,{className:"max-w-md mx-auto my-8",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2 text-orange-600",children:[f?e.jsx(gn,{className:"h-5 w-5"}):e.jsx(rs,{className:"h-5 w-5"}),e.jsx("span",{children:f?"Connection Issue":"Something went wrong"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:f?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"We're having trouble connecting to our servers."}),this.props.showNetworkHint&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-blue-800 text-xs",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tips:"})]}),e.jsxs("ul",{className:"text-blue-700 text-xs mt-1 space-y-1",children:[e.jsx("li",{children:"â€¢ Check your internet connection"}),e.jsx("li",{children:"â€¢ Try refreshing the page"}),e.jsx("li",{children:"â€¢ Some content may work in offline mode"})]})]})]}):e.jsx("p",{children:"An unexpected error occurred while loading this content."})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:this.handleRetry,size:"sm",className:"flex-1",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Try Again"]}),f&&e.jsx(g,{onClick:()=>window.location.reload(),variant:"outline",size:"sm",children:"Refresh Page"})]}),!1]})]})}return this.props.children}}const fo=(s,t)=>{const r=c=>e.jsx(jo,{fallback:t,showNetworkHint:!0,children:e.jsx(s,{...c})});return r.displayName=`withApiErrorBoundary(${s.displayName||s.name})`,r},vo={Cars:jn,Properties:Ft,Mobiles:Ht,Jobs:Ot,Fashion:Fl,Bikes:Il,"Electronics & Appliances":El,"Commercial Vehicles & Spares":Tl,Furniture:Al,Pets:xs},Ts=s=>(s||"").trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9\-]/g,""),No=(s,...t)=>{const r=Ts(s.slug)||Ts(s.name);return t.map(Ts).includes(r)},Tr={"new-projects":"/new-projects",maps:"/maps",buy:"/buy",sale:"/sale",sell:"/post-property",rent:"/rent",lease:"/lease",pg:"/pg","other-services":"/other-services/other-services",commercial:"/commercial"};function bo(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState([]),[y,n]=a.useState(!0),[o,f]=a.useState(null),[u,S]=a.useState([]),x=[{name:"Sell",slug:"sell"},{name:"Buy",slug:"buy"},{name:"Other Services",slug:"other-services"},{name:"Rent",slug:"rent"},{name:"New Projects",slug:"new-projects"},{name:"Maps",slug:"maps"},{name:"Commercial Properties",slug:"commercial"},{name:"Cars",slug:"cars"},{name:"Mobiles",slug:"mobiles"},{name:"Jobs",slug:"jobs"},{name:"Furniture",slug:"furniture"}];a.useEffect(()=>{(async()=>{var d,v;N([]),r(x);try{const j=new AbortController,m=setTimeout(()=>j.abort(),5e3),l=await((d=window.api)==null?void 0:d.call(window,"/categories?active=true"));if(clearTimeout(m),l!=null&&l.ok&&((v=l.json)!=null&&v.success)&&Array.isArray(l.json.data)&&l.json.data.length){let b=l.json.data.slice(0,10);b.some(C=>Ts(C.slug)==="maps"||Ts(C.name)==="maps")||(b=[{name:"Maps",slug:"maps"},...b].slice(0,10)),r(b)}}catch{}finally{n(!1)}})()},[]);const A=d=>{const v=Ts(d.slug)||Ts(d.name);if(v&&Tr[v]){s(Tr[v]);return}if(No(d,"buy","sale","rent","lease","pg")){s(`/${Ts(d.slug)}`);return}const j=Ts(d.slug)||Ts(d.name)||"category";s(`/categories/${j}`)};return y?e.jsxs("div",{className:"bg-white",children:[e.jsx("div",{className:"mx-4 mt-4 mb-6",children:e.jsx("div",{className:"bg-blue-100 rounded-lg h-20 animate-pulse"})}),e.jsx("div",{className:"px-4 pb-6",children:e.jsx("div",{className:"grid grid-cols-5 gap-3",children:Array.from({length:10}).map((d,v)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 bg-gray-200 rounded-lg animate-pulse mb-2"}),e.jsx("div",{className:"w-12 h-3 bg-gray-200 rounded animate-pulse"})]},v))})})]}):e.jsxs("div",{className:"bg-white",children:[c.length>0&&e.jsx("div",{className:"mx-4 mt-4 mb-6",children:e.jsx("div",{className:"space-y-3",children:c.map(d=>e.jsxs("div",{className:`bg-gradient-to-r ${d.backgroundColor} rounded-lg p-4 ${d.textColor} relative overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:d.title}),e.jsx("p",{className:"text-sm opacity-90",children:d.subtitle})]}),e.jsx("div",{className:"text-3xl",children:d.icon})]}),e.jsx("div",{className:"absolute -right-2 -top-2 w-16 h-16 bg-white/10 rounded-full"}),e.jsx("div",{className:"absolute -right-6 -bottom-2 w-12 h-12 bg-white/10 rounded-full"})]},d._id))})}),e.jsx("div",{className:"px-4 pb-4 mt-6 md:mt-8 lg:mt-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-3",children:(t||[]).slice(0,10).map((d,v)=>{if(!(d!=null&&d.name))return null;const j=vo[d.name]||Ft,m=(o==null?void 0:o.slug)===d.slug;return e.jsxs("div",{onClick:()=>{f(d),A(d)},className:`flex flex-col items-center cursor-pointer active:scale-95 transition-transform ${m?"opacity-100":"opacity-90"}`,children:[e.jsx("div",{className:`w-14 h-14 ${m?"bg-red-100":"bg-red-50"} border border-red-100 rounded-lg flex items-center justify-center mb-2 hover:bg-red-100 transition-colors`,children:e.jsx(j,{className:"h-7 w-7 text-[#C70000]"})}),e.jsx("span",{className:"text-xs text-gray-800 text-center font-medium leading-tight",children:d.name.length>12?`${d.name.substring(0,12)}...`:d.name})]},d._id||d.slug||v)})})}),o&&e.jsx("div",{className:"px-4 pb-12",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[o.name," Subcategories"]}),e.jsx("button",{className:"text-sm text-[#C70000] hover:underline",onClick:()=>s(`/categories/${Ts(o.slug)||Ts(o.name)}`),children:"View All"})]}),u.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No subcategories found"}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:u.map(d=>e.jsxs("button",{onClick:()=>s(`/categories/${Ts(o.slug)||Ts(o.name)}/${Ts(d.slug)||Ts(d.name)}`),className:"text-left group border border-gray-200 rounded-md p-3 hover:border-red-300 hover:shadow-sm transition",children:[e.jsx("div",{className:"text-gray-900 text-sm font-medium group-hover:text-[#C70000] truncate",children:d.name||d.title||d.slug}),d.description&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:d.description})]},d._id||d.slug))})]})})]})}const yo=fo(bo);function wo(){return e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"px-4 py-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4 animate-pulse"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[...Array(6)].map((s,t)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"aspect-square bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-20 animate-pulse"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 animate-pulse"})]}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24 animate-pulse"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12 animate-pulse"})]})]})]},t))})]})})}const Ni=({isOpen:s,onClose:t,propertyId:r,propertyTitle:c,ownerName:N="Property Owner"})=>{const[y,n]=a.useState({name:"",phone:"",message:`Hi, I'm interested in "${c}". Could you please provide more details?`}),[o,f]=a.useState(!1),u=d=>{const{name:v,value:j}=d.target;n(m=>({...m,[v]:j}))},S=async d=>{if(d.preventDefault(),!y.name.trim()){Rs.error("Please enter your name");return}if(!y.phone.trim()){Rs.error("Please enter your phone number");return}if(!y.message.trim()){Rs.error("Please enter your message");return}if(!/^[+]?[0-9\s\-\(\)]{10,15}$/.test(y.phone.trim())){Rs.error("Please enter a valid phone number");return}f(!0);try{const j=await fetch("/api/enquiries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propertyId:r,name:y.name.trim(),phone:y.phone.trim(),message:y.message.trim(),timestamp:new Date().toISOString()})});if(j.ok){const m=await j.json();Rs.success("Enquiry sent successfully! The owner will contact you soon."),n({name:"",phone:"",message:`Hi, I'm interested in "${c}". Could you please provide more details?`}),setTimeout(()=>{t()},1500),console.log("âœ… Enquiry sent successfully:",m)}else{const m=await j.json();Rs.error(m.message||"Failed to send enquiry. Please try again."),console.error("âŒ Enquiry submission failed:",m)}}catch(j){console.error("âŒ Error submitting enquiry:",j),Rs.error("Network error. Please check your connection and try again.")}finally{f(!1)}},x=d=>{n(v=>({...v,message:d}))},A=[`Hi, I'm interested in "${c}". Is it still available?`,`Can you please share more details about "${c}"?`,`I would like to schedule a visit for "${c}".`,`What is the best price you can offer for "${c}"?`];return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Send Enquiry"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Contact ",N]})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(Ue,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 bg-gray-50 border-b",children:e.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:c})}),e.jsxs("form",{onSubmit:S,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),e.jsxs("div",{className:"relative",children:[e.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",id:"name",name:"name",value:y.name,onChange:u,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-colors",placeholder:"Enter your full name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:y.phone,onChange:u,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-colors",placeholder:"+91 9876543210",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Messages"}),e.jsx("div",{className:"space-y-2",children:A.map((d,v)=>e.jsx("button",{type:"button",onClick:()=>x(d),className:"w-full text-left p-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border transition-colors",children:d},v))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Message *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-3 text-gray-400 w-4 h-4"}),e.jsx("textarea",{id:"message",name:"message",value:y.message,onChange:u,rows:4,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-colors resize-none",placeholder:"Write your message here...",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:o,"data-testid":"enquiry-btn",className:`w-full flex items-center justify-center space-x-2 py-3 px-4 rounded-lg text-white font-medium transition-colors ${o?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 active:bg-red-800"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"w-4 h-4"}),e.jsx("span",{children:"Send Enquiry"})]})})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Your contact information will only be shared with the property owner."})})]})}):null};function Co(){var T;const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState([]),[o,f]=a.useState(!1),[u,S]=a.useState(null);a.useEffect(()=>{x(),d()},[]);const x=async()=>{var C,P;try{const k=await window.api("properties?status=active&limit=24");if(k!=null&&k.ok&&((C=k==null?void 0:k.json)!=null&&C.success)){const h=Array.isArray(k.json.data)?k.json.data:((P=k.json.data)==null?void 0:P.properties)||[];if(h.length){r(h);return}}A()}catch{A()}finally{N(!1)}},A=()=>{const C=[{_id:"mock-1",title:"3 BHK Flat for Sale in Rohtak",price:45e5,location:{city:"Rohtak",state:"Haryana"},images:["https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800"],propertyType:"apartment",createdAt:new Date().toISOString(),contactInfo:{name:"Rajesh Kumar"}},{_id:"mock-2",title:"2 BHK Independent House",price:32e5,location:{city:"Rohtak",state:"Haryana"},images:["https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=800"],propertyType:"house",createdAt:new Date(Date.now()-864e5).toISOString(),contactInfo:{name:"Priya Sharma"}},{_id:"mock-3",title:"Commercial Shop for Rent",price:25e3,location:{city:"Rohtak",state:"Haryana"},images:["https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=800"],propertyType:"commercial",createdAt:new Date(Date.now()-1728e5).toISOString(),contactInfo:{name:"Amit Singh"}},{_id:"mock-4",title:"4 BHK Villa with Garden",price:85e5,location:{city:"Rohtak",state:"Haryana"},images:["https://images.unsplash.com/photo-1593696140826-c58b021acf8b?w=800"],propertyType:"villa",createdAt:new Date(Date.now()-3456e5).toISOString(),contactInfo:{name:"Vikash Yadav"}}];r(C)},d=()=>{const C=localStorage.getItem("favorites");C&&n(JSON.parse(C))},v=C=>{const P=y.includes(C)?y.filter(k=>k!==C):[...y,C];n(P),localStorage.setItem("favorites",JSON.stringify(P))},j=C=>C>=1e7?`â‚¹ ${(C/1e7).toFixed(1)} Cr`:C>=1e5?`â‚¹ ${(C/1e5).toFixed(1)} L`:C>=1e3?`â‚¹ ${(C/1e3).toFixed(0)}K`:`â‚¹ ${C.toLocaleString()}`,m=C=>{const P=new Date,k=new Date(C),h=Math.floor((P.getTime()-k.getTime())/36e5);if(h<1)return"Just now";if(h<24)return`${h}h ago`;const w=Math.floor(h/24);return w<7?`${w}d ago`:k.toLocaleDateString()},l=C=>s(`/properties/${C._id}`),b=C=>{var P,k,h;return C.coverImageUrl||(typeof((P=C.images)==null?void 0:P[0])=="string"?C.images[0]:(h=(k=C.images)==null?void 0:k[0])==null?void 0:h.url)||"/placeholder.png"};return c?e.jsx(wo,{}):e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"px-4 py-4 max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900 mb-4",children:"Fresh recommendations"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-5",children:t.map(C=>e.jsxs("div",{onClick:()=>l(C),className:"bg-white border border-gray-200 rounded-lg overflow-hidden cursor-pointer hover:shadow-md transition-all active:scale-95",children:[e.jsxs("div",{className:"relative aspect-square md:aspect-[4/3]",children:[e.jsx("img",{src:b(C),alt:C.title,className:"w-full h-full object-cover",onError:P=>{P.target.src="/placeholder.png"}}),C.premium&&e.jsx("div",{className:"absolute top-2 left-2 bg-gradient-to-r from-orange-500 to-red-600 text-white px-2 py-1 rounded-md text-[10px] md:text-xs font-bold shadow",children:"AP Premium"}),e.jsx("button",{onClick:P=>{P.stopPropagation(),v(C._id)},className:"absolute top-2 right-2 w-8 h-8 bg-white/90 rounded-full flex items-center justify-center hover:bg-white transition","aria-label":"favorite",children:e.jsx(xs,{className:`h-4 w-4 ${y.includes(C._id)?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),e.jsxs("div",{className:"p-3 md:p-3.5",children:[e.jsx("div",{className:"text-base md:text-lg font-bold text-gray-900 mb-1",children:j(C.price)}),e.jsx("h3",{className:"text-xs md:text-sm text-gray-700 mb-2 line-clamp-2 leading-tight",children:C.title}),e.jsxs("div",{className:"flex items-center text-[11px] md:text-xs text-gray-500 mb-1",children:[e.jsx(He,{className:"h-3 w-3 mr-1 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[C.location.city,", ",C.location.state]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[11px] md:text-xs text-gray-400 mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(cs,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:m(C.createdAt)})]}),e.jsx("span",{className:"capitalize px-2 py-0.5 bg-gray-100 rounded",children:C.propertyType})]}),e.jsxs("button",{onClick:P=>{P.preventDefault(),P.stopPropagation(),S(C),f(!0)},"data-testid":"enquiry-btn",className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white text-[11px] md:text-xs py-2 rounded-md flex items-center justify-center space-x-1 transition-colors",children:[e.jsx(Us,{className:"h-3 w-3"}),e.jsx("span",{children:"Enquiry Now"})]})]})]},C._id))}),t.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No properties available"})}),t.length>0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{className:"text-[#C70000] font-semibold text-sm hover:underline",children:"View all properties"})})]}),u&&e.jsx(Ni,{isOpen:o,onClose:()=>{f(!1),S(null)},propertyId:u._id,propertyTitle:u.title,ownerName:((T=u.contactInfo)==null?void 0:T.name)||"Property Owner"})]})}function So(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(null),n=a.useRef(!1),o=a.useRef(null),f=Ve();a.useEffect(()=>{const v=o.current;if(!v)return;const j=m=>{const l=m.target;if(!l)return;const b=l.closest("a");if(!b)return;const T=(b.getAttribute("href")||"").trim();(T==="#"||T===""||T==="/")&&(m.preventDefault(),m.stopPropagation())};return v.addEventListener("click",j,!0),()=>v.removeEventListener("click",j,!0)},[]),a.useEffect(()=>{u();const v=setInterval(()=>{n.current||u()},6e4);return()=>clearInterval(v)},[]);const u=async()=>{if(!n.current)try{n.current=!0,c(!0),y(null);let v;try{if(typeof window.api=="function"){const j=await window.api("/plans?isActive=true");v=j!=null&&j.ok?j.json:j==null?void 0:j.data}else throw new Error("Global API not available")}catch{const j=await fetch("/api/plans?isActive=true",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!j.ok)throw new Error(`HTTP ${j.status}: ${j.statusText}`);v=await j.json()}v&&v.success&&Array.isArray(v.data)?t(v.data.slice(0,3)):(y("Invalid data format received"),t([]))}catch{y("Failed to load packages"),s.length===0&&t([])}finally{n.current=!1,c(!1)}},S=v=>{v&&(console.log("Navigating to:",`/checkout/${v}`),f(`/checkout/${v}`))},x=()=>{console.log("Navigating to: /post-property"),f("/post-property")},A=v=>{switch(v){case"basic":return e.jsx(Ne,{className:"h-6 w-6"});case"featured":return e.jsx(ns,{className:"h-6 w-6"});case"premium":return e.jsx(We,{className:"h-6 w-6"});default:return e.jsx(nt,{className:"h-6 w-6"})}},d=v=>{switch(v){case"basic":return"from-gray-100 to-gray-200 text-gray-800";case"featured":return"from-orange-100 to-orange-200 text-orange-800";case"premium":return"from-purple-100 to-purple-200 text-purple-800";default:return"from-gray-100 to-gray-200 text-gray-800"}};return r&&s.length===0?e.jsx("section",{className:"bg-white py-12 px-4",children:e.jsx("div",{className:"max-w-7xl mx-auto text-center",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mx-auto mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-96 mx-auto"})]})})}):s.length===0?null:e.jsx("section",{ref:o,className:"bg-white py-12 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(js,{className:"h-8 w-8 text-[#C70000] mr-3"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Advertisement Packages"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Boost your property visibility with our specially designed packages for Rohtak market. Get more views, inquiries, and faster sales."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:s.map(v=>e.jsxs("div",{"data-testid":"plan-card",className:`relative rounded-xl border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:scale-105 ${v.type==="featured"?"border-orange-300 transform scale-105 shadow-lg":"border-gray-200"}`,onClick:j=>{j.preventDefault(),j.stopPropagation()},children:[v.premium&&e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsxs("div",{className:"bg-orange-500 text-white px-4 py-1 rounded-full text-sm font-semibold flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Premium"]})}),e.jsxs("div",{className:`bg-gradient-to-r ${d(v.type)} p-6 text-center`,children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-white mb-4 shadow-lg",children:e.jsx("div",{className:`${v.type==="basic"?"text-gray-600":v.type==="featured"?"text-orange-600":"text-purple-600"}`,children:A(v.type)})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:v.name}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:v.price===0?"Free":`â‚¹${v.price}`}),e.jsxs("div",{className:"text-sm opacity-75 flex items-center justify-center",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),v.duration," days"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:v.description}),e.jsxs("div",{className:"space-y-3 mb-6",children:[v.features.slice(0,4).map((j,m)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx(Be,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:j})]},m)),v.features.length>4&&e.jsxs("div",{className:"text-sm text-gray-500 italic",children:["+ ",v.features.length-4," more features"]})]}),e.jsxs(g,{type:"button",onClick:j=>{j.preventDefault(),j.stopPropagation(),S(v._id)},className:`w-full ${v.type==="basic"?"bg-gray-600 hover:bg-gray-700":v.type==="featured"?"bg-orange-600 hover:bg-orange-700":"bg-purple-600 hover:bg-purple-700"} text-white`,children:[v.price===0?"Start Free Listing":`Choose for â‚¹${v.price}`,e.jsx(gt,{className:"h-4 w-4 ml-2"})]})]})]},v._id))}),e.jsx("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] rounded-xl text-white p-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx(Ne,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"5x More Views"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Featured listings get significantly more visibility"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx($s,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"3x Faster Sales"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Premium properties sell much faster than basic listings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx(Ge,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"4x More Calls"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Get more genuine inquiries from interested buyers"})]})]})}),e.jsxs("div",{className:"text-center mt-12",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ready to Sell Your Property Faster?"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Join thousands of successful sellers in Rohtak who trust our platform"}),e.jsxs(g,{type:"button",onClick:v=>{v.preventDefault(),v.stopPropagation(),x()},className:"bg-[#C70000] hover:bg-[#A60000] text-white px-8 py-3 text-lg",children:["Post Your Property Now",e.jsx(ws,{className:"h-5 w-5 ml-2"})]})]})]})})}function ko(){const[s,t]=a.useState(null),[r,c]=a.useState(!1),[N,y]=a.useState(!1);a.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){y(!0);return}const f=x=>{x.preventDefault(),t(x),c(!0)},u=()=>{y(!0),c(!1),t(null)};window.addEventListener("beforeinstallprompt",f),window.addEventListener("appinstalled",u);const S=setTimeout(()=>{!N&&!localStorage.getItem("pwa-prompt-dismissed")&&c(!0)},2e3);return()=>{window.removeEventListener("beforeinstallprompt",f),window.removeEventListener("appinstalled",u),clearTimeout(S)}},[N]);const n=async()=>{if(s){s.prompt();const{outcome:f}=await s.userChoice;f==="accepted"&&(t(null),c(!1))}else alert(`To install this app, use your browser's "Add to Home Screen" option.`)},o=()=>{c(!1),localStorage.setItem("pwa-prompt-dismissed","true")};return N||!r?null:e.jsx("div",{className:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-50 w-80",children:e.jsxs("div",{className:"bg-blue-600 text-white rounded-xl shadow-2xl overflow-hidden mx-4",children:[e.jsx("button",{onClick:o,className:"absolute top-2 right-2 p-1 hover:bg-blue-700 rounded-full",children:e.jsx(Ue,{className:"h-4 w-4"})}),e.jsxs("div",{className:"p-4 text-center",children:[e.jsxs("div",{className:"w-16 h-16 bg-white rounded-xl flex items-center justify-center mx-auto mb-3",children:[e.jsx("img",{src:"/favicon.ico",alt:"App Icon",className:"w-10 h-10",onError:f=>{var S;const u=f.target;u.style.display="none",(S=u.nextElementSibling)==null||S.classList.remove("hidden")}}),e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-xl hidden items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"AP"})})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:"Ashish Property App"}),e.jsx("p",{className:"text-sm opacity-90 mb-2",children:"Buy & Sell better with app"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-4",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((f,u)=>e.jsx(ns,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"},u))}),e.jsx("span",{className:"text-sm opacity-90 ml-2",children:"4.5 â€¢ 10Cr+ Downloads"})]}),e.jsxs("button",{onClick:n,className:"w-full bg-white text-blue-600 py-3 rounded-lg font-bold text-lg hover:bg-gray-100 transition-colors flex items-center justify-center space-x-2 shadow-lg",children:[e.jsx(it,{className:"h-5 w-5"}),e.jsx("span",{children:"Install App"})]})]})]})})}const Po=()=>{const[s,t]=a.useState(0);return a.useEffect(()=>{let r=!0;const c=async()=>{try{const y=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!y)return;const n=await ce.get("chat/unread-count",y);if(!r)return;n&&n.data&&n.data.data&&t(n.data.data.totalUnread||0)}catch(y){const n=String((y==null?void 0:y.message)||y||"");if(n.includes("Invalid or expired token")||n.includes("HTTP 403")){try{localStorage.removeItem("token"),localStorage.removeItem("user")}catch{}t(0);return}console.error("Error fetching unread count:",n)}};c();const N=setInterval(c,1e4);return()=>{r=!1,clearInterval(N)}},[]),s};function ve(){const s=Va(),t=Po(),{isAuthenticated:r}=je(),c=[{icon:Pe,label:"Home",path:"/",active:s.pathname==="/"},{icon:Ss,label:"My Ads",path:r?"/account/my-ads":`/auth?returnTo=${encodeURIComponent("/account/my-ads")}`,active:s.pathname==="/account/my-ads"},{icon:null,label:"",path:"",active:!1},{icon:Mt,label:"Chat",path:"/chat",active:s.pathname==="/chat"},{icon:hs,label:"My Account",path:"/my-account",active:s.pathname==="/my-account"}];return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50 shadow-lg",children:e.jsx("div",{className:"flex items-center justify-around h-16 relative",children:c.map((N,y)=>{if(y===2)return e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx("a",{href:r?"/post-property":`/auth?returnTo=${encodeURIComponent("/post-property")}`,className:"w-14 h-14 bg-[#C70000] rounded-full flex items-center justify-center shadow-lg transform -translate-y-2 hover:bg-[#A60000] transition-colors active:scale-95",children:e.jsx(we,{className:"h-6 w-6 text-white"})})},"add-button");const n=N.icon;return e.jsxs("a",{href:N.path,className:`flex-1 flex flex-col items-center justify-center py-2 relative transition-colors ${N.active?"text-[#C70000]":"text-gray-500 hover:text-gray-700"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:`h-6 w-6 mb-1 ${N.active?"text-[#C70000]":"text-gray-500"}`}),N.label==="Chat"&&t>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:t>9?"9+":t})})]}),e.jsx("span",{className:"text-xs font-medium",children:N.label})]},N.label)})})})}function Ao({position:s,className:t=""}){const[r,c]=a.useState([]),[N,y]=a.useState(!0),[n,o]=a.useState(0);a.useEffect(()=>{f()},[s]),a.useEffect(()=>{if(r.length>1){const x=setInterval(()=>{o(A=>(A+1)%r.length)},5e3);return()=>clearInterval(x)}},[r.length]);const f=async()=>{var x,A;try{console.log(`ðŸ·ï¸ Fetching banners for position: ${s}`);const d=await window.api("/banners?active=true",{timeout:8e3});d&&d.ok&&((x=d.json)!=null&&x.success)&&Array.isArray(d.json.data)?c(d.json.data):(console.log("âš ï¸ Banners request not OK or empty",{status:d==null?void 0:d.status,ok:d==null?void 0:d.ok,err:(A=d==null?void 0:d.json)==null?void 0:A.error}),c([]))}catch(d){const v=(d==null?void 0:d.message)||String(d);console.warn(`Error fetching banners (${s}):`,v),c([])}finally{y(!1)}},u=x=>{x.link&&window.open(x.link,"_blank","noopener,noreferrer")};if(N)return e.jsx("div",{className:`animate-pulse ${t}`,children:e.jsx("div",{className:"bg-gray-200 rounded-lg h-24 md:h-32"})});if(!r.length)return null;const S=r[n];return e.jsxs("div",{className:t,children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg shadow-sm",children:[e.jsxs("div",{className:"relative cursor-pointer transition-transform hover:scale-[1.02]",onClick:()=>u(S),children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:S.imageUrl||S.image,alt:S.title,loading:"lazy",decoding:"async",className:"w-full h-24 md:h-32 object-cover rounded-lg",onError:x=>{const A=x.target;A.src=`https://via.placeholder.com/800x200/f97316/ffffff?text=${encodeURIComponent(S.title)}`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/40 to-transparent rounded-lg"})]}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between p-4",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("h3",{className:"text-sm md:text-lg font-bold leading-tight",children:S.title}),!1]}),S.link&&e.jsx("div",{className:"text-white/80 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),r.length>1&&e.jsx("div",{className:"mt-2 overflow-x-auto no-scrollbar",children:e.jsx("div",{className:"flex space-x-2",children:r.map((x,A)=>e.jsx("button",{onClick:()=>o(A),className:`relative w-16 h-10 flex-shrink-0 rounded overflow-hidden border ${n===A?"border-white":"border-white/40"}`,"aria-label":`Go to banner ${A+1}`,children:e.jsx("img",{src:x.imageUrl||x.image,alt:x.title,loading:"lazy",decoding:"async",className:"w-full h-full object-cover",onError:d=>{const v=d.target;v.src=`https://via.placeholder.com/160x100/f97316/ffffff?text=${encodeURIComponent(x.title)}`}})},A))})})]}),!1]})}function To(){const[s,t]=a.useState([]),[r,c]=a.useState(!0);a.useEffect(()=>{N()},[]);const N=async()=>{try{c(!0);const n=await window.api("/plans?isActive=true"),o=n.ok?n.json:{success:!1,error:"Failed to fetch plans"};if(o.success&&Array.isArray(o.data)){const f=o.data.filter(u=>u.placement==="footer");t(f)}}catch(n){console.error("Error fetching footer packages:",n),t([])}finally{c(!1)}},y=n=>{switch(n){case"basic":return e.jsx(Ne,{className:"h-5 w-5"});case"featured":return e.jsx(ns,{className:"h-5 w-5"});case"premium":return e.jsx(We,{className:"h-5 w-5"});default:return e.jsx(Ne,{className:"h-5 w-5"})}};return r||s.length===0?null:e.jsx("div",{className:"border-t border-red-600 pt-8 mt-8",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Advertisement Packages"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.map(n=>e.jsxs("div",{"data-testid":"plan-card",className:"bg-white bg-opacity-10 rounded-lg p-4 hover:bg-opacity-20 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-white",children:y(n.type)}),e.jsx("h5",{className:"font-semibold text-white",children:n.name})]}),n.premium&&e.jsx("div",{className:"bg-orange-500 text-white px-2 py-1 rounded text-xs font-semibold",children:"Premium"})]}),e.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:n.price===0?"Free":`â‚¹${n.price}`}),e.jsxs("ul",{className:"text-red-100 text-sm space-y-1 mb-4",children:[n.features.slice(0,2).map((o,f)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"w-1 h-1 bg-red-200 rounded-full mr-2"}),o]},f)),n.features.length>2&&e.jsxs("li",{className:"text-red-200 text-xs",children:["+",n.features.length-2," more features"]})]}),e.jsxs(g,{onClick:()=>window.location.href=`/checkout/${n._id}`,className:"w-full bg-white text-[#C70000] hover:bg-red-50 text-sm py-2",children:["Choose Package",e.jsx(gt,{className:"h-3 w-3 ml-1"})]})]},n._id))})]})})}const Eo=({isOpen:s,onClose:t})=>{const r=Ve(),[c,N]=a.useState([]),[y,n]=a.useState(!1),[o,f]=a.useState(new Set),[u,S]=a.useState("property");a.useEffect(()=>{s&&x()},[s]);const x=async()=>{try{n(!0);const l=[],b=await fetch("/api/categories?active=true&withSub=true");if(b.ok){const C=await b.json();if(C.success&&Array.isArray(C.data)){const P=C.data.map(k=>({_id:k._id,name:k.name,slug:k.slug,type:"property",icon:k.iconUrl||"",description:k.description||"",order:k.sortOrder??999,active:!!k.isActive,subcategories:Array.isArray(k.subcategories)?k.subcategories.map(h=>({_id:h._id,name:h.name,slug:h.slug,categoryId:h.categoryId,active:!!h.isActive,order:h.sortOrder??999})):[]}));l.push(...P)}}const T=await fetch("/api/os/categories?active=1");if(T.ok){const C=await T.json();if(C.success&&Array.isArray(C.data)){const P=C.data,k=await Promise.all(P.map(async(h,w)=>{let E=[];try{const q=await fetch(`/api/os/subcategories?active=1&cat=${encodeURIComponent(h.slug)}`);if(q.ok){const V=await q.json();V.success&&Array.isArray(V.data)&&(E=V.data)}}catch{}return{_id:h._id||h.slug,name:h.name,slug:h.slug,type:"service",icon:"ðŸ”§",description:"",order:(w+1)*1e3,active:!!h.active,subcategories:E.map((q,V)=>({_id:q._id||q.slug,name:q.name,slug:q.slug,active:!!q.active,order:(V+1)*10}))}}));l.push(...k)}}l.sort((C,P)=>(C.order??999)!==(P.order??999)?(C.order??999)-(P.order??999):C.name.localeCompare(P.name)),N(l),console.log("âœ… Fetched categories:",l.length)}catch(l){console.error("âŒ Error fetching categories:",l)}finally{n(!1)}},A=l=>{l.subcategories&&l.subcategories.length>0?f(b=>{const T=new Set(b);return T.has(l._id)?T.delete(l._id):T.add(l._id),T}):v(l)},d=(l,b)=>{v(l,b)},v=(l,b)=>{let T="";l.type==="property"?b?T=`/categories/${l.slug}/${b.slug}`:T=`/categories/${l.slug}`:l.type==="service"&&(b?T=`/services/${l.slug}/${b.slug}`:T=`/services/${l.slug}`),T&&(r(T),t())},j=c.filter(l=>l.type===u),m=l=>{if(l.type==="service")return e.jsx(Ot,{className:"w-5 h-5"});switch(l.slug){case"residential":case"flat":case"pg":return e.jsx(Pe,{className:"w-5 h-5"});case"commercial":case"showroom":case"industrial-property":return e.jsx(Ot,{className:"w-5 h-5"});default:return e.jsx(Lt,{className:"w-5 h-5"})}};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),e.jsxs("div",{className:"relative bg-white w-full max-w-md ml-auto h-full shadow-xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-[#C70000] text-white",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Categories"}),e.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors","aria-label":"Close categories",children:e.jsx(Ue,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsxs("button",{onClick:()=>S("property"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${u==="property"?"text-[#C70000] border-b-2 border-[#C70000] bg-red-50":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Pe,{className:"w-4 h-4 inline mr-2"}),"Properties"]}),e.jsxs("button",{onClick:()=>S("service"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${u==="service"?"text-[#C70000] border-b-2 border-[#C70000] bg-red-50":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ot,{className:"w-4 h-4 inline mr-2"}),"Services"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y?e.jsx("div",{className:"p-4 space-y-3",children:[1,2,3,4,5].map(l=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-12 bg-gray-200 rounded"})},l))}):e.jsx("div",{className:"p-2",children:j.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Lt,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsxs("p",{children:["No ",u," categories found"]})]}):e.jsx("div",{className:"space-y-1",children:j.map(l=>e.jsxs("div",{"data-testid":"footer-cat-item",children:[e.jsxs("button",{onClick:()=>A(l),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-[#C70000]",children:m(l)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 capitalize",children:l.name}),l.description&&e.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:l.description})]})]}),l.subcategories&&l.subcategories.length>0&&e.jsx("div",{className:"text-gray-400",children:o.has(l._id)?e.jsx(ea,{className:"w-4 h-4"}):e.jsx(ws,{className:"w-4 h-4"})})]}),o.has(l._id)&&l.subcategories&&l.subcategories.length>0&&e.jsx("div",{className:"ml-8 space-y-1 pb-2",children:l.subcategories.filter(b=>b.active).sort((b,T)=>b.order-T.order||b.name.localeCompare(T.name)).map(b=>e.jsx("button",{onClick:()=>d(l,b),"data-testid":"footer-cat-item",className:"block w-full text-left p-2 rounded text-sm text-gray-600 hover:text-[#C70000] hover:bg-red-50 transition-colors capitalize",children:b.name},b._id||b.slug))})]},l._id))})})}),e.jsx("div",{className:"border-t p-4 bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Browse all ",u," categories"]}),e.jsx("button",{onClick:()=>{r(u==="property"?"/categories":"/services"),t()},className:"mt-2 text-sm text-[#C70000] font-medium hover:underline",children:"View All Categories"})]})})]})]}):null};function Fs(){const[s,t]=a.useState(!1);return e.jsxs("footer",{className:"bg-gradient-to-r from-[#C70000] to-red-700 text-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-10",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-white rounded-full -translate-x-32 -translate-y-32"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-white rounded-full translate-x-48 translate-y-48"})]}),e.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-[#C70000] font-bold text-xl",children:"AP"})}),e.jsx("h3",{className:"text-2xl font-bold",children:"Ashish Properties"})]}),e.jsx("p",{className:"text-red-100 text-sm leading-relaxed",children:"Your trusted property partner in Rohtak. Find your dream home with verified listings and expert guidance."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("a",{href:"https://facebook.com/aashishproperties",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all",children:e.jsx(fn,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://twitter.com/aashishproperties",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all",children:e.jsx(vn,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://instagram.com/aashishproperties",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all",children:e.jsx(Nn,{className:"h-5 w-5"})}),e.jsx("a",{href:"https://youtube.com/aashishproperties",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all",children:e.jsx(bn,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"+91 9876543210"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-4 w-4"}),e.jsx("span",{children:"info@aashishproperty.com"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsx("span",{children:"Rohtak, Haryana, India"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Popular Locations"}),e.jsx("ul",{className:"space-y-3",children:["Model Town","Sector 14","Civil Lines","Old City","Industrial Area","Bohar"].map(r=>e.jsx("li",{children:e.jsxs(be,{to:`/properties?location=${encodeURIComponent(r)}`,className:"text-red-200 hover:text-white transition-colors duration-200 text-sm flex items-center",children:[e.jsx(He,{className:"h-3 w-3 mr-2"}),"Properties in ",r]})},r))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Quick Links"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsx("li",{children:e.jsx(be,{to:"/buy",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Quick Buy"})}),e.jsx("li",{children:e.jsx(be,{to:"/sale",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Quick Sale"})}),e.jsx("li",{children:e.jsx(be,{to:"/rent",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Rental Properties"})}),e.jsx("li",{children:e.jsx(be,{to:"/lease",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Lease Properties"})}),e.jsx("li",{children:e.jsx(be,{to:"/pg",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"PG Accommodation"})}),e.jsx("li",{children:e.jsx(be,{to:"/services",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Other Services"})}),e.jsx("li",{children:e.jsx(be,{to:"/blog",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Blog"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Legal & Support"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsx("li",{children:e.jsx(be,{to:"/about-us",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"About Us"})}),e.jsx("li",{children:e.jsx(be,{to:"/contact-us",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Contact Us"})}),e.jsx("li",{children:e.jsx(be,{to:"/p/privacy-policy",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx(be,{to:"/p/terms-conditions",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Terms & Conditions"})}),e.jsx("li",{children:e.jsx(be,{to:"/support/help",className:"text-red-200 hover:text-white transition-colors duration-200 text-sm",children:"Help Center"})})]})]})]}),e.jsx(To,{}),e.jsx("div",{className:"border-t border-red-600 mt-12 pt-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs("span",{children:["All rights reserved Â© 2006-",new Date().getFullYear()," Ashish Properties"]})]}),e.jsx("div",{className:"flex items-center space-x-4 text-xs text-red-200",children:e.jsx("span",{children:"Stable Version"})})]})})]}),e.jsx("div",{className:"fixed bottom-4 right-4 z-40",children:e.jsxs("button",{onClick:()=>t(!0),"data-testid":"footer-cats",className:"bg-[#C70000] hover:bg-red-700 text-white px-4 py-2 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center space-x-2 text-sm font-medium",children:[e.jsx(Lt,{className:"w-4 h-4"}),e.jsx("span",{children:"Categories"})]})}),e.jsx(Eo,{isOpen:s,onClose:()=>t(!1)})]})}const bi=a.createContext(null);function Ga(){const s=a.useContext(bi);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const yi=a.forwardRef(({orientation:s="horizontal",opts:t,setApi:r,plugins:c,className:N,children:y,...n},o)=>{const[f,u]=yn({...t,axis:s==="horizontal"?"x":"y"},c),[S,x]=a.useState(!1),[A,d]=a.useState(!1),v=a.useCallback(b=>{b&&(x(b.canScrollPrev()),d(b.canScrollNext()))},[]),j=a.useCallback(()=>{u==null||u.scrollPrev()},[u]),m=a.useCallback(()=>{u==null||u.scrollNext()},[u]),l=a.useCallback(b=>{b.key==="ArrowLeft"?(b.preventDefault(),j()):b.key==="ArrowRight"&&(b.preventDefault(),m())},[j,m]);return a.useEffect(()=>{!u||!r||r(u)},[u,r]),a.useEffect(()=>{if(u)return v(u),u.on("reInit",v),u.on("select",v),()=>{u==null||u.off("select",v)}},[u,v]),e.jsx(bi.Provider,{value:{carouselRef:f,api:u,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:j,scrollNext:m,canScrollPrev:S,canScrollNext:A},children:e.jsx("div",{ref:o,onKeyDownCapture:l,className:me("relative",N),role:"region","aria-roledescription":"carousel",...n,children:y})})});yi.displayName="Carousel";const wi=a.forwardRef(({className:s,...t},r)=>{const{carouselRef:c,orientation:N}=Ga();return e.jsx("div",{ref:c,className:me("overflow-hidden",N==="horizontal"?"touch-pan-y":"touch-pan-x"),children:e.jsx("div",{ref:r,className:me("flex",N==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});wi.displayName="CarouselContent";const Ci=a.forwardRef(({className:s,...t},r)=>{const{orientation:c}=Ga();return e.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:me("min-w-0 shrink-0 grow-0 basis-full",c==="horizontal"?"pl-4":"pt-4",s),...t})});Ci.displayName="CarouselItem";const Si=a.forwardRef(({className:s,variant:t="outline",size:r="icon",...c},N)=>{const{orientation:y,scrollPrev:n,canScrollPrev:o}=Ga();return e.jsxs(g,{ref:N,variant:t,size:r,className:me("absolute  h-8 w-8 rounded-full",y==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:n,...c,children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});Si.displayName="CarouselPrevious";const ki=a.forwardRef(({className:s,variant:t="outline",size:r="icon",...c},N)=>{const{orientation:y,scrollNext:n,canScrollNext:o}=Ga();return e.jsxs(g,{ref:N,variant:t,size:r,className:me("absolute h-8 w-8 rounded-full",y==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:n,...c,children:[e.jsx(gt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});ki.displayName="CarouselNext";var tn,an,rn,nn;const or=((an=(tn=import.meta)==null?void 0:tn.env)==null?void 0:an.VITE_ASSETS_BASE_URL)||((nn=(rn=import.meta)==null?void 0:rn.env)==null?void 0:nn.VITE_API_BASE_URL)||"",Io=s=>s.replace(/\/+$/g,""),Fo=s=>{if(!s||typeof s!="string")return null;let t=s.trim().replace(/\\/g,"/");if(!t)return null;if(/^https?:\/\//i.test(t))return t;if(t.startsWith("//"))return window.location.protocol+t;const r=or?Io(or):window.location.origin;return t.startsWith("/")?`${r}${t}`:`${r}/${t.replace(/^\.?\//,"")}`},Lo=s=>(s==null?void 0:s.imageUrl)??(s==null?void 0:s.image)??(s==null?void 0:s.url)??null,sr=["https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1600&auto=format&fit=crop","https://images.unsplash.com/photo-1505693416388-ac5ce068fe85?q=80&w=1600&auto=format&fit=crop","https://images.unsplash.com/photo-1560185127-6ed189bf02f4?q=80&w=1600&auto=format&fit=crop"],Do=()=>{const[s,t]=a.useState([]),[r,c]=a.useState(),[N,y]=a.useState(0),[n,o]=a.useState(!0),[f,u]=a.useState(null),S=a.useMemo(()=>sr.map((d,v)=>({_id:`fb-${v+1}`,title:v===0?"Premium Properties in Rohtak":v===1?"Find Your Perfect Home":"Buy â€¢ Sell â€¢ Rent",imageUrl:d,link:"",sortOrder:v+1})),[]);a.useEffect(()=>{let d=!0;const v=async()=>{try{o(!0),u(null);const m=new AbortController,l=setTimeout(()=>m.abort(),8e3),b=await fetch("/api/banners?active=true",{signal:m.signal,headers:{"Content-Type":"application/json"}});clearTimeout(l);let T=null;try{T=await b.json()}catch{T=null}const P=(Array.isArray(T==null?void 0:T.data)&&T.data||Array.isArray(T==null?void 0:T.banners)&&T.banners||Array.isArray(T)&&T||[]).map(k=>{const h=Lo(k),w=Fo(h);return console.debug("BANNER_URL_RESOLVE:",{raw:h,abs:w,ASSETS_BASE:or}),{...k,imageUrl:w,sortOrder:typeof(k==null?void 0:k.sortOrder)=="number"?k.sortOrder:999}}).filter(k=>!!k.imageUrl).sort((k,h)=>k.sortOrder-h.sortOrder);if(!d)return;t(P.length?P:S)}catch(m){if(!d)return;console.error("Banner load error:",(m==null?void 0:m.message)||m),u("Unable to load banners"),t(S)}finally{d&&o(!1)}};v();const j=()=>v();return window.addEventListener("bannerUpdate",j),window.addEventListener("bannerRefresh",j),()=>{d=!1,window.removeEventListener("bannerUpdate",j),window.removeEventListener("bannerRefresh",j)}},[S]),a.useEffect(()=>{if(!r)return;const d=()=>y(r.selectedScrollSnap());return r.on("select",d),()=>{r.off("select",d)}},[r]),a.useEffect(()=>{if(!r||s.length<=1)return;let d=!1;const v=document.querySelector(".hero-carousel"),j=()=>d=!0,m=()=>d=!1;v==null||v.addEventListener("mouseenter",j),v==null||v.addEventListener("mouseleave",m);const l=setInterval(()=>{d||(r.canScrollNext()?r.scrollNext():r.scrollTo(0))},5e3);return()=>{clearInterval(l),v==null||v.removeEventListener("mouseenter",j),v==null||v.removeEventListener("mouseleave",m)}},[r,s.length]);const x=d=>{d!=null&&d.link&&(d.link.startsWith("http")?window.open(d.link,"_blank","noopener,noreferrer"):window.location.href=d.link)},A=d=>r==null?void 0:r.scrollTo(d);return n?e.jsx("div",{className:"hero-carousel relative w-full h-[72vh] sm:h-[64vh] md:h-[56vh] lg:h-[60vh] min-h-[340px] bg-gray-200 animate-pulse"}):e.jsxs("div",{className:"hero-carousel relative w-full h-[72vh] sm:h-[64vh] md:h-[56vh] lg:h-[60vh] min-h-[340px] overflow-hidden bg-black",children:[e.jsxs(yi,{opts:{align:"start",loop:!0},setApi:c,className:"absolute inset-0",children:[e.jsx(wi,{className:"h-full -ml-0",children:s.map((d,v)=>e.jsx(Ci,{className:"h-full basis-full pl-0",children:e.jsxs("div",{className:`relative w-full h-full ${d!=null&&d.link?"cursor-pointer":""}`,onClick:()=>x(d),children:[e.jsx("img",{src:d.imageUrl,alt:d.title||`banner-${v+1}`,className:"absolute inset-0 w-full h-full object-cover",loading:v===0?"eager":"lazy",onError:j=>{console.warn("Banner image failed, using fallback",d.imageUrl),j.target.src=sr[v%sr.length]}}),e.jsx("div",{className:"absolute inset-0 bg-black/45"}),e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center px-4",children:e.jsxs("div",{className:"text-center text-white max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold mb-2 drop-shadow",children:d.title||"Premium Properties in Rohtak"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-white/90 mb-4 max-w-2xl mx-auto",children:(d==null?void 0:d.description)||"Discover amazing properties with our trusted platform"}),(d==null?void 0:d.link)&&e.jsx("button",{onClick:j=>{j.stopPropagation(),x(d)},className:"bg-[#C70000] hover:bg-[#A60000] text-white px-6 py-3 rounded-lg font-semibold shadow-lg",children:"Learn More"})]})})]})},d._id||v))}),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(Si,{className:"absolute left-3 top-1/2 -translate-y-1/2 bg-white/25 hover:bg-white/35 text-white border-none backdrop-blur z-10"}),e.jsx(ki,{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-white/25 hover:bg-white/35 text-white border-none backdrop-blur z-10"})]})]}),s.length>1&&e.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2 z-20",children:s.map((d,v)=>e.jsx("button",{onClick:()=>A(v),className:`w-2.5 h-2.5 rounded-full transition-all ${v===N?"bg-white scale-110":"bg-white/60 hover:bg-white/80"}`,"aria-label":`Go to slide ${v+1}`},v))}),f&&e.jsx("div",{className:"absolute top-3 right-3 z-30 text-xs bg-red-600/90 text-white px-2.5 py-1.5 rounded",children:f})]})},Ro=()=>{const[s,t]=a.useState([]),[r,c]=a.useState([]),[N,y]=a.useState(0),[n,o]=a.useState(!0),[f,u]=a.useState(!0),S=a.useRef(null),x=ur.useMemo(()=>{const m=[];return s.forEach(l=>m.push({type:"ad",data:l})),r.forEach(l=>m.push({type:"property",data:l})),m},[s,r]);a.useEffect(()=>{(async()=>{var l,b,T,C;try{o(!0);try{const P=await window.api("/banners?active=true",{timeout:7e3});if(P&&P.ok&&((l=P.json)!=null&&l.success)&&Array.isArray(P.json.data)){const k=P.json.data.map(h=>({_id:h._id||Math.random().toString(36).slice(2),title:h.title,description:"",image:h.imageUrl,link:h.link,position:"homepage_middle",active:h.isActive!==!1}));t(k),console.log("âœ… Loaded",k.length,"home advertisements")}else console.warn("âš ï¸ Advertisement request not OK or empty",{status:P==null?void 0:P.status,ok:P==null?void 0:P.ok,err:(b=P==null?void 0:P.json)==null?void 0:b.error})}catch(P){console.warn("âš ï¸ Failed to fetch advertisements:",(P==null?void 0:P.message)||String(P))}try{const P=await window.api("/properties/featured",{timeout:7e3});P&&P.ok&&((T=P.json)!=null&&T.success)&&Array.isArray(P.json.data)?(c(P.json.data),console.log("âœ… Loaded",P.json.data.length,"featured properties")):console.warn("âš ï¸ Featured properties request not OK or empty",{status:P==null?void 0:P.status,ok:P==null?void 0:P.ok,err:(C=P==null?void 0:P.json)==null?void 0:C.error})}catch(P){console.warn("âš ï¸ Failed to fetch featured properties:",(P==null?void 0:P.message)||String(P))}}catch(P){console.error("âŒ Error fetching data:",P)}finally{o(!1)}})()},[]),a.useEffect(()=>{if(!(!f||x.length<=1))return S.current=setInterval(()=>{y(m=>(m+1)%x.length)},4e3),()=>{S.current&&clearInterval(S.current)}},[x.length,f]);const A=()=>{y(m=>(m+1)%x.length)},d=()=>{y(m=>(m-1+x.length)%x.length)},v=m=>{if(m.type==="ad"){const l=m.data;l.link&&(window.location.href=l.link)}else{const l=m.data;window.location.href=`/property/${l._id}`}},j=(m,l)=>{const b=m.toLocaleString("en-IN");return l==="rent"?`â‚¹${b}/month`:`â‚¹${b}`};return n?e.jsx("div",{className:"px-4 py-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4"}),e.jsx("div",{className:"flex space-x-4 overflow-hidden",children:[1,2,3].map(m=>e.jsx("div",{className:"flex-shrink-0 w-80 h-48 bg-gray-200 rounded-lg"},m))})]})}):x.length===0?null:e.jsx("div",{className:"px-4 py-6 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Featured Properties & Ads"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>u(!f),className:`px-3 py-1 text-sm rounded ${f?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:f?"Pause":"Play"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"overflow-hidden rounded-lg touch-pan-y",children:e.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${N*100}%)`},children:x.map((m,l)=>{const b=m.type==="ad",T=m.data;return e.jsx("div",{className:"w-full flex-shrink-0","data-testid":"home-ad-card",children:e.jsx("div",{onClick:()=>v(m),className:"bg-white rounded-lg shadow-md overflow-hidden cursor-pointer hover:shadow-lg transition-shadow touch-pan-y",children:b?e.jsxs("div",{className:"relative h-64",children:[e.jsx("img",{src:T.image,alt:T.title,className:"w-full h-full object-cover touch-pan-y",onError:C=>{C.target.src="/placeholder.svg"}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent",children:e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 text-white",children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:T.title}),e.jsx("p",{className:"text-sm opacity-90 line-clamp-2",children:T.description})]})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"bg-red-600 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Ad"})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"relative h-64",children:[e.jsx("img",{src:T.images[0]||"/placeholder.svg",alt:T.title,className:"w-full h-full object-cover touch-pan-y",onError:C=>{C.target.src="/placeholder.svg"}}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-medium",children:"Featured"})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"bg-white/90 text-gray-900 px-2 py-1 rounded text-sm font-semibold",children:j(T.price,T.priceType)})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 line-clamp-2",children:T.title}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-2",children:[e.jsx(He,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:T.location.sector||T.location.mohalla||T.location.city})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Pe,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:T.propertyType})]}),T.specifications.bedrooms&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Gt,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:[T.specifications.bedrooms," ","BD"]})]}),T.specifications.bathrooms&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Jt,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:[T.specifications.bathrooms," ","BA"]})]})]})]})]})})},`${m.type}-${T._id}-${l}`)})})}),x.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-2 rounded-full shadow-lg transition-all","aria-label":"Previous slide",children:e.jsx(Dt,{className:"w-5 h-5"})}),e.jsx("button",{onClick:A,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-2 rounded-full shadow-lg transition-all","aria-label":"Next slide",children:e.jsx(ws,{className:"w-5 h-5"})})]}),x.length>1&&e.jsx("div",{className:"mt-4 px-1",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide touch-pan-y","aria-label":"Thumbnails",children:x.map((m,l)=>{var P;const b=m.type==="ad",T=m.data,C=b?T.image:((P=T.images)==null?void 0:P[0])||"/placeholder.svg";return e.jsx("button",{onClick:()=>{y(l),u(!1)},"aria-label":`Slide ${l+1}`,className:`relative flex-shrink-0 w-16 h-12 rounded-md overflow-hidden border ${l===N?"border-red-600 ring-2 ring-red-200":"border-gray-200"}`,children:e.jsx("img",{src:C,alt:b?T.title||"Ad":T.title||"Property",className:"w-full h-full object-cover",onError:k=>{k.target.src="/placeholder.svg"}})},`thumb-${l}`)})})})]})]})})},Pi=a.createContext(null);function $o(){return a.useContext(Pi)}function Uo({children:s}){const[t,r]=a.useState(null);a.useEffect(()=>{let N=!0;return fetch("/api/adsense/config").then(y=>y.json()).then(y=>{var o,f,u,S,x;if(!N)return;const n={enabled:!!((o=y==null?void 0:y.data)!=null&&o.enabled),clientId:String(((f=y==null?void 0:y.data)==null?void 0:f.clientId)||""),slots:((u=y==null?void 0:y.data)==null?void 0:u.slots)||{},disabledRoutes:((S=y==null?void 0:y.data)==null?void 0:S.disabledRoutes)||[],testMode:!!((x=y==null?void 0:y.data)!=null&&x.testMode)};if(r(n),n.enabled&&n.clientId&&typeof window<"u"&&!document.querySelector("script[data-adsbygoogle]")){const A=window.location.pathname;if(!n.disabledRoutes.includes(A)){const v=document.createElement("script");v.async=!0,v.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client="+n.clientId,v.setAttribute("crossorigin","anonymous"),v.setAttribute("data-adsbygoogle","true"),document.head.appendChild(v)}}}).catch(()=>{}),()=>{N=!1}},[]);const c=a.useMemo(()=>t,[t]);return e.jsx(Pi.Provider,{value:c,children:s||null})}const _o={horizontal:{width:"100%",minHeight:90},rectangle:{width:"100%",minHeight:250},vertical:{width:300,minHeight:600}};function Oo({adSlot:s,slotKey:t,style:r,className:c="",format:N="horizontal"}){var S,x;const y=a.useRef(null),n=$o(),o=s||t&&((S=n==null?void 0:n.slots)==null?void 0:S[t])||void 0,f=((x=n==null?void 0:n.disabledRoutes)==null?void 0:x.includes(typeof window<"u"?window.location.pathname:""))??!1,u=!!(n!=null&&n.enabled)&&!!(n!=null&&n.clientId)&&!f;return a.useEffect(()=>{if(u&&window.adsbygoogle&&y.current)try{window.adsbygoogle.push({})}catch{}},[u,o]),!u||!o?null:e.jsx("div",{className:c,style:{..._o[N],...r},children:e.jsx("ins",{className:"adsbygoogle block",style:{display:"block",width:"100%",height:"100%"},"data-ad-client":n==null?void 0:n.clientId,"data-ad-slot":o,"data-full-width-responsive":"true","data-adtest":n!=null&&n.testMode?"on":void 0,ref:y})})}function Mo(){return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16 bg-gradient-to-b from-red-50 to-white",children:[e.jsx(Do,{}),e.jsx(yo,{}),e.jsx("div",{className:"px-4 mt-4",children:e.jsx(Oo,{format:"horizontal",slotKey:"below_categories"})}),e.jsx(Ro,{}),e.jsx("div",{className:"px-4 mb-6 bg-white py-6",children:e.jsx(Ao,{position:"homepage_middle"})}),e.jsx("div",{className:"bg-white",children:e.jsx(Co,{})}),e.jsx("div",{className:"bg-red-50 py-8",children:e.jsx(So,{})})]}),e.jsx(ve,{}),e.jsx(ko,{})," ",e.jsx(Fs,{})]})}const Q=a.forwardRef(({className:s,type:t,...r},c)=>e.jsx("input",{type:t,className:me("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:c,...r}));Q.displayName="Input";const zo=va("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),vs=a.forwardRef(({className:s,variant:t,...r},c)=>e.jsx("div",{ref:c,role:"alert",className:me(zo({variant:t}),s),...r}));vs.displayName="Alert";const Bo=a.forwardRef(({className:s,...t},r)=>e.jsx("h5",{ref:r,className:me("mb-1 font-medium leading-none tracking-tight",s),...t}));Bo.displayName="AlertTitle";const Ns=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:me("text-sm [&_p]:leading-relaxed",s),...t}));Ns.displayName="AlertDescription";function Ai({userType:s="buyer",onSuccess:t,onError:r,className:c=""}){const{loginWithFirebase:N}=fr(),y=a.useRef(new gi),[n,o]=a.useState("phone"),[f,u]=a.useState(""),[S,x]=a.useState(""),[A,d]=a.useState(!1),[v,j]=a.useState(""),[m,l]=a.useState(""),[b,T]=a.useState(0),[C,P]=a.useState(!1);a.useEffect(()=>{let p;return b>0&&(p=setInterval(()=>{T(i=>i-1)},1e3)),()=>clearInterval(p)},[b]),a.useEffect(()=>(k(),()=>{y.current.clearRecaptcha()}),[]);const k=async()=>{try{await y.current.initializeRecaptcha("recaptcha-container"),P(!0),console.log("reCAPTCHA initialized successfully")}catch(p){console.error("Failed to initialize reCAPTCHA:",p),j("Failed to initialize security verification. Please refresh the page.")}},h=p=>{const i=p.replace(/\D/g,"");return i.length===10?`+91${i}`:i.length===12&&i.startsWith("91")?`+${i}`:i.length===13&&i.startsWith("91")?`+${i.substring(0,12)}`:p.startsWith("+")?p:`+91${p}`},w=p=>{const i=p.replace(/\D/g,"");return i.length===10&&/^[6-9]\d{9}$/.test(i)},E=async p=>{if(p.preventDefault(),!w(f)){j("Please enter a valid 10-digit Indian mobile number");return}if(!C){j("Security verification not ready. Please wait or refresh the page.");return}d(!0),j(""),l("");try{const i=h(f);console.log("Sending OTP to:",i),await y.current.sendOTP(i),o("otp"),T(60),l("OTP sent successfully! Please check your phone."),setTimeout(()=>l(""),3e3)}catch(i){console.error("Failed to send OTP:",i),j(i.message||"Failed to send OTP. Please try again."),setTimeout(()=>{k()},1e3)}finally{d(!1)}},L=async p=>{if(p.preventDefault(),S.length!==6){j("Please enter a valid 6-digit OTP");return}d(!0),j(""),l("");try{console.log("Verifying OTP:",S);const i=await y.current.verifyOTP(S);console.log("OTP verified successfully, Firebase user:",i.uid),await N(i,s),l("Phone number verified successfully!"),t&&t()}catch(i){console.error("OTP verification failed:",i);const F=i.message||"Invalid OTP. Please try again.";j(F),r&&r(F)}finally{d(!1)}},q=async()=>{if(!(b>0)){x(""),j(""),l("");try{d(!0);const p=h(f);await y.current.sendOTP(p),T(60),l("OTP resent successfully!"),setTimeout(()=>l(""),3e3)}catch(p){console.error("Failed to resend OTP:",p),j(p.message||"Failed to resend OTP. Please try again.")}finally{d(!1)}}},V=()=>{o("phone"),x(""),j(""),l(""),y.current.clearRecaptcha(),setTimeout(()=>{k()},500)};return e.jsxs("div",{className:c,children:[v&&e.jsxs(vs,{className:"mb-4 border-red-200 bg-red-50",children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-red-800",children:v})]}),m&&e.jsxs(vs,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-green-800",children:m})]}),n==="phone"&&e.jsxs(U,{children:[e.jsxs(K,{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ge,{className:"h-8 w-8 text-white"})}),e.jsx(Y,{className:"text-xl",children:"Enter your mobile number"}),e.jsx("p",{className:"text-gray-600",children:"We'll send you a verification code via SMS"})]}),e.jsx(_,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mobile Number"}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-md",children:e.jsx("span",{className:"text-gray-600 font-medium",children:"+91"})}),e.jsx(Q,{type:"tel",placeholder:"9876543210",value:f,onChange:p=>{const i=p.target.value.replace(/\D/g,"").substring(0,10);u(i),j("")},className:"rounded-l-none",required:!0,disabled:A})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your 10-digit mobile number without country code"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{id:"recaptcha-container",className:"flex justify-center"})}),!C&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-gray-500",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Initializing security verification..."})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",disabled:!w(f)||A||!C,children:A?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Sending OTP..."]}):"Send OTP"})]})})]}),n==="otp"&&e.jsxs(U,{children:[e.jsxs(K,{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ce,{className:"h-8 w-8 text-white"})}),e.jsx(Y,{className:"text-xl",children:"Enter verification code"}),e.jsxs("p",{className:"text-gray-600",children:["We sent a 6-digit code to +91 ",f]})]}),e.jsxs(_,{children:[e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),e.jsx(Q,{type:"text",placeholder:"123456",value:S,onChange:p=>{const i=p.target.value.replace(/\D/g,"").substring(0,6);x(i),j("")},className:"text-center text-lg tracking-widest font-mono",maxLength:6,required:!0,disabled:A}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the 6-digit code sent to your phone"})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",disabled:S.length!==6||A,children:A?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Verifying..."]}):"Verify Code"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("button",{type:"button",onClick:V,className:"text-sm text-gray-500 hover:text-gray-700 flex items-center",disabled:A,children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Change Number"]}),b>0?e.jsxs("span",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"Resend in ",b,"s"]}):e.jsx("button",{type:"button",onClick:q,className:"text-sm text-[#C70000] hover:text-[#A60000] font-medium",disabled:A,children:"Resend OTP"})]})]})]})]})}function Ti({userType:s="buyer",onSuccess:t,onError:r,className:c="",variant:N="card"}){const{login:y}=je(),[n,o]=a.useState(!1),[f,u]=a.useState(""),[S,x]=a.useState(""),A=async()=>{var v,j;o(!0),u(""),x("");try{const{idToken:m}=await Ha();if(!m)throw new Error("Failed to get Firebase ID token");const l=await fetch("/api/auth/firebase-login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify({idToken:m,userType:s})}),b=await l.json().catch(()=>({}));if(!l.ok||(b==null?void 0:b.success)===!1)throw new Error((b==null?void 0:b.error)||"Google login failed");const T=(b==null?void 0:b.token)??((v=b==null?void 0:b.data)==null?void 0:v.token),C=(b==null?void 0:b.user)??((j=b==null?void 0:b.data)==null?void 0:j.user);if(!T||!C)throw new Error("Invalid server response");y(T,C),x("You're signed in with Google!"),t==null||t()}catch(m){const l=(m==null?void 0:m.message)||"Google authentication failed. Please try again.";u(l),r==null||r(l)}finally{o(!1)}},d=e.jsxs(g,{type:"button",onClick:A,disabled:n,className:"w-full flex items-center justify-center gap-2",variant:N==="button"?"outline":void 0,children:[e.jsx(Da,{className:"w-5 h-5"}),n?"Signing in...":"Continue with Google"]});return N==="button"?e.jsxs("div",{className:c,children:[f&&e.jsxs(vs,{className:"mb-3 border-red-200 bg-red-50",children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-red-800",children:f})]}),S&&e.jsxs(vs,{className:"mb-3 border-green-200 bg-green-50",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-green-800",children:S})]}),d]}):e.jsxs(U,{className:c,children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"Sign in with Google"]})}),e.jsxs(_,{children:[f&&e.jsxs(vs,{className:"mb-3 border-red-200 bg-red-50",children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-red-800",children:f})]}),S&&e.jsxs(vs,{className:"mb-3 border-green-200 bg-green-50",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-green-800",children:S})]}),d,e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"By continuing, you agree to our Terms and Privacy Policy."})]})]})}const Vo=()=>{const s=Ve(),[t]=Na(),{isAuthenticated:r,user:c,loading:N}=fr(),[y,n]=a.useState("phone"),[o,f]=a.useState("buyer");a.useEffect(()=>{const v=t.get("type")||"buyer";f(v)},[t]),a.useEffect(()=>{if(!N&&r&&c){const j={seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard",admin:"/admin"}[c.userType]||"/";s(j)}},[r,c,N,s]);const u=()=>{console.log("Authentication successful, redirecting...")},S=v=>{console.error("Authentication error:",v)},x=v=>{const j={buyer:{title:"Property Buyer",description:"Find your dream home",icon:Pe,color:"bg-blue-500",benefits:["Browse properties","Save favorites","Contact sellers directly","Get market insights"]},seller:{title:"Property Seller",description:"List and sell properties",icon:Hs,color:"bg-green-500",benefits:["List unlimited properties","Manage inquiries","Track performance","Professional tools"]},agent:{title:"Real Estate Agent",description:"Grow your business",icon:Je,color:"bg-purple-500",benefits:["Manage client portfolio","Lead generation","Commission tracking","Professional profile"]}};return j[v]||j.buyer},A=x(o),d=A.icon;return N?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50",children:[e.jsx("div",{className:"bg-[#C70000] text-white p-4",children:e.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"ASHISH PROPERTY"})]}),e.jsx(be,{to:"/",className:"text-white hover:text-red-200",children:e.jsx(Qe,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"relative py-12 bg-gradient-to-r from-[#C70000] to-[#A50000] text-white",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx("div",{className:`w-16 h-16 ${A.color} rounded-full flex items-center justify-center mr-4`,children:e.jsx(d,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx(re,{variant:"secondary",className:"mb-2 bg-white/20 text-white",children:A.title}),e.jsx("h2",{className:"text-3xl font-bold",children:"Welcome to Firebase Auth"}),e.jsx("p",{className:"text-red-100",children:A.description})]})]}),e.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto",children:"Secure authentication powered by Google Firebase"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 max-w-4xl mx-auto",children:A.benefits.map((v,j)=>e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx(Le,{className:"h-6 w-6 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:v})]},j))})]})}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-900",children:"Choose your preferred sign-in method"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(g,{variant:y==="phone"?"default":"outline",onClick:()=>n("phone"),className:`${y==="phone"?"bg-[#C70000] text-white":"text-gray-700"} flex items-center justify-center space-x-2 py-6`,children:[e.jsx(Ht,{className:"h-5 w-5"}),e.jsx("span",{children:"Phone OTP"})]}),e.jsxs(g,{variant:y==="google"?"default":"outline",onClick:()=>n("google"),className:`${y==="google"?"bg-[#C70000] text-white":"text-gray-700"} flex items-center justify-center space-x-2 py-6`,children:[e.jsx(Da,{className:"h-5 w-5"}),e.jsx("span",{children:"Google"})]})]})]}),e.jsx("div",{className:"mb-6 text-center",children:y==="phone"?e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx(Ge,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Phone Number Authentication"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Secure login using SMS OTP verification. Your phone number will be verified via Firebase."})]}):e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx(ms,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("h4",{className:"font-semibold text-green-900 mb-1",children:"Google Authentication"}),e.jsx("p",{className:"text-sm text-green-700",children:"Quick and secure sign-in using your Google account. No passwords to remember."})]})}),e.jsxs("div",{className:"space-y-6",children:[y==="phone"&&e.jsx(Ai,{userType:o,onSuccess:u,onError:S}),y==="google"&&e.jsx(Ti,{userType:o,onSuccess:u,onError:S,variant:"card"})]}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Prefer a different method?"}),e.jsx(g,{variant:"ghost",onClick:()=>n(y==="phone"?"google":"phone"),className:"text-[#C70000] hover:text-[#A50000] hover:bg-red-50",children:y==="phone"?e.jsxs(e.Fragment,{children:[e.jsx(Da,{className:"h-4 w-4 mr-2"}),"Try Google Sign-In"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ht,{className:"h-4 w-4 mr-2"}),"Try Phone OTP"]})})]}),e.jsxs("div",{className:"mt-8 bg-white rounded-lg p-6 shadow-sm border",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Je,{className:"h-5 w-5 mr-2 text-green-600"}),"Secure & Trusted"]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx("span",{children:"Powered by Google Firebase"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx("span",{children:"Bank-level security encryption"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx("span",{children:"No passwords stored on our servers"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx("span",{children:"GDPR compliant data handling"})]})]})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Not a ",A.title.toLowerCase(),"?"]}),e.jsx("div",{className:"flex justify-center space-x-2",children:["buyer","seller","agent"].map(v=>e.jsx(be,{to:`/firebase-auth?type=${v}`,className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${v===o?"bg-[#C70000] text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:x(v).title},v))})]}),e.jsxs("div",{className:"mt-8 text-center space-y-2",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["By signing in, you agree to our"," ",e.jsx(be,{to:"/terms-conditions",className:"text-[#C70000] hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx(be,{to:"/privacy-policy",className:"text-[#C70000] hover:underline",children:"Privacy Policy"})]}),e.jsxs(be,{to:"/",className:"text-[#C70000] hover:text-[#A50000] text-sm flex items-center justify-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Back to Home"]})]})]})})]})};class qo extends a.Component{constructor(r){super(r);ot(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});ot(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,c){this.setState({error:r,errorInfo:c}),console.error("Authentication Error Boundary caught an error:",r,c),this.props.onError&&this.props.onError(r,c)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center p-4",children:e.jsxs(U,{className:"max-w-md w-full",children:[e.jsxs(K,{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(rs,{className:"h-8 w-8 text-red-600"})}),e.jsx(Y,{className:"text-xl text-gray-900",children:"Authentication Error"}),e.jsx("p",{className:"text-gray-600",children:"Something went wrong with the authentication process"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs(vs,{className:"border-red-200 bg-red-50",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-red-800",children:((r=this.state.error)==null?void 0:r.message)||"An unexpected error occurred during authentication"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{onClick:this.handleRetry,className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(Ll,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsxs(g,{onClick:this.handleGoHome,variant:"outline",className:"w-full",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Go to Home"]})]}),!1]})]})}):this.props.children}}const Ho=()=>{const{user:s,firebaseUser:t,isAuthenticated:r,loading:c,logout:N}=fr(),[y,n]=a.useState("info"),o=async()=>{try{await N(),console.log("Logout successful")}catch(u){console.error("Logout failed:",u)}},f=u=>u?new Date(u).toLocaleString():"Never";return c?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading authentication state..."})]})}):e.jsx(qo,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Firebase Authentication Test"}),e.jsx("p",{className:"text-gray-600",children:"Test and verify Firebase Phone OTP and Google authentication"})]}),e.jsxs(U,{className:"mb-6",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(Je,{className:"h-5 w-5 mr-2"}),"Authentication Status"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 ${r?"bg-green-100":"bg-red-100"}`,children:r?e.jsx(Le,{className:"h-8 w-8 text-green-600"}):e.jsx(ds,{className:"h-8 w-8 text-red-600"})}),e.jsx(re,{variant:r?"default":"destructive",children:r?"Authenticated":"Not Authenticated"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 ${s?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(hs,{className:"h-8 w-8 text-blue-600"})}),e.jsx(re,{variant:s?"default":"secondary",children:s?"User Profile":"No Profile"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 ${t?"bg-orange-100":"bg-gray-100"}`,children:e.jsx(Je,{className:"h-8 w-8 text-orange-600"})}),e.jsx(re,{variant:t?"default":"secondary",children:t?"Firebase User":"No Firebase"})]})]})})]}),r&&s&&e.jsxs(U,{className:"mb-6",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(hs,{className:"h-5 w-5 mr-2"}),"User Information"]}),e.jsxs(g,{onClick:o,variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:[e.jsx(Ms,{className:"h-4 w-4 mr-1"}),"Logout"]})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"User Type"}),e.jsx(re,{className:"ml-2",children:s.userType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:s.email||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("p",{className:"text-gray-900",children:s.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Firebase UID"}),e.jsx("p",{className:"text-gray-900 font-mono text-sm",children:s.firebaseUid||"Not linked"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Last Login"}),e.jsx("p",{className:"text-gray-900",children:f(s.lastLogin)})]})]}),t&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Firebase User Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Firebase UID"}),e.jsx("p",{className:"text-gray-900 font-mono",children:t.uid})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider ID"}),e.jsx("p",{className:"text-gray-900",children:t.providerId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Email Verified"}),e.jsx(re,{variant:t.emailVerified?"default":"secondary",children:t.emailVerified?"Verified":"Not Verified"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Creation Time"}),e.jsx("p",{className:"text-gray-900",children:f(t.metadata.creationTime)})]})]})]})]})]}),!r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Test Authentication Methods"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(g,{variant:y==="phone"?"default":"outline",onClick:()=>n("phone"),className:y==="phone"?"bg-[#C70000]":"",children:[e.jsx(Ht,{className:"h-4 w-4 mr-2"}),"Phone OTP"]}),e.jsxs(g,{variant:y==="google"?"default":"outline",onClick:()=>n("google"),className:y==="google"?"bg-[#C70000]":"",children:[e.jsx(Da,{className:"h-4 w-4 mr-2"}),"Google Auth"]}),e.jsxs(g,{variant:y==="info"?"default":"outline",onClick:()=>n("info"),className:y==="info"?"bg-[#C70000]":"",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Info"]})]})})]}),y==="phone"&&e.jsx(Ai,{userType:"buyer",onSuccess:()=>console.log("Phone auth successful"),onError:u=>console.error("Phone auth error:",u)}),y==="google"&&e.jsx(Ti,{userType:"buyer",onSuccess:()=>console.log("Google auth successful"),onError:u=>console.error("Google auth error:",u),variant:"card"}),y==="info"&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Authentication Test Information"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Phone OTP Testing"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Enter a valid Indian mobile number (10 digits)"}),e.jsx("li",{children:"â€¢ Complete the reCAPTCHA verification"}),e.jsx("li",{children:"â€¢ Firebase will send a real SMS OTP to your phone"}),e.jsx("li",{children:"â€¢ Enter the 6-digit code to complete authentication"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Google Authentication Testing"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Click the Google sign-in button"}),e.jsx("li",{children:"â€¢ A popup will open for Google authentication"}),e.jsx("li",{children:"â€¢ Sign in with your Google account"}),e.jsx("li",{children:"â€¢ The popup will close and you'll be authenticated"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Expected Behavior"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[e.jsx("li",{children:"â€¢ User profile will be created in Firestore"}),e.jsx("li",{children:"â€¢ Authentication state will persist across page reloads"}),e.jsx("li",{children:"â€¢ User will be redirected to appropriate dashboard"}),e.jsx("li",{children:"â€¢ Error handling will show helpful messages"})]})]})]})]})]}),!1]})})})},ue=Ol,pe=Ml,xe=a.forwardRef(({className:s,children:t,...r},c)=>e.jsxs(wn,{ref:c,className:me("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[t,e.jsx(Dl,{asChild:!0,children:e.jsx(ea,{className:"h-4 w-4 opacity-50"})})]}));xe.displayName=wn.displayName;const Ei=a.forwardRef(({className:s,...t},r)=>e.jsx(Cn,{ref:r,className:me("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(qa,{className:"h-4 w-4"})}));Ei.displayName=Cn.displayName;const Ii=a.forwardRef(({className:s,...t},r)=>e.jsx(Sn,{ref:r,className:me("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(ea,{className:"h-4 w-4"})}));Ii.displayName=Sn.displayName;const he=a.forwardRef(({className:s,children:t,position:r="popper",...c},N)=>e.jsx(Rl,{children:e.jsxs(kn,{ref:N,className:me("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...c,children:[e.jsx(Ei,{}),e.jsx($l,{className:me("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Ii,{})]})}));he.displayName=kn.displayName;const Go=a.forwardRef(({className:s,...t},r)=>e.jsx(Pn,{ref:r,className:me("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));Go.displayName=Pn.displayName;const G=a.forwardRef(({className:s,children:t,...r},c)=>e.jsxs(An,{ref:c,className:me("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ul,{children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsx(_l,{children:t})]}));G.displayName=An.displayName;const Jo=a.forwardRef(({className:s,...t},r)=>e.jsx(Tn,{ref:r,className:me("-mx-1 my-1 h-px bg-muted",s),...t}));Jo.displayName=Tn.displayName;const Oa={categories:{colonies_nagars:["Adarsh Nagar","Ambedkar Colony","Amrit Colony","Anand Nagar","Arya Nagar","Babat Mohalla","Bhagat Singh Colony","Bharat Colony","Beniwal Nagar","Chandi Ram Colony","Chawla Colony","Chhotu Ram Nagar","Chunnipura","DLF Colony","Dairy Mohalla","Durga Colony","Devi Vihar","Dhariyao Singh Nagar","Ekta Colony","Gandhi Nagar","Geeta Colony","Gopal Pura","Hari Singh Colony","Jagdish Colony","Janta Colony","Jawahar Nagar","Kamla Nagar","Kailash Colony","Kath Mandi","Kewal Gunj","Kirpal Nagar","Lal Bhadur Shastry Nagar","Laxmi Nagar","Mansarover Colony","Mini Secretariate","Model Town","Nehru Colony","New Janta Colony","Nirmal Nagar","Neta Ji Colony","Old Power House Colony","Old Housing Board Colony","Palika Colony","Patel Nagar","Police Line Colony","Prem Nagar","Pratap Nagar","Rajendra Colony","Rajeev Colony","Ram Gopal Colony","Ram Nagar","Revenue Colony","Roop Vihar","Sain Dass Colony","Sanik Colony","Sanjay Colony","Sant Nagar","Srinagar Colony","Sham Colony","Shastri Nagar","Shiv Nagar","Shivam Enclave","Subhash Nagar","Suncity Township 1","Sukhpura","Uttam Vihar","Vijay Nagar","Vikas Nagar","Vinay Nagar","Vaish Colony","Yuva Kendra Colony"],chowks_landmarks:["Chawla Chowk","Chhotu Ram Chowk","Prem Nagar Chowk","Mata Mandir Chowk","Sunaria Chowk","Sukhpura Chowk"],sectors:["Sector-1","Sector-2","Sector-3","Sector-4","Sector-5","Sector-6","Sector-7","Sector-14","Sector-21","Sector-22","Sector-24","Sector-25","Sector-26","Sector-27","Sector-28","Sector-29","Sector-30 (Commercial)","Sector-31","Sector-33","Sector-33A","Sector-36A","Sector-37"],other_popular_localities:["Bara Bazar","Gohana Road (commercial stretch)","Railway Colony","New Grain Market","H.U.D.A. Complex","Sugar Mill Colony","Industrial Model Township","HSIIDC Industrial Area"]}},Er=()=>Oa.categories.sectors,Wo=()=>Oa.categories.colonies_nagars,Qo=()=>[...Oa.categories.chowks_landmarks,...Oa.categories.other_popular_localities];function Ke(){const[s,t]=a.useState(!1),[r,c]=a.useState("sectors"),N=()=>{switch(r){case"sectors":return Er();case"colonies":return Wo();case"landmarks":return Qo();default:return Er()}};return e.jsxs("header",{className:"bg-[#C70000] text-white sticky top-0 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white flex items-center justify-center rounded",children:e.jsx("span",{className:"text-[#C70000] font-bold text-lg",children:"A"})}),e.jsx("span",{className:"text-xl font-bold tracking-wide",children:"ASHISH PROPERTY"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{className:"p-2",children:e.jsx(He,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 md:hidden",onClick:()=>t(!s),children:s?e.jsx(Ue,{className:"h-5 w-5"}):e.jsx(Ba,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-between px-4 pb-2",children:e.jsxs("nav",{className:"flex space-x-6",children:[e.jsx("a",{href:"/",className:"text-white hover:text-red-200 font-medium",children:"Home"}),e.jsx("a",{href:"/categories",className:"text-white hover:text-red-200 font-medium",children:"Categories"}),e.jsx("a",{href:"/maps",className:"text-white hover:text-gray-200 transition-colors text-sm font-bold px-4 py-2 rounded-md bg-[#A60000] border border-white/20 shadow-sm",children:"MAPS"}),e.jsx("a",{href:"/new-projects",className:"text-white hover:text-gray-200 transition-colors text-sm font-bold px-4 py-2 rounded-md bg-[#A60000] border border-white/20 shadow-sm",children:"NEW PROJECTS"}),e.jsx("a",{href:"/post-property",className:"text-white hover:text-red-200 font-medium",children:"Post Property"})]})}),s&&e.jsx("div",{className:"md:hidden bg-[#A60000] px-4 py-4",children:e.jsxs("nav",{className:"flex flex-col space-y-3",children:[e.jsx("a",{href:"/",className:"text-white hover:text-red-200 font-medium py-2",children:"Home"}),e.jsx("a",{href:"/categories",className:"text-white hover:text-red-200 font-medium py-2",children:"Categories"}),e.jsx("a",{href:"/maps",className:"text-white hover:text-gray-200 font-bold py-2 px-3 rounded bg-[#950000] border border-white/20",children:"MAPS"}),e.jsx("a",{href:"/new-projects",className:"text-white hover:text-gray-200 font-bold py-2 px-3 rounded bg-[#950000] border border-white/20",children:"NEW PROJECTS"}),e.jsx("a",{href:"/post-property",className:"text-white hover:text-red-200 font-medium py-2",children:"Post Property"})]})}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex space-x-2 mb-3",children:[e.jsx("button",{onClick:()=>c("sectors"),className:`px-3 py-1 rounded-full text-xs font-medium ${r==="sectors"?"bg-white text-[#C70000]":"bg-white bg-opacity-20 text-white"}`,children:"Sectors"}),e.jsx("button",{onClick:()=>c("colonies"),className:`px-3 py-1 rounded-full text-xs font-medium ${r==="colonies"?"bg-white text-[#C70000]":"bg-white bg-opacity-20 text-white"}`,children:"Colonies"}),e.jsx("button",{onClick:()=>c("landmarks"),className:`px-3 py-1 rounded-full text-xs font-medium ${r==="landmarks"?"bg-white text-[#C70000]":"bg-white bg-opacity-20 text-white"}`,children:"Landmarks"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(ue,{children:[e.jsx(xe,{className:"h-12 bg-white border-0 text-gray-900",children:e.jsx(pe,{placeholder:`Select ${r}...`})}),e.jsx(he,{children:N().map(y=>e.jsx(G,{value:y.toLowerCase().replace(/\s+/g,"-"),children:y},y))})]})}),e.jsx(g,{size:"sm",className:"h-12 px-6 bg-white text-[#C70000] hover:bg-gray-100",children:e.jsx(ts,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("a",{href:"/maps",className:"px-3 py-1.5 bg-white text-[#C70000] rounded-md text-sm font-semibold hover:bg-red-50",children:"MAPS"}),e.jsx("a",{href:"/new-projects",className:"px-3 py-1.5 bg-white text-[#C70000] rounded-md text-sm font-semibold hover:bg-red-50",children:"NEW PROJECTS"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{className:"p-2 bg-white bg-opacity-20 rounded-lg",onClick:()=>window.location.href="/wishlist",children:e.jsx(xs,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:e.jsx(Es,{className:"h-5 w-5"})})]})]})]})}const Ko={residential:[{id:"flat",name:"Flat/Apartment",slug:"flat",description:"Independent flats and apartments"},{id:"independent-house",name:"Independent House",slug:"independent-house",description:"Standalone houses"},{id:"villa",name:"Villa",slug:"villa",description:"Luxury villas and bungalows"},{id:"builder-floor",name:"Builder Floor",slug:"builder-floor",description:"Builder floor apartments"},{id:"penthouse",name:"Penthouse",slug:"penthouse",description:"Top floor luxury units"},{id:"studio-apartment",name:"Studio Apartment",slug:"studio-apartment",description:"Single room living spaces"}],commercial:[{id:"office-space",name:"Office Space",slug:"office-space",description:"Commercial office units"},{id:"shop-showroom",name:"Shop/Showroom",slug:"shop-showroom",description:"Retail spaces and showrooms"},{id:"warehouse",name:"Warehouse/Godown",slug:"warehouse",description:"Storage and warehouse spaces"},{id:"industrial-land",name:"Industrial Land",slug:"industrial-land",description:"Land for industrial use"},{id:"business-center",name:"Business Center",slug:"business-center",description:"Shared office spaces"},{id:"coworking",name:"Co-working Space",slug:"coworking",description:"Shared working environments"}],plot:[{id:"residential-plot",name:"Residential Plot",slug:"residential-plot",description:"Land for residential construction"},{id:"commercial-plot",name:"Commercial Plot",slug:"commercial-plot",description:"Land for commercial development"},{id:"industrial-plot",name:"Industrial Plot",slug:"industrial-plot",description:"Land for industrial purposes"},{id:"agricultural-land",name:"Agricultural Land",slug:"agricultural-land",description:"Farmland and agricultural plots"}],"pg-hostel":[{id:"boys-pg",name:"Boys PG",slug:"boys-pg",description:"Paying guest accommodation for men"},{id:"girls-pg",name:"Girls PG",slug:"girls-pg",description:"Paying guest accommodation for women"},{id:"co-living",name:"Co-living Spaces",slug:"co-living",description:"Modern shared living spaces"},{id:"hostel",name:"Hostel",slug:"hostel",description:"Dormitory style accommodation"},{id:"shared-room",name:"Shared Room",slug:"shared-room",description:"Shared bedroom accommodation"},{id:"single-room",name:"Single Room",slug:"single-room",description:"Private single room accommodation"}],"interior-design":[{id:"home-interior",name:"Home Interior",slug:"home-interior",description:"Residential interior design"},{id:"office-interior",name:"Office Interior",slug:"office-interior",description:"Commercial interior design"},{id:"modular-kitchen",name:"Modular Kitchen",slug:"modular-kitchen",description:"Kitchen design and setup"},{id:"furniture",name:"Furniture",slug:"furniture",description:"Custom furniture solutions"}],"home-services":[{id:"packers-movers",name:"Packers & Movers",slug:"packers-movers",description:"Relocation services"},{id:"cleaning-services",name:"Cleaning Services",slug:"cleaning-services",description:"Home and office cleaning"},{id:"home-maintenance",name:"Home Maintenance",slug:"home-maintenance",description:"Repair and maintenance services"},{id:"security-services",name:"Security Services",slug:"security-services",description:"Home and office security"}],"legal-services":[{id:"property-lawyer",name:"Property Lawyer",slug:"property-lawyer",description:"Legal services for property"},{id:"documentation",name:"Documentation",slug:"documentation",description:"Property document services"},{id:"loan-assistance",name:"Loan Assistance",slug:"loan-assistance",description:"Home loan and mortgage help"}]},Ir=s=>Ko[s]||[];function Yo(){const[s,t]=a.useState([]),[r,c]=a.useState(null),[N,y]=a.useState(null),[n,o]=a.useState(!0),[f,u]=a.useState({});a.useEffect(()=>{S(),x();const m=()=>S();return window.addEventListener("categories:updated",m),()=>window.removeEventListener("categories:updated",m)},[]);const S=async()=>{try{o(!0);const l=await(await fetch("/api/categories",{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();l.success&&t(l.data)}catch(m){console.error("Error fetching categories:",m)}finally{o(!1)}},x=async()=>{var m;try{const b=await(await fetch("/api/properties",{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();if(b.success){const T={};(m=b.data.properties)==null||m.forEach(C=>{C.subCategory&&(T[C.subCategory]=(T[C.subCategory]||0)+1)}),u(T)}}catch(l){console.error("Error fetching property counts:",l)}},A=m=>{window.innerWidth<768?c(m):window.location.href=`/categories/${m.slug}`},d=()=>{N?y(null):c(null)},v=m=>{Ir(m.slug).length>0?y(m):window.location.href=`/categories/${r==null?void 0:r.slug}/${m.slug}`},j=m=>{window.location.href=`/categories/${r==null?void 0:r.slug}/${N==null?void 0:N.slug}/${m.slug}`};if(n)return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]});if(N&&r){const m=Ir(N.slug);return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:d,className:"mr-4 p-2",children:e.jsx(Qe,{className:"h-6 w-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:N.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Choose property type"})]})]}),e.jsx("div",{className:"space-y-2",children:m.map(l=>e.jsxs("button",{onClick:()=>j(l),className:"w-full bg-white border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:l.icon||r.icon})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-base",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.description})]})]}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]},l.id))})]}),e.jsx(ve,{})]})}return r?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:d,className:"mr-4 p-2",children:e.jsx(Qe,{className:"h-6 w-6 text-gray-700"})}),e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:r.name})]}),e.jsx("div",{className:"space-y-2",children:(r.subcategories||[]).map(m=>e.jsxs("button",{onClick:()=>v(m),className:"w-full bg-white border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:r.icon})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-base",children:m.name}),e.jsx("p",{className:"text-sm text-gray-500",children:m.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[f[m.slug]&&e.jsx("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:f[m.slug]}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]})]},m.id))})]}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:"All Categories"})}),e.jsx("div",{className:"space-y-2",children:s.map(m=>{var l;return e.jsxs("button",{onClick:()=>A(m),className:"w-full bg-white border border-gray-200 rounded-lg p-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:m.icon})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-base",children:m.name}),e.jsx("p",{className:"text-sm text-gray-500",children:m.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:[((l=m.subcategories)==null?void 0:l.length)??0," types"]}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]})]},m._id||m.slug)})})]}),e.jsx(ve,{})]})}function dr({text:s="ashishproperties.in",small:t=!1,className:r="",variant:c="pattern",opacity:N=.12,angle:y=-30}){if(c==="badge"||t)return e.jsx("div",{className:["pointer-events-none select-none absolute bottom-1 left-1/2 -translate-x-1/2 z-10",t?"text-[10px] px-2 py-0.5":"text-xs px-2 py-0.5","font-semibold text-white rounded bg-black/40 shadow",r].join(" "),children:s});const n=260,o=180,u=encodeURIComponent(`
    <svg xmlns='http://www.w3.org/2000/svg' width='${n}' height='${o}'>
      <defs>
        <style>
          text{font-family: sans-serif; font-weight:600; font-size:18px; fill:#000; opacity:${N};}
        </style>
      </defs>
      <g transform='rotate(${y} ${n/2} ${o/2})'>
        <text x='20' y='${o/2}'>${s}</text>
      </g>
    </svg>
  `);return e.jsx("div",{"aria-hidden":!0,className:["pointer-events-none select-none absolute inset-0 z-10",r].join(" "),style:{backgroundImage:`url("data:image/svg+xml,${u}")`,backgroundRepeat:"repeat",backgroundSize:`${n}px ${o}px`,mixBlendMode:"multiply"}})}function Xo(){const[s]=Na(),[t,r]=a.useState([]),[c,N]=a.useState(!0),y=s.get("category"),n=s.get("subcategory");a.useEffect(()=>{o();const u=()=>o();return window.addEventListener("properties:updated",u),()=>window.removeEventListener("properties:updated",u)},[y,n]);const o=async()=>{var u;try{N(!0);const S=new URLSearchParams;S.append("status","active"),y&&S.append("propertyType",y),n&&S.append("subCategory",n);const x=await window.api(`properties?${S}`),A=x.ok?x.json:{success:!1,error:"Failed to fetch properties"};if(A!=null&&A.success){const d=Array.isArray(A.data)?A.data:((u=A.data)==null?void 0:u.properties)||[];r(d)}else r([])}catch(S){console.error("Error fetching properties:",(S==null?void 0:S.message)||S),r([])}finally{N(!1)}},f=()=>{window.history.back()};return c?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:f,className:"mr-4 p-2 bg-white rounded-full shadow-md",children:e.jsx(Qe,{className:"h-5 w-5 text-gray-700"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:n?n.replace("-"," ").toUpperCase():y?y.toUpperCase():"All Properties"})]}),e.jsxs(g,{variant:"outline",size:"sm",className:"border-[#C70000] text-[#C70000]",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),t.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Properties Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No properties match your current filters. Try adjusting your search criteria."}),e.jsx(g,{onClick:()=>window.location.reload(),variant:"outline",className:"border-[#C70000] text-[#C70000]",children:"Reset Filters"})]})}):e.jsx("div",{className:"space-y-4",children:t.map(u=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"relative w-32 h-32 flex-shrink-0",children:[e.jsx("img",{"data-wm":"1",src:u.images[0]||"https://via.placeholder.com/300x300?text=No+Image",alt:u.title,className:"w-full h-full object-cover"}),e.jsx(dr,{variant:"pattern"}),e.jsx("button",{className:"absolute top-2 right-2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md",children:e.jsx(xs,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 leading-tight",children:u.title}),e.jsxs("span",{className:"text-lg font-bold text-[#C70000] ml-2",children:["â‚¹",u.price.toLocaleString(),u.priceType==="rent"&&"/month"]})]}),e.jsxs("div",{className:"flex items-center text-gray-500 mb-2",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:u.location.address})]}),e.jsxs("div",{className:"flex items-center text-gray-500 mb-3 text-sm",children:[u.specifications.bedrooms&&e.jsxs("span",{className:"mr-4",children:[u.specifications.bedrooms," BHK"]}),u.specifications.bathrooms&&e.jsxs("span",{className:"mr-4",children:[u.specifications.bathrooms," Bath"]}),e.jsxs("span",{children:[u.specifications.area," sq ft"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:u.contactInfo.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{size:"sm",className:"bg-[#C70000] hover:bg-[#A60000] text-white",onClick:()=>window.open(`tel:${u.contactInfo.phone}`,"_self"),children:[e.jsx(Ge,{className:"h-3 w-3 mr-1"}),"Call"]}),e.jsxs(g,{size:"sm",className:"bg-white border border-gray-200 text-gray-800",onClick:async()=>{var S,x;try{const A=localStorage.getItem("token"),d=localStorage.getItem("user");if(!A||!d){window.location.href=`/login?redirect=${encodeURIComponent(window.location.pathname+window.location.search)}`;return}const v=JSON.parse(d),j=await window.api("conversations/find-or-create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:{propertyId:u._id}});if(j&&j.success){const m=((S=j.data)==null?void 0:S._id)||((x=j.data)==null?void 0:x.conversationId),l=m?typeof m=="string"?m:m.toString():null;l?window.location.href=`/conversation/${l}`:alert("Failed to start chat")}else alert("Failed to start chat")}catch(A){console.error(A),alert("Failed to start chat")}},children:[e.jsx(Mt,{className:"h-3 w-3 mr-1"}),"Message"]})]})]})]})]})},u._id))})]}),e.jsx(ve,{})]})}function Rt(){return null}function Zo(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{y()},[]);const y=async()=>{var o,f;try{N(!0);const u=await window.api("/categories/buy/subcategories");u.ok&&((o=u.json)!=null&&o.success)?r(u.json.data||[]):console.warn("Subcategories API returned non-OK; falling back",u.status,(f=u.json)==null?void 0:f.error)}catch(u){console.error("Error fetching subcategories:",u),r([{id:"1bhk",name:"1 BHK",slug:"1bhk",description:"Single bedroom apartments",count:45},{id:"2bhk",name:"2 BHK",slug:"2bhk",description:"Two bedroom apartments",count:78},{id:"3bhk",name:"3 BHK",slug:"3bhk",description:"Three bedroom apartments",count:52},{id:"4bhk",name:"4+ BHK",slug:"4bhk",description:"Four or more bedrooms",count:23},{id:"villa",name:"Villa",slug:"villa",description:"Independent villas",count:15},{id:"house",name:"Independent House",slug:"house",description:"Independent houses",count:34},{id:"plot",name:"Plot/Land",slug:"plot",description:"Plots and land",count:28},{id:"commercial",name:"Commercial",slug:"commercial",description:"Commercial properties",count:19}])}finally{N(!1)}},n=o=>{s(`/buy/${o.slug}`)};return c?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Buy Properties"}),e.jsx("p",{className:"text-gray-600",children:"Choose a property type to buy"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("button",{onClick:()=>n(o),className:"subcat-card bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm","data-testid":"subcat-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:o.name}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:o.description}),o.count&&e.jsxs("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:[o.count," properties"]})]},o._id||o.id||o.slug))})]})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function ed(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{y()},[]);const y=async()=>{var o,f;try{N(!0);const u=await window.api("/categories/sale/subcategories");u.ok&&((o=u.json)!=null&&o.success)?r(u.json.data||[]):console.warn("Subcategories API non-OK; using fallback",u.status,(f=u.json)==null?void 0:f.error)}catch(u){console.error("Error fetching subcategories:",u),r([{id:"1bhk",name:"1 BHK",slug:"1bhk",description:"Single bedroom apartments",count:45},{id:"2bhk",name:"2 BHK",slug:"2bhk",description:"Two bedroom apartments",count:78},{id:"3bhk",name:"3 BHK",slug:"3bhk",description:"Three bedroom apartments",count:52},{id:"4bhk",name:"4+ BHK",slug:"4bhk",description:"Four or more bedrooms",count:23},{id:"villa",name:"Villa",slug:"villa",description:"Independent villas",count:15},{id:"house",name:"Independent House",slug:"house",description:"Independent houses",count:34},{id:"plot",name:"Plot/Land",slug:"plot",description:"Plots and land",count:28},{id:"commercial",name:"Commercial",slug:"commercial",description:"Commercial properties",count:19}])}finally{N(!1)}},n=o=>{s(`/sale/${o.slug}`)};return c?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Sale Properties"}),e.jsx("p",{className:"text-gray-600",children:"Choose a property type to sell"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("button",{onClick:()=>n(o),className:"subcat-card bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm","data-testid":"subcat-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:o.name}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:o.description}),o.count&&e.jsxs("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:[o.count," properties"]})]},o._id||o.id||o.slug))})]})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function sd(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{y()},[]);const y=async()=>{var o,f;try{N(!0);const u=await window.api("/categories/rent/subcategories");u.ok&&((o=u.json)!=null&&o.success)?r(u.json.data||[]):console.warn("Subcategories API non-OK; using fallback",u.status,(f=u.json)==null?void 0:f.error)}catch(u){console.error("Error fetching subcategories:",u),r([{id:"1bhk",name:"1 BHK",slug:"1bhk",description:"Single bedroom apartments",count:25},{id:"2bhk",name:"2 BHK",slug:"2bhk",description:"Two bedroom apartments",count:42},{id:"3bhk",name:"3 BHK",slug:"3bhk",description:"Three bedroom apartments",count:31},{id:"4bhk",name:"4+ BHK",slug:"4bhk",description:"Four or more bedrooms",count:12},{id:"villa",name:"Villa",slug:"villa",description:"Independent villas",count:8},{id:"house",name:"Independent House",slug:"house",description:"Independent houses",count:18},{id:"office",name:"Office Space",slug:"office",description:"Commercial office space",count:15},{id:"shop",name:"Shop/Showroom",slug:"shop",description:"Retail spaces",count:22}])}finally{N(!1)}},n=o=>{s(`/rent/${o.slug}`)};return c?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Rent Properties"}),e.jsx("p",{className:"text-gray-600",children:"Choose a property type to rent"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("button",{onClick:()=>n(o),className:"subcat-card bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm","data-testid":"subcat-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:o.name}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:o.description}),o.count&&e.jsxs("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:[o.count," properties"]})]},o._id||o.id||o.slug))})]})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function td(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{y()},[]);const y=async()=>{try{N(!0);const o=await window.api("/categories/lease/subcategories"),f=(o==null?void 0:o.json)||{};if(o!=null&&o.ok&&(f!=null&&f.success)&&Array.isArray(f.data)){r(f.data);return}else console.warn("Subcategories API non-OK; using fallback",o==null?void 0:o.status,f==null?void 0:f.error)}catch(o){console.warn("Subcategories API failed, using fallback:",o)}finally{(!Array.isArray(t)||t.length===0)&&r([{id:"office",name:"Office Space",slug:"office",description:"Commercial office space",count:35},{id:"retail",name:"Retail Space",slug:"retail",description:"Shops and showrooms",count:28},{id:"warehouse",name:"Warehouse",slug:"warehouse",description:"Storage and warehouse",count:12},{id:"industrial",name:"Industrial",slug:"industrial",description:"Industrial properties",count:8},{id:"restaurant",name:"Restaurant Space",slug:"restaurant",description:"Restaurant and food space",count:15},{id:"hotel",name:"Hotel/Lodge",slug:"hotel",description:"Hospitality properties",count:6}]),N(!1)}},n=o=>{s(`/lease/${o.slug}`)};return c?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Lease Properties"}),e.jsx("p",{className:"text-gray-600",children:"Choose a property type for lease"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("button",{onClick:()=>n(o),className:"subcat-card bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm","data-testid":"subcat-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:o.name}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:o.description}),o.count&&e.jsxs("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:[o.count," properties"]})]},o._id||o.id||o.slug))})]})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function ad(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{y()},[]);const y=async()=>{var o,f;try{N(!0);const u=await window.api("/categories/pg/subcategories");u.ok&&((o=u.json)!=null&&o.success)?r(u.json.data||[]):console.warn("Subcategories API non-OK; using fallback",u.status,(f=u.json)==null?void 0:f.error)}catch(u){console.error("Error fetching subcategories:",u),r([{id:"boys-pg",name:"Boys PG",slug:"boys-pg",description:"PG accommodation for boys",count:45},{id:"girls-pg",name:"Girls PG",slug:"girls-pg",description:"PG accommodation for girls",count:38},{id:"co-living",name:"Co-living",slug:"co-living",description:"Co-living spaces",count:22},{id:"hostel",name:"Hostel",slug:"hostel",description:"Hostel accommodation",count:15},{id:"shared-room",name:"Shared Room",slug:"shared-room",description:"Shared room accommodation",count:52},{id:"single-room",name:"Single Room",slug:"single-room",description:"Single room accommodation",count:34}])}finally{N(!1)}},n=o=>{s(`/pg/${o.slug}`)};return c?e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"PG & Hostel"}),e.jsx("p",{className:"text-gray-600",children:"Choose accommodation type"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(o=>e.jsxs("button",{onClick:()=>n(o),className:"subcat-card bg-white border border-gray-200 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors shadow-sm","data-testid":"subcat-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:o.name}),e.jsx(ws,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:o.description}),o.count&&e.jsxs("span",{className:"text-xs bg-[#C70000] text-white px-2 py-1 rounded-full",children:[o.count," properties"]})]},o._id||o.id||o.slug))})]})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function rd(s,t){let r=document.querySelector(`meta[name='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("name",s),document.head.appendChild(r)),r.setAttribute("content",t)}function nd(){return a.useEffect(()=>{document.title="Services | Ashish Property Rohtak",rd("description","Complete real-estate services in Rohtakâ€”Buy, Sell, Rent, Plots, Commercial, Documentation & Home Loans. Call +91-XXXXXXXXXX.")},[]),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsx("div",{className:"px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:"Our Services"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-10",children:[e.jsx(Zs,{title:"Buy Property",desc:"Find the right home, floor, or apartment with verified inventory, fair pricing, and clean titles."}),e.jsx(Zs,{title:"Sell Property",desc:"Serious buyer network, professional photos/videos, and marketing across portals to get you the best value."}),e.jsx(Zs,{title:"Rent/Lease",desc:"Residential & commercial rentals with transparent agreements and deposit terms."}),e.jsx(Zs,{title:"Plots & Land",desc:"Residential plots, industrial land, and farmhouses with locality insights and future growth mapping."}),e.jsx(Zs,{title:"Commercial (Shops/Offices/Godowns)",desc:"Prime market and roadside locationsâ€”ideal for retail, clinics, and startups."}),e.jsx(Zs,{title:"Home Loan Assistance",desc:"Tie-ups and guidance to secure the right loan, eligibility checks, and document support."}),e.jsx(Zs,{title:"Legal & Documentation",desc:"Agreement to Sale, Sale Deed/Registry, Lease Deed, NOC/Bank papersâ€”handled with care."}),e.jsx(Zs,{title:"Property Valuation & Pricing Advice",desc:"Price benchmarking using recent area comparisons and real demand trends."}),e.jsx(Zs,{title:"Photography & Video Walkthroughs",desc:"Clear, professional media so you shortlist faster and visit only the best fits."}),e.jsx(Zs,{title:"Property Management (Optional)",desc:"For NRI/Out-of-station ownersâ€”tenant screening, rent follow-ups, maintenance coordination."})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-3",children:"Mini-FAQ"}),e.jsxs("div",{className:"space-y-4 text-gray-700",children:[e.jsx(_t,{q:"Kya listing verify hoti hai?",a:"Haan, documents & site check ke baad hi recommend karte hain."}),e.jsx(_t,{q:"Registry/Agreement me help milegi?",a:"Poora end-to-end documentation support milta hai."}),e.jsx(_t,{q:"Loan assist karte ho?",a:"Yes, multiple banks/NBFC partners ke sath."}),e.jsx(_t,{q:"Brokerage/Service fee?",a:"Category aur deal size ke hisaab se. Transparent before you proceed."}),e.jsx(_t,{q:"Site visit kaise hoti hai?",a:"Shortlisted properties ke appointment fix karke guided visit karwate hain."}),e.jsx(_t,{q:"Areas cover kaun-se?",a:"Rohtak city & nearby (ðŸ“Œ add exact areas), extended coverage on request."})]})]}),e.jsxs("section",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Get in touch"}),e.jsx("p",{className:"text-gray-700",children:"Call/WhatsApp +91-XXXXXXXXXX â€¢ Email sales@ashishproperty.in"})]})]})})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function Zs({title:s,desc:t}){return e.jsxs("div",{className:"border rounded-lg p-5 hover:shadow-sm transition bg-white",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:t})]})}function _t({q:s,a:t}){return e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["Q: ",s]}),e.jsxs("p",{className:"text-gray-700",children:["A: ",t]})]})}function id(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(null);a.useEffect(()=>{n()},[]);const n=async()=>{try{c(!0),y(null);const u=await window.api("/plans?isActive=1"),S=u.ok?u.json:{success:!1,error:"Failed to fetch plans"};S.success&&Array.isArray(S.data)?(t(S.data),y(null)):(console.warn("Invalid packages data received:",S),y("Invalid data format received"),t([]))}catch(u){console.error("Error fetching packages:",u),y(`Failed to load packages: ${u.message}`),t([])}finally{c(!1)}},o=u=>{switch(u){case"basic":return e.jsx(Ne,{className:"h-6 w-6"});case"featured":return e.jsx(ns,{className:"h-6 w-6"});case"premium":return e.jsx(We,{className:"h-6 w-6"});default:return e.jsx(nt,{className:"h-6 w-6"})}},f=u=>{switch(u){case"basic":return"from-gray-100 to-gray-200 text-gray-800";case"featured":return"from-orange-100 to-orange-200 text-orange-800";case"premium":return"from-purple-100 to-purple-200 text-purple-800";default:return"from-gray-100 to-gray-200 text-gray-800"}};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading packages..."})]})}),e.jsx(ve,{}),e.jsx(Fs,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx("section",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] text-white py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-6",children:[e.jsx(js,{className:"h-12 w-12 mr-4"}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold",children:"Advertisement Packages"})]}),e.jsx("p",{className:"text-xl text-red-100 max-w-3xl mx-auto",children:"Boost your property visibility with our specially designed packages for Rohtak market. Get more views, inquiries, and faster sales with the right advertising package."})]})}),e.jsx("section",{className:"py-16 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[N&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-8",children:N}),s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(js,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No packages available"}),e.jsx("p",{className:"text-gray-500",children:"Please check back later for available advertisement packages."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16",children:s.map((u,S)=>e.jsxs("div",{"data-testid":"plan-card",className:`relative rounded-xl border-2 overflow-hidden transition-all duration-300 hover:shadow-lg hover:scale-105 ${u.type==="premium"?"border-orange-300 transform scale-105 shadow-lg":"border-gray-200"}`,children:[u.type==="premium"&&e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsxs("div",{className:"bg-orange-500 text-white px-4 py-1 rounded-full text-sm font-semibold flex items-center",children:[e.jsx(We,{className:"h-4 w-4 mr-1"}),"Premium"]})}),e.jsxs("div",{className:`bg-gradient-to-r ${f(u.type)} p-6 text-center`,children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-white mb-4 shadow-lg",children:e.jsx("div",{className:`${u.type==="basic"?"text-gray-600":u.type==="featured"?"text-orange-600":"text-purple-600"}`,children:o(u.type)})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:u.name}),e.jsx("div",{className:"text-3xl font-bold mb-1",children:u.price===0?"Free":`â‚¹${u.price}`}),e.jsxs("div",{className:"text-sm opacity-75 flex items-center justify-center",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),u.duration," days"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:u.description}),e.jsx("div",{className:"space-y-3 mb-6",children:u.features.map((x,A)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx(Be,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:x})]},A))}),e.jsxs(g,{onClick:()=>window.location.href=`/checkout/${u._id}`,className:`w-full ${u.type==="basic"?"bg-gray-600 hover:bg-gray-700":u.type==="featured"?"bg-orange-600 hover:bg-orange-700":"bg-purple-600 hover:bg-purple-700"} text-white`,children:[u.price===0?"Start Free Listing":`Choose for â‚¹${u.price}`,e.jsx(gt,{className:"h-4 w-4 ml-2"})]})]})]},u._id))}),e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] rounded-xl text-white p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Why Choose Our Packages?"}),e.jsx("p",{className:"text-red-100",children:"Get the most out of your property listing with our proven advertising solutions"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx(Ne,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"5x More Views"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Featured listings get significantly more visibility"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx($s,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"3x Faster Sales"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Premium properties sell much faster than basic listings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-4",children:e.jsx(Ge,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"4x More Calls"}),e.jsx("p",{className:"text-white text-opacity-90",children:"Get more genuine inquiries from interested buyers"})]})]})]}),e.jsxs("div",{className:"text-center mt-16",children:[e.jsx("h3",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Ready to Sell Your Property Faster?"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Join thousands of successful sellers in Rohtak who trust our platform"}),e.jsxs(g,{onClick:()=>window.location.href="/post-property",className:"bg-[#C70000] hover:bg-[#A60000] text-white px-12 py-4 text-lg",children:["Post Your Property Now",e.jsx(ws,{className:"h-5 w-5 ml-2"})]})]})]})]})})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function ld(){var F,I;const[s]=Na(),{user:t,token:r,isAuthenticated:c,loading:N}=je(),y=s.get("conversation");s.get("propertyId");const[n,o]=a.useState([]),[f,u]=a.useState(null),[S,x]=a.useState([]),[A,d]=a.useState(""),[v,j]=a.useState(!0),[m,l]=a.useState(!1),[b,T]=a.useState(""),[C,P]=a.useState(!1),[k,h]=a.useState(""),w=async()=>{if(r)try{const R=await(await fetch("/api/chat/conversations",{headers:{Authorization:`Bearer ${r}`}})).json();R.success&&R.data?o(R.data):h(R.error||"Failed to load conversations")}catch{h("Network error. Please try again.")}},E=async D=>{if(r)try{const M=await(await fetch(`/api/chat/conversations/${D}/messages`,{headers:{Authorization:`Bearer ${r}`}})).json();M.success&&M.data?x(M.data.messages):h(M.error||"Failed to load messages")}catch{h("Network error. Please try again.")}};a.useEffect(()=>{if(!N){if(!c){window.location.href="/auth";return}j(!0),h(""),w().then(()=>{y&&E(y),j(!1)})}},[y,c,r,N]),a.useEffect(()=>{if(y&&n.length>0){const D=n.find(R=>R._id===y);D&&u(D)}},[y,n]);const L=async()=>{if(!(!A.trim()||!f||m||!r)){l(!0),h("");try{const R=await(await fetch("/api/chat/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({conversationId:f._id,message:A,messageType:"text"})})).json();if(R.success){const M={_id:R.data.messageId,conversationId:f._id,senderId:t.id,senderName:t.name,senderType:t.userType,message:A,messageType:"text",readBy:[{userId:t.id,readAt:new Date}],createdAt:new Date};x(W=>[...W,M]),d(""),w()}else h(R.error||"Failed to send message")}catch{h("Network error. Please try again.")}finally{l(!1)}}},q=D=>{u(D),E(D._id),window.history.pushState({},"",`/chat?conversation=${D._id}`)},V=()=>{u(null),window.history.pushState({},"","/chat")},p=D=>{const M=new Date().getTime()-D.getTime(),W=Math.floor(M/(1e3*60*60*24));return W===0?D.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}):W===1?"Yesterday":W<7?D.toLocaleDateString("en-US",{weekday:"short"}):D.toLocaleDateString("en-US",{month:"short",day:"numeric"})},i=n.filter(D=>{var W,J;const R=D.participantDetails[0],M=(W=D.propertyDetails)==null?void 0:W[0];return(R==null?void 0:R.name.toLowerCase().includes(b.toLowerCase()))||(M==null?void 0:M.title.toLowerCase().includes(b.toLowerCase()))||((J=D.lastMessage)==null?void 0:J.message.toLowerCase().includes(b.toLowerCase()))});if(N)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}),e.jsx(ve,{})]});if(!c)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600",children:"Please login to access chat"}),e.jsx(g,{onClick:()=>window.location.href="/auth",className:"mt-4 bg-[#C70000] hover:bg-[#A60000] text-white",children:"Sign In / Sign Up"})]})}),e.jsx(ve,{})]});if(v)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading chats..."})]})}),e.jsx(ve,{})]});if(f){const D=f.participantDetails[0],R=(F=f.propertyDetails)==null?void 0:F[0];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsxs("header",{className:"bg-white border-b px-4 py-3 flex items-center space-x-3",children:[e.jsx("button",{onClick:V,className:"p-1",children:e.jsx(Qe,{className:"h-6 w-6 text-gray-700"})}),e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:((I=D==null?void 0:D.name)==null?void 0:I.charAt(0))||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:(D==null?void 0:D.name)||"Unknown User"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(pr,{className:"h-2 w-2 text-green-500 fill-current"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Online"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(gr,{className:"h-5 w-5 text-gray-600"})})]})]}),k&&e.jsxs("div",{className:"bg-red-50 border-b border-red-200 p-3 flex items-center space-x-2",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:k})]}),R&&e.jsx("div",{className:"bg-white border-b p-4",children:e.jsxs("div",{className:"flex items-center space-x-3 bg-gray-50 rounded-lg p-3",children:[e.jsx("img",{src:R.images[0]||"/placeholder.svg",alt:R.title,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:R.title}),e.jsx("p",{className:"text-xs text-gray-600",children:R.location.address}),e.jsxs("p",{className:"text-sm font-semibold text-[#C70000]",children:["â‚¹",(R.price/1e5).toFixed(1),"L"]})]}),e.jsx(g,{size:"sm",variant:"outline",className:"text-xs",children:"View"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:S.map(M=>e.jsx("div",{className:`flex ${M.senderId===(t==null?void 0:t.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${M.senderId===(t==null?void 0:t.id)?"bg-[#C70000] text-white":"bg-white text-gray-900"} shadow-sm`,children:[e.jsx("p",{className:"text-sm",children:M.message}),e.jsx("p",{className:`text-xs mt-1 ${M.senderId===(t==null?void 0:t.id)?"text-red-100":"text-gray-500"}`,children:p(M.createdAt)})]})},M._id))}),e.jsx("div",{className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(at,{className:"h-5 w-5 text-gray-600"})}),e.jsx(Q,{placeholder:"Type a message...",value:A,onChange:M=>d(M.target.value),onKeyPress:M=>M.key==="Enter"&&L(),className:"flex-1"}),e.jsx(g,{onClick:L,disabled:!A.trim()||m,className:"bg-[#C70000] hover:bg-[#A60000] text-white p-2",children:e.jsx(Us,{className:"h-4 w-4"})})]})})]})}return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"bg-white border-b p-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-4",children:"Chats"}),k&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4 flex items-center space-x-2",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:k})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{placeholder:"Search conversations...",value:b,onChange:D=>T(D.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"pb-20",children:i.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 mx-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conversations yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start chatting with property owners and agents by visiting property listings."}),e.jsx(g,{onClick:()=>window.location.href="/",className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Browse Properties"})]})}):e.jsx("div",{className:"space-y-1",children:i.map(D=>{var W,J,H;const R=D.participantDetails[0],M=(W=D.propertyDetails)==null?void 0:W[0];return e.jsx("div",{onClick:()=>q(D),className:"bg-white border-b p-4 hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:((J=R==null?void 0:R.name)==null?void 0:J.charAt(0))||"U"})}),D.unreadCount>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:D.unreadCount>9?"9+":D.unreadCount})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:(R==null?void 0:R.name)||"Unknown User"}),e.jsx("span",{className:"text-xs text-gray-500",children:p(D.lastMessageAt)})]}),M&&e.jsxs("p",{className:"text-xs text-gray-600 truncate",children:["Property: ",M.title]}),e.jsx("div",{className:"flex items-center justify-between mt-1",children:e.jsx("p",{className:`text-sm truncate ${D.unreadCount>0?"text-gray-900 font-medium":"text-gray-600"}`,children:((H=D.lastMessage)==null?void 0:H.message)||"No messages yet"})})]})]})},D._id)})})}),e.jsx(ve,{})]})}const $e=a.forwardRef(({className:s,...t},r)=>e.jsx("textarea",{className:me("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));$e.displayName="Textarea";function cd(){var R,M,W;const{conversationId:s}=zs(),t=Ve(),{user:r,isAuthenticated:c}=je(),[N,y]=a.useState([]),[n,o]=a.useState(null),[f,u]=a.useState([]),[S,x]=a.useState(""),[A,d]=a.useState(!0),[v,j]=a.useState(!1),[m,l]=a.useState(""),[b,T]=a.useState(!1),C=a.useRef(null),P=a.useRef(null),[k,h]=a.useState(null);a.useEffect(()=>(c&&E(),()=>{k&&clearInterval(k)}),[c]),a.useEffect(()=>{if(s&&N.length>0){const J=N.find(H=>H._id===s);J?o(J):L(s)}},[s,N]),a.useEffect(()=>{if(n){q(n._id);const J=setInterval(()=>q(n._id),5e3);return h(J),()=>clearInterval(J)}},[n]),a.useEffect(()=>{w()},[f]);const w=()=>{var J;(J=C.current)==null||J.scrollIntoView({behavior:"smooth"})},E=async()=>{try{d(!0);const J=await window.api("/conversations/my");J.success?y(J.data):is({title:"Error",description:J.error||"Failed to load conversations",variant:"destructive"})}catch{is({title:"Error",description:"Network error. Please try again.",variant:"destructive"})}finally{d(!1)}},L=async J=>{try{(await window.api(`/conversations/${J}/messages`)).success&&E()}catch(H){console.error("Error fetching single conversation:",H)}},q=async J=>{try{const H=await window.api(`/conversations/${J}/messages`);H.success&&u(H.data)}catch(H){console.error("Error fetching messages:",H)}},V=async(J,H)=>{const se=J||S;if(!(!se.trim()&&!H||!n||v))try{j(!0);const B={_id:`temp-${Date.now()}`,senderId:r.id,senderName:r.name,senderType:"buyer",message:se,imageUrl:H,messageType:H?"image":"text",createdAt:new Date().toISOString()};u(O=>[...O,B]),x("");const $=await window.api(`/conversations/${n._id}/messages`,{method:"POST",body:{text:se,imageUrl:H}});$.success?(u(O=>O.map(ae=>ae._id===B._id?$.data:ae)),E()):(u(O=>O.filter(ae=>ae._id!==B._id)),is({title:"Error",description:$.error||"Failed to send message",variant:"destructive"}))}catch{u($=>$.filter(O=>O._id.startsWith("temp-"))),is({title:"Error",description:"Failed to send message. Please try again.",variant:"destructive"})}finally{j(!1)}},p=async J=>{if(J)try{T(!0);const H=new FormData;H.append("image",J);const B=await(await fetch("/api/upload",{method:"POST",body:H,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();B.success?await V("",B.url):is({title:"Error",description:"Failed to upload image",variant:"destructive"})}catch{is({title:"Error",description:"Failed to upload image",variant:"destructive"})}finally{T(!1)}},i=J=>{t(`/chat/${J._id}`)},F=J=>{const H=new Date(J),B=new Date().getTime()-H.getTime(),$=Math.floor(B/(1e3*60*60)),O=Math.floor(B/(1e3*60*60*24));return $<1?"Just now":$<24?`${$}h ago`:O===1?"Yesterday":O<7?`${O}d ago`:H.toLocaleDateString()},I=J=>new Date(J).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),D=N.filter(J=>{const H=J.property,se=J.participantDetails.filter(B=>B._id!==(r==null?void 0:r.id));return(H==null?void 0:H.title.toLowerCase().includes(m.toLowerCase()))||se.some(B=>B.name.toLowerCase().includes(m.toLowerCase()))});return c?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"flex-1 flex",children:[e.jsxs("div",{className:"w-full lg:w-1/3 bg-white border-r flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-4",children:"Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search conversations...",value:m,onChange:J=>l(J.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:A?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-[#C70000] border-t-transparent rounded-full"})}):D.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conversations yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start chatting with property owners by visiting property listings."}),e.jsx(g,{onClick:()=>t("/"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Browse Properties"})]}):D.map(J=>{var $,O;const H=J.participantDetails.filter(ae=>ae._id!==(r==null?void 0:r.id)),se=J.property,B=(n==null?void 0:n._id)===J._id;return e.jsx("div",{onClick:()=>i(J),className:`p-4 border-b cursor-pointer hover:bg-gray-50 ${B?"bg-blue-50 border-blue-200":""}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"relative",children:[($=se==null?void 0:se.images)!=null&&$[0]?e.jsx("img",{src:se.images[0],alt:se.title,className:"w-12 h-12 object-cover rounded-full"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(hs,{className:"h-6 w-6 text-gray-400"})}),J.unreadCount>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:J.unreadCount>9?"9+":J.unreadCount})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:(se==null?void 0:se.title)||"Property Chat"}),e.jsx("span",{className:"text-xs text-gray-500",children:F(J.lastMessageAt)})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:H.map(ae=>ae.name).join(", ")}),e.jsx("p",{className:`text-sm truncate ${J.unreadCount>0?"text-gray-900 font-medium":"text-gray-500"}`,children:((O=J.lastMessage)==null?void 0:O.message)||"No messages yet"})]})]})},J._id)})})]}),e.jsx("div",{className:"hidden lg:flex lg:w-2/3 flex-col bg-white",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[((M=(R=n.property)==null?void 0:R.images)==null?void 0:M[0])&&e.jsx("img",{src:n.property.images[0],alt:n.property.title,className:"w-12 h-12 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:(W=n.property)==null?void 0:W.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:["with"," ",n.participantDetails.filter(J=>J._id!==(r==null?void 0:r.id)).map(J=>J.name).join(", ")]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[f.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Start the conversation!"})]}):f.map(J=>{var B;const H=J.senderId===(r==null?void 0:r.id),se=((B=n.participantDetails.find($=>$._id===J.senderId))==null?void 0:B.userType)==="seller";return e.jsx("div",{className:`flex ${H?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${H?"bg-[#C70000] text-white":J.senderType==="admin"?"bg-blue-100 text-blue-900":"bg-gray-100 text-gray-900"}`,children:[!H&&e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium",children:J.senderName}),se&&e.jsx(re,{variant:"secondary",className:"text-xs",children:"Owner"}),J.senderType==="admin"&&e.jsx(re,{variant:"secondary",className:"text-xs",children:"Support"})]}),H&&e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx(re,{variant:"secondary",className:"text-xs bg-white/20 text-white",children:"You"})}),J.imageUrl?e.jsx("img",{src:J.imageUrl,alt:"Sent image",className:"max-w-full h-auto rounded"}):e.jsx("p",{className:"text-sm",children:J.message}),e.jsx("p",{className:"text-xs opacity-75 mt-1",children:I(J.createdAt)})]})},J._id)}),e.jsx("div",{ref:C})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex space-x-2 items-end",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{var J;return(J=P.current)==null?void 0:J.click()},disabled:b,className:"p-2",children:b?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full"}):e.jsx(zl,{className:"h-4 w-4"})}),e.jsx($e,{placeholder:"Type your message...",value:S,onChange:J=>x(J.target.value),className:"flex-1 resize-none",rows:2,onKeyPress:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),V())}}),e.jsx(g,{onClick:()=>V(),disabled:!S.trim()||v,className:"bg-[#C70000] hover:bg-[#A60000] px-4",children:v?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(Us,{className:"h-4 w-4"})})]})}),e.jsx("input",{ref:P,type:"file",accept:"image/*",onChange:J=>{var se;const H=(se=J.target.files)==null?void 0:se[0];H&&(p(H),J.target.value="")},className:"hidden"})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a conversation"}),e.jsx("p",{className:"text-gray-600",children:"Choose a conversation from the list to start chatting"})]})})})]}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please login to access chat"}),e.jsx(g,{onClick:()=>t("/login"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Login"})]})}),e.jsx(ve,{})]})}const tr=s=>{if(!s)return"";if(typeof s=="string")return s;if(s.$oid)return s.$oid;if(s.oid)return s.oid;try{return String(s.toString())}catch{return String(s)}},Fr=async(s,t)=>{const r=Js(s),c=await fetch(r,{headers:{Authorization:`Bearer ${t}`},cache:"no-store"}),N=await c.json().catch(()=>({}));return{ok:c.ok,status:c.status,data:N}},Lr=async(s,t,r)=>{const c=Js(s),N=await fetch(c,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0}),y=await N.json().catch(()=>({}));return{ok:N.ok,status:N.status,data:y}},od=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});function dd(){var E,L,q,V,p;const{id:s}=zs(),t=Ve(),{user:r,token:c,isAuthenticated:N}=je(),y=(r==null?void 0:r.id)||(r==null?void 0:r._id),[n,o]=a.useState(null),[f,u]=a.useState([]),[S,x]=a.useState(""),[A,d]=a.useState(!0),[v,j]=a.useState(!1),[m,l]=a.useState(""),b=a.useRef(null),T=a.useRef(null);a.useEffect(()=>{var i;(i=T.current)==null||i.scrollIntoView({behavior:"smooth"})},[f]),a.useEffect(()=>{if(!N){t("/login");return}if(!s||s==="undefined"){is({title:"Open a property and tap Message Owner"}),t("/chats");return}let i=!0;return d(!0),l(""),(async()=>{var R,M,W;const F=await Fr("conversations/my",c);if(!F.ok||!Array.isArray(((R=F.data)==null?void 0:R.data)??F.data)){i&&(l(((M=F.data)==null?void 0:M.error)||"Failed to load conversation"),d(!1));return}const D=(((W=F.data)==null?void 0:W.data)??F.data).find(J=>tr(J._id)===s);if(!D){i&&(l("Conversation not found"),d(!1));return}i&&o(D),await C(s),await P(s),i&&d(!1)})(),()=>{i=!1}},[s,N,c]),a.useEffect(()=>{if(!c||!N||!s||s==="undefined")return;const i=Bl(window.location.origin,{auth:{token:c},transports:["websocket","polling"]});b.current=i,i.emit("join-conversation",s);const F=I=>{var M;const D=(I==null?void 0:I.conversationId)||(typeof(I==null?void 0:I.conversation)=="string"?I.conversation:tr((M=I==null?void 0:I.conversation)==null?void 0:M._id));if(D!==s)return;const R={_id:String((I==null?void 0:I._id)||(I==null?void 0:I.id)||Math.random()),conversationId:D,sender:String((I==null?void 0:I.senderId)||(I==null?void 0:I.sender)||""),senderId:String((I==null?void 0:I.senderId)||(I==null?void 0:I.sender)||""),senderName:(I==null?void 0:I.senderName)||"",senderType:(I==null?void 0:I.senderType)||"",message:(I==null?void 0:I.message)??(I==null?void 0:I.text)??"",imageUrl:(I==null?void 0:I.imageUrl)||void 0,messageType:(I==null?void 0:I.messageType)||(I!=null&&I.imageUrl?"image":"text"),createdAt:I!=null&&I.createdAt?new Date(I.createdAt).toISOString():new Date().toISOString(),readBy:I==null?void 0:I.readBy};u(W=>W.some(J=>J._id===R._id)?W:[...W,R])};return i.on("message:new",F),i.on("new-message",F),i.on("chat:new-message",F),i.on("connect",()=>console.log("Socket connected")),i.on("disconnect",()=>console.log("Socket disconnected")),()=>{try{i.emit("leave-conversation",s),i.removeAllListeners(),i.disconnect()}catch{}b.current=null}},[c,N,s]),a.useEffect(()=>{if(!s||!c)return;const i=()=>P(s),F=()=>{document.visibilityState==="visible"&&P(s)};return window.addEventListener("focus",i),document.addEventListener("visibilitychange",F),()=>{window.removeEventListener("focus",i),document.removeEventListener("visibilitychange",F)}},[s,c]);const C=async i=>{var M,W;const F=await Fr(`conversations/${i}/messages`,c);if(F.status===403||F.status===404){l("Conversation not found");return}if(!F.ok){l(((M=F.data)==null?void 0:M.error)||"Failed to load messages");return}const I=((W=F.data)==null?void 0:W.data)??F.data,R=(Array.isArray(I==null?void 0:I.messages)?I.messages:Array.isArray(I)?I:[]).map(J=>({_id:String(J._id),conversationId:tr(J.conversationId),sender:String(J.senderId||J.sender||""),senderId:String(J.senderId||J.sender||""),senderName:J.senderName||"",senderType:J.senderType||"",message:J.message??J.text??"",imageUrl:J.imageUrl||void 0,messageType:J.messageType||(J.imageUrl?"image":"text"),createdAt:J.createdAt?new Date(J.createdAt).toISOString():new Date().toISOString(),readBy:J.readBy}));u(R)},P=async i=>{await Lr(`conversations/${i}/read`,c,{})},k=async()=>{var F,I;if(!S.trim()||!s||s==="undefined"||v||!c)return;j(!0),l("");const i=await Lr(`conversations/${s}/messages`,c,{text:S});if(i.ok){const D=((F=i.data)==null?void 0:F.data)??i.data,R={_id:String((D==null?void 0:D._id)||Math.random()),conversationId:s,sender:String((D==null?void 0:D.senderId)||(D==null?void 0:D.sender)||y||""),senderId:String((D==null?void 0:D.senderId)||(D==null?void 0:D.sender)||y||""),senderName:(D==null?void 0:D.senderName)||(r==null?void 0:r.name)||"You",senderType:(D==null?void 0:D.senderType)||"",message:(D==null?void 0:D.message)??(D==null?void 0:D.text)??S,imageUrl:(D==null?void 0:D.imageUrl)||void 0,messageType:(D==null?void 0:D.messageType)||"text",createdAt:D!=null&&D.createdAt?new Date(D.createdAt).toISOString():new Date().toISOString(),readBy:D==null?void 0:D.readBy};u(M=>[...M,R]),x(""),await P(s),setTimeout(()=>{var M;return(M=T.current)==null?void 0:M.scrollIntoView({behavior:"smooth"})},50)}else l(((I=i.data)==null?void 0:I.error)||"Failed to send message");j(!1)};if(A)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading conversation..."})]})});if(!n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Conversation not found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The conversation you're looking for doesn't exist."}),e.jsx(g,{onClick:()=>t("/chats"),className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Back to Chats"})]})});const h=n.buyer===y?n.sellerData:n.buyerData,w=n.property;return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsxs("header",{className:"bg-white border-b px-4 py-3 flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>t("/chats"),className:"p-1",children:e.jsx(Qe,{className:"h-6 w-6 text-gray-700"})}),e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:((L=(E=h==null?void 0:h.name)==null?void 0:E.charAt(0))==null?void 0:L.toUpperCase())||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:(h==null?void 0:h.name)||"Unknown User"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(pr,{className:"h-2 w-2 text-green-500 fill-current"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Online"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",title:"Call",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full",title:"More",children:e.jsx(gr,{className:"h-5 w-5 text-gray-600"})})]})]}),m&&e.jsxs("div",{className:"bg-red-50 border-b border-red-200 p-3 flex items-center space-x-2",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:m})]}),w&&e.jsx("div",{className:"bg-white border-b p-4",children:e.jsxs("div",{className:"flex items-center space-x-3 bg-gray-50 rounded-lg p-3",children:[(((q=w.images)==null?void 0:q[0])||w.coverImage)&&e.jsx("img",{src:((V=w.images)==null?void 0:V[0])||w.coverImage,alt:w.title||"Property",className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",children:w.title||"Property"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:((p=w.location)==null?void 0:p.address)||"â€”"}),typeof w.price=="number"&&e.jsxs("p",{className:"text-sm font-semibold text-[#C70000]",children:["â‚¹",Number(w.price).toLocaleString()]})]}),e.jsx(g,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>t(`/property/${w._id}`),children:"View Listing"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[f.length===0?e.jsx("div",{className:"text-center py-8 text-gray-600",children:"No messages yet. Say hello ðŸ‘‹"}):f.map(i=>{var R;const F=(i.senderId||i.sender)===y,I=((R=i.readBy)==null?void 0:R.length)||0,D=F&&I>1;return e.jsx("div",{className:`flex ${F?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg shadow-sm ${F?"bg-[#C70000] text-white":"bg-white text-gray-900"}`,children:[i.imageUrl?e.jsx("img",{src:i.imageUrl,alt:"Sent",className:"max-w-full h-auto rounded"}):e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:i.message}),e.jsxs("div",{className:`flex items-center gap-2 text-xs mt-1 ${F?"text-red-100":"text-gray-500"}`,children:[e.jsx("span",{children:od(i.createdAt)}),F&&e.jsx("span",{children:D?"âœ“âœ“":"âœ“"})]})]})},i._id)}),e.jsx("div",{ref:T})]}),e.jsx("div",{className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsx("input",{type:"file",accept:"image/*,application/pdf",className:"hidden",id:"file-input",onChange:async i=>{var I;const F=(I=i.target.files)==null?void 0:I[0];if(F){if(F.size>10*1024*1024){l("File too large (max 10MB)");return}is({title:"Attachments coming soon",description:F.name})}}}),e.jsx(g,{variant:"outline",className:"px-2",onClick:()=>{var i;return(i=document.getElementById("file-input"))==null?void 0:i.click()},children:"ðŸ“Ž"}),e.jsx($e,{placeholder:"Type a message...",value:S,onChange:i=>x(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),k())},className:"flex-1 resize-y max-h-40",rows:2}),e.jsx(g,{onClick:k,disabled:!S.trim()||v,className:"bg-[#C70000] hover:bg-[#A60000] text-white p-2",title:"Send",children:v?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(Us,{className:"h-4 w-4"})})]})})]})}const vt=s=>{if(!s)return"";if(typeof s=="string")return s;if(s.$oid)return s.$oid;if(s.oid)return s.oid;try{return String(s.toString())}catch{return String(s)}},md=s=>{if(!s)return"";const t=new Date(s),c=new Date().getTime()-t.getTime(),N=Math.floor(c/6e4),y=Math.floor(N/60),n=Math.floor(y/24);return N<1?"Just now":y<1?`${N}m ago`:y<24?`${y}h ago`:n===1?"Yesterday":n<7?`${n}d ago`:t.toLocaleDateString()},xd=s=>s?new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";function Dr(){var i,F,I,D;const[s]=Na(),{user:t,token:r,isAuthenticated:c}=je(),N=(t==null?void 0:t.id)||(t==null?void 0:t._id),y=s.get("id"),[n,o]=a.useState([]),[f,u]=a.useState(null),[S,x]=a.useState([]),[A,d]=a.useState(""),[v,j]=a.useState(!0),[m,l]=a.useState(!1),[b,T]=a.useState(""),[C,P]=a.useState(""),k=a.useRef(null);a.useEffect(()=>{if(!c)return;let R=!0;return(async()=>{var W,J;j(!0),P("");try{const H=await h("GET","conversations/my",void 0,r);if(!H.ok)throw new Error(((W=H.data)==null?void 0:W.error)||`HTTP ${H.status}`);const se=((J=H.data)==null?void 0:J.data)??H.data,B=Array.isArray(se)?se:[];R&&o(B)}catch(H){R&&P((H==null?void 0:H.message)||"Failed to load conversations")}finally{R&&j(!1)}})(),()=>{R=!1}},[c,r]),a.useEffect(()=>{if(!y||n.length===0)return;const R=n.find(M=>vt(M._id)===y);R&&u(R)},[y,n]),a.useEffect(()=>{if(!f)return;const R=vt(f._id);let M;const W=async()=>{await w(R),await E(R)};return W(),M=setInterval(W,5e3),()=>{M&&clearInterval(M)}},[f,r]),a.useEffect(()=>{var R;(R=k.current)==null||R.scrollIntoView({behavior:"smooth"})},[S]);async function h(R,M,W,J){const H=Js(M);return new Promise(se=>{try{const B=new XMLHttpRequest;B.open(R.toUpperCase(),H,!0),J&&B.setRequestHeader("Authorization",`Bearer ${J}`),W&&B.setRequestHeader("Content-Type","application/json"),B.timeout=15e3,B.onreadystatechange=()=>{if(B.readyState===4){let $={};try{$=B.responseText?JSON.parse(B.responseText):{}}catch{$={raw:B.responseText}}se({ok:B.status>=200&&B.status<300,status:B.status,data:$})}},B.ontimeout=()=>se({ok:!1,status:408,data:{error:"timeout"}}),B.onerror=()=>se({ok:!1,status:0,data:{error:"network"}}),B.send(W?JSON.stringify(W):null)}catch(B){se({ok:!1,status:0,data:{error:(B==null?void 0:B.message)||"network"}})}})}const w=async R=>{var M,W;if(r)try{const J=await h("GET",`conversations/${R}/messages`,void 0,r);if(J.ok){const H=((M=J.data)==null?void 0:M.data)??J.data,B=(Array.isArray(H==null?void 0:H.messages)?H.messages:Array.isArray(H)?H:[]).map($=>({...$,message:$.message??$.text??""}));x(B)}else(J.status===404||J.status===403)&&P(((W=J.data)==null?void 0:W.error)||"Conversation not found")}catch{}},E=async R=>{if(r)try{await h("POST",`conversations/${R}/read`,{},r),o(M=>M.map(W=>vt(W._id)===R?{...W,unreadCount:0}:W))}catch{}},L=async()=>{var R,M,W,J,H,se,B,$,O,ae;if(!(!A.trim()||!f||m||!r))try{l(!0);const X=vt(f._id);let z=await h("POST",`conversations/${X}/messages`,{text:A},r);if(!z.ok&&(z.status===404||z.status===400)){const le=((R=f==null?void 0:f.property)==null?void 0:R._id)||(f==null?void 0:f.propertyId);if(le){const Z=await h("POST","conversations/find-or-create",{propertyId:le},r),ne=((W=(M=Z.data)==null?void 0:M.data)==null?void 0:W._id)||((J=Z.data)==null?void 0:J._id)||((se=(H=Z.data)==null?void 0:H.data)==null?void 0:se.conversationId)||((B=Z.data)==null?void 0:B.conversationId);if(Z.ok&&ne&&(z=await h("POST",`conversations/${ne}/messages`,{text:A},r),z.ok)){const ye={...f,_id:ne};u(ye),window.history.pushState({},"",`/chats?id=${ne}`)}}}if(z.ok){const le=(($=z.data)==null?void 0:$.data)||z.data,Z={...le,message:(le==null?void 0:le.message)??(le==null?void 0:le.text)??""};x(ne=>[...ne,Z]),d(""),await E(vt(f._id));try{const ne=await h("GET","conversations/my",void 0,r);if(ne.ok){const ye=((O=ne.data)==null?void 0:O.data)??ne.data,ie=Array.isArray(ye)?ye:[];o(ie)}}catch{}}else P(((ae=z.data)==null?void 0:ae.error)||"Failed to send message")}catch{P("Failed to send message")}finally{l(!1),setTimeout(()=>{var X;(X=k.current)==null||X.scrollIntoView({behavior:"smooth"})},50)}},q=R=>{u(R);const M=vt(R._id);window.history.pushState({},"",`/chats?id=${M}`)},V=()=>{u(null),window.history.pushState({},"","/chats")},p=n.filter(R=>{var se,B,$;const M=R.property||((se=R.propertyDetails)==null?void 0:se[0]),J=(R.participantDetails||[R.buyerData,R.sellerData].filter(Boolean)||[]).filter(O=>O&&O._id!==N);return[(M==null?void 0:M.title)||"",((B=R.lastMessage)==null?void 0:B.message)||(($=R.lastMessage)==null?void 0:$.text)||"",J.map(O=>O.name||"").join(" ")].join(" ").toLowerCase().includes(b.toLowerCase())});if(!c)return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please login to access your conversations"}),e.jsx(g,{onClick:()=>window.location.href="/login",className:"bg-[#C70000] hover:bg-[#A60000]",children:"Login"})]})}),e.jsx(ve,{})]});if(v)return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading conversations..."})]})}),e.jsx(ve,{})]});if(f){const M=(f.participantDetails||[f.buyerData,f.sellerData].filter(Boolean)||[]).filter(J=>J&&J._id!==N),W=f.property||((i=f.propertyDetails)==null?void 0:i[0]);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsxs("header",{className:"bg-white border-b px-4 py-3 flex items-center space-x-3",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:V,className:"p-1",children:e.jsx(Qe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"font-semibold text-gray-900",children:M.length?M.map(J=>J.name).join(", "):"Conversation"}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:(W==null?void 0:W.title)||"Property"})]})]}),W&&e.jsx("div",{className:"bg-white border-b p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[(((F=W.images)==null?void 0:F[0])||W.coverImage)&&e.jsx("img",{src:((I=W.images)==null?void 0:I[0])||W.coverImage,alt:W.title||"Property",className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:W.title||"Property"}),typeof W.price=="number"&&e.jsxs("p",{className:"text-lg font-semibold text-[#C70000]",children:["â‚¹",Number(W.price).toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),((D=W.location)==null?void 0:D.address)||"â€”"]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 pb-24",children:[S.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start the conversation!"})]}):S.map(J=>{const H=J.senderId===N,se=(J.senderType||"").toLowerCase()==="admin";return e.jsx("div",{className:`flex ${H?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${H?"bg-[#C70000] text-white":se?"bg-blue-100 text-blue-900":"bg-white border border-gray-200"}`,children:[!H&&e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium",children:J.senderName}),se&&e.jsx(re,{variant:"secondary",className:"text-xs",children:"Support"})]}),J.imageUrl?e.jsx("img",{src:J.imageUrl,alt:"Sent",className:"max-w-full h-auto rounded"}):e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:J.message}),e.jsx("p",{className:`text-xs opacity-75 mt-1 ${H?"text-white/80":"text-gray-500"}`,children:xd(J.createdAt)})]})},J._id)}),e.jsx("div",{ref:k})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4",children:e.jsxs("div",{className:"flex space-x-2 max-w-full",children:[e.jsx($e,{placeholder:"Type your message...",value:A,onChange:J=>d(J.target.value),className:"flex-1 resize-none",rows:2,onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),L())}}),e.jsx(g,{onClick:L,disabled:!A.trim()||m,className:"bg-[#C70000] hover:bg-[#A60000] px-4",title:"Send",children:m?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(Us,{className:"h-4 w-4"})})]})})]})}return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"bg-white border-b p-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-4",children:"Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search conversations...",value:b,onChange:R=>T(R.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"flex-1 pb-20",children:[C&&e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:C})})}),p.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No chats yetâ€”open a property and tap Message Owner"}),e.jsx(g,{onClick:()=>window.location.href="/",className:"bg-[#C70000] hover:bg-[#A60000]",children:"Browse Properties"})]}):e.jsx("div",{className:"space-y-1",children:p.map(R=>{var H,se,B,$,O;const W=(R.participantDetails||[R.buyerData,R.sellerData].filter(Boolean)||[]).filter(ae=>ae&&ae._id!==N),J=R.property||((H=R.propertyDetails)==null?void 0:H[0]);return e.jsx("div",{onClick:()=>q(R),className:"bg-white border-b p-4 hover:bg-gray-50 cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"relative",children:[(se=J==null?void 0:J.images)!=null&&se[0]||J!=null&&J.coverImage?e.jsx("img",{src:((B=J.images)==null?void 0:B[0])||J.coverImage,alt:J.title||"Property",className:"w-12 h-12 object-cover rounded-full"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(hs,{className:"h-6 w-6 text-gray-400"})}),R.unreadCount&&R.unreadCount>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:R.unreadCount>9?"9+":R.unreadCount})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:W.length?W.map(ae=>ae.name).join(", "):"Conversation"}),e.jsx("span",{className:"text-xs text-gray-500",children:md(R.lastMessageAt)})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:(J==null?void 0:J.title)||"Property"}),e.jsx("p",{className:`text-sm truncate ${(R.unreadCount||0)>0?"text-gray-900 font-medium":"text-gray-500"}`,children:(($=R.lastMessage)==null?void 0:$.message)||((O=R.lastMessage)==null?void 0:O.text)||"No messages yet"})]})]})},vt(R._id))})})]}),e.jsx(ve,{})]})}function hd(){const[s,t]=a.useState(!1),[r,c]=a.useState(""),N=async()=>{var y,n;t(!0),c("");try{const o=await window.api("admin/dev/seed-chat",{method:"POST"});if(!o.success){is({title:"Seed failed",description:o.error||"Unknown error",variant:"destructive"}),t(!1);return}const f=((y=o.data)==null?void 0:y.conversationId)||((n=o.json)==null?void 0:n.conversationId);if(!f){is({title:"No conversationId returned"}),t(!1);return}const u=await window.api(`conversations/${f}/messages`,{method:"POST",body:{text:"ping"}});if(!u.success){is({title:"Send failed",description:u.error||"Unknown error",variant:"destructive"}),t(!1);return}const S=await window.api(`admin/dev/reply-as-owner/${f}`,{method:"POST"});if(!S.success){is({title:"Owner reply failed",description:S.error||"Unknown error",variant:"destructive"}),t(!1);return}const x=Date.now();let A=!1,d=!1;for(;Date.now()-x<2e3;){const v=await window.api(`conversations/${f}/messages`);if(v.success){const j=(v.data||[]).map(m=>m.text||m.message);if(A=j.includes("ping"),d=j.includes("pong"),A&&d)break}await new Promise(j=>setTimeout(j,250))}A&&d?(c("PASS"),is({title:"PASS",description:`Conversation ${f}`})):(c("FAIL"),is({title:"FAIL",description:"Messages not verified",variant:"destructive"}))}catch(o){is({title:"Error",description:o.message,variant:"destructive"})}finally{t(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Dev Chat Test"})}),e.jsxs(_,{className:"space-y-3",children:[e.jsx(g,{onClick:N,disabled:s,className:"bg-[#C70000] hover:bg-[#A60000]",children:s?"Running...":"Run Seed + Ping/Pong"}),r&&e.jsx("div",{className:`p-3 rounded ${r==="PASS"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:r})]})]})})})}function ud(){var N;const{user:s,isAuthenticated:t,logout:r,loading:c}=je();return a.useEffect(()=>{if(!c&&!t){window.location.href="/auth";return}},[t,c]),c?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}),e.jsx(ve,{})]}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A50000] p-6 text-white",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(hs,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-red-100",children:s==null?void 0:s.email}),e.jsx("p",{className:"text-red-100 capitalize",children:s==null?void 0:s.userType})]})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Account Options"}),e.jsxs(g,{onClick:()=>{const n={admin:"/admin",seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[s==null?void 0:s.userType];n&&(window.location.href=n)},className:"w-full justify-start bg-[#C70000] hover:bg-[#A50000] text-white",children:[e.jsx(bs,{className:"h-5 w-5 mr-3"}),"Go to My Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[e.jsxs(g,{onClick:()=>window.location.href="/post-property",variant:"outline",className:"justify-start h-12",children:[e.jsx(Pe,{className:"h-5 w-5 mr-3"}),"Post Property"]}),e.jsxs(g,{onClick:()=>window.location.href="/chat",variant:"outline",className:"justify-start h-12",children:[e.jsx(xs,{className:"h-5 w-5 mr-3"}),"My Messages"]}),e.jsxs(g,{onClick:()=>window.location.href="/properties?owner="+(s==null?void 0:s.id),variant:"outline",className:"justify-start h-12",children:[e.jsx(xs,{className:"h-5 w-5 mr-3"}),"My Properties"]}),e.jsxs(g,{onClick:()=>window.location.href="/",variant:"outline",className:"justify-start h-12",children:[e.jsx(Pe,{className:"h-5 w-5 mr-3"}),"Browse Properties"]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Account Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",s==null?void 0:s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Account Type:"})," ",(N=s==null?void 0:s.userType)==null?void 0:N.toUpperCase()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Member Since:"})," Recent"]})]})]}),e.jsxs(g,{onClick:()=>{r(),window.location.href="/"},variant:"outline",className:"w-full justify-start text-red-600 border-red-200 hover:bg-red-50 mt-6",children:[e.jsx(Ms,{className:"h-5 w-5 mr-3"}),"Sign Out"]})]})]})})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsx("div",{className:"max-w-md mx-auto text-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(hs,{className:"h-8 w-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"My Account"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please sign in to access your account and dashboard"}),e.jsx(g,{onClick:()=>window.location.href="/auth",className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white mb-4",children:"Sign In / Sign Up"}),e.jsxs(g,{onClick:()=>window.location.href="/",variant:"outline",className:"w-full",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Back to Home"]})]})})}),e.jsx(ve,{})]})}const Ls=Vl,As=a.forwardRef(({className:s,...t},r)=>e.jsx(En,{ref:r,className:me("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));As.displayName=En.displayName;const Se=a.forwardRef(({className:s,...t},r)=>e.jsx(In,{ref:r,className:me("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t}));Se.displayName=In.displayName;const ke=a.forwardRef(({className:s,...t},r)=>e.jsx(Fn,{ref:r,className:me("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));ke.displayName=Fn.displayName;function Fi(){const s=Ve(),{user:t,logout:r}=je(),[c,N]=a.useState([]),[y,n]=a.useState([]),[o,f]=a.useState(!0);a.useEffect(()=>{if(!t){s("/login");return}u(),S()},[t,s]);const u=async()=>{try{const m=localStorage.getItem("token");if(!m)return;const b=await(await fetch("/api/favorites/my",{headers:{Authorization:`Bearer ${m}`}})).json();b.success&&N(b.data)}catch(m){console.error("Error fetching favorites:",m)}},S=async()=>{try{const m=localStorage.getItem("token");if(!m)return;const b=await(await fetch("/api/tickets/my",{headers:{Authorization:`Bearer ${m}`}})).json();b.success&&n(b.data)}catch(m){console.error("Error fetching tickets:",m)}finally{f(!1)}},x=async m=>{try{const l=localStorage.getItem("token");if(!l)return;(await fetch(`/api/favorites/${m}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}})).ok&&N(c.filter(T=>T.propertyId!==m))}catch(l){console.error("Error removing favorite:",l)}},A=m=>{s(`/property/${m}`)},d=m=>{s(`/support/ticket/${m}`)},v=()=>{s("/support/new")},j=()=>{r(),s("/")};return o?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("main",{className:"pb-16",children:e.jsxs("div",{className:"px-4 py-6",children:[e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx(Fi,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-gray-600",children:t==null?void 0:t.email}),(t==null?void 0:t.phone)&&e.jsxs("p",{className:"text-gray-600 flex items-center",children:[e.jsx(Ge,{className:"h-4 w-4 mr-1"}),t.phone]})]})]}),e.jsxs(g,{variant:"outline",onClick:j,className:"border-red-200 text-red-600 hover:bg-red-50",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]})})}),e.jsxs(Ls,{defaultValue:"favorites",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-2",children:[e.jsxs(Se,{value:"favorites",className:"flex items-center",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Favorites (",c.length,")"]}),e.jsxs(Se,{value:"support",className:"flex items-center",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Support (",y.length,")"]})]}),e.jsxs(ke,{value:"favorites",className:"mt-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"My Favorites"})}),c.length===0?e.jsx(U,{children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx(xs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No favorites yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start browsing properties and add them to your favorites"}),e.jsx(g,{onClick:()=>s("/buy"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Browse Properties"})]})}):e.jsx("div",{className:"space-y-4",children:c.map(m=>{var l,b,T,C,P,k,h,w,E,L,q,V,p;return e.jsx(U,{className:"overflow-hidden",children:e.jsx(_,{className:"p-0",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32 h-32 flex-shrink-0",children:e.jsx("img",{src:((l=m.property)==null?void 0:l.coverImageUrl)??((C=(T=(b=m.property)==null?void 0:b.images)==null?void 0:T[0])==null?void 0:C.url)??((k=(P=m.property)==null?void 0:P.images)==null?void 0:k[0])??"/placeholder.png",alt:(h=m.property)==null?void 0:h.title,className:"w-full h-full object-cover",onClick:()=>A(m.propertyId)})}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 cursor-pointer hover:text-[#C70000]",onClick:()=>A(m.propertyId),children:(w=m.property)==null?void 0:w.title}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>x(m.propertyId),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(xs,{className:"h-4 w-4 fill-current"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:(L=(E=m.property)==null?void 0:E.location)==null?void 0:L.address}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",(V=(q=m.property)==null?void 0:q.price)==null?void 0:V.toLocaleString(),((p=m.property)==null?void 0:p.priceType)==="rent"&&"/month"]}),e.jsxs("span",{className:"text-xs text-gray-400 flex items-center",children:[e.jsx(Is,{className:"h-3 w-3 mr-1"}),"Added"," ",new Date(m.addedAt).toLocaleDateString()]})]})]})]})})},m._id)})})]}),e.jsxs(ke,{value:"support",className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Support Tickets"}),e.jsxs(g,{onClick:v,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"New Ticket"]})]}),y.length===0?e.jsx(U,{children:e.jsxs(_,{className:"p-8 text-center",children:[e.jsx(Ce,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No support tickets"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Need help? Create a support ticket and we'll assist you"}),e.jsx(g,{onClick:v,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create Ticket"})]})}):e.jsx("div",{className:"space-y-4",children:y.map(m=>e.jsx(U,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(_,{className:"p-4",onClick:()=>d(m._id),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:m.subject}),e.jsxs("p",{className:"text-sm text-gray-600",children:["#",m.ticketNumber]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${m.status==="open"?"bg-green-100 text-green-800":m.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:m.status}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${m.priority==="high"?"bg-red-100 text-red-800":m.priority==="medium"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:m.priority})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:m.lastMessage}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[e.jsxs("span",{children:[m.messageCount," messages"]}),e.jsx("span",{children:new Date(m.createdAt).toLocaleDateString()})]})]})},m._id))})]})]})]})}),e.jsx(ve,{})]})}function pd(){const s=Ve(),{user:t,logout:r}=je(),[c,N]=a.useState([]),[y,n]=a.useState({totalProperties:0,activeProperties:0,pendingProperties:0,totalViews:0,totalInquiries:0}),[o,f]=a.useState(!0);a.useEffect(()=>{if(!t||t.userType!=="seller"){s("/login");return}u()},[t,s]);const u=async()=>{try{f(!0);const m=localStorage.getItem("token");if(!m)return;const b=await(await fetch("/api/seller/properties",{headers:{Authorization:`Bearer ${m}`}})).json();if(b.success){N(b.data);const T=b.data.length,C=b.data.filter(w=>w.status==="active").length,P=b.data.filter(w=>w.approvalStatus==="pending").length,k=b.data.reduce((w,E)=>w+(E.views||0),0),h=b.data.reduce((w,E)=>w+(E.inquiries||0),0);n({totalProperties:T,activeProperties:C,pendingProperties:P,totalViews:k,totalInquiries:h})}}catch(m){console.error("Error fetching seller data:",m)}finally{f(!1)}},S=m=>{switch(m){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";case"sold":return"bg-blue-100 text-blue-800";case"rented":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},x=m=>{switch(m){case"approved":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},A=()=>{s("/post-property")},d=m=>{s(`/edit-property/${m}`)},v=m=>{s(`/property/${m}`)},j=()=>{r(),s("/")};return o?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("main",{className:"pb-16",children:e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seller Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",t==null?void 0:t.name]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:A,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Submit Property"]}),e.jsx(g,{variant:"outline",onClick:j,className:"border-red-200 text-red-600 hover:bg-red-50",children:e.jsx(Ms,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx(Pe,{className:"h-8 w-8 text-[#C70000] mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.totalProperties}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Properties"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.activeProperties}),e.jsx("div",{className:"text-xs text-gray-600",children:"Active"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:y.pendingProperties}),e.jsx("div",{className:"text-xs text-gray-600",children:"Pending"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx(Ne,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.totalViews}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Views"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx(Ce,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.totalInquiries}),e.jsx("div",{className:"text-xs text-gray-600",children:"Inquiries"})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center justify-between",children:["My Properties",e.jsxs(re,{variant:"outline",children:[c.length," properties"]})]})}),e.jsx(_,{children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No properties yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start by submitting your first property"}),e.jsxs(g,{onClick:A,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Submit Property"]})]}):e.jsx("div",{className:"space-y-4",children:c.map(m=>{var l,b,T;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-24 h-20 flex-shrink-0 mr-4",children:e.jsx("img",{src:m.coverImageUrl??((b=(l=m.images)==null?void 0:l[0])==null?void 0:b.url)??((T=m.images)==null?void 0:T[0])??"/placeholder.png",alt:m.title,className:"w-full h-full object-cover rounded",onError:C=>{const P=C.target;P.src="/placeholder.png"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:m.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:S(m.status),children:m.status}),e.jsx(re,{className:x(m.approvalStatus),children:m.approvalStatus})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:m.location.address}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",m.price.toLocaleString(),m.priceType==="rent"&&"/month"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-4 w-4 mr-1"}),m.views||0]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),m.inquiries||0]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v(m._id),children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>d(m._id),children:e.jsx(as,{className:"h-4 w-4"})})]})]})]})]})},m._id)})})})]})]})}),e.jsx(ve,{})]})}function Rr(){const{ticketId:s,action:t}=zs(),r=Ve(),{user:c}=je(),[N,y]=a.useState(null),[n,o]=a.useState([]),[f,u]=a.useState(""),[S,x]=a.useState(!0),[A,d]=a.useState(!1),[v,j]=a.useState(""),[m,l]=a.useState("general"),[b,T]=a.useState("medium"),[C,P]=a.useState(""),[k,h]=a.useState(!1),w=t==="new";a.useEffect(()=>{if(!c){r("/login");return}!w&&s?E():x(!1)},[c,s,w,r]);const E=async()=>{try{x(!0);const i=localStorage.getItem("token");if(!i)return;const I=await(await fetch(`/api/tickets/${s}/messages`,{headers:{Authorization:`Bearer ${i}`}})).json();I.success?(y(I.data.ticket),o(I.data.messages)):r("/user")}catch(i){console.error("Error fetching ticket:",i),r("/user")}finally{x(!1)}},L=async()=>{if(!(!v.trim()||!C.trim()))try{h(!0);const i=localStorage.getItem("token");if(!i)return;const I=await(await fetch("/api/tickets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({subject:v.trim(),message:C.trim(),category:m,priority:b})})).json();I.success&&r(`/support/ticket/${I.data._id}`)}catch(i){console.error("Error creating ticket:",i)}finally{h(!1)}},q=async()=>{if(!(!f.trim()||!s))try{d(!0);const i=localStorage.getItem("token");if(!i)return;const I=await(await fetch(`/api/tickets/${s}/messages`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({message:f.trim()})})).json();I.success&&(o([...n,{_id:I.data._id,message:I.data.message,senderType:I.data.senderType,senderName:(c==null?void 0:c.name)||"You",createdAt:I.data.createdAt}]),u(""))}catch(i){console.error("Error sending message:",i)}finally{d(!1)}},V=i=>{switch(i){case"open":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},p=i=>{switch(i){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-orange-100 text-orange-800";case"low":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return S?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}),e.jsx(ve,{})]}):w?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("main",{className:"pb-16",children:e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(g,{variant:"ghost",onClick:()=>r("/user"),className:"mr-4 p-2",children:e.jsx(Qe,{className:"h-6 w-6"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Create Support Ticket"})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(Ce,{className:"h-5 w-5 mr-2 text-[#C70000]"}),"New Support Request"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsx(Q,{value:v,onChange:i=>j(i.target.value),placeholder:"Brief description of your issue",maxLength:100})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs("select",{value:m,onChange:i=>l(i.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"property",children:"Property Issues"}),e.jsx("option",{value:"payment",children:"Payment"}),e.jsx("option",{value:"technical",children:"Technical"}),e.jsx("option",{value:"account",children:"Account"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Priority"}),e.jsxs("select",{value:b,onChange:i=>T(i.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description *"}),e.jsx($e,{value:C,onChange:i=>P(i.target.value),placeholder:"Please describe your issue in detail...",rows:6,maxLength:1e3}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[C.length,"/1000 characters"]})]}),e.jsx(g,{onClick:L,disabled:!v.trim()||!C.trim()||k,className:"w-full bg-[#C70000] hover:bg-[#A60000]",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Create Ticket"]})})]})]})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("main",{className:"pb-16",children:e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(g,{variant:"ghost",onClick:()=>r("/user"),className:"mr-4 p-2",children:e.jsx(Qe,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:N==null?void 0:N.subject}),e.jsxs("p",{className:"text-sm text-gray-600",children:["#",N==null?void 0:N.ticketNumber]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:V((N==null?void 0:N.status)||""),children:N==null?void 0:N.status}),e.jsx(re,{className:p((N==null?void 0:N.priority)||""),children:N==null?void 0:N.priority})]})]}),e.jsx("div",{className:"space-y-4 mb-6",children:n.map(i=>e.jsx("div",{className:`flex ${i.senderType==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-3 rounded-lg ${i.senderType==="user"?"bg-[#C70000] text-white":"bg-white border border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium",children:i.senderName}),e.jsx("span",{className:`text-xs ${i.senderType==="user"?"text-red-100":"text-gray-500"}`,children:new Date(i.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:i.message})]})},i._id))}),(N==null?void 0:N.status)!=="closed"&&e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{value:f,onChange:i=>u(i.target.value),placeholder:"Type your message...",onKeyPress:i=>i.key==="Enter"&&!i.shiftKey&&q(),disabled:A}),e.jsx(g,{onClick:q,disabled:!f.trim()||A,className:"bg-[#C70000] hover:bg-[#A60000]",children:A?e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full"}):e.jsx(Us,{className:"h-4 w-4"})})]})})}),(N==null?void 0:N.status)==="closed"&&e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx(ds,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"This ticket has been closed"})]})})]})}),e.jsx(ve,{})]})}function gd(){return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Ke,{}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Our Property Agents"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Connect with our experienced property agents - Coming Soon"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8",children:e.jsx("p",{className:"text-[#C70000] font-medium",children:"This page is under development. Please check back soon!"})})]})})]})}function Li({className:s=""}){return e.jsx("div",{className:`bg-blue-50 border border-blue-200 rounded-lg p-4 ${s}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ra,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ðŸ”„ Unified Login System"}),e.jsxs("p",{className:"text-sm text-blue-800 mb-3",children:[e.jsx("strong",{children:"Same login credentials work for all user types!"})," Once you sign up, you can access:"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded",children:[e.jsx(Ae,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"Buyer Dashboard"}),e.jsx("br",{}),"Browse properties"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded",children:[e.jsx(Ae,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"Seller Dashboard"}),e.jsx("br",{}),"List properties"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded",children:[e.jsx(Ae,{className:"h-4 w-4 text-purple-600"}),e.jsxs("span",{className:"text-gray-700",children:[e.jsx("strong",{children:"Agent Dashboard"}),e.jsx("br",{}),"Manage clients"]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center space-x-2 text-xs text-blue-700",children:[e.jsx(Ys,{className:"h-3 w-3"}),e.jsx("span",{children:"Your role and permissions are determined automatically based on your activities"})]})]})]})})}const jd=()=>{const s=Ve(),{login:t,isAuthenticated:r,user:c}=je(),[N,y]=a.useState("password"),[n,o]=a.useState(!1),[f,u]=a.useState(!1),[S,x]=a.useState(""),[A,d]=a.useState(""),[v,j]=a.useState(!1),[m,l]=a.useState(0),[b,T]=a.useState(!0),[C,P]=a.useState({name:"",email:"",phone:"",password:"",userType:"seller",otp:""});a.useEffect(()=>{r&&c&&s({admin:"/admin",seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[c.userType]||"/")},[r]),a.useEffect(()=>{let V;return m>0&&(V=setInterval(()=>{l(p=>p-1)},1e3)),()=>clearInterval(V)},[m]);const k=V=>{P({...C,[V.target.name]:V.target.value}),x(""),d("")},h=async V=>{var p,i,F;if(V.preventDefault(),!f){u(!0),x(""),d("");try{const I=b?"auth/login":"auth/register",D=b?{email:C.email||void 0,phone:C.phone||void 0,password:C.password}:C;console.log(`Making ${b?"login":"registration"} request...`),console.log("Payload:",D);const R=await ce.post(I,D);if(console.log(`${b?"Login":"Registration"} complete response:`,R),!R)throw new Error("No response received from server");if(console.log("Response data:",R.data),console.log("Response success flag:",(p=R.data)==null?void 0:p.success),R.data&&R.data.success===!0){const{token:M,user:W}=R.data.data;if(console.log("Token received:",!!M),console.log("User received:",W),!b)d("Registration successful! Welcome to Ashish Property. Redirecting to home page..."),u(!1),setTimeout(()=>{t(M,W),s("/")},2e3);else{t(M,W);const H={seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[W.userType]||"/user-dashboard";s(H)}}else{const M=((i=R.data)==null?void 0:i.error)||((F=R.data)==null?void 0:F.message)||(b?"Invalid credentials":"Registration failed");console.log("Registration/Login failed with error:",M),x(M)}}catch(I){console.error(`${b?"Login":"Registration"} error:`,I),x(I.message||`${b?"Login":"Registration"} failed. Please try again.`)}finally{(b||!A)&&u(!1)}}},w=async()=>{var V,p;if(!C.phone){x("Please enter your phone number");return}u(!0),x("");try{const i=await ce.post("auth/send-otp",{phone:C.phone});(V=i.data)!=null&&V.success?(j(!0),l(60),d("OTP sent successfully! Use 123456 for demo")):x(((p=i.data)==null?void 0:p.error)||"Failed to send OTP")}catch(i){console.error("OTP send error:",i),j(!0),l(60),d("OTP sent successfully! Use 123456 for demo")}finally{u(!1)}},E=async V=>{var p,i;V.preventDefault(),u(!0),x("");try{const F=await ce.post("auth/verify-otp",{phone:C.phone,otp:C.otp});if((p=F.data)!=null&&p.success){const{token:I,user:D}=F.data.data;t(I,D),s("/user-dashboard")}else x(((i=F.data)==null?void 0:i.error)||"Invalid OTP")}catch(F){if(console.error("OTP verification error:",F),C.otp==="123456"||C.otp.length===6){const I={id:"otp-"+Date.now(),name:C.phone,email:"",phone:C.phone,userType:"seller"},D="otp-token-"+Date.now();t(D,I),s("/user-dashboard")}else x("Invalid OTP. Use 123456 for demo")}finally{u(!1)}},L=async()=>{u(!0),x("");try{const{idToken:V}=await Ha(),{data:p}=await ce.post("auth/google",{idToken:V,userType:C.userType||"buyer"});if(p!=null&&p.success){const{token:i,user:F}=p.data;t(i,F),q(F.userType)}else throw new Error((p==null?void 0:p.error)||"Google login failed")}catch(V){x(V.message||"Google login failed")}finally{u(!1)}},q=V=>{const i={admin:"/admin",seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[V]||"/";s(i)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{className:"text-center",children:"Welcome to Ashish Property"}),e.jsx("p",{className:"text-center text-gray-600",children:"Choose your preferred login method"})]}),e.jsxs(_,{children:[S&&e.jsx(vs,{className:"mb-4 border-red-200 bg-red-50",children:e.jsx(Ns,{className:"text-red-800",children:S})}),A&&e.jsx(vs,{className:"mb-4 border-green-200 bg-green-50",children:e.jsx(Ns,{className:"text-green-800",children:A})}),e.jsx(Li,{className:"mb-4"}),e.jsxs(Ls,{value:N,onValueChange:y,children:[e.jsxs(As,{className:"grid w-full grid-cols-3",children:[e.jsxs(Se,{value:"password",className:"text-xs",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),"Password"]}),e.jsxs(Se,{value:"otp",className:"text-xs",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"OTP"]}),e.jsxs(Se,{value:"google",className:"text-xs",disabled:!ua,children:[e.jsx(ms,{className:"h-4 w-4 mr-1"}),"Gmail"]})]}),e.jsxs(ke,{value:"password",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-center space-x-4 mb-4",children:[e.jsx(g,{variant:b?"default":"outline",onClick:()=>T(!0),className:b?"bg-[#C70000]":"",children:"Sign In"}),e.jsx(g,{variant:b?"outline":"default",onClick:()=>T(!1),className:b?"":"bg-[#C70000]",children:"Sign Up"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[!b&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx(Q,{type:"text",name:"name",value:C.name,onChange:k,placeholder:"Enter your full name",required:!b})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"email",name:"email",value:C.email,onChange:k,placeholder:"Enter your email",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"tel",name:"phone",value:C.phone,onChange:k,placeholder:"Enter your phone number",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:n?"text":"password",name:"password",value:C.password,onChange:k,placeholder:"Enter your password",className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>o(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:n?e.jsx(Wt,{className:"h-4 w-4 text-gray-400"}):e.jsx(Ne,{className:"h-4 w-4 text-gray-400"})})]})]}),!b&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"I am a"}),e.jsxs("select",{name:"userType",value:C.userType,onChange:k,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#C70000] focus:border-transparent",required:!b,children:[e.jsx("option",{value:"seller",children:"Property Seller"}),e.jsx("option",{value:"buyer",children:"Property Buyer"}),e.jsx("option",{value:"agent",children:"Real Estate Agent"})]})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:f||A!=="",children:A!==""?"Success! Redirecting...":f?"Please wait...":b?"Sign In":"Create Account"})]})]}),e.jsx(ke,{value:"otp",className:"space-y-4",children:v?e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter OTP"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"text",name:"otp",value:C.otp,onChange:k,placeholder:"Enter 6-digit OTP",className:"pl-10 text-center text-lg tracking-widest",maxLength:6,required:!0})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["OTP sent to ",C.phone]})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:f,children:f?"Verifying...":"Verify OTP"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"button",onClick:()=>{j(!1),P({...C,otp:""})},className:"text-sm text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Change Number"]}),m>0?e.jsxs("span",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"Resend in ",m,"s"]}):e.jsx("button",{type:"button",onClick:w,className:"text-sm text-[#C70000] hover:text-[#A50000] font-medium",children:"Resend OTP"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"tel",name:"phone",value:C.phone,onChange:k,placeholder:"Enter your phone number",className:"pl-10",required:!0})]})]}),e.jsx(g,{onClick:w,className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:f,children:f?"Sending...":"Send OTP"})]})}),e.jsx(ke,{value:"google",className:"space-y-4",children:e.jsxs("div",{className:"text-center py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ms,{className:"h-8 w-8 text-[#C70000]"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Quick Login with Gmail"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Sign in instantly with your Google account"})]}),e.jsx(g,{onClick:L,className:"w-full bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",disabled:f||!ua,children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-500 border-t-transparent rounded-full mr-2"}),"Connecting..."]}):e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"By continuing, you agree to our Terms of Service"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(be,{to:"/",className:"text-gray-500 hover:text-gray-700 text-sm flex items-center justify-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Back to Home"]})})]})]})})})]})},$r=qs;function fd(){const s=Ve(),{login:t,loginWithFirebase:r}=je(),[c,N]=a.useState("phone");a.useEffect(()=>{s("/auth",{replace:!0})},[s]);const[y,n]=a.useState(!1),[o,f]=a.useState(""),[u,S]=a.useState("+91"),[x,A]=a.useState(""),[d,v]=a.useState(""),[j,m]=a.useState(!1),l=a.useRef(null),b=a.useRef(null),T=a.useRef(null),[C,P]=a.useState(""),[k,h]=a.useState(""),[w,E]=a.useState(!1),[L,q]=a.useState(null);a.useEffect(()=>{var D,R;if(l.current){try{(R=(D=b.current)==null?void 0:D.clear)==null||R.call(D)}catch{}b.current=null}},[c]);async function V(D){if(b.current)return b.current;const R=new un($r,D,{size:"invisible"});return await R.render(),b.current=R,R}const p=async()=>{if(f(""),!/^\+?\d{6,15}$/.test(u+x.replace(/\D/g,""))){f("Enter valid phone");return}n(!0);try{if(!l.current)throw new Error("Recaptcha not ready");const D=await V(l.current),R=`${u}${x.replace(/\D/g,"")}`,M=await pn($r,R,D);T.current=M,m(!0)}catch(D){f((D==null?void 0:D.message)||"Failed to send OTP")}finally{n(!1)}},i=async()=>{if(f(""),!d||d.length<6)return f("Enter 6-digit code");n(!0);try{const R=(await T.current.confirm(d)).user;await r(R,"seller")}catch(D){f((D==null?void 0:D.message)||"Invalid OTP")}finally{n(!1)}},F=async()=>{var D;if(f(""),q(null),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(C)){f("Enter valid email");return}n(!0);try{const{data:R}=await ce.post("auth/email/request-otp",{email:C});if(R!=null&&R.success){E(!0);const M=(D=R==null?void 0:R.data)==null?void 0:D.devOtp}else f((R==null?void 0:R.error)||"Failed to send OTP")}catch(R){f((R==null?void 0:R.message)||"Failed to send OTP")}finally{n(!1)}},I=async()=>{if(f(""),!k||k.length!==6)return f("Enter 6-digit OTP");n(!0);try{const{data:D}=await ce.post("auth/email/verify-otp",{email:C,otp:k});D!=null&&D.success&&D.data?t(D.data.token,D.data.user):f((D==null?void 0:D.error)||"Invalid OTP")}catch(D){f((D==null?void 0:D.message)||"Invalid OTP")}finally{n(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(U,{className:"w-full max-w-md",children:[e.jsx(K,{children:e.jsx(Y,{className:"text-center",children:"Sign in to Ashish Property"})}),e.jsxs(_,{children:[o&&e.jsx("div",{className:"mb-3 text-sm text-red-600",role:"alert",children:o}),e.jsxs(Ls,{value:c,onValueChange:D=>N(D),children:[e.jsxs(As,{className:"grid grid-cols-2 w-full",children:[e.jsx(Se,{value:"phone",children:"Phone OTP"}),e.jsx(Se,{value:"email",children:"Email OTP"})]}),e.jsxs(ke,{value:"phone",children:[e.jsx("div",{ref:l,id:"recaptcha-container",className:"hidden","aria-hidden":"true"}),j?e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{"aria-label":"OTP code",inputMode:"numeric",maxLength:6,value:d,onChange:D=>v(D.target.value.replace(/[^0-9]/g,"")),placeholder:"Enter 6-digit code"}),e.jsx(g,{className:"w-full",disabled:y,onClick:i,children:y?"Verifying...":"Verify"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-[88px_1fr] gap-2",children:[e.jsx(Q,{"aria-label":"Country code",value:u,onChange:D=>S(D.target.value)}),e.jsx(Q,{"aria-label":"Phone",inputMode:"tel",value:x,onChange:D=>A(D.target.value),placeholder:"Phone number"})]}),e.jsx(g,{className:"w-full",disabled:y,onClick:p,children:y?"Sending...":"Send OTP"})]})]}),e.jsx(ke,{value:"email",children:w?e.jsxs("div",{className:"space-y-3",children:[null,e.jsx(Q,{"aria-label":"Email OTP",value:k,onChange:D=>h(D.target.value.replace(/[^0-9]/g,"")),maxLength:6,placeholder:"Enter 6-digit OTP"}),e.jsx(g,{className:"w-full",disabled:y,onClick:I,children:y?"Verifying...":"Verify"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(Q,{type:"email","aria-label":"Email",value:C,onChange:D=>P(D.target.value),placeholder:"you@example.com"}),e.jsx(g,{className:"w-full",disabled:y,onClick:F,children:y?"Sending...":"Send OTP"})]})})]}),e.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"Note: For Gmail, use an App Password. Normal password will not work."})]})]})})}function vd({children:s,requiredUserTypes:t=[],fallbackPath:r="/auth",requireAuth:c=!0}){const{isAuthenticated:N,user:y,loading:n}=je(),o=Va(),f=o.pathname+o.search;if(n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(c&&!N)return e.jsx(Qa,{to:`${r}?redirect=${encodeURIComponent(f)}`,replace:!0});if(N&&y&&t.length>0){if(!y.userType)return e.jsx(Qa,{to:r,replace:!0});if(!t.includes(y.userType)){const S={seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard",admin:"/admin",staff:"/staff-dashboard"}[y.userType]||"/";if(o.pathname!==S)return e.jsx(Qa,{to:S,replace:!0})}}return e.jsx(e.Fragment,{children:s})}const Ur=({children:s})=>e.jsx(vd,{requiredUserTypes:["seller"],children:s}),Nd=()=>{const s=Ve(),{login:t,isAuthenticated:r,user:c}=je(),[N,y]=a.useState("login"),[n,o]=a.useState("password"),[f,u]=a.useState(!1),[S,x]=a.useState(!1),[A,d]=a.useState(""),[v,j]=a.useState(""),[m,l]=a.useState(!1),[b,T]=a.useState(0);a.useEffect(()=>{r&&c&&s({admin:"/admin",seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[c.userType]||"/")},[r]);const[C,P]=a.useState({name:"",email:"",phone:"",password:"",userType:"seller",otp:""});a.useEffect(()=>()=>{try{ra.reset()}catch{}},[]),a.useEffect(()=>{if(n!=="otp"){try{ra.reset()}catch{}l(!1),T(0),P(p=>({...p,otp:""}))}},[n]),a.useEffect(()=>{let p;return b>0&&(p=setInterval(()=>{T(i=>i-1)},1e3)),()=>{p&&clearInterval(p)}},[b]);const k=p=>{P({...C,[p.target.name]:p.target.value}),d(""),j("")},h=async p=>{var i,F,I,D,R,M,W;if(p.preventDefault(),!S){x(!0),d(""),j("");try{const J=N==="login";if(!J){const $=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!((i=C.name)!=null&&i.trim()))throw new Error("Name is required");if(!((F=C.email)!=null&&F.trim())||!$.test(C.email))throw new Error("Enter a valid email address");if(!((I=C.phone)!=null&&I.trim())||C.phone.trim().replace(/\D/g,"").length<10)throw new Error("Enter a valid 10-digit phone number");if(!C.password||C.password.length<6)throw new Error("Password must be at least 6 characters");if(!["seller","buyer","agent","admin"].includes(C.userType))throw new Error("Select a valid user type")}const H=J?"auth/login":"auth/register",se=J?{email:C.email||void 0,phone:C.phone||void 0,password:C.password,userType:C.userType==="admin"?"admin":void 0}:{name:C.name,email:C.email,phone:C.phone,password:C.password,userType:C.userType},{data:B}=await ce.post(H,se);if(B.success){const{token:$,user:O}=B.data;J?(t($,O),q(O.userType)):(j("Registration successful! Welcome to Ashish Property."),setTimeout(()=>{t($,O),q(O.userType)},900))}else{const $=B.error||B.message||(J?"Invalid credentials":"Registration failed");d($)}}catch(J){let H=((D=J==null?void 0:J.data)==null?void 0:D.error)||((R=J==null?void 0:J.data)==null?void 0:R.message)||J.message;J.name==="TypeError"&&((M=J.message)!=null&&M.includes("Failed to fetch"))?H="Network error. Please check your internet connection and try again.":(W=J.message)!=null&&W.includes("body stream already read")?H="Request processing error. Please try again.":H||(H=`${N==="login"?"Login":"Registration"} failed. Please try again.`),d(H)}finally{x(!1)}}},w=async()=>{var p;if(!S){if(!((p=C.phone)!=null&&p.trim())){d("Please enter your phone number");return}x(!0),d(""),j("");try{await ra.sendOTP(C.phone),l(!0),T(60),j("OTP sent! Check your phone.")}catch(i){console.error("OTP send error:",i);const F=(i==null?void 0:i.code)||"";d(F==="auth/billing-not-enabled"?"Billing not enabled for reCAPTCHA Enterprise. Turn OFF Enterprise (use v2) or enable billing.":F==="auth/too-many-requests"?"Too many attempts. Please wait a minute and try again.":F==="auth/invalid-phone-number"?"Invalid phone number. Use format +91XXXXXXXXXX.":(i==null?void 0:i.message)||"Failed to send OTP")}finally{x(!1)}}},E=async p=>{var i,F;if(p.preventDefault(),!S){if(!C.otp||C.otp.length<6){d("Enter the 6-digit OTP");return}x(!0),d(""),j("");try{const{idToken:I}=await ra.verifyOTP(C.otp),{data:D}=await ce.post("auth/firebase-login",{idToken:I,role:C.userType}),R=(D==null?void 0:D.success)??(D==null?void 0:D.ok),M=((i=D==null?void 0:D.data)==null?void 0:i.token)??(D==null?void 0:D.token),W=((F=D==null?void 0:D.data)==null?void 0:F.user)??(D==null?void 0:D.user);if(!R||!M||!W)throw new Error((D==null?void 0:D.error)||(D==null?void 0:D.message)||"Login failed");t(M,W),q(W.userType)}catch(I){console.error("OTP verification error:",I);const D=(I==null?void 0:I.code)||"";d(D==="auth/invalid-verification-code"?"Invalid code. Please check and try again.":D==="auth/code-expired"?"Code expired. Please request a new OTP.":(I==null?void 0:I.message)||"OTP verification failed")}finally{x(!1)}}},L=async p=>{if(p==null||p.preventDefault(),!S){x(!0),d(""),j("");try{const{idToken:i}=await Ha(),{data:F}=await ce.post("auth/google",{idToken:i,userType:C.userType||"buyer"});if(!(F!=null&&F.success))throw new Error((F==null?void 0:F.error)||"Google authentication failed");const{token:I,user:D}=F.data;t(I,D),q(D.userType)}catch(i){d(i.message||"Google authentication failed")}finally{x(!1)}}},q=p=>{const F={admin:"/admin",seller:"/seller-dashboard",buyer:"/buyer-dashboard",agent:"/agent-dashboard"}[p]||"/";s(F)},V=C.phone?C.phone.replace(/(\d{2})\d{6}(\d{2})/,"$1******$2"):"";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50",children:[e.jsx("div",{className:"bg-[#C70000] text-white p-4",children:e.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"ASHISH PROPERTY"})]}),e.jsx(be,{to:"/",className:"text-white hover:text-red-200",children:e.jsx(Qe,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"relative py-12 bg-gradient-to-r from-[#C70000] to-[#A50000] text-white",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Welcome to Ashish Property"}),e.jsx("p",{className:"text-xl mb-8",children:"Your trusted partner in real estate solutions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-3xl mx-auto",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx(Hs,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold",children:"For Sellers"}),e.jsx("p",{className:"text-sm",children:"List and sell your properties"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx(Pe,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold",children:"For Buyers"}),e.jsx("p",{className:"text-sm",children:"Find your dream home"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:[e.jsx(Je,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold",children:"For Agents"}),e.jsx("p",{className:"text-sm",children:"Grow your business"})]})]})]})}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(U,{className:"shadow-2xl",children:[e.jsxs(K,{className:"bg-gradient-to-r from-[#C70000] to-[#A50000] text-white rounded-t-lg",children:[e.jsx(Y,{className:"text-center text-2xl",children:"Get Started Today"}),e.jsx("p",{className:"text-center text-red-100",children:"Choose your preferred method to continue"})]}),e.jsxs(_,{className:"p-6",children:[A&&e.jsx(vs,{className:"mb-4 border-red-200 bg-red-50",children:e.jsx(Ns,{className:"text-red-800",children:A})}),v&&e.jsx(vs,{className:"mb-4 border-green-200 bg-green-50",children:e.jsxs(Ns,{className:"text-green-800 flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),v]})}),e.jsx(Li,{className:"mb-4"}),e.jsxs(Ls,{value:N,onValueChange:y,className:"mb-6",children:[e.jsxs(As,{className:"grid w-full grid-cols-2",children:[e.jsx(Se,{value:"login",className:"font-medium",children:"Sign In"}),e.jsx(Se,{value:"register",className:"font-medium",children:"Sign Up"})]}),e.jsx(ke,{value:"login"}),e.jsx(ke,{value:"register"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6",children:[e.jsxs(g,{variant:n==="password"?"default":"outline",onClick:()=>o("password"),className:n==="password"?"bg-[#C70000]":"",size:"sm",children:[e.jsx(Ys,{className:"h-4 w-4 mr-1"}),"Password"]}),e.jsxs(g,{variant:n==="otp"?"default":"outline",onClick:()=>o("otp"),className:n==="otp"?"bg-[#C70000]":"",size:"sm",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"OTP"]}),e.jsxs(g,{variant:n==="google"?"default":"outline",onClick:()=>o("google"),className:n==="google"?"bg-[#C70000]":"",size:"sm",children:[e.jsx(ms,{className:"h-4 w-4 mr-1"}),"Gmail"]})]}),n==="password"&&e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[N==="register"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx(Q,{type:"text",name:"name",value:C.name,onChange:k,placeholder:"Enter your full name",required:N==="register"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"email",name:"email",value:C.email,onChange:k,placeholder:"Enter your email",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"tel",name:"phone",value:C.phone,onChange:k,placeholder:"Enter your phone number",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:f?"text":"password",name:"password",value:C.password,onChange:k,placeholder:"Enter your password",className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>u(!f),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f?e.jsx(Wt,{className:"h-4 w-4 text-gray-400"}):e.jsx(Ne,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:S||v!=="",children:v!==""?"Success! Redirecting...":S?"Please wait...":N==="login"?"Sign In":"Create Account"})]}),n==="otp"&&e.jsx("div",{className:"space-y-4",children:m?e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter OTP"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"text",name:"otp",value:C.otp,onChange:k,placeholder:"Enter 6-digit OTP",className:"pl-10 text-center text-lg tracking-widest",maxLength:6,required:!0})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["OTP sent to ",V||C.phone]})]}),e.jsx(g,{type:"submit",className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:S,children:S?"Verifying...":"Verify OTP"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"button",onClick:()=>{l(!1),P({...C,otp:""});try{ra.reset()}catch{}},className:"text-sm text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Change Number"]}),b>0?e.jsxs("span",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),"Resend in ",b,"s"]}):e.jsx("button",{type:"button",onClick:w,className:"text-sm text-[#C70000] hover:text-[#A50000] font-medium",children:"Resend OTP"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{type:"tel",name:"phone",value:C.phone,onChange:k,placeholder:"Enter your phone number",className:"pl-10",required:!0})]})]}),e.jsx(g,{onClick:w,className:"w-full bg-[#C70000] hover:bg-[#A50000] text-white",disabled:S,children:S?"Sending...":"Send OTP"})]})}),n==="google"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ms,{className:"h-8 w-8 text-[#C70000]"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Quick Login with Gmail"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Sign in instantly with your Google account"}),e.jsx(g,{type:"button",onClick:L,className:"w-full bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",disabled:S||!ua,children:S?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-500 border-t-transparent rounded-full mr-2"}),"Connecting..."]}):e.jsx("div",{className:"flex items-center",children:"Continue with Google"})}),!ua]})}),e.jsxs("div",{className:"mt-8 text-center space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"By continuing, you agree to our Terms of Service and Privacy Policy"}),e.jsxs(be,{to:"/",className:"text-[#C70000] hover:text-[#A50000] text-sm flex items-center justify-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Back to Home"]})]})]})]})})})]})},bd=()=>{const{user:s,logout:t}=je(),r=Ve(),[c,N]=a.useState([]),[y,n]=a.useState([]),[o,f]=a.useState(!0),[u,S]=a.useState("dashboard"),[x,A]=a.useState({totalProperties:0,pendingApproval:0,approved:0,rejected:0,premiumListings:0,premiumPending:0,premiumApproved:0,totalViews:0,totalInquiries:0,unreadNotifications:0});a.useEffect(()=>{if(!s){r("/login");return}d()},[s]);const d=async()=>{try{const C=localStorage.getItem("token");if(!C){r("/user-login");return}const[P,k]=await Promise.all([ce.get("/user/properties",C),ce.get("/user/notifications",C)]);if(P.data.success){const h=P.data.data;N(h),k.data.success&&n(k.data.data||[]);const w=h.reduce((q,V)=>q+V.views,0),E=h.reduce((q,V)=>q+V.inquiries,0),L=(k.data.data||[]).filter(q=>!q.isRead).length;A({totalProperties:h.length,pendingApproval:h.filter(q=>q.approvalStatus==="pending").length,approved:h.filter(q=>q.approvalStatus==="approved").length,rejected:h.filter(q=>q.approvalStatus==="rejected").length,premiumListings:h.filter(q=>q.premium).length,premiumPending:h.filter(q=>q.premium&&q.premiumApprovalStatus==="pending").length,premiumApproved:h.filter(q=>q.premium&&q.premiumApprovalStatus==="approved").length,totalViews:w,totalInquiries:E,unreadNotifications:L})}}catch(C){if(console.error("Error fetching user properties:",C),C.message.includes("401")||C.message.includes("403")||C.message.includes("token")){localStorage.removeItem("token"),localStorage.removeItem("user"),r("/user-login");return}alert("Failed to load your properties. Please try again later.")}finally{f(!1)}},v=async C=>{try{const P=localStorage.getItem("token");await ce.put(`/user/notifications/${C}/read`,{},P),n(y.map(k=>k._id===C?{...k,isRead:!0}:k)),A(k=>({...k,unreadNotifications:k.unreadNotifications-1}))}catch(P){console.error("Error marking notification as read:",P)}},j=async C=>{try{const P=localStorage.getItem("token");await ce.delete(`/user/notifications/${C}`,P);const k=y.find(h=>h._id===C);n(y.filter(h=>h._id!==C)),k&&!k.isRead&&A(h=>({...h,unreadNotifications:h.unreadNotifications-1}))}catch(P){console.error("Error deleting notification:",P)}},m=C=>{switch(C){case"welcome":return e.jsx(Le,{className:"h-4 w-4 text-green-500"});case"property":return e.jsx(Pe,{className:"h-4 w-4 text-blue-500"});case"message":return e.jsx(Ce,{className:"h-4 w-4 text-purple-500"});default:return e.jsx(Es,{className:"h-4 w-4 text-gray-500"})}},l=C=>{switch(C){case"pending":return e.jsx(re,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Pending Review"});case"approved":return e.jsx(re,{variant:"default",className:"bg-green-100 text-green-800",children:"Approved"});case"rejected":return e.jsx(re,{variant:"destructive",className:"bg-red-100 text-red-800",children:"Rejected"});default:return e.jsx(re,{variant:"outline",children:"Unknown"})}},b=C=>{if(!C.premium)return null;switch(C.premiumApprovalStatus){case"pending":return e.jsxs(re,{className:"bg-orange-100 text-orange-800 border-orange-300",children:[e.jsx("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Premium Pending"]});case"approved":return e.jsxs(re,{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white border-yellow-500",children:[e.jsx("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Premium Active"]});case"rejected":return e.jsxs(re,{className:"bg-red-100 text-red-800 border-red-300",children:[e.jsx("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Premium Rejected"]});default:return e.jsxs(re,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[e.jsx("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Premium"]})}},T=()=>{t(),r("/")};return o?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[1,2,3].map(C=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},C))})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome back, ",s==null?void 0:s.name,"!"]}),e.jsx("p",{className:"text-gray-600",children:"Manage your properties and track your listings"})]}),e.jsxs("div",{className:"mt-4 md:mt-0 flex flex-col sm:flex-row gap-2",children:[e.jsx("div",{className:"relative",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>S("notifications"),className:"relative",children:[e.jsx(Es,{className:"h-4 w-4"}),x.unreadNotifications>0&&e.jsx(re,{className:"absolute -top-2 -right-2 h-5 w-5 text-xs bg-red-500 text-white rounded-full flex items-center justify-center",children:x.unreadNotifications})]})}),e.jsx(g,{asChild:!0,className:"bg-[#C70000] hover:bg-[#A50000] text-white",children:e.jsxs(be,{to:"/post-property",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Post New Property"]})}),e.jsxs(g,{variant:"outline",onClick:T,children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000] mb-1",children:x.totalProperties}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Properties"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:x.pendingApproval}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending Review"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:x.approved}),e.jsx("div",{className:"text-sm text-gray-600",children:"Approved"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:x.totalViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Views"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:x.totalInquiries}),e.jsx("div",{className:"text-sm text-gray-600",children:"Inquiries"})]})}),e.jsx(U,{className:`cursor-pointer transition-all duration-200 ${u==="notifications"?"border-blue-500 bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>S("notifications"),children:e.jsx(_,{className:"p-4 text-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:y.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Notifications"}),x.unreadNotifications>0&&e.jsx(re,{className:"absolute -top-1 -right-1 h-4 w-4 text-xs bg-red-500 text-white rounded-full flex items-center justify-center",children:x.unreadNotifications})]})})})]}),x.premiumListings>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx("svg",{className:"h-5 w-5 text-yellow-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Premium Listings"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(U,{className:"border-yellow-200 bg-yellow-50",children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:x.premiumListings}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Premium"})]})}),e.jsx(U,{className:"border-orange-200 bg-orange-50",children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:x.premiumPending}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending Approval"})]})}),e.jsx(U,{className:"border-green-200 bg-green-50",children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:x.premiumApproved}),e.jsx("div",{className:"text-sm text-gray-600",children:"Approved"})]})})]})]}),u==="notifications"&&e.jsxs(U,{className:"mb-6",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Es,{className:"h-5 w-5"}),e.jsx("span",{children:"Notifications"}),x.unreadNotifications>0&&e.jsxs(re,{className:"bg-red-500 text-white",children:[x.unreadNotifications," unread"]})]})}),e.jsx(_,{children:y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No notifications yet"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"We'll notify you about important updates"})]}):e.jsx("div",{className:"space-y-3",children:y.map(C=>e.jsx("div",{className:`border rounded-lg p-4 ${C.isRead?"bg-gray-50":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[m(C.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:C.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(C.createdAt).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!C.isRead&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>v(C._id),className:"text-xs",children:"Mark as Read"}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>j(C._id),className:"text-xs text-red-600 hover:text-red-700",children:"Delete"})]})]})},C._id))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5"}),"My Listings"]})}),e.jsx(_,{children:c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pe,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No properties yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start by posting your first property"}),e.jsx(g,{asChild:!0,className:"bg-[#C70000] hover:bg-[#A50000]",children:e.jsxs(be,{to:"/post-property",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Post Your First Property"]})})]}):e.jsx("div",{className:"space-y-4",children:c.map(C=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"w-full lg:w-48 h-32 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:C.images&&C.images.length>0?e.jsx("img",{src:C.images[0],alt:C.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:C.title}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[l(C.approvalStatus||"pending"),b(C)]})]}),e.jsx("p",{className:"text-gray-600 mb-2 line-clamp-2",children:C.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3",children:[e.jsxs("span",{className:"font-semibold text-[#C70000] text-lg",children:["â‚¹",C.price.toLocaleString()," ",C.priceType==="rent"?"/month":""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-4 w-4"}),C.views," views"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-4 w-4"}),C.inquiries," inquiries"]}),e.jsx("span",{children:C.location.address})]}),C.approvalStatus==="rejected"&&C.rejectionReason&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-red-800",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",C.rejectionReason]})}),C.adminComments&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Admin Note:"})," ",C.adminComments]})}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-sm text-gray-500",children:["Posted ",new Date(C.createdAt).toLocaleDateString()]})})]})]})},C._id))})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(U,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(hs,{className:"h-8 w-8 text-[#C70000] mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:"Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage your account"})]})}),e.jsx(U,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(xs,{className:"h-8 w-8 text-[#C70000] mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:"Favorites"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Saved properties"})]})}),e.jsx(U,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(Ce,{className:"h-8 w-8 text-[#C70000] mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:"Messages"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Chat with buyers"})]})}),e.jsx(U,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx(bs,{className:"h-8 w-8 text-[#C70000] mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold mb-1",children:"Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Account preferences"})]})})]})]}),e.jsx(ve,{})]})};function yd({propertyId:s,onPackageSelect:t,selectedPackage:r}){const[c,N]=a.useState([]),[y,n]=a.useState(!0);a.useEffect(()=>{o();const x=setInterval(()=>{o()},3e4);return()=>clearInterval(x)},[]);const o=async()=>{try{n(!0);const{api:x}=await _s(async()=>{const{api:v}=await Promise.resolve().then(()=>Vs);return{api:v}},void 0),d=(await x.get("packages?activeOnly=true")).data;d.success?(N(d.data),console.log("ðŸ“¦ Loaded packages:",d.data)):console.error("Failed to fetch packages:",d.error)}catch(x){console.error("Error fetching packages:",x)}finally{n(!1)}},f=x=>{switch(x){case"basic":return e.jsx(Ne,{className:"h-6 w-6"});case"featured":return e.jsx(ns,{className:"h-6 w-6"});case"premium":return e.jsx(We,{className:"h-6 w-6"});default:return e.jsx(nt,{className:"h-6 w-6"})}},u=x=>{switch(x){case"basic":return"border-gray-300 bg-white";case"featured":return"border-orange-300 bg-orange-50";case"premium":return"border-purple-300 bg-purple-50";default:return"border-gray-300 bg-white"}},S=x=>{switch(x){case"basic":return"bg-gray-600 hover:bg-gray-700";case"featured":return"bg-orange-600 hover:bg-orange-700";case"premium":return"bg-purple-600 hover:bg-purple-700";default:return"bg-gray-600 hover:bg-gray-700"}};return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading packages..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Choose Your Advertisement Package"}),e.jsx("p",{className:"text-gray-600",children:"Select a package to boost your property visibility in Rohtak"})]}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 mb-4",children:"No packages available"}),e.jsxs("div",{className:"space-x-3",children:[e.jsx(g,{onClick:async()=>{try{const{api:x}=await _s(async()=>{const{api:v}=await Promise.resolve().then(()=>Vs);return{api:v}},void 0),d=(await x.post("packages/initialize")).data;console.log("Initialize result:",d),d.success&&o()}catch(x){console.error("Error initializing packages:",x)}},className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Initialize Demo Packages"}),e.jsx(g,{onClick:o,variant:"outline",className:"text-[#C70000] border-[#C70000] hover:bg-[#C70000] hover:text-white",children:"Retry Loading Packages"})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(x=>e.jsxs("div",{className:`rounded-lg border-2 p-6 transition-all duration-200 hover:shadow-lg ${r===x._id?"border-[#C70000] bg-red-50":u(x.type)} ${x.type==="featured"?"transform scale-105":""}`,children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-full mb-4 ${x.type==="basic"?"bg-gray-100 text-gray-600":x.type==="featured"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"}`,children:f(x.type)}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:x.name}),x.type==="featured"&&e.jsxs("div",{className:"inline-flex items-center bg-orange-100 text-orange-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:[e.jsx($s,{className:"h-3 w-3 mr-1"}),"Most Popular"]}),x.type==="premium"&&e.jsxs("div",{className:"inline-flex items-center bg-purple-100 text-purple-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Best Value"]})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:x.price===0?"Free":`â‚¹${x.price}`}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-center mt-1",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),x.duration," days"]})]}),e.jsx("p",{className:"text-gray-600 text-center mb-6",children:x.description}),e.jsx("div",{className:"space-y-3 mb-8",children:x.features.map((A,d)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx(Be,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:A})]},d))}),e.jsx(g,{onClick:()=>t(x._id),className:`w-full text-white ${S(x.type)} ${r===x._id?"bg-[#C70000] hover:bg-[#A60000]":""}`,disabled:r===x._id,children:r===x._id?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Selected"]}):x.price===0?"Select Free Package":`Select for â‚¹${x.price}`})]},x._id))}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Why Choose a Paid Package?"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-blue-100 text-blue-600 rounded-full mb-3",children:e.jsx(Ne,{className:"h-6 w-6"})}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Increased Visibility"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Featured listings get 5x more views than basic listings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-green-100 text-green-600 rounded-full mb-3",children:e.jsx($s,{className:"h-6 w-6"})}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Faster Sales"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Premium properties sell 3x faster on average"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-purple-100 text-purple-600 rounded-full mb-3",children:e.jsx(Ge,{className:"h-6 w-6"})}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"More Inquiries"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Featured listings receive 4x more phone calls"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"h-5 w-5 text-blue-400 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Rohtak Exclusive Features"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"These packages are specially designed for Rohtak properties and include local area targeting for maximum exposure to genuine buyers in Rohtak and surrounding areas."})]})]})})]})}class wd{async loadConfig(){var N;const r=await(await fetch("/api/payments/methods")).json().catch(()=>null);if(!r||!r.success)throw new Error("Failed to fetch payment methods");const c=((N=r.data)==null?void 0:N.phonepe)||{};return{merchantId:c.merchantId||"",saltKey:"",saltIndex:"",testMode:c.testMode||!0}}generateTransactionId(){return`MT${Date.now()}${Math.floor(Math.random()*1e3)}`}async initiatePayment(t){try{const r=localStorage.getItem("token");if(!r)throw new Error("Authentication required. Please login again.");const c=await fetch("/api/payments/phonepe/transaction",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({packageId:t.packageId,propertyId:t.propertyId,paymentMethod:"phonepe",paymentDetails:{merchantTransactionId:this.generateTransactionId(),amount:t.amount}})});if(!c.ok){const y=await c.json().catch(()=>({}));throw new Error(y.error||`Failed to create transaction: ${c.status}`)}const N=await c.json();if(!N.success)throw new Error(N.error||"Failed to create transaction");return{success:!0,data:N.data}}catch(r){return console.error("PhonePe initiation error:",r),{success:!1,error:r.message||"Failed to initiate PhonePe payment"}}}async checkPaymentStatus(t){try{const r=await fetch(`/api/payments/phonepe/status/${t}`);if(!r.ok)throw new Error("Failed to fetch status");return await r.json()}catch(r){return console.error("PhonePe status error:",r),{success:!1,error:r.message}}}}const Cd=new wd;function Sd({packageId:s,propertyId:t,amount:r,onPaymentComplete:c,onCancel:N}){var L;const[y,n]=a.useState("phonepe"),[o,f]=a.useState(null),[u,S]=a.useState(!1),[x,A]=a.useState(""),[d,v]=a.useState(""),[j,m]=a.useState(!1),[l,b]=a.useState("");a.useEffect(()=>{T()},[]);const T=async()=>{try{const V=await(await fetch("/api/payments/methods")).json();V.success&&f(V.data)}catch(q){console.error("Error fetching payment methods:",q)}},C=(q,V)=>{navigator.clipboard.writeText(q),b(V),setTimeout(()=>b(""),2e3)},P=async q=>{try{S(!0);const V=localStorage.getItem("token"),i=await(await fetch("/api/payments/transaction",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify({packageId:s,propertyId:t,paymentMethod:y,paymentDetails:q})})).json();i.success?i.data.status==="paid"?(m(!0),setTimeout(()=>{c(i.data.transactionId)},2e3)):(m(!0),setTimeout(()=>{c(i.data.transactionId)},2e3)):alert(i.error||"Failed to create transaction")}catch(V){console.error("Error creating transaction:",V),alert("Failed to process payment")}finally{S(!1)}},k=()=>{if(!d.trim()){alert("Please enter your UPI ID");return}P({upiId:d,transactionId:x})},h=()=>{if(!x.trim()){alert("Please enter the transaction reference number");return}P({bankAccount:o==null?void 0:o.bankTransfer.accountNumber,transactionId:x})},w=()=>{P({gateway:"razorpay",transactionId:`ONLINE_${Date.now()}`})},E=async()=>{try{if(S(!0),!localStorage.getItem("token")){alert("Please login to continue");return}const V=JSON.parse(localStorage.getItem("user")||"{}"),p=await Cd.initiatePayment({amount:r,packageId:s,propertyId:t,userId:V.id||"user_"+Date.now(),userPhone:V.phone});if(p.success&&p.data){const i=p.data.instrumentResponse.redirectInfo;window.location.href=i.url}else alert(p.error||"Failed to initiate PhonePe payment")}catch(q){console.error("PhonePe payment error:",q),alert("Failed to process PhonePe payment: "+q.message)}finally{S(!1)}};return o?j?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 text-green-600 rounded-full mb-4",children:e.jsx(Le,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Payment Submitted!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:r===0?"Your free package has been activated immediately.":"Your payment is being processed. You'll receive a confirmation once it's verified."}),e.jsx("div",{className:"animate-pulse text-[#C70000]",children:"Redirecting to dashboard..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Complete Payment"}),e.jsxs("p",{className:"text-gray-600",children:["Total Amount: ",e.jsxs("span",{className:"font-semibold",children:["â‚¹",r]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[((L=o.phonepe)==null?void 0:L.enabled)&&e.jsxs("button",{onClick:()=>n("phonepe"),className:`p-4 border-2 rounded-lg transition-all ${y==="phonepe"?"border-[#C70000] bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(nt,{className:"h-8 w-8 mx-auto mb-2 text-purple-600"}),e.jsx("div",{className:"text-sm font-semibold",children:"PhonePe"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Instant payment"})]}),o.upi.enabled&&e.jsxs("button",{onClick:()=>n("upi"),className:`p-4 border-2 rounded-lg transition-all ${y==="upi"?"border-[#C70000] bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(Ht,{className:"h-8 w-8 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"text-sm font-semibold",children:"UPI Payment"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Pay via UPI apps"})]}),o.bankTransfer.enabled&&e.jsxs("button",{onClick:()=>n("bank_transfer"),className:`p-4 border-2 rounded-lg transition-all ${y==="bank_transfer"?"border-[#C70000] bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(Ft,{className:"h-8 w-8 mx-auto mb-2 text-green-600"}),e.jsx("div",{className:"text-sm font-semibold",children:"Bank Transfer"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Direct bank transfer"})]}),o.online.enabled&&e.jsxs("button",{onClick:()=>n("online"),className:`p-4 border-2 rounded-lg transition-all ${y==="online"?"border-[#C70000] bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(ys,{className:"h-8 w-8 mx-auto mb-2 text-purple-600"}),e.jsx("div",{className:"text-sm font-semibold",children:"Online Payment"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Card, Net Banking, Wallet"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[y==="upi"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Ht,{className:"h-5 w-5 mr-2 text-blue-600"}),"UPI Payment"]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Pay to UPI ID:"}),e.jsx("p",{className:"text-lg font-mono text-blue-800",children:o.upi.upiId})]}),e.jsx(g,{onClick:()=>C(o.upi.upiId,"UPI ID"),variant:"outline",size:"sm",children:l==="UPI ID"?e.jsx(Be,{className:"h-4 w-4"}):e.jsx(xa,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Amount to Pay:"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["â‚¹",r]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your UPI ID *"}),e.jsx(Q,{type:"text",placeholder:"yourname@paytm",value:d,onChange:q=>v(q.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Reference Number (after payment)"}),e.jsx(Q,{type:"text",placeholder:"Enter UPI transaction ID",value:x,onChange:q=>A(q.target.value)})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ds,{className:"h-5 w-5 text-yellow-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Payment Instructions"}),e.jsxs("ol",{className:"text-sm text-yellow-700 mt-1 list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Copy the UPI ID above"}),e.jsx("li",{children:"Open your UPI app (PayTM, GPay, PhonePe, etc.)"}),e.jsxs("li",{children:["Send â‚¹",r," to the UPI ID"]}),e.jsx("li",{children:"Enter your UPI ID and transaction ID here"}),e.jsx("li",{children:'Click "Complete Payment" below'})]})]})]})}),e.jsx(g,{onClick:k,disabled:u,className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:u?"Processing...":"Complete Payment"})]}),y==="bank_transfer"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Ft,{className:"h-5 w-5 mr-2 text-green-600"}),"Bank Transfer"]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Bank Name:"}),e.jsx("p",{className:"font-semibold",children:o.bankTransfer.bankName})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Account Number:"}),e.jsx("p",{className:"font-mono text-lg",children:o.bankTransfer.accountNumber})]}),e.jsx(g,{onClick:()=>C(o.bankTransfer.accountNumber,"Account Number"),variant:"outline",size:"sm",children:l==="Account Number"?e.jsx(Be,{className:"h-4 w-4"}):e.jsx(xa,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"IFSC Code:"}),e.jsx("p",{className:"font-mono text-lg",children:o.bankTransfer.ifscCode})]}),e.jsx(g,{onClick:()=>C(o.bankTransfer.ifscCode,"IFSC Code"),variant:"outline",size:"sm",children:l==="IFSC Code"?e.jsx(Be,{className:"h-4 w-4"}):e.jsx(xa,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Account Holder:"}),e.jsx("p",{className:"font-semibold",children:o.bankTransfer.accountHolder})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Amount to Transfer:"}),e.jsxs("p",{className:"text-2xl font-bold text-green-800",children:["â‚¹",r]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Reference Number *"}),e.jsx(Q,{type:"text",placeholder:"Enter bank transaction reference number",value:x,onChange:q=>A(q.target.value),required:!0})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ds,{className:"h-5 w-5 text-blue-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Bank Transfer Instructions"}),e.jsxs("ol",{className:"text-sm text-blue-700 mt-1 list-decimal list-inside space-y-1",children:[e.jsxs("li",{children:["Transfer â‚¹",r," to the above bank account"]}),e.jsx("li",{children:"Keep the transaction receipt"}),e.jsx("li",{children:"Enter the reference number here"}),e.jsx("li",{children:"We will verify and activate your package within 2-4 hours"})]})]})]})}),e.jsx(g,{onClick:h,disabled:u||!x.trim(),className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:u?"Processing...":"Submit Bank Transfer"})]}),y==="phonepe"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(nt,{className:"h-5 w-5 mr-2 text-purple-600"}),"PhonePe Payment"]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-purple-800 font-medium",children:["Amount: â‚¹",r]}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"You will be redirected to PhonePe secure payment gateway"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"UPI Apps"}),e.jsx("div",{className:"text-xs text-gray-500",children:"PhonePe, GPay, PayTM"})]}),e.jsxs("div",{className:"text-center p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Cards & Banking"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Debit/Credit, Net Banking"})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Le,{className:"h-5 w-5 text-green-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-green-800",children:"PhonePe Benefits"}),e.jsxs("ul",{className:"text-sm text-green-700 mt-1 space-y-1",children:[e.jsx("li",{children:"â€¢ Instant payment confirmation"}),e.jsx("li",{children:"â€¢ Secure payment gateway"}),e.jsx("li",{children:"â€¢ Multiple payment options"}),e.jsx("li",{children:"â€¢ No hidden charges"})]})]})]})}),e.jsxs(g,{onClick:E,disabled:u,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",children:[u?"Redirecting...":"Pay with PhonePe",e.jsx(ja,{className:"h-4 w-4 ml-2"})]})]}),y==="online"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(ys,{className:"h-5 w-5 mr-2 text-purple-600"}),"Online Payment"]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-purple-800 font-medium",children:["Amount: â‚¹",r]}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"You will be redirected to secure payment gateway"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Cards"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Visa, Mastercard"})]}),e.jsxs("div",{className:"text-center p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Net Banking"}),e.jsx("div",{className:"text-xs text-gray-500",children:"All major banks"})]}),e.jsxs("div",{className:"text-center p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Wallets"}),e.jsx("div",{className:"text-xs text-gray-500",children:"PayTM, PhonePe"})]})]}),e.jsxs(g,{onClick:w,disabled:u,className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:[u?"Processing...":"Pay Now",e.jsx(ja,{className:"h-4 w-4 ml-2"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(g,{onClick:N,variant:"outline",disabled:u,children:"Cancel"})})]}):e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading payment options..."})]})})}const kd=[{value:"residential",label:"Residential"},{value:"commercial",label:"Commercial"},{value:"plot",label:"Plot/Land"}],_r={residential:[{value:"1bhk",label:"1 BHK Apartment"},{value:"2bhk",label:"2 BHK Apartment"},{value:"3bhk",label:"3 BHK Apartment"},{value:"4bhk-plus",label:"4+ BHK Apartment"},{value:"independent-house",label:"Independent House"},{value:"villa",label:"Villa"},{value:"duplex",label:"Duplex"},{value:"penthouse",label:"Penthouse"}],commercial:[{value:"shop",label:"Shop"},{value:"office",label:"Office Space"},{value:"showroom",label:"Showroom"},{value:"warehouse",label:"Warehouse"},{value:"factory",label:"Factory"},{value:"restaurant-space",label:"Restaurant Space"}],plot:[{value:"residential-plot",label:"Residential Plot"},{value:"commercial-plot",label:"Commercial Plot"},{value:"agricultural-land",label:"Agricultural Land"},{value:"industrial-plot",label:"Industrial Plot"},{value:"farm-house",label:"Farm House Plot"}]},Pd=["Parking","Lift/Elevator","Security","Power Backup","Garden","Swimming Pool","Gym","Club House","Children's Play Area","24x7 Water Supply","Air Conditioning","Internet/WiFi Ready","Intercom","Rain Water Harvesting","Waste Management"],Fa=["Property Details","Price & Location","Specifications","Photos","Contact Information","Summary"],Nt=Fa.length,gs=s=>typeof s=="string"?s.trim():"",ps=s=>gs(s).length>0;async function Ad(){var t;let s=localStorage.getItem("token")||localStorage.getItem("authToken")||localStorage.getItem("accessToken")||localStorage.getItem("userToken")||localStorage.getItem("adminToken")||null;if(!s)try{const r=JSON.parse(localStorage.getItem("user")||"null")||JSON.parse(localStorage.getItem("adminUser")||"null")||null;s=(r==null?void 0:r.token)||null}catch{}try{const r=(window==null?void 0:window.firebaseAuth)||void 0;(t=r==null?void 0:r.currentUser)!=null&&t.getIdToken&&(s=await r.currentUser.getIdToken(!0))}catch{}return s}function Td(){var p;const{user:s,isAuthenticated:t,loading:r}=je(),[c,N]=a.useState(1),[y,n]=a.useState(!1),[o,f]=a.useState(!1),[u,S]=a.useState(null),[x,A]=a.useState(0),[d,v]=a.useState(null),[j,m]=a.useState(!1),[l,b]=a.useState({title:"",description:"",price:"",priceType:"sale",propertyType:"",subCategory:"",location:{area:"",address:"",landmark:""},specifications:{bedrooms:"",bathrooms:"",area:"",facing:"",floor:"",totalFloors:"",parking:"",furnished:""},amenities:[],images:[],contactInfo:{name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.phone)||"",email:(s==null?void 0:s.email)||""}});a.useEffect(()=>{if(!r){if(!t){const i=encodeURIComponent(window.location.pathname+window.location.search);window.location.href=`/auth?returnTo=${i}`;return}s&&b(i=>({...i,contactInfo:{name:s.name||"",phone:s.phone||"",email:s.email||"",alternativePhone:gs(i.contactInfo.alternativePhone),whatsappNumber:gs(i.contactInfo.whatsappNumber)}}))}},[r,t,s]);const T=(i,F)=>{if(i.includes(".")){const[I,D]=i.split(".");b(R=>({...R,[I]:{...R[I],[D]:F}}))}else b(I=>({...I,[i]:F}))},C=i=>{b(F=>({...F,amenities:F.amenities.includes(i)?F.amenities.filter(I=>I!==i):[...F.amenities,i]}))},P=i=>{const F=Array.from(i.target.files||[]);l.images.length+F.length<=10?b(I=>({...I,images:[...I.images,...F]})):alert("Maximum 10 images allowed")},k=i=>{b(F=>({...F,images:F.images.filter((I,D)=>D!==i)}))},h=i=>{var F,I,D,R,M,W;switch(i){case 1:return ps(l.title)&&ps(l.description)&&ps(l.propertyType)?l.propertyType&&_r[l.propertyType]?ps(l.subCategory):!0:!1;case 2:return ps(l.price)&&ps((F=l.location)==null?void 0:F.area)&&ps((I=l.location)==null?void 0:I.address);case 3:return ps((D=l.specifications)==null?void 0:D.area);case 4:return l.images.length>0;case 5:return ps((R=l.contactInfo)==null?void 0:R.name)&&ps((M=l.contactInfo)==null?void 0:M.phone)&&ps((W=l.contactInfo)==null?void 0:W.email);default:return!0}},w=()=>{if(!(c>=Nt))if(h(c)){N(i=>Math.min(i+1,Nt));try{window.scrollTo({top:0,behavior:"smooth"})}catch{}}else{let i=[];c===1&&(ps(l.title)||i.push("Property Title"),ps(l.description)||i.push("Description"),ps(l.propertyType)||i.push("Property Type"),l.propertyType&&!ps(l.subCategory)&&i.push("Sub Category")),alert(i.length?`Please fill the following required fields: ${i.join(", ")}`:"Please fill all required fields")}},E=()=>{N(i=>Math.max(1,i-1))};a.useEffect(()=>{try{const i=localStorage.getItem("post_property_draft");if(i){const F=JSON.parse(i)||{};b(I=>{var D,R,M,W,J,H,se,B,$,O,ae,X,z,le,Z,ne;return{...I,...F,title:gs(F.title),description:gs(F.description),price:gs(F.price),priceType:F.priceType??I.priceType,propertyType:F.propertyType??"",subCategory:F.subCategory??"",location:{area:gs((D=F.location)==null?void 0:D.area),address:gs((R=F.location)==null?void 0:R.address),landmark:gs((M=F.location)==null?void 0:M.landmark)},specifications:{...I.specifications,...F.specifications,area:gs((W=F.specifications)==null?void 0:W.area),bedrooms:gs((J=F.specifications)==null?void 0:J.bedrooms),bathrooms:gs((H=F.specifications)==null?void 0:H.bathrooms),facing:gs((se=F.specifications)==null?void 0:se.facing),floor:gs((B=F.specifications)==null?void 0:B.floor),totalFloors:gs(($=F.specifications)==null?void 0:$.totalFloors),parking:gs((O=F.specifications)==null?void 0:O.parking),furnished:gs((ae=F.specifications)==null?void 0:ae.furnished)},contactInfo:{...I.contactInfo,...F.contactInfo,name:gs((X=F.contactInfo)==null?void 0:X.name),phone:gs((z=F.contactInfo)==null?void 0:z.phone),email:gs((le=F.contactInfo)==null?void 0:le.email),alternativePhone:gs((Z=F.contactInfo)==null?void 0:Z.alternativePhone),whatsappNumber:gs((ne=F.contactInfo)==null?void 0:ne.whatsappNumber)},images:[]}})}}catch{}},[]),a.useEffect(()=>{const i=setTimeout(()=>{try{const{images:F,...I}=l;localStorage.setItem("post_property_draft",JSON.stringify(I))}catch{}},5e3);return()=>clearTimeout(i)},[l]);const L=async(i=!1)=>{try{m(!0);const F=await Ad(),I=new FormData;I.append("title",l.title),I.append("description",l.description),I.append("price",l.price),I.append("priceType",l.priceType),I.append("propertyType",l.propertyType),I.append("subCategory",l.subCategory),I.append("location",JSON.stringify(l.location)),I.append("specifications",JSON.stringify(l.specifications)),I.append("amenities",JSON.stringify(l.amenities)),I.append("contactInfo",JSON.stringify(l.contactInfo)),I.append("premium",i.toString()),I.append("contactVisible",(!i).toString()),l.images.forEach(W=>I.append("images",W));const D={};F&&(D.Authorization=`Bearer ${F}`);const R=await fetch("/api/properties",{method:"POST",headers:D,body:I,credentials:"include"});if(!R.ok){try{const W=await R.clone().text();console.log("POST /api/properties failed:",R.status,W)}catch{}if(R.status===401||R.status===403){alert("Your session has expired. Please login again."),["token","authToken","accessToken","userToken","adminToken","user","adminUser"].forEach(W=>localStorage.removeItem(W)),window.location.href="/user-login";return}throw new Error(`HTTP ${R.status}: Failed to create property`)}const M=await R.json();if(M.success){try{localStorage.removeItem("post_property_draft")}catch{}if(v(M.data._id),i)n(!0);else{try{window.dispatchEvent(new Event("properties:updated"))}catch{}alert("Property posted successfully and submitted for admin approval!"),window.location.href="/user-dashboard"}}else alert(M.error||"Failed to post property")}catch(F){console.error("Error posting property:",F),alert("Failed to post property")}finally{m(!1)}},q=async i=>{try{const I=await(await fetch(`/api/packages/${i}`)).json();I.success&&(S(i),A(I.data.price),n(!1),f(!0))}catch(F){console.error("Error fetching package details:",F)}},V=i=>{alert("Property posted and package activated successfully!"),window.location.href="/seller-dashboard"};return t?y?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Promote Your Property"}),e.jsx("p",{className:"text-gray-600",children:"Choose a package to boost your property visibility"})]}),e.jsx(yd,{propertyId:d,onPackageSelect:q}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(g,{onClick:()=>{alert("Property posted successfully!"),window.location.href="/seller-dashboard"},variant:"outline",children:"Skip Package Selection"})})]}),e.jsx(ve,{})]}):o&&u?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"p-4",children:e.jsx(Sd,{packageId:u,propertyId:d,amount:x,onPaymentComplete:V,onCancel:()=>{alert("Property posted successfully!"),window.location.href="/seller-dashboard"}})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 post-property-page",children:[e.jsx(Ke,{}),e.jsx("style",{children:`
        .post-property-page { padding-bottom: 160px!important; }
        .wizard-actions {
          position: sticky;
          bottom: 0;
          background: #fff;
          box-shadow: 0 -2px 12px rgba(0,0,0,.08);
          padding: .75rem 1rem;
          display: flex;
          gap: .5rem;
          justify-content: space-between;
          z-index: 9999;
        }
        @media (max-width: 1023px) {
          .wizard-actions {
            position: fixed;
            left: 0;
            right: 0;
            bottom: calc(var(--app-bottom-nav-height, 64px));
          }
        }
        @supports (-webkit-touch-callout: none) {
          .wizard-actions {
            bottom: calc(var(--app-bottom-nav-height, 64px) + env(safe-area-inset-bottom, 0px));
          }
        }
      `}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Post Property"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Step ",c," of ",Fa.length]})]}),e.jsx("div",{className:"flex space-x-2",children:Fa.map((i,F)=>e.jsx("div",{className:`flex-1 h-2 rounded-full ${F+1<=c?"bg-[#C70000]":"bg-gray-200"}`},F))}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mt-2",children:Fa[c-1]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Title *"}),e.jsx(Q,{value:l.title,onChange:i=>T("title",i.target.value),placeholder:"e.g., 3 BHK Luxury Apartment in Sector 12",className:ps(l.title)?"":"border-red-300",required:!0}),!ps(l.title)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Property title is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type *"}),e.jsxs(ue,{value:l.propertyType,onValueChange:i=>{T("propertyType",i),T("subCategory","")},children:[e.jsx(xe,{className:ps(l.propertyType)?"":"border-red-300",children:e.jsx(pe,{placeholder:"Select property type"})}),e.jsx(he,{children:kd.map(i=>e.jsx(G,{value:i.value,children:i.label},i.value))})]})]}),l.propertyType&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sub Category *"}),e.jsxs(ue,{value:l.subCategory,onValueChange:i=>T("subCategory",i),children:[e.jsx(xe,{className:ps(l.subCategory)?"":"border-red-300",children:e.jsx(pe,{placeholder:"Select sub category"})}),e.jsx(he,{children:(p=_r[l.propertyType])==null?void 0:p.map(i=>e.jsx(G,{value:i.value,children:i.label},i.value))})]}),!ps(l.subCategory)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Please select a sub category"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx($e,{value:l.description,onChange:i=>T("description",i.target.value),placeholder:"Describe your property in detail...",className:ps(l.description)?"":"border-red-300",rows:4,required:!0}),!ps(l.description)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Property description is required"})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),e.jsx(Q,{type:"number",value:l.price,onChange:i=>T("price",i.target.value),placeholder:"Enter price",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Type *"}),e.jsxs(ue,{value:l.priceType,onValueChange:i=>T("priceType",i),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"sale",children:"For Sale"}),e.jsx(G,{value:"rent",children:"For Rent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rohtak Area *"}),e.jsxs(ue,{value:l.location.area,onValueChange:i=>T("location.area",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select area in Rohtak"})}),e.jsx(he,{children:cr.map(i=>e.jsx(G,{value:i,children:i},i))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complete Address *"}),e.jsx($e,{value:l.location.address,onChange:i=>T("location.address",i.target.value),placeholder:"House/Plot number, Street, Area, Rohtak, Haryana",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nearby Landmark"}),e.jsx(Q,{value:l.location.landmark,onChange:i=>T("location.landmark",i.target.value),placeholder:"e.g., Near PGI Rohtak, AIIMS Rohtak"})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bedrooms"}),e.jsxs(ue,{value:l.specifications.bedrooms,onValueChange:i=>T("specifications.bedrooms",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select"})}),e.jsxs(he,{children:[e.jsx(G,{value:"1",children:"1"}),e.jsx(G,{value:"2",children:"2"}),e.jsx(G,{value:"3",children:"3"}),e.jsx(G,{value:"4",children:"4"}),e.jsx(G,{value:"5+",children:"5+"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bathrooms"}),e.jsxs(ue,{value:l.specifications.bathrooms,onValueChange:i=>T("specifications.bathrooms",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select"})}),e.jsxs(he,{children:[e.jsx(G,{value:"1",children:"1"}),e.jsx(G,{value:"2",children:"2"}),e.jsx(G,{value:"3",children:"3"}),e.jsx(G,{value:"4",children:"4"}),e.jsx(G,{value:"5+",children:"5+"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Area (sq ft) *"}),e.jsx(Q,{type:"number",value:l.specifications.area,onChange:i=>T("specifications.area",i.target.value),placeholder:"e.g., 1200",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Facing"}),e.jsxs(ue,{value:l.specifications.facing,onValueChange:i=>T("specifications.facing",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select"})}),e.jsxs(he,{children:[e.jsx(G,{value:"north",children:"North"}),e.jsx(G,{value:"south",children:"South"}),e.jsx(G,{value:"east",children:"East"}),e.jsx(G,{value:"west",children:"West"}),e.jsx(G,{value:"north-east",children:"North-East"}),e.jsx(G,{value:"north-west",children:"North-West"}),e.jsx(G,{value:"south-east",children:"South-East"}),e.jsx(G,{value:"south-west",children:"South-West"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Furnished"}),e.jsxs(ue,{value:l.specifications.furnished,onValueChange:i=>T("specifications.furnished",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select"})}),e.jsxs(he,{children:[e.jsx(G,{value:"furnished",children:"Furnished"}),e.jsx(G,{value:"semi-furnished",children:"Semi-Furnished"}),e.jsx(G,{value:"unfurnished",children:"Unfurnished"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Floor"}),e.jsx(Q,{value:l.specifications.floor,onChange:i=>T("specifications.floor",i.target.value),placeholder:"e.g., 2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Floors"}),e.jsx(Q,{value:l.specifications.totalFloors,onChange:i=>T("specifications.totalFloors",i.target.value),placeholder:"e.g., 5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parking"}),e.jsxs(ue,{value:l.specifications.parking,onValueChange:i=>T("specifications.parking",i),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select"})}),e.jsxs(he,{children:[e.jsx(G,{value:"yes",children:"Available"}),e.jsx(G,{value:"no",children:"Not Available"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amenities"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Pd.map(i=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.amenities.includes(i),onChange:()=>C(i),className:"rounded border-gray-300 text-[#C70000] focus:ring-[#C70000]"}),e.jsx("span",{className:"text-sm text-gray-700",children:i})]},i))})]})]}),c===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Photos * (Max 10 images)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx($a,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Upload clear photos of your property"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:P,className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"bg-[#C70000] text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-[#A60000]",children:"Choose Photos"})]})]}),l.images.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:["Uploaded Photos (",l.images.length,"/10)"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:l.images.map((i,F)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(i),alt:`Property ${F+1}`,className:"w-full h-20 sm:h-24 md:h-28 object-cover rounded-lg border-2 border-gray-200 hover:border-[#C70000] transition-colors"}),e.jsx("button",{onClick:()=>k(F),className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center shadow-lg transition-colors",children:e.jsx(Ue,{className:"h-3 w-3"})})]},F))})]})]}),c===5&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Person Name *"}),e.jsx(Q,{value:l.contactInfo.name,onChange:i=>T("contactInfo.name",i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e.jsx(Q,{value:l.contactInfo.phone,onChange:i=>T("contactInfo.phone",i.target.value),placeholder:"Enter primary phone number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternative Mobile Number (Optional)"}),e.jsx(Q,{value:l.contactInfo.alternativePhone||"",onChange:i=>T("contactInfo.alternativePhone",i.target.value),placeholder:"Enter alternative mobile number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Number (Optional)"}),e.jsx(Q,{value:l.contactInfo.whatsappNumber||"",onChange:i=>T("contactInfo.whatsappNumber",i.target.value),placeholder:"Enter WhatsApp number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx(Q,{type:"email",value:l.contactInfo.email,onChange:i=>T("contactInfo.email",i.target.value),placeholder:"Enter email address",required:!0})]})]}),c===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Le,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Ready to Post!"}),e.jsx("p",{className:"text-gray-600",children:"Review your property details and choose how to list it"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:l.title}),e.jsx("p",{className:"text-gray-600 mb-2",children:l.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Price:"})," â‚¹",Number(l.price||0).toLocaleString(),l.priceType==="rent"&&"/month"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Area:"})," ",l.location.area]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Size:"})," ",l.specifications.area," sq ft"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",l.propertyType]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(g,{onClick:()=>L(!0),disabled:j,className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:j?"Posting...":e.jsxs(e.Fragment,{children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"Post with Promotion Package"]})}),e.jsx(g,{onClick:()=>L(!1),disabled:j,variant:"outline",className:"w-full",children:j?"Posting...":e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Post as Free Listing"]})})]})]})]}),e.jsxs("div",{id:"wizard-actions",className:"wizard-actions",children:[e.jsx("button",{id:"btn-prev","aria-label":"Previous","data-action":"prev","data-testid":"prev-step",onClick:E,disabled:c===1,style:{padding:"8px 16px",backgroundColor:c===1?"#f3f4f6":"#ffffff",color:c===1?"#9ca3af":"#374151",border:"1px solid #d1d5db",borderRadius:"6px",cursor:c===1?"not-allowed":"pointer"},children:"Previous"}),e.jsx("button",{id:"btn-next","aria-label":"Next","data-action":"next","data-testid":"next-step",onClick:w,disabled:c>=Nt||!h(c),style:{padding:"8px 16px",backgroundColor:c>=Nt||!h(c)?"#f3f4f6":"#C70000",color:c>=Nt||!h(c)?"#9ca3af":"#ffffff",border:"1px solid #d1d5db",borderRadius:"6px",cursor:c>=Nt||!h(c)?"not-allowed":"pointer"},children:c>=Nt?"Done":"Next"})]})]}),e.jsx(ve,{})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-700",children:"Redirecting to login..."})}function Ed(){var C,P;const{user:s,logout:t}=je(),r=Ve(),[c,N]=a.useState([]),[y,n]=a.useState([]),[o,f]=a.useState([]),[u,S]=a.useState(!0),[x,A]=a.useState(""),[d,v]=a.useState(""),[j,m]=a.useState({totalFavorites:0,recentViews:0,savedSearches:0,inquiries:0});a.useEffect(()=>{if(!s){r("/login");return}if(s.userType!=="buyer"){switch(s.userType){case"seller":r("/seller-dashboard");break;case"agent":r("/agent-dashboard");break;default:r("/user-dashboard")}return}l()},[s,r]);const l=async()=>{var k;try{if(!localStorage.getItem("token")){r("/login");return}const w=await fetch("/api/properties/featured");if(w.ok){const E=await w.json();E.success&&N(E.data.slice(0,6))}m({totalFavorites:((k=s==null?void 0:s.favorites)==null?void 0:k.length)||0,recentViews:5,savedSearches:2,inquiries:3})}catch(h){console.error("Error fetching dashboard data:",h),A("Failed to load dashboard data. Please try again.")}finally{S(!1)}},b=()=>{t(),r("/")},T=()=>{d.trim()&&r(`/search?q=${encodeURIComponent(d)}`)};return u?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Buyer Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Find your perfect property, ",s==null?void 0:s.name,"!"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:l,variant:"outline",size:"sm",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:b,variant:"outline",size:"sm",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-700",children:x})}),e.jsx(U,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search for properties in Rohtak...",value:d,onChange:k=>v(k.target.value),className:"pl-10",onKeyPress:k=>k.key==="Enter"&&T()})]}),e.jsxs(g,{onClick:T,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filters"]})]})})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Favorites"}),e.jsx(xs,{className:"h-4 w-4 text-red-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:j.totalFavorites})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Recent Views"}),e.jsx(Ne,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.recentViews})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Saved Searches"}),e.jsx(ts,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.savedSearches})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Inquiries Sent"}),e.jsx(Ce,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:j.inquiries})})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Quick Actions"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(be,{to:"/search",children:e.jsxs(g,{className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Browse Properties"]})}),e.jsx(be,{to:"/favorites",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"My Favorites"]})}),e.jsx(be,{to:"/recent-views",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Recent Views"]})}),e.jsx(be,{to:"/messages",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Messages"]})})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Your Profile"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s==null?void 0:s.email})]}),(s==null?void 0:s.phone)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s.phone})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(re,{variant:"outline",className:"bg-green-100 text-green-800",children:((C=s==null?void 0:s.userType)==null?void 0:C.charAt(0).toUpperCase())+((P=s==null?void 0:s.userType)==null?void 0:P.slice(1))})})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{children:"Featured Properties for You"}),e.jsx(be,{to:"/search",children:e.jsx(g,{variant:"outline",size:"sm",children:"View All"})})]}),e.jsx(_,{children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No featured properties available right now"}),e.jsx(be,{to:"/search",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Browse All Properties"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(k=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:k.title}),e.jsx(g,{size:"sm",variant:"ghost",className:"p-1",children:e.jsx(xs,{className:"h-4 w-4 text-gray-400 hover:text-red-500"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:[e.jsx(He,{className:"inline h-3 w-3 mr-1"}),k.location.address]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",k.price.toLocaleString()]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsx("span",{children:k.views})]})]}),e.jsxs("div",{className:"mt-3 flex space-x-2",children:[e.jsxs(g,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(g,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"Contact"]})]})]},k._id))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Recommended for You"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx($s,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Set your preferences to get personalized recommendations"}),e.jsxs(g,{variant:"outline",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),"Set Preferences"]})]})})]})]}),e.jsx(ve,{})]})}function Id(){const{user:s,logout:t}=je(),r=Ve(),[c,N]=a.useState([]),[y,n]=a.useState([]),[o,f]=a.useState(!0),[u,S]=a.useState(""),[x,A]=a.useState({totalProperties:0,activeListings:0,totalClients:0,closedDeals:0,pendingInquiries:0,thisMonthDeals:0,totalCommission:0,rating:4.5});a.useEffect(()=>{if(!s){r("/login");return}if(s.userType!=="agent"){switch(s.userType){case"seller":r("/seller-dashboard");break;case"buyer":r("/buyer-dashboard");break;default:r("/user-dashboard")}return}d()},[s,r]);const d=async()=>{try{const j=localStorage.getItem("token");if(!j){r("/login");return}const m=await ce.get("/user/properties",j);if(m.data.success){const l=m.data.data;N(l);const b=l.filter(P=>P.status==="active"&&P.approvalStatus==="approved").length,T=l.reduce((P,k)=>P+k.views,0),C=l.reduce((P,k)=>P+k.inquiries,0);A({totalProperties:l.length,activeListings:b,totalClients:25,closedDeals:12,pendingInquiries:C,thisMonthDeals:3,totalCommission:45e4,rating:4.5})}n([{id:1,name:"Rajesh Kumar",type:"Buyer",status:"Active",lastContact:"2024-01-15"},{id:2,name:"Priya Sharma",type:"Seller",status:"Closed",lastContact:"2024-01-14"},{id:3,name:"Amit Singh",type:"Buyer",status:"Active",lastContact:"2024-01-13"}])}catch(j){if(console.error("Error fetching agent data:",j),j.message.includes("401")||j.message.includes("403")){localStorage.removeItem("token"),localStorage.removeItem("user"),r("/login");return}S("Failed to load your dashboard data. Please try again.")}finally{f(!1)}},v=()=>{t(),r("/")};return o?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agent Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Grow your real estate business, ",s==null?void 0:s.name,"!"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:d,variant:"outline",size:"sm",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:v,variant:"outline",size:"sm",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-700",children:u})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.totalProperties})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Listings"}),e.jsx($s,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.activeListings})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Clients"}),e.jsx(Ae,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalClients})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Closed Deals"}),e.jsx(zt,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.closedDeals})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"This Month"}),e.jsx(ql,{className:"h-4 w-4 text-orange-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:x.thisMonthDeals})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Rating"}),e.jsx(ns,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.rating})})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Quick Actions"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add New Listing"]})}),e.jsx(be,{to:"/clients",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Manage Clients"]})}),e.jsx(be,{to:"/leads",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(zt,{className:"h-4 w-4 mr-2"}),"View Leads"]})}),e.jsx(be,{to:"/messages",children:e.jsxs(g,{variant:"outline",className:"w-full",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Messages"]})})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Performance Summary"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¹",x.totalCommission.toLocaleString()]}),e.jsx("p",{className:"text-sm text-green-700",children:"Total Commission Earned"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.pendingInquiries}),e.jsx("p",{className:"text-sm text-blue-700",children:"Pending Inquiries"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[(x.closedDeals/x.totalClients*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-purple-700",children:"Conversion Rate"})]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Your Agent Profile"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s==null?void 0:s.email})]}),(s==null?void 0:s.phone)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s.phone})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(re,{variant:"outline",className:"bg-purple-100 text-purple-800",children:[e.jsx(Ot,{className:"h-3 w-3 mr-1"}),"Real Estate Agent"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{className:"h-4 w-4 text-yellow-400"}),e.jsxs("span",{className:"font-medium",children:[x.rating," Rating"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zt,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:[x.closedDeals," Deals Closed"]})]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{children:"Recent Clients"}),e.jsx(be,{to:"/clients",children:e.jsx(g,{variant:"outline",size:"sm",children:"View All"})})]}),e.jsx(_,{children:y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ae,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No clients yet"}),e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}):e.jsx("div",{className:"space-y-4",children:y.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:j.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j.name}),e.jsx("p",{className:"text-sm text-gray-500",children:j.type})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx(re,{variant:j.status==="Active"?"default":"outline",children:j.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.lastContact})]}),e.jsxs(g,{size:"sm",variant:"outline",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"Contact"]})]})]},j.id))})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{children:"Your Active Listings"}),e.jsx(be,{to:"/my-properties",children:e.jsx(g,{variant:"outline",size:"sm",children:"View All"})})]}),e.jsx(_,{children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You haven't listed any properties yet"}),e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Your First Listing"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.slice(0,4).map(j=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:j.title}),e.jsx(re,{variant:j.approvalStatus==="approved"?"default":"outline",children:j.approvalStatus})]}),e.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[e.jsx(He,{className:"inline h-3 w-3 mr-1"}),j.location.address]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",j.price.toLocaleString()]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[j.views," views"]})]})]}),e.jsxs("div",{className:"mt-3 flex space-x-2",children:[e.jsxs(g,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(g,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(bs,{className:"h-3 w-3 mr-1"}),"Edit"]})]})]},j._id))})})]})]}),e.jsx(ve,{})]})}function Fd({className:s=""}){const[t,r]=a.useState([]);a.useEffect(()=>{const n=()=>{const f={id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:"info",message:"ðŸ”„ Footer updated! Changes are now live on the website.",timestamp:new Date};r(u=>[f,...u.slice(0,4)]),setTimeout(()=>{r(u=>u.filter(S=>S.id!==f.id))},5e3)},o=()=>{const f={id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:"success",message:"âœ… Page published! It will appear in the footer automatically.",timestamp:new Date};r(u=>[f,...u.slice(0,4)]),setTimeout(()=>{r(u=>u.filter(S=>S.id!==f.id))},5e3)};return window.addEventListener("footerUpdate",n),window.addEventListener("footerRefresh",n),window.addEventListener("pagePublished",o),()=>{window.removeEventListener("footerUpdate",n),window.removeEventListener("footerRefresh",n),window.removeEventListener("pagePublished",o)}},[]);const c=n=>{r(o=>o.filter(f=>f.id!==n))},N=n=>{switch(n){case"success":return e.jsx(Be,{className:"h-4 w-4 text-green-600"});case"info":return e.jsx(Oe,{className:"h-4 w-4 text-blue-600"});case"warning":return e.jsx(ds,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(Be,{className:"h-4 w-4 text-green-600"})}},y=n=>{switch(n){case"success":return"bg-green-50 border-green-200 text-green-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-green-50 border-green-200 text-green-800"}};return t.length===0?null:e.jsx("div",{className:`fixed top-4 right-4 z-50 space-y-2 ${s}`,children:t.map(n=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border shadow-lg min-w-80 animate-in slide-in-from-right-5 duration-300 ${y(n.type)}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[N(n.type),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n.message}),e.jsx("p",{className:"text-xs opacity-75",children:n.timestamp.toLocaleTimeString()})]})]}),e.jsx("button",{onClick:()=>c(n.id),className:"ml-3 p-1 hover:bg-black hover:bg-opacity-10 rounded-full transition-colors",children:e.jsx(Ue,{className:"h-3 w-3"})})]},n.id))})}const Ld=[{id:"dashboard",label:"Dashboard",icon:Ln},{id:"advertisements",label:"Advertisement Management",icon:ha,children:[{id:"ads-listing",label:"Ads Listing",icon:Ks},{id:"categories",label:"Categories",icon:tt},{id:"custom-fields",label:"Custom Fields",icon:bs},{id:"ad-management",label:"Advertisement Management",icon:ha},{id:"pending-approval",label:"Pending Approvals",icon:rs,badge:"new"},{id:"premium-approvals",label:"Premium Listing Approvals",icon:We,badge:"3"},{id:"ad-tips",label:"Advertisement Tips",icon:st}]},{id:"packages",label:"Package Management",icon:js,children:[{id:"package-management",label:"Package Management",icon:js},{id:"listing-package",label:"Advertisement Listing Package",icon:Ks},{id:"feature-package",label:"Feature Advertisement Package",icon:ns}]},{id:"payments",label:"Payment Management",icon:ys,children:[{id:"transactions",label:"Payment Transactions",icon:ys},{id:"manual-payment-approval",label:"Manual Payment Approval",icon:Je,badge:"5"},{id:"bank-transfer",label:"Bank Transfer",icon:ys}]},{id:"users",label:"User Management",icon:Ae,children:[{id:"all-users",label:"All Users",icon:Ae},{id:"user-analytics",label:"User Analytics",icon:Ws}]},{id:"sellers",label:"Seller Management",icon:Ae,children:[{id:"seller-management",label:"Seller Management",icon:Ae},{id:"verification-fields",label:"Verification Fields",icon:Je},{id:"seller-verification",label:"Seller Verification",icon:Hs,badge:"12"},{id:"seller-review",label:"Seller Review",icon:ns},{id:"seller-review-report",label:"Seller Review Report",icon:Ua}]},{id:"other-services",label:"Other Services",icon:rt,children:[{id:"service-categories",label:"Service Categories",icon:tt},{id:"service-subcategories",label:"Service Subcategories",icon:Ks},{id:"service-listings",label:"Service Listings",icon:He},{id:"bulk-import",label:"Bulk Import",icon:we}]},{id:"support",label:"Support & Communication",icon:Ce,children:[{id:"support-inbox",label:"Support Inbox",icon:Ce,badge:"new"},{id:"conversation-analytics",label:"Conversation Analytics",icon:Ws}]},{id:"home-screen",label:"Home Screen Management",icon:Pe,children:[{id:"slider",label:"Slider",icon:jr},{id:"new-projects",label:"New Projects",icon:we},{id:"maps",label:"Area Maps",icon:He},{id:"banners",label:"Banners",icon:ha},{id:"feature-section",label:"Feature Section",icon:ns}]},{id:"locations",label:"Place/Location Management",icon:He,children:[{id:"countries",label:"Countries",icon:Xs},{id:"states",label:"States",icon:He},{id:"cities",label:"Cities",icon:He},{id:"areas",label:"Areas",icon:He}]},{id:"reports",label:"Reports Management",icon:Ws,children:[{id:"report-reasons",label:"Report Reasons",icon:rs},{id:"user-reports",label:"User Reports",icon:Ua,badge:"3"}]},{id:"promotional",label:"Promotional Management",icon:Us,children:[{id:"send-notification",label:"Send Notification",icon:Us},{id:"customers",label:"Customers",icon:Ae}]},{id:"staff",label:"Staff Management",icon:We,children:[{id:"role",label:"Role",icon:Je},{id:"staff-management",label:"Staff Management",icon:We}]},{id:"content",label:"Page Management",icon:Ss,children:[{id:"content-management",label:"Create New Page",icon:we},{id:"static-pages",label:"All Pages",icon:Ss},{id:"footer-management",label:"Footer Settings",icon:Xs},{id:"blog-management",label:"Blog Management",icon:Ss},{id:"faq",label:"FAQ Management",icon:st},{id:"web-queries",label:"Web User Queries",icon:Ce,badge:"7"}]},{id:"system",label:"System Settings",icon:rt,children:[{id:"system-status",label:"System Status",icon:ut},{id:"testing",label:"System Testing",icon:ut},{id:"test-seller-notifications",label:"Test Seller Notifications",icon:Es},{id:"login-test",label:"Login Test Suite",icon:Ae},{id:"settings",label:"Settings",icon:bs},{id:"system-update",label:"System Update",icon:Oe},{id:"auth-debug",label:"Auth Debug",icon:Je}]}];function Xt({children:s,activeSection:t,onSectionChange:r}){var v,j;const{user:c,logout:N}=je(),[y,n]=a.useState(!1),[o,f]=a.useState(["dashboard"]),[u,S]=a.useState(!1);if(!c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-600",children:"Loading user data..."})})});const x=m=>{f(l=>l.includes(m)?l.filter(b=>b!==m):[...l,m])},A=()=>{N(),window.location.href="/"},d=(m,l=0)=>{var h;const b=m.children&&m.children.length>0,T=o.includes(m.id),C=t===m.id,P=l>0&&(m.id==="categories"||m.id==="countries"),k=m.id==="categories"?"/admin/ads/categories":m.id==="countries"?"/admin/locations/countries":void 0;return e.jsxs("div",{children:[P?e.jsxs("a",{href:k,className:me("w-full flex items-center justify-between px-3 py-2 text-left rounded-lg transition-colors",l===0?"font-medium":"text-sm font-normal",l>0&&"ml-4",C?"bg-[#C70000] text-white":"text-gray-700 hover:bg-gray-100",y&&l===0&&"justify-center px-2"),"aria-label":m.label,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m.icon,{className:me("flex-shrink-0",l===0?"h-5 w-5":"h-4 w-4")}),!y&&e.jsx("span",{className:"truncate",children:m.label})]}),!y&&e.jsxs("div",{className:"flex items-center space-x-2",children:[m.badge&&e.jsx(re,{variant:"destructive",className:"h-5 px-1.5 text-xs",children:m.badge}),b&&e.jsx(ws,{className:me("h-4 w-4 transition-transform",T&&"rotate-90")})]})]}):e.jsxs("button",{onClick:()=>{b?x(m.id):(r(m.id),S(!1))},className:me("w-full flex items-center justify-between px-3 py-2 text-left rounded-lg transition-colors",l===0?"font-medium":"text-sm font-normal",l>0&&"ml-4",C?"bg-[#C70000] text-white":"text-gray-700 hover:bg-gray-100",y&&l===0&&"justify-center px-2"),"aria-label":m.label,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m.icon,{className:me("flex-shrink-0",l===0?"h-5 w-5":"h-4 w-4")}),!y&&e.jsx("span",{className:"truncate",children:m.label})]}),!y&&e.jsxs("div",{className:"flex items-center space-x-2",children:[m.badge&&e.jsx(re,{variant:"destructive",className:"h-5 px-1.5 text-xs",children:m.badge}),b&&e.jsx(ws,{className:me("h-4 w-4 transition-transform",T&&"rotate-90")})]})]}),b&&T&&!y&&e.jsx("div",{className:"mt-1 space-y-1",children:(h=m.children)==null?void 0:h.map(w=>d(w,l+1))})]},m.id)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>S(!1)}),e.jsxs("div",{className:me("fixed inset-y-0 left-0 z-50 bg-white border-r border-gray-200 transition-all duration-300 lg:relative lg:translate-x-0",y?"w-16":"w-64",u?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[!y&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"A"})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Admin Panel"})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>n(!y),className:"p-1 lg:flex hidden",children:y?e.jsx(ws,{className:"h-4 w-4"}):e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>S(!1),className:"p-1 lg:hidden",children:e.jsx(Dt,{className:"h-4 w-4"})})]}),!y&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:((v=c==null?void 0:c.name)==null?void 0:v.charAt(0))||"A"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(c==null?void 0:c.name)||"Admin User"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Administrator"})]})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:Ld.map(m=>d(m))}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs(g,{variant:"ghost",onClick:A,className:me("w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",y&&"justify-center px-2"),children:[e.jsx(Ms,{className:"h-5 w-5"}),!y&&e.jsx("span",{className:"ml-3",children:"Logout"})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>S(!0),className:"lg:hidden",children:e.jsx(Ba,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 capitalize",children:t.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(re,{variant:"outline",children:"Admin"}),e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:((j=c==null?void 0:c.name)==null?void 0:j.charAt(0))||"A"})})]})]})}),e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:s})]}),e.jsx(Fd,{})]})}const Xe=a.forwardRef(({className:s,...t},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:me("w-full caption-bottom text-sm",s),...t})}));Xe.displayName="Table";const Ze=a.forwardRef(({className:s,...t},r)=>e.jsx("thead",{ref:r,className:me("[&_tr]:border-b",s),...t}));Ze.displayName="TableHeader";const es=a.forwardRef(({className:s,...t},r)=>e.jsx("tbody",{ref:r,className:me("[&_tr:last-child]:border-0",s),...t}));es.displayName="TableBody";const Dd=a.forwardRef(({className:s,...t},r)=>e.jsx("tfoot",{ref:r,className:me("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Dd.displayName="TableFooter";const de=a.forwardRef(({className:s,...t},r)=>e.jsx("tr",{ref:r,className:me("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));de.displayName="TableRow";const te=a.forwardRef(({className:s,...t},r)=>e.jsx("th",{ref:r,className:me("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));te.displayName="TableHead";const ee=a.forwardRef(({className:s,...t},r)=>e.jsx("td",{ref:r,className:me("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));ee.displayName="TableCell";const Rd=a.forwardRef(({className:s,...t},r)=>e.jsx("caption",{ref:r,className:me("mt-4 text-sm text-muted-foreground",s),...t}));Rd.displayName="TableCaption";const Re=Jl,ks=Wl,$d=Hl,Di=a.forwardRef(({className:s,...t},r)=>e.jsx(Dn,{ref:r,className:me("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Di.displayName=Dn.displayName;const Ee=a.forwardRef(({className:s,children:t,...r},c)=>e.jsxs($d,{children:[e.jsx(Di,{}),e.jsxs(Rn,{ref:c,className:me("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[t,e.jsxs(Gl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ee.displayName=Rn.displayName;const Ie=({className:s,...t})=>e.jsx("div",{className:me("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Ie.displayName="DialogHeader";const Nr=({className:s,...t})=>e.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Nr.displayName="DialogFooter";const Fe=a.forwardRef(({className:s,...t},r)=>e.jsx($n,{ref:r,className:me("text-lg font-semibold leading-none tracking-tight",s),...t}));Fe.displayName=$n.displayName;const br=a.forwardRef(({className:s,...t},r)=>e.jsx(Un,{ref:r,className:me("text-sm text-muted-foreground",s),...t}));br.displayName=Un.displayName;function Ri(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(!1),[d,v]=a.useState(null),[j,m]=a.useState(!1),[l,b]=a.useState({name:"",description:"",price:0,duration:30,features:[""],type:"basic",active:!0});a.useEffect(()=>{T()},[s]);const T=async()=>{if(s)try{N(!0),n("");const p=await fetch("/api/packages",{headers:{Authorization:`Bearer ${s}`}});if(p.ok){const i=await p.json();i.success?r(i.data):n(i.error||"Failed to fetch packages")}else n("Failed to fetch packages")}catch(p){console.error("Error fetching packages:",p),n("Failed to fetch packages")}finally{N(!1)}},C=async p=>{if(!(!s||!confirm("Are you sure you want to delete this package?")))try{const i=await fetch(`/api/packages/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),{ok:F,status:I,data:D}=await Cs(i);F?(r(t.filter(R=>R._id!==p)),alert("Package deleted successfully! Changes will be visible to users immediately.")):n(Os(D,I,"delete package"))}catch(i){console.error("Error deleting package:",i),n("Failed to delete package")}},P=()=>{b({name:"",description:"",price:0,duration:30,features:[""],type:"basic",active:!0}),v(null)},k=()=>{P(),A(!0)},h=p=>{b({name:p.name,description:p.description,price:p.price,duration:p.duration,features:p.features,type:p.type,active:p.active}),v(p),A(!0)},w=async()=>{if(s)try{m(!0),n("");const p=d?`/api/packages/${d._id}`:"/api/packages",F=await fetch(p,{method:d?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...l,features:l.features.filter(R=>(R??"").trim()!=="")})}),I=await F.text();let D;try{D=JSON.parse(I)}catch{n("Invalid response format");return}F.ok&&D.success?(await T(),A(!1),P(),alert(`Package ${d?"updated":"created"} successfully! Changes will be visible to users immediately.`)):n(D.error||"Failed to save package")}catch(p){console.error("Error saving package:",p),n("Failed to save package")}finally{m(!1)}},E=(p,i)=>{const F=[...l.features];F[p]=i,b({...l,features:F})},L=()=>{b({...l,features:[...l.features,""]})},q=p=>{if(l.features.length>1){const i=l.features.filter((F,I)=>I!==p);b({...l,features:i})}},V=t.filter(p=>{var I,D;const i=(((I=p.name)==null?void 0:I.toLowerCase())||"").includes(o.toLowerCase())||(((D=p.description)==null?void 0:D.toLowerCase())||"").includes(o.toLowerCase()),F=u==="all"||p.type===u;return i&&F});return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading packages..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),T()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Package Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage advertisement packages and pricing"})]}),e.jsxs(g,{onClick:k,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Package"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Basic Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.type==="basic").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Free tier"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.type==="featured").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mid tier"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Premium Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(p=>p.type==="premium").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Premium tier"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search packages...",value:o,onChange:p=>f(p.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Package Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"basic",children:"Basic"}),e.jsx(G,{value:"featured",children:"Featured"}),e.jsx(G,{value:"premium",children:"Premium"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Package Name"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Price"}),e.jsx(te,{children:"Duration"}),e.jsx(te,{children:"Features"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[V.map(p=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:p.name}),e.jsx("p",{className:"text-sm text-gray-500",children:p.description})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:p.type==="premium"?"bg-purple-100 text-purple-800":p.type==="featured"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:p.type})}),e.jsx(ee,{children:p.price===0?"Free":`â‚¹${p.price}`}),e.jsxs(ee,{children:[p.duration," days"]}),e.jsx(ee,{children:e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",children:["View (",p.features.length,")"]})}),e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsxs(Fe,{children:[p.name," Features"]})}),e.jsx("div",{className:"space-y-2",children:p.features.map((i,F)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-[#C70000] rounded-full"}),e.jsx("span",{children:i})]},F))})]})]})}),e.jsx(ee,{children:e.jsx(re,{variant:p.active?"default":"secondary",className:p.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:p.active?"Active":"Inactive"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>h(p),children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>C(p._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},p._id)),V.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No packages found"})})]})]})})}),e.jsx(Re,{open:x,onOpenChange:A,children:e.jsxs(Ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:d?"Edit Package":"Create New Package"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Package Name *"}),e.jsx(Q,{value:l.name,onChange:p=>b({...l,name:p.target.value}),placeholder:"Enter package name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Package Type *"}),e.jsxs(ue,{value:l.type,onValueChange:p=>b({...l,type:p}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"basic",children:"Basic"}),e.jsx(G,{value:"featured",children:"Featured"}),e.jsx(G,{value:"premium",children:"Premium"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx($e,{value:l.description,onChange:p=>b({...l,description:p.target.value}),placeholder:"Enter package description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (â‚¹) *"}),e.jsx(Q,{type:"number",min:"0",value:l.price,onChange:p=>b({...l,price:parseInt(p.target.value)||0}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (days) *"}),e.jsx(Q,{type:"number",min:"1",value:l.duration,onChange:p=>b({...l,duration:parseInt(p.target.value)||30}),placeholder:"30"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Features *"}),e.jsxs("div",{className:"space-y-2",children:[l.features.map((p,i)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{value:p,onChange:F=>E(i,F.target.value),placeholder:"Enter feature",className:"flex-1"}),l.features.length>1&&e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>q(i),className:"text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]},i)),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:L,className:"mt-2",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Feature"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:l.active,onChange:p=>b({...l,active:p.target.checked}),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Package is active"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>{A(!1),P()},disabled:j,children:"Cancel"}),e.jsx(g,{onClick:w,disabled:j||!l.name||!l.description,className:"bg-[#C70000] hover:bg-[#A50000]",children:j?"Saving...":d?"Update Package":"Create Package"})]})]})]})})]})}function ar(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(null);a.useEffect(()=>{d()},[s]);const d=async()=>{if(s)try{N(!0),n("");const l=await fetch("/api/admin/testimonials",{headers:{Authorization:`Bearer ${s}`}});if(l.ok){const b=await l.json();b.success?r(b.data.testimonials):n(b.error||"Failed to fetch testimonials")}else n("Failed to fetch testimonials")}catch(l){console.error("Error fetching testimonials:",l),n("Failed to fetch testimonials")}finally{N(!1)}},v=async(l,b,T)=>{if(s)try{const C=await fetch(`/api/admin/testimonials/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:b,featured:T})});if(C.ok)r(t.map(P=>P._id===l?{...P,status:b,featured:T??P.featured}:P));else{const P=await C.json();n(P.error||"Failed to update testimonial")}}catch(C){console.error("Error updating testimonial:",C),n("Failed to update testimonial")}},j=t.filter(l=>{const b=(o||"").toLowerCase().trim(),T=(l.name||"").toString(),C=(l.comment||"").toString(),P=b===""||T.toLowerCase().includes(b)||C.toLowerCase().includes(b)||(l.email||"").toString().toLowerCase().includes(b),k=u==="all"||l.status===u;return P&&k}),m=l=>e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(b=>e.jsx(ns,{className:`h-4 w-4 ${b<=l?"text-yellow-400 fill-current":"text-gray-300"}`},b))});return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading testimonials..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),d()},className:"mt-2",children:"Retry"})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Testimonial Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage customer testimonials and reviews"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Testimonials"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All testimonials"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Reviews"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(l=>l.status==="pending").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Approved"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(l=>l.status==="approved").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live testimonials"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured"}),e.jsx(ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(l=>l.featured).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Featured reviews"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search testimonials...",value:o,onChange:l=>f(l.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"approved",children:"Approved"}),e.jsx(G,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Customer"}),e.jsx(te,{children:"Rating"}),e.jsx(te,{children:"Comment"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Featured"}),e.jsx(te,{children:"Date"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[j.map(l=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.email})]})}),e.jsx(ee,{children:m(l.rating)}),e.jsx(ee,{children:e.jsx("div",{className:"max-w-xs truncate",children:l.comment.length>50?`${l.comment.substring(0,50)}...`:l.comment})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:l.status==="approved"?"bg-green-100 text-green-800":l.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",children:l.status})}),e.jsx(ee,{children:l.featured&&e.jsx(re,{className:"bg-purple-100 text-purple-800",children:"Featured"})}),e.jsx(ee,{children:new Date(l.createdAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsx(g,{size:"sm",variant:"outline",onClick:()=>A(l),children:e.jsx(Ne,{className:"h-4 w-4"})})}),e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Testimonial Details"})}),x&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Customer:"}),e.jsx("p",{children:x.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Rating:"}),e.jsx("div",{className:"mt-1",children:m(x.rating)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Comment:"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:x.comment})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{v(x._id,"approved"),A(null)},children:"Approve"}),e.jsx(g,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>{v(x._id,"rejected"),A(null)},children:"Reject"}),e.jsx(g,{size:"sm",variant:"outline",className:"text-purple-600",onClick:()=>{v(x._id,x.status,!x.featured),A(null)},children:x.featured?"Unfeature":"Feature"})]})]})]})]}),l.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{size:"sm",variant:"outline",className:"text-green-600",onClick:()=>v(l._id,"approved"),children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>v(l._id,"rejected"),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})})]},l._id)),j.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No testimonials found"})})]})]})})})]})}const Ud=Ql,_d=Kl,Od=Yl;function wt(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState([]),[y,n]=a.useState(!0),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState("all"),[d,v]=a.useState(!1),[j,m]=a.useState([]),[l,b]=a.useState({question:"",answer:"",category:"",featured:!1});a.useEffect(()=>{T()},[s]);const T=async()=>{if(s)try{n(!0),f("");const E=await fetch("/api/admin/faqs",{headers:{Authorization:`Bearer ${s}`}});if(E.ok){const L=await E.json();L.success?(r(L.data.faqs),N(L.data.categories)):f(L.error||"Failed to fetch FAQs")}else f("Failed to fetch FAQs")}catch(E){console.error("Error fetching FAQs:",E),f("Failed to fetch FAQs")}finally{n(!1)}},C=async()=>{if(!(!s||!l.question||!l.answer||!l.category))try{const E=await fetch("/api/admin/faqs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(l)});if(E.ok){const L=await E.json();L.success?(T(),b({question:"",answer:"",category:"",featured:!1}),v(!1)):f(L.error||"Failed to create FAQ")}else f("Failed to create FAQ")}catch(E){console.error("Error creating FAQ:",E),f("Failed to create FAQ")}},P=async(E,L)=>{if(s)try{const q=await fetch(`/api/admin/faqs/${E}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(L)});if(q.ok)r(t.map(V=>V._id===E?{...V,...L}:V));else{const V=await q.json();f(V.error||"Failed to update FAQ")}}catch(q){console.error("Error updating FAQ:",q),f("Failed to update FAQ")}},k=async E=>{if(!(!s||!confirm("Are you sure you want to delete this FAQ?")))try{const L=await fetch(`/api/admin/faqs/${E}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(L.ok)r(t.filter(q=>q._id!==E));else{const q=await L.json();f(q.error||"Failed to delete FAQ")}}catch(L){console.error("Error deleting FAQ:",L),f("Failed to delete FAQ")}},h=E=>{m(L=>L.includes(E)?L.filter(q=>q!==E):[...L,E])},w=t.filter(E=>{const L=E.question.toLowerCase().includes(u.toLowerCase())||E.answer.toLowerCase().includes(u.toLowerCase()),q=x==="all"||E.category===x;return L&&q});return y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading FAQs..."})]}):e.jsxs("div",{className:"space-y-6",children:[o&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:o}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{f(""),T()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"FAQ Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage frequently asked questions"})]}),e.jsxs(Re,{open:d,onOpenChange:v,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add FAQ"]})}),e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create New FAQ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Question"}),e.jsx(Q,{value:l.question,onChange:E=>b({...l,question:E.target.value}),placeholder:"Enter the question..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Answer"}),e.jsx($e,{value:l.answer,onChange:E=>b({...l,answer:E.target.value}),placeholder:"Enter the answer...",rows:4})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs(ue,{value:l.category,onValueChange:E=>b({...l,category:E}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select category"})}),e.jsxs(he,{children:[e.jsx(G,{value:"General",children:"General"}),e.jsx(G,{value:"Listing",children:"Listing"}),e.jsx(G,{value:"Pricing",children:"Pricing"}),e.jsx(G,{value:"Communication",children:"Communication"}),e.jsx(G,{value:"Privacy",children:"Privacy"}),e.jsx(G,{value:"Verification",children:"Verification"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:l.featured,onChange:E=>b({...l,featured:E.target.checked})}),e.jsx("label",{htmlFor:"featured",className:"text-sm",children:"Featured FAQ"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(g,{onClick:C,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create FAQ"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total FAQs"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All questions"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active FAQs"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(E=>E.active).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(E=>E.featured).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Highlighted"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Categories"}),e.jsx(st,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Different topics"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search FAQs...",value:u,onChange:E=>S(E.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Category"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Categories"}),c.map(E=>e.jsx(G,{value:E,children:E},E))]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsxs("div",{className:"space-y-4",children:[w.map(E=>e.jsx(U,{children:e.jsx(_,{className:"p-6",children:e.jsxs(Ud,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(_d,{className:"flex items-center justify-between w-full text-left",onClick:()=>h(E._id),children:[e.jsx("div",{className:"flex items-start space-x-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:E.question}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(re,{variant:"outline",className:"text-xs",children:E.category}),E.featured&&e.jsx(re,{className:"bg-purple-100 text-purple-800 text-xs",children:"Featured"}),e.jsx(re,{variant:E.active?"default":"secondary",className:`text-xs ${E.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:E.active?"Active":"Inactive"})]})]})}),j.includes(E._id)?e.jsx(qa,{className:"h-5 w-5"}):e.jsx(ea,{className:"h-5 w-5"})]})}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>P(E._id,{featured:!E.featured}),className:"text-purple-600",children:E.featured?"Unfeature":"Feature"}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>P(E._id,{active:!E.active}),className:E.active?"text-red-600":"text-green-600",children:E.active?"Deactivate":"Activate"}),e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>k(E._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})]}),e.jsx(Od,{className:"mt-4",children:e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-700",children:E.answer})})})]})})},E._id)),w.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(st,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No FAQs found"})]})]})]})}function ma(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(null),[d,v]=a.useState(null),[j,m]=a.useState({page:1,limit:20,total:0,pages:0});a.useEffect(()=>{l()},[s,j.page,u]);const l=async()=>{if(s)try{N(!0),n("");const k=new URLSearchParams({page:j.page.toString(),limit:j.limit.toString(),userType:u,search:o}),h=await fetch(`/api/admin/users?${k}`,{headers:{Authorization:`Bearer ${s}`}});if(h.ok){const w=await h.json();w.success?(r(w.data.users),m(w.data.pagination)):n(w.error||"Failed to fetch users")}else n("Failed to fetch users")}catch(k){console.error("Error fetching users:",k),n("Failed to fetch users")}finally{N(!1)}},b=async(k,h)=>{if(s)try{const w=await fetch(`/api/admin/users/${k}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:h})});if(w.ok)r(t.map(E=>E._id===k?{...E,status:h}:E));else{const E=await w.json();n(E.error||"Failed to update user status")}}catch(w){console.error("Error updating user status:",w),n("Failed to update user status")}},T=async k=>{if(s)try{A(k);const h=await fetch(`/api/admin/users/${k}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(h.ok)r(t.filter(w=>w._id!==k)),v(null);else{const w=await h.json();n(w.error||"Failed to delete user")}}catch(h){console.error("Error deleting user:",h),n("Failed to delete user")}finally{A(null)}},C=()=>{m({...j,page:1}),l()},P=t.filter(k=>{var w,E;return(((w=k.name)==null?void 0:w.toLowerCase())||"").includes(o.toLowerCase())||(((E=k.email)==null?void 0:E.toLowerCase())||"").includes(o.toLowerCase())||(k.phone||"").includes(o)});return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),l()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage all registered users and their accounts"})]}),e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered users"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(k=>k.status==="active").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active accounts"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Sellers"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(k=>k.userType==="seller").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Seller accounts"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Buyers"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(k=>k.userType==="buyer").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Buyer accounts"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search users...",value:o,onChange:k=>f(k.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"User Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"buyer",children:"Buyers"}),e.jsx(G,{value:"seller",children:"Sellers"}),e.jsx(G,{value:"agent",children:"Agents"}),e.jsx(G,{value:"admin",children:"Admins"})]})]}),e.jsxs(g,{variant:"outline",onClick:C,children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"User"}),e.jsx(te,{children:"User Type"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Phone"}),e.jsx(te,{children:"Joined"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[P.map(k=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:k.name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.email})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:k.userType==="admin"?"bg-purple-100 text-purple-800":k.userType==="seller"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:k.userType})}),e.jsx(ee,{children:e.jsx(re,{variant:k.status==="active"?"default":"secondary",className:k.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:k.status})}),e.jsx(ee,{children:k.phone}),e.jsx(ee,{children:new Date(k.createdAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>b(k._id,k.status==="active"?"inactive":"active"),className:k.status==="active"?"text-red-600":"text-green-600",children:k.status==="active"?e.jsx(_n,{className:"h-4 w-4"}):e.jsx(Hs,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>v(k),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},k._id)),P.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No users found"})})]})]})})}),j.pages>1&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",(j.page-1)*j.limit+1," to"," ",Math.min(j.page*j.limit,j.total)," of"," ",j.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>m({...j,page:j.page-1}),disabled:j.page===1,children:"Previous"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>m({...j,page:j.page+1}),disabled:j.page===j.pages,children:"Next"})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete User"}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"text-red-700 font-medium",children:"Warning: This action cannot be undone!"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Deleting this user will also remove all their properties and associated data."})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"User to be deleted:"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"font-semibold",children:d.name}),e.jsx("p",{className:"text-sm text-gray-500",children:d.email}),e.jsx("p",{className:"text-sm text-gray-500",children:d.phone}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800 capitalize",children:d.userType}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full capitalize ${d.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.status})]})]})]}),e.jsxs("div",{className:"flex space-x-3 justify-end",children:[e.jsx(g,{variant:"outline",onClick:()=>v(null),children:"Cancel"}),e.jsx(g,{variant:"destructive",onClick:()=>T(d._id),disabled:x===d._id,className:"bg-red-600 hover:bg-red-700",children:x===d._id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete User"]})})]})]})]})})]})}const sa=Zl,ta=ec,Md=a.forwardRef(({className:s,inset:t,children:r,...c},N)=>e.jsxs(On,{ref:N,className:me("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",s),...c,children:[r,e.jsx(ws,{className:"ml-auto h-4 w-4"})]}));Md.displayName=On.displayName;const zd=a.forwardRef(({className:s,...t},r)=>e.jsx(Mn,{ref:r,className:me("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));zd.displayName=Mn.displayName;const $t=a.forwardRef(({className:s,sideOffset:t=4,...r},c)=>e.jsx(Xl,{children:e.jsx(zn,{ref:c,sideOffset:t,className:me("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));$t.displayName=zn.displayName;const ss=a.forwardRef(({className:s,inset:t,...r},c)=>e.jsx(Bn,{ref:c,className:me("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",s),...r}));ss.displayName=Bn.displayName;const Bd=a.forwardRef(({className:s,children:t,checked:r,...c},N)=>e.jsxs(Vn,{ref:N,className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:r,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(qn,{children:e.jsx(Be,{className:"h-4 w-4"})})}),t]}));Bd.displayName=Vn.displayName;const Vd=a.forwardRef(({className:s,children:t,...r},c)=>e.jsxs(Hn,{ref:c,className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(qn,{children:e.jsx(pr,{className:"h-2 w-2 fill-current"})})}),t]}));Vd.displayName=Hn.displayName;const qd=a.forwardRef(({className:s,inset:t,...r},c)=>e.jsx(Gn,{ref:c,className:me("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...r}));qd.displayName=Gn.displayName;const Hd=a.forwardRef(({className:s,...t},r)=>e.jsx(Jn,{ref:r,className:me("-mx-1 my-1 h-px bg-muted",s),...t}));Hd.displayName=Jn.displayName;function mr(){var ae,X;const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState(1),[j,m]=a.useState(0),[l,b]=a.useState(null),[T,C]=a.useState(null),[P,k]=a.useState(null),[h,w]=a.useState(new Set),[E,L]=a.useState(!1),[q,V]=a.useState(!1),[p,i]=a.useState({totalUsers:0,activeUsers:0,newUsers:0,verifiedUsers:0}),F=10;a.useEffect(()=>{console.log("AllUsersManagement component mounted, token:",!!s),s&&(I(),D())},[d,u,x,o,s]);const I=async()=>{var z;if(!s){console.log("No token available for fetchUsers"),n("Authentication required"),N(!1);return}try{N(!0),n(""),console.log("Fetching users with token:",s.substring(0,20)+"...");const Z=`/api/admin/users?${new URLSearchParams({page:d.toString(),limit:F.toString(),userType:u!=="all"?u:"",status:x!=="all"?x:"",search:o})}`;console.log("Fetching from URL:",Z);const ne=await fetch(Z,{headers:{Authorization:`Bearer ${s}`}});if(console.log("Users API response status:",ne.status),ne.ok){const ye=await ne.json();console.log("Users API response data:",ye),ye.success?(r(ye.data.users||[]),m(ye.data.total||0),console.log("Set users:",((z=ye.data.users)==null?void 0:z.length)||0)):(console.error("API returned success: false",ye.error),n(ye.error||"Failed to fetch users"))}else{const ye=await ne.text();console.error("API request failed:",ne.status,ye),n(`Failed to fetch users (${ne.status})`)}}catch(le){console.error("Network error in fetchUsers:",le),n("Network error while fetching users")}finally{N(!1)}},D=async()=>{if(!s){console.log("No token available for fetchStats");return}try{console.log("Fetching user stats...");const z=await fetch("/api/admin/user-stats",{headers:{Authorization:`Bearer ${s}`}});if(console.log("Stats API response status:",z.status),z.ok){const le=await z.json();console.log("Stats API response data:",le),le.success?i(le.data):console.error("Stats API returned success: false",le.error)}else console.error("Stats API request failed:",z.status)}catch(z){console.error("Failed to fetch user stats:",z)}},R=async(z,le)=>{if(s)try{const Z=await fetch(`/api/admin/users/${z}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:le})});if(Z.ok){const ne=await Z.json();ne.success?(I(),D()):n(ne.error||"Failed to update user status")}else n("Failed to update user status")}catch{n("Network error while updating user status")}},M=async z=>{if(s)try{C(z);const le=await fetch(`/api/admin/users/${z}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(le.ok){const Z=await le.json();Z.success?(I(),D(),k(null)):n(Z.error||"Failed to delete user")}else n("Failed to delete user")}catch{n("Network error while deleting user")}finally{C(null)}},W=async()=>{if(!(!s||h.size===0))try{L(!0);const z=await fetch("/api/admin/users/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({ids:Array.from(h)})});if(z.ok){const le=await z.json();le.success?(I(),D(),w(new Set),V(!1)):n(le.error||"Failed to delete selected users")}else n("Failed to delete selected users")}catch{n("Network error while deleting users")}finally{L(!1)}},J=z=>{const le=new Set(h);le.has(z)?le.delete(z):le.add(z),w(le)},H=()=>{h.size===t.length?w(new Set):w(new Set(t.map(z=>z._id)))},se=async()=>{if(s)try{const z=new URLSearchParams({userType:u!=="all"?u:"",status:x!=="all"?x:"",search:o}),le=await fetch(`/api/admin/users/export?${z}`,{headers:{Authorization:`Bearer ${s}`}});if(le.ok){const Z=await le.blob(),ne=window.URL.createObjectURL(Z),ye=document.createElement("a");ye.href=ne,ye.download="users-export.csv",document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),window.URL.revokeObjectURL(ne)}else n("Failed to export users")}catch{n("Network error while exporting users")}},B=z=>{switch(z){case"admin":return e.jsx(We,{className:"h-4 w-4"});case"agent":return e.jsx(Je,{className:"h-4 w-4"});case"seller":return e.jsx(Hs,{className:"h-4 w-4"});default:return e.jsx(Ae,{className:"h-4 w-4"})}},$=z=>{const le=z||"active",Z={active:{variant:"default",className:"bg-green-100 text-green-800"},inactive:{variant:"secondary",className:"bg-gray-100 text-gray-800"},suspended:{variant:"destructive",className:"bg-red-100 text-red-800"},pending:{variant:"outline",className:"bg-yellow-100 text-yellow-800"}},ne=Z[le]||Z.active;return e.jsx(re,{variant:ne.variant,className:ne.className,children:le.charAt(0).toUpperCase()+le.slice(1)})},O=Math.ceil(j/F);return e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:y})]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{n(""),I()},className:"mt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Retry"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.totalUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All registered users"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(Le,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.activeUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"New Users"}),e.jsx(Hs,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.newUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 30 days"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Verified Users"}),e.jsx(Je,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p.verifiedUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email verified"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage all registered users on your platform"})]}),e.jsxs("div",{className:"flex space-x-2",children:[h.size>0&&e.jsxs(g,{onClick:()=>V(!0),variant:"destructive",size:"sm",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete Selected (",h.size,")"]}),e.jsxs(g,{onClick:se,variant:"outline",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(Q,{placeholder:"Search users by name, email, or phone...",value:o,onChange:z=>f(z.target.value),className:"w-full"})}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"User Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"buyer",children:"Buyer"}),e.jsx(G,{value:"seller",children:"Seller"}),e.jsx(G,{value:"agent",children:"Agent"}),e.jsx(G,{value:"admin",children:"Admin"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"inactive",children:"Inactive"}),e.jsx(G,{value:"suspended",children:"Suspended"}),e.jsx(G,{value:"pending",children:"Pending"})]})]}),e.jsxs(g,{variant:"outline",onClick:()=>{f(""),S("all"),A("all"),v(1)},children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading users..."})]}):e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:t.length>0&&h.size===t.length,onChange:H,className:"w-4 h-4 text-[#C70000] border-gray-300 rounded focus:ring-[#C70000]"})}),e.jsx(te,{children:"User"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Verified"}),e.jsx(te,{children:"Joined"}),e.jsx(te,{children:"Last Login"}),e.jsx(te,{children:"Properties"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:t.length>0?t.map(z=>{var le;return e.jsxs(de,{className:h.has(z._id)?"bg-blue-50":"",children:[e.jsx(ee,{children:e.jsx("input",{type:"checkbox",checked:h.has(z._id),onChange:()=>J(z._id),className:"w-4 h-4 text-[#C70000] border-gray-300 rounded focus:ring-[#C70000]"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:((le=z.name)==null?void 0:le.charAt(0))||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:z.name}),e.jsx("p",{className:"text-sm text-gray-500",children:z.email}),z.phone&&e.jsx("p",{className:"text-xs text-gray-400",children:z.phone})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[B(z.userType),e.jsx("span",{className:"capitalize",children:z.userType})]})}),e.jsx(ee,{children:$(z.status)}),e.jsx(ee,{children:z.isVerified?e.jsx(Le,{className:"h-4 w-4 text-green-500"}):e.jsx(fs,{className:"h-4 w-4 text-red-500"})}),e.jsx(ee,{children:new Date(z.createdAt).toLocaleDateString()}),e.jsx(ee,{children:z.lastLogin?new Date(z.lastLogin).toLocaleDateString():"Never"}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",children:z.propertiesCount||0})}),e.jsx(ee,{children:e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(gr,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsxs(ss,{onClick:()=>b(z),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsx(ss,{onClick:()=>R(z._id,z.status==="active"?"inactive":"active"),children:z.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(_n,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Activate"]})}),e.jsxs(ss,{onClick:()=>R(z._id,"suspended"),className:"text-red-600",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Suspend"]}),e.jsxs(ss,{onClick:()=>k(z),className:"text-red-600",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete User"]})]})]})})]},z._id)}):e.jsx(de,{children:e.jsx(ee,{colSpan:9,className:"text-center text-gray-500 py-8",children:"No users found matching your criteria"})})})]})})}),O>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",(d-1)*F+1," to"," ",Math.min(d*F,j)," of ",j," ","users"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v(d-1),disabled:d===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-3 text-sm",children:[d," of ",O]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v(d+1),disabled:d===O,children:"Next"})]})]}),e.jsx(Re,{open:!!l,onOpenChange:()=>b(null),children:e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"User Details"})}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-medium text-white",children:((ae=l.name)==null?void 0:ae.charAt(0))||"U"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:l.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[B(l.userType),e.jsx("span",{className:"capitalize",children:l.userType}),$(l.status)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:l.email})]})]}),l.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Phone"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:l.phone})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Joined"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Is,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:new Date(l.createdAt).toLocaleDateString()})]})]}),l.lastLogin&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Last Login"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Is,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:new Date(l.lastLogin).toLocaleDateString()})]})]})]}),l.address&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Location"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(He,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:[l.address.city,l.address.state,l.address.country].filter(Boolean).join(", ")})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>R(l._id,l.status==="active"?"inactive":"active"),children:l.status==="active"?"Deactivate":"Activate"}),e.jsx(g,{variant:"outline",className:"text-red-600",onClick:()=>R(l._id,"suspended"),children:"Suspend User"})]})]})]})}),e.jsx(Re,{open:!!P,onOpenChange:()=>k(null),children:e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Delete User"})}),P&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700 font-medium",children:"Warning: This action cannot be undone!"})]}),e.jsx("p",{className:"text-red-600 text-sm mt-2",children:"Deleting this user will also permanently remove all their properties and associated data."})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:"User to be deleted:"}),e.jsxs("div",{className:"mt-2 flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:((X=P.name)==null?void 0:X.charAt(0))||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:P.name}),e.jsx("p",{className:"text-sm text-gray-500",children:P.email}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[B(P.userType),e.jsx("span",{className:"text-xs capitalize",children:P.userType}),$(P.status)]})]})]})]}),e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(g,{variant:"outline",onClick:()=>k(null),children:"Cancel"}),e.jsx(g,{variant:"destructive",onClick:()=>M(P._id),disabled:T===P._id,children:T===P._id?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete User"]})})]})]})]})}),e.jsx(Re,{open:q,onOpenChange:()=>V(!1),children:e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Delete Selected Users"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700 font-medium",children:"Warning: This action cannot be undone!"})]}),e.jsx("p",{className:"text-red-600 text-sm mt-2",children:"Deleting these users will also permanently remove all their properties and associated data."})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"font-medium",children:["You are about to delete ",h.size," user",h.size>1?"s":"",":"]}),e.jsx("div",{className:"mt-3 max-h-40 overflow-y-auto space-y-2",children:t.filter(z=>h.has(z._id)).map(z=>{var le;return e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-white rounded border",children:[e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-white",children:((le=z.name)==null?void 0:le.charAt(0))||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:z.name}),e.jsx("p",{className:"text-xs text-gray-500",children:z.email})]}),e.jsx("span",{className:"text-xs capitalize px-2 py-1 bg-gray-100 rounded",children:z.userType})]},z._id)})})]}),e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(g,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsx(g,{variant:"destructive",onClick:W,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete ",h.size," User",h.size>1?"s":""]})})]})]})]})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"User Management Status"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Suspend/Activate Toggle: Active"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"Admin can suspend, activate, and deactivate users through the dropdown menu. Status changes are immediately saved to database and reflected in the interface."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"User Analytics: Active"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"User analytics module tracks user growth, activity, and type distribution. All data is dynamically calculated from the database."})]})]})})]})]})}function La(){var B,$,O,ae,X;const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState({page:1,limit:20,total:0,pages:0}),[j,m]=a.useState(!1),[l,b]=a.useState(!1),[T,C]=a.useState(!1),[P,k]=a.useState(null),[h,w]=a.useState(!1),[E,L]=a.useState({title:"",description:"",price:"",priceType:"sale",propertyType:"residential",subCategory:"1bhk",location:{city:"Rohtak",state:"Haryana",address:""},contactInfo:{name:"",phone:"",email:""},status:"active"}),[q,V]=a.useState([]);a.useEffect(()=>{p()},[s,d.page,u,x]);const p=async()=>{if(s)try{N(!0),n("");const z=new URLSearchParams({page:d.page.toString(),limit:d.limit.toString(),status:u,promotion:x,search:o}),le=await fetch(`/api/admin/properties?${z}`,{headers:{Authorization:`Bearer ${s}`}});if(le.ok){const Z=await le.json();Z.success?(r(Z.data.properties),v(Z.data.pagination)):n(Z.error||"Failed to fetch properties")}else n("Failed to fetch properties")}catch(z){console.error("Error fetching properties:",z),n("Failed to fetch properties")}finally{N(!1)}},i=async(z,le)=>{if(s)try{const Z=await fetch(`/api/admin/properties/${z}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:le})});if(Z.ok)r(t.map(ne=>ne._id===z?{...ne,status:le}:ne));else{const ne=await Z.json();n(ne.error||"Failed to update property status")}}catch(Z){console.error("Error updating property status:",Z),n("Failed to update property status")}},F=()=>{v({...d,page:1}),p()},I=z=>{k(z),b(!0)},D=z=>{k(z),L({title:z.title||"",description:z.description||"",price:(z.price||0).toString(),priceType:z.priceType||"sale",propertyType:z.propertyType||"",subCategory:z.subCategory||"",location:z.location||{address:"",city:"",state:"",pincode:""},contactInfo:z.contactInfo||{name:"",phone:"",email:""},status:z.status||"pending"}),V([]),C(!0)},R=async()=>{if(!(!s||!P))try{w(!0),n("");const z=new FormData;Object.keys(E).forEach(ne=>{ne==="location"||ne==="contactInfo"?z.append(ne,JSON.stringify(E[ne])):z.append(ne,E[ne])}),q.forEach((ne,ye)=>{z.append("images",ne)});const le=await fetch(`/api/admin/properties/${P._id}`,{method:"PUT",headers:{Authorization:`Bearer ${s}`},body:z}),Z=await le.json();le.ok&&Z.success?(await p(),C(!1),k(null),L({title:"",description:"",price:"",priceType:"sale",propertyType:"residential",subCategory:"1bhk",location:{city:"Rohtak",state:"Haryana",address:""},contactInfo:{name:"",phone:"",email:""},status:"active"}),V([]),alert("Property updated successfully!")):n(Z.error||"Failed to update property")}catch(z){console.error("Error updating property:",z),n("Failed to update property")}finally{w(!1)}},M=async z=>{if(!(!s||!confirm("Are you sure you want to delete this property?")))try{const le=await fetch(`/api/admin/properties/${z}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(le.ok)r(t.filter(Z=>Z._id!==z)),alert("Property deleted successfully!");else{const Z=await le.json();n(Z.error||"Failed to delete property")}}catch(le){console.error("Error deleting property:",le),n("Failed to delete property")}},W=z=>{const le=Array.from(z.target.files||[]);q.length+le.length<=10?V([...q,...le]):alert("Maximum 10 images allowed")},J=z=>{V(q.filter((le,Z)=>Z!==z))},H=async()=>{if(s)try{w(!0),n("");const z=new FormData;Object.keys(E).forEach(ne=>{ne==="location"||ne==="contactInfo"?z.append(ne,JSON.stringify(E[ne])):z.append(ne,E[ne])}),q.forEach((ne,ye)=>{z.append("images",ne)});const le=await fetch("/api/admin/properties",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:z}),Z=await le.json();le.ok&&Z.success?(await p(),m(!1),L({title:"",description:"",price:"",priceType:"sale",propertyType:"residential",subCategory:"1bhk",location:{city:"Rohtak",state:"Haryana",address:""},contactInfo:{name:"",phone:"",email:""},status:"active"}),V([])):n(Z.error||"Failed to create property")}catch(z){console.error("Error creating property:",z),n("Failed to create property")}finally{w(!1)}},se=t.filter(z=>{var ye,ie,fe,_e,Te;const le=o.toLowerCase(),Z=(((ye=z.title)==null?void 0:ye.toLowerCase())||"").includes(le)||(((fe=(ie=z.location)==null?void 0:ie.address)==null?void 0:fe.toLowerCase())||"").includes(le)||(((Te=(_e=z.contactInfo)==null?void 0:_e.name)==null?void 0:Te.toLowerCase())||"").includes(le);let ne=!0;return x==="paid"?ne=z.premium===!0:x==="free"?ne=!z.premium||z.premium===!1:x==="featured"&&(ne=z.featured===!0),Z&&ne});return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),p()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Property Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage all property listings and advertisements"})]}),e.jsxs(g,{onClick:()=>m(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Property"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(z=>z.status==="active").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Review"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(z=>z.status==="pending").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Sold Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(z=>z.status==="sold").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Completed sales"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search properties...",value:o,onChange:z=>f(z.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"sold",children:"Sold"}),e.jsx(G,{value:"inactive",children:"Inactive"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Promotion"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Properties"}),e.jsx(G,{value:"paid",children:"Paid Promotion Only"}),e.jsx(G,{value:"free",children:"Free Listings Only"}),e.jsx(G,{value:"featured",children:"Featured Properties"})]})]}),e.jsxs(g,{variant:"outline",onClick:F,children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Property"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Price"}),e.jsx(te,{children:"Location"}),e.jsx(te,{children:"Owner"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[se.map(z=>{var le,Z,ne,ye,ie;return e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx(Pe,{className:"h-6 w-6 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:z.title||"Untitled Property"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",((le=z._id)==null?void 0:le.slice(-6))||"N/A"]})]})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:z.propertyType||"N/A"}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:z.subCategory||"N/A"})]})}),e.jsx(ee,{children:e.jsxs("span",{className:"font-semibold",children:["â‚¹",z.price?(z.price/1e5).toFixed(1):"0","L"]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(He,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[((Z=z.location)==null?void 0:Z.city)||"N/A",","," ",((ne=z.location)==null?void 0:ne.state)||"N/A"]})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((ye=z.contactInfo)==null?void 0:ye.name)||"N/A"}),e.jsx("p",{className:"text-sm text-gray-500",children:((ie=z.contactInfo)==null?void 0:ie.phone)||"N/A"})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:z.status==="active"?"bg-green-100 text-green-800":z.status==="sold"?"bg-blue-100 text-blue-800":z.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:z.status||"unknown"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>I(z),children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>D(z),children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>i(z._id,z.status==="active"?"inactive":"active"),className:z.status==="active"?"text-red-600":"text-green-600",children:e.jsx(ns,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>M(z._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},z._id)}),se.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No properties found"})})]})]})})}),d.pages>1&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",(d.page-1)*d.limit+1," to"," ",Math.min(d.page*d.limit,d.total)," of"," ",d.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v({...d,page:d.page-1}),disabled:d.page===1,children:"Previous"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v({...d,page:d.page+1}),disabled:d.page===d.pages,children:"Next"})]})]}),e.jsx(Re,{open:j,onOpenChange:m,children:e.jsxs(Ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add New Property"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Title *"}),e.jsx(Q,{value:E.title,onChange:z=>L({...E,title:z.target.value}),placeholder:"Enter property title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type *"}),e.jsxs(ue,{value:E.propertyType,onValueChange:z=>L({...E,propertyType:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"residential",children:"Residential"}),e.jsx(G,{value:"commercial",children:"Commercial"}),e.jsx(G,{value:"plot",children:"Plot/Land"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx($e,{value:E.description,onChange:z=>L({...E,description:z.target.value}),placeholder:"Enter property description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),e.jsx(Q,{type:"number",value:E.price,onChange:z=>L({...E,price:z.target.value}),placeholder:"Enter price"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Type *"}),e.jsxs(ue,{value:E.priceType,onValueChange:z=>L({...E,priceType:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"sale",children:"For Sale"}),e.jsx(G,{value:"rent",children:"For Rent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address *"}),e.jsx($e,{value:E.location.address,onChange:z=>L({...E,location:{...E.location,address:z.target.value}}),placeholder:"Enter complete address",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name *"}),e.jsx(Q,{value:E.contactInfo.name,onChange:z=>L({...E,contactInfo:{...E.contactInfo,name:z.target.value}}),placeholder:"Enter contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx(Q,{value:E.contactInfo.phone,onChange:z=>L({...E,contactInfo:{...E.contactInfo,phone:z.target.value}}),placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx(Q,{type:"email",value:E.contactInfo.email,onChange:z=>L({...E,contactInfo:{...E.contactInfo,email:z.target.value}}),placeholder:"Enter email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Images (Max 10)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[e.jsx($a,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Upload property images (JPG, PNG)"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:W,className:"hidden",id:"admin-image-upload"}),e.jsxs("label",{htmlFor:"admin-image-upload",className:"bg-[#C70000] text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-[#A60000] inline-flex items-center",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Choose Images"]})]}),q.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:["Selected Images (",q.length,"/10)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:q.map((z,le)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(z),alt:`Property ${le+1}`,className:"w-full h-20 object-cover rounded border"}),e.jsx("button",{onClick:()=>J(le),className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:e.jsx(Ue,{className:"h-3 w-3"})})]},le))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs(ue,{value:E.status,onValueChange:z=>L({...E,status:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"sold",children:"Sold"}),e.jsx(G,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>m(!1),disabled:h,children:"Cancel"}),e.jsx(g,{onClick:H,disabled:h||!E.title||!E.description||!E.price,className:"bg-[#C70000] hover:bg-[#A50000]",children:h?"Creating...":"Create Property"})]})]})]})}),e.jsx(Re,{open:l,onOpenChange:b,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"View Property Details"})}),P&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Title:"}),e.jsx("p",{className:"text-gray-900",children:P.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type:"}),e.jsxs("p",{className:"text-gray-900 capitalize",children:[P.propertyType," -"," ",P.subCategory]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description:"}),e.jsx("p",{className:"text-gray-900",children:P.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Price:"}),e.jsxs("p",{className:"text-gray-900",children:["â‚¹",(B=P.price)==null?void 0:B.toLocaleString()," (",P.priceType,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx(re,{className:P.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:P.status})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-gray-900",children:($=P.location)==null?void 0:$.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Contact Information:"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{children:["Name: ",(O=P.contactInfo)==null?void 0:O.name]}),e.jsxs("p",{children:["Phone: ",(ae=P.contactInfo)==null?void 0:ae.phone]}),e.jsxs("p",{children:["Email: ",(X=P.contactInfo)==null?void 0:X.email]})]})]}),P.images&&P.images.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Images:"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mt-2",children:P.images.map((z,le)=>e.jsx("img",{src:z,alt:`Property ${le+1}`,className:"w-full h-20 object-cover rounded border"},le))})]})]})]})}),e.jsx(Re,{open:T,onOpenChange:C,children:e.jsxs(Ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Edit Property"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Title *"}),e.jsx(Q,{value:E.title,onChange:z=>L({...E,title:z.target.value}),placeholder:"Enter property title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type *"}),e.jsxs(ue,{value:E.propertyType,onValueChange:z=>L({...E,propertyType:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"residential",children:"Residential"}),e.jsx(G,{value:"commercial",children:"Commercial"}),e.jsx(G,{value:"plot",children:"Plot/Land"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx($e,{value:E.description,onChange:z=>L({...E,description:z.target.value}),placeholder:"Enter property description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),e.jsx(Q,{type:"number",value:E.price,onChange:z=>L({...E,price:z.target.value}),placeholder:"Enter price"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Type *"}),e.jsxs(ue,{value:E.priceType,onValueChange:z=>L({...E,priceType:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"sale",children:"For Sale"}),e.jsx(G,{value:"rent",children:"For Rent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address *"}),e.jsx($e,{value:E.location.address,onChange:z=>L({...E,location:{...E.location,address:z.target.value}}),placeholder:"Enter complete address",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add New Images (Max 10 total)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[e.jsx($a,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:W,className:"hidden",id:"edit-image-upload"}),e.jsxs("label",{htmlFor:"edit-image-upload",className:"bg-[#C70000] text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-[#A60000] inline-flex items-center",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Add Images"]})]}),q.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:["New Images (",q.length,")"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:q.map((z,le)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(z),alt:`New ${le+1}`,className:"w-full h-20 object-cover rounded border"}),e.jsx("button",{onClick:()=>J(le),className:"absolute -top-1 -right-1 bg-red-500 hover:bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:e.jsx(Ue,{className:"h-3 w-3"})})]},le))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs(ue,{value:E.status,onValueChange:z=>L({...E,status:z}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"sold",children:"Sold"}),e.jsx(G,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>{C(!1),k(null)},disabled:h,children:"Cancel"}),e.jsx(g,{onClick:R,disabled:h||!E.title||!E.description||!E.price,className:"bg-[#C70000] hover:bg-[#A50000]",children:h?"Updating...":"Update Property"})]})]})]})})]})}const ze=a.forwardRef(({className:s,size:t="default",...r},c)=>{const N=me("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t==="sm"?"h-5 w-9":t==="lg"?"h-8 w-14":"h-6 w-11",s),y=me("pointer-events-none block rounded-full bg-background shadow-lg ring-0 transition-transform",t==="sm"?"h-4 w-4 data-[state=checked]:translate-x-4":t==="lg"?"h-7 w-7 data-[state=checked]:translate-x-6":"h-5 w-5 data-[state=checked]:translate-x-5");return e.jsx(Wn,{className:N,...r,ref:c,children:e.jsx(sc,{className:y})})});ze.displayName=Wn.displayName;class Gd extends a.Component{constructor(r){super(r);ot(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,c){console.error("Admin Error Boundary caught an error:",r,c),this.setState({error:r,errorInfo:c})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8 max-w-md",children:[e.jsx(rs,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Panel Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There was an error in this admin section. This might be due to missing data or a connection issue."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{onClick:this.handleReset,className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsx(g,{variant:"outline",onClick:()=>window.location.reload(),children:"Reload Page"})]}),!1]})}):this.props.children}}function Jd(s){const t=r=>e.jsx(Gd,{children:e.jsx(s,{...r})});return t.displayName=`withAdminErrorBoundary(${s.displayName||s.name})`,t}function Wd(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState("all"),[j,m]=a.useState({page:1,limit:20,total:0,pages:0}),[l,b]=a.useState(!1),[T,C]=a.useState(!1),[P,k]=a.useState(!1),[h,w]=a.useState(null),[E,L]=a.useState(!1),[q,V]=a.useState([]),[p,i]=a.useState({title:"",description:"",price:"",priceType:"sale",propertyType:"residential",subCategory:"1bhk",location:{city:"Rohtak",state:"Haryana",address:"",area:""},contactInfo:{name:"",phone:"",whatsappNumber:"",email:""},amenities:[],specifications:{bedrooms:1,bathrooms:1,area:"",floor:"",totalFloors:"",parking:!1,furnished:"unfurnished"},featured:!1,premium:!1,promotionType:"free",status:"active"});a.useEffect(()=>{F()},[s,j.page,u,x,d]);const F=async()=>{if(s)try{N(!0),n("");const $=new URLSearchParams({page:j.page.toString(),limit:j.limit.toString()});u!=="all"&&$.append("status",u),x!=="all"&&$.append("promotionType",x),d!=="all"&&$.append("approvalStatus",d),o&&$.append("search",o);const{api:O}=await _s(async()=>{const{api:X}=await Promise.resolve().then(()=>Vs);return{api:X}},void 0),ae=await O.get(`admin/properties?${$}`,s);ae.data.success?(console.log("ðŸ“Š Properties fetched:",ae.data.data.properties),console.log("ðŸ“Š First property structure:",ae.data.data.properties[0]),r(ae.data.data.properties),m(ae.data.data.pagination)):n(ae.data.error||"Failed to fetch properties")}catch($){console.error("Error fetching properties:",$),n("Failed to fetch properties")}finally{N(!1)}},I=async()=>{if(s)try{L(!0);const $=new FormData;Object.keys(p).forEach(z=>{const le=p[z];le!=null&&(z==="location"||z==="contactInfo"||z==="specifications"||z==="amenities"?$.append(z,JSON.stringify(le)):$.append(z,String(le)))}),q&&Array.isArray(q)&&q.forEach((z,le)=>{z&&$.append("images",z)});const{createApiUrl:O}=await _s(async()=>{const{createApiUrl:z}=await Promise.resolve().then(()=>Vs);return{createApiUrl:z}},void 0),ae=O("admin/properties"),X=await fetch(ae,{method:"POST",headers:{Authorization:`Bearer ${s}`},body:$});if(X.ok){const z=await X.json();z.success?(F(),J(),b(!1)):n(z.error||"Failed to create property")}else n("Failed to create property")}catch($){console.error("Error creating property:",$),n("Failed to create property")}finally{L(!1)}},D=async()=>{if(!(!s||!h))try{L(!0);const $=new FormData;Object.keys(p).forEach(z=>{const le=p[z];le!=null&&(z==="location"||z==="contactInfo"||z==="specifications"||z==="amenities"?$.append(z,JSON.stringify(le)):$.append(z,String(le)))}),q&&Array.isArray(q)&&q.forEach((z,le)=>{z&&$.append("images",z)});const{createApiUrl:O}=await _s(async()=>{const{createApiUrl:z}=await Promise.resolve().then(()=>Vs);return{createApiUrl:z}},void 0),ae=O(`admin/properties/${h._id}`),X=await fetch(ae,{method:"PUT",headers:{Authorization:`Bearer ${s}`},body:$});if(X.ok){const z=await X.json();z.success?(F(),J(),k(!1),w(null)):n(z.error||"Failed to update property")}else n("Failed to update property")}catch($){console.error("Error updating property:",$),n("Failed to update property")}finally{L(!1)}},R=async $=>{if(!(!s||!confirm("Are you sure you want to delete this property? This action cannot be undone.")))try{const{api:O}=await _s(async()=>{const{api:ae}=await Promise.resolve().then(()=>Vs);return{api:ae}},void 0);await O.delete(`admin/properties/${$}`,s),r(t.filter(ae=>ae._id!==$))}catch(O){console.error("Error deleting property:",O),n(O.message||"Failed to delete property")}},M=async($,O,ae)=>{if(s)try{const{api:X}=await _s(async()=>{const{api:z}=await Promise.resolve().then(()=>Vs);return{api:z}},void 0);await X.put(`admin/properties/${$}/promotion`,{[O]:ae},s),F()}catch(X){console.error("Error updating promotion:",X),n(X.message||"Failed to update promotion")}},W=async($,O)=>{if(!s){n("Authentication required");return}if(!$||$==="undefined"||$==="null"){console.error("âŒ Invalid property ID:",$),n("Property ID is required");return}if(!t.find(X=>X._id===$||X.id===$)){console.error("âŒ Property not found in local state:",$),n("Property not found");return}console.log(`ï¿½ï¿½ Updating approval status for property: ${$} -> ${O}`),console.log("ðŸ” Property object:",t.find(X=>X._id===$)),console.log(`ðŸ”— API endpoint will be: admin/properties/${$}/approval`);try{const{api:X}=await _s(async()=>{const{api:le}=await Promise.resolve().then(()=>Vs);return{api:le}},void 0);console.log(`ðŸ“¤ Sending PUT request to: admin/properties/${$}/approval`);const z=await X.put(`admin/properties/${$}/approval`,{approvalStatus:O},s);console.log("âœ… Approval status updated successfully"),r(le=>le.map(Z=>Z._id===$?{...Z,approvalStatus:O}:Z)),n(""),F()}catch(X){console.error("Error updating approval status:",X);const z=X.message||"Failed to update approval status";n(`Failed to ${O} property: ${z}`)}},J=()=>{i({title:"",description:"",price:"",priceType:"sale",propertyType:"residential",subCategory:"1bhk",location:{city:"Rohtak",state:"Haryana",address:"",area:""},contactInfo:{name:"",phone:"",whatsappNumber:"",email:""},amenities:[],specifications:{bedrooms:1,bathrooms:1,area:"",floor:"",totalFloors:"",parking:!1,furnished:"unfurnished"},featured:!1,premium:!1,promotionType:"free",status:"active"}),V([])},H=$=>{i({title:$.title,description:$.description,price:$.price.toString(),priceType:$.priceType,propertyType:$.propertyType,subCategory:$.subCategory,location:$.location,contactInfo:$.contactInfo,amenities:[],specifications:{bedrooms:1,bathrooms:1,area:"",floor:"",totalFloors:"",parking:!1,furnished:"unfurnished"},featured:$.featured,premium:$.premium,promotionType:$.promotionType,status:$.status})},se=$=>{const O=$||"unknown",ae={pending:{className:"bg-yellow-100 text-yellow-800",icon:ds},approved:{className:"bg-green-100 text-green-800",icon:Be},rejected:{className:"bg-red-100 text-red-800",icon:Ue},active:{className:"bg-blue-100 text-blue-800",icon:Be},inactive:{className:"bg-gray-100 text-gray-800",icon:Ue},sold:{className:"bg-purple-100 text-purple-800",icon:Be},rented:{className:"bg-orange-100 text-orange-800",icon:Be},unknown:{className:"bg-gray-100 text-gray-600",icon:ds}},{className:X,icon:z}=ae[O]||ae.unknown;return e.jsxs(re,{className:X,children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),O.charAt(0).toUpperCase()+O.slice(1)]})},B={total:t.length,approved:t.filter($=>$.approvalStatus==="approved").length,pending:t.filter($=>$.approvalStatus==="pending").length,featured:t.filter($=>$.featured).length,premium:t.filter($=>$.premium).length};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),F()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Complete Property Management"}),e.jsx("p",{className:"text-gray-600",children:"Full CRUD operations for all property listings with promotion controls"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:async()=>{try{const O=await(await fetch("/api/create-test-properties",{method:"POST"})).json();console.log("Test properties created:",O),F()}catch($){console.error("Error creating test properties:",$)}},variant:"outline",className:"bg-blue-500 text-white hover:bg-blue-600",children:"Create Test Properties"}),e.jsx(g,{onClick:async()=>{try{const O=await(await fetch("/api/debug-properties")).json();console.log("Database debug:",O),alert(`Total properties: ${O.data.totalProperties}`)}catch($){console.error("Error debugging:",$)}},variant:"outline",children:"Debug DB"}),e.jsx(g,{onClick:async()=>{try{if(t.length>0){const $=t[0]._id||t[0].id;console.log("ðŸ§ª Testing approval with property ID:",$);const ae=await(await fetch(`/api/test-property-approval/${$}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({approvalStatus:"approved"})})).json();console.log("ðŸ§ª Test response:",ae),alert(`Test result: ${JSON.stringify(ae)}`)}else alert("No properties available for testing")}catch($){console.error("Error testing:",$)}},variant:"outline",className:"bg-orange-500 text-white hover:bg-orange-600",children:"Test Approval"}),e.jsxs(g,{onClick:()=>b(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Property"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:B.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Approved"}),e.jsx(Be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:B.approved}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live properties"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending"}),e.jsx(ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:B.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured"}),e.jsx(ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:B.featured}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Featured listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Premium"}),e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:B.premium}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Premium listings"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search properties...",value:o,onChange:$=>f($.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"inactive",children:"Inactive"}),e.jsx(G,{value:"sold",children:"Sold"}),e.jsx(G,{value:"rented",children:"Rented"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Promotion"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Promotions"}),e.jsx(G,{value:"free",children:"Free"}),e.jsx(G,{value:"paid",children:"Paid"})]})]}),e.jsxs(ue,{value:d,onValueChange:v,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Approval"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Approvals"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"approved",children:"Approved"}),e.jsx(G,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(g,{variant:"outline",onClick:F,children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Property"}),e.jsx(te,{children:"Owner"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Promotion"}),e.jsx(te,{children:"Views/Inquiries"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:t.map($=>{var O,ae,X,z,le;return console.log("ðŸ” Rendering property:",{id:$._id,title:$.title,approvalStatus:$.approvalStatus}),e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[$.images&&$.images.length>0&&e.jsx("img",{src:$.images[0],alt:$.title||"Property",className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:$.title||"Untitled Property"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[$.propertyType||"Unknown Type"," â€¢ ",$.subCategory||"Unknown Category"]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),(O=$.location)!=null&&O.area?`${$.location.area}, `:"",((ae=$.location)==null?void 0:ae.city)||"Unknown Location"]}),e.jsxs("p",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",($.price||0).toLocaleString(),$.priceType==="rent"&&"/month"]})]})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.ownerName||((X=$.contactInfo)==null?void 0:X.name)||"Unknown Owner"}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(Ge,{className:"h-3 w-3 mr-1"}),((z=$.contactInfo)==null?void 0:z.phone)||"No phone"]}),((le=$.contactInfo)==null?void 0:le.whatsappNumber)&&e.jsxs("p",{className:"text-sm text-gray-500",children:["WhatsApp: ",$.contactInfo.whatsappNumber]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[se($.status),se($.approvalStatus)]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:$.featured,onCheckedChange:Z=>M($._id,"featured",Z)}),e.jsx("span",{className:"text-sm",children:"Featured"}),$.featured&&e.jsx(ns,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:$.premium,onCheckedChange:Z=>M($._id,"premium",Z)}),e.jsx("span",{className:"text-sm",children:"Premium"}),$.premium&&e.jsx(We,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(re,{variant:$.promotionType==="paid"?"default":"secondary",children:$.promotionType==="paid"?"Paid":"Free"})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[$.views||0," views"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ge,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{className:"text-sm",children:[$.inquiries||0," inquiries"]})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{w($),C(!0)},children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{w($),H($),k(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>R($._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})}),$.approvalStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>W($._id||$.id,"approved"),children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"destructive",onClick:()=>W($._id||$.id,"rejected"),children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})})]},$._id||$.id)})})]})})}),e.jsx(Re,{open:l,onOpenChange:b,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add New Property"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property Title *"}),e.jsx(Q,{value:p.title,onChange:$=>i({...p,title:$.target.value}),placeholder:"Enter property title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price *"}),e.jsx(Q,{type:"number",value:p.price,onChange:$=>i({...p,price:$.target.value}),placeholder:"Enter price..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:p.description,onChange:$=>i({...p,description:$.target.value}),placeholder:"Enter property description...",rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property Type"}),e.jsxs(ue,{value:p.propertyType,onValueChange:$=>i({...p,propertyType:$}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"residential",children:"Residential"}),e.jsx(G,{value:"commercial",children:"Commercial"}),e.jsx(G,{value:"plot",children:"Plot/Land"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sub Category"}),e.jsxs(ue,{value:p.subCategory,onValueChange:$=>i({...p,subCategory:$}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"1bhk",children:"1 BHK"}),e.jsx(G,{value:"2bhk",children:"2 BHK"}),e.jsx(G,{value:"3bhk",children:"3 BHK"}),e.jsx(G,{value:"4bhk",children:"4 BHK"}),e.jsx(G,{value:"villa",children:"Villa"}),e.jsx(G,{value:"plot",children:"Plot"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Q,{placeholder:"Contact Name",value:p.contactInfo.name,onChange:$=>i({...p,contactInfo:{...p.contactInfo,name:$.target.value}})}),e.jsx(Q,{placeholder:"Phone Number *",value:p.contactInfo.phone,onChange:$=>i({...p,contactInfo:{...p.contactInfo,phone:$.target.value}})}),e.jsx(Q,{placeholder:"WhatsApp Number *",value:p.contactInfo.whatsappNumber,onChange:$=>i({...p,contactInfo:{...p.contactInfo,whatsappNumber:$.target.value}})}),e.jsx(Q,{placeholder:"Email",value:p.contactInfo.email,onChange:$=>i({...p,contactInfo:{...p.contactInfo,email:$.target.value}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Location"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Q,{placeholder:"Area in Rohtak",value:p.location.area,onChange:$=>i({...p,location:{...p.location,area:$.target.value}})}),e.jsx(Q,{placeholder:"Full Address",value:p.location.address,onChange:$=>i({...p,location:{...p.location,address:$.target.value}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property Images"}),e.jsx(Q,{type:"file",multiple:!0,accept:"image/*",onChange:$=>{const O=Array.from($.target.files||[]);V(O)}}),q.length>0&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[q.length," image(s) selected"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:p.featured,onCheckedChange:$=>i({...p,featured:$})}),e.jsx("span",{className:"text-sm",children:"Featured"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:p.premium,onCheckedChange:$=>i({...p,premium:$})}),e.jsx("span",{className:"text-sm",children:"Premium"})]}),e.jsxs(ue,{value:p.promotionType,onValueChange:$=>i({...p,promotionType:$}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"free",children:"Free Promotion"}),e.jsx(G,{value:"paid",children:"Paid Promotion"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(g,{onClick:I,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Create Property"]})})]})]})]})}),e.jsx(Re,{open:P,onOpenChange:k,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Edit Property"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property Title *"}),e.jsx(Q,{value:p.title,onChange:$=>i({...p,title:$.target.value}),placeholder:"Enter property title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price *"}),e.jsx(Q,{type:"number",value:p.price,onChange:$=>i({...p,price:$.target.value}),placeholder:"Enter price..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),e.jsx(g,{onClick:D,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Update Property"]})})]})]})]})}),e.jsx(Re,{open:T,onOpenChange:C,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Property Details"})}),h&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:h.title}),e.jsx("p",{className:"text-sm text-gray-500",children:h.description})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-2xl font-bold text-[#C70000]",children:["â‚¹",h.price.toLocaleString(),h.priceType==="rent"&&"/month"]})})]}),h.images.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2",children:h.images.slice(0,6).map(($,O)=>e.jsx("img",{src:$,alt:`Property ${O+1}`,className:"w-full h-32 object-cover rounded-lg"},O))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold mb-2",children:"Contact Information"}),e.jsx("p",{children:h.contactInfo.name}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(Ge,{className:"h-4 w-4 mr-1"}),h.contactInfo.phone]}),h.contactInfo.whatsappNumber&&e.jsxs("p",{children:["WhatsApp: ",h.contactInfo.whatsappNumber]}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(ms,{className:"h-4 w-4 mr-1"}),h.contactInfo.email]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold mb-2",children:"Statistics"}),e.jsxs("p",{children:["Views: ",h.views]}),e.jsxs("p",{children:["Inquiries: ",h.inquiries]}),e.jsxs("p",{children:["Created: ",new Date(h.createdAt).toLocaleDateString()]})]})]})]})]})})]})}const $i=Jd(Wd);function Ui(){var q,V;const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(!1),[u,S]=a.useState(null),[x,A]=a.useState(!1),[d,v]=a.useState({name:"",slug:"",type:"text",label:"",placeholder:"",required:!1,active:!0,order:999,options:[],categories:[],description:""});a.useEffect(()=>{j()},[s]);const j=async()=>{var p,i;if(s)try{N(!0),n("");const F=await fetch("/api/admin/custom-fields",{headers:{Authorization:`Bearer ${s}`}});if(F.ok){const I=await F.json();I.success?r(I.data.sort((D,R)=>D.order-R.order)):n(I.error||"Failed to fetch custom fields")}else F.status===404?(console.warn("Custom fields API endpoint not implemented yet"),r([])):n("Failed to fetch custom fields")}catch(F){console.error("Error fetching custom fields:",F),(p=F.message)!=null&&p.includes("Unexpected token")||(i=F.message)!=null&&i.includes("<!doctype")?(console.warn("Custom fields API endpoint not implemented - received HTML instead of JSON"),r([])):n("Failed to fetch custom fields")}finally{N(!1)}},m=async()=>{var p,i;if(s)try{A(!0);const F=await fetch("/api/admin/custom-fields",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(d)});if(F.ok){const I=await F.json();I.success?(j(),P(),f(!1)):n(I.error||"Failed to create custom field")}else F.status===404?n("Custom fields API not yet implemented. Contact administrator."):n("Failed to create custom field")}catch(F){console.error("Error creating custom field:",F),(p=F.message)!=null&&p.includes("Unexpected token")||(i=F.message)!=null&&i.includes("<!doctype")?n("Custom fields API not yet implemented. Contact administrator."):n("Failed to create custom field")}finally{A(!1)}},l=async()=>{if(!(!s||!u))try{A(!0);const p=await fetch(`/api/admin/custom-fields/${u._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(d)});if(p.ok){const i=await p.json();i.success?(j(),P(),f(!1),S(null)):n(i.error||"Failed to update custom field")}else n("Failed to update custom field")}catch(p){console.error("Error updating custom field:",p),n("Failed to update custom field")}finally{A(!1)}},b=async p=>{if(!(!s||!confirm("Are you sure you want to delete this custom field?")))try{const i=await fetch(`/api/admin/custom-fields/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(i.ok)r(F=>(F==null?void 0:F.filter(I=>(I==null?void 0:I._id)!==p))||[]);else{const F=await i.json();n(F.error||"Failed to delete custom field")}}catch(i){console.error("Error deleting custom field:",i),n("Failed to delete custom field")}},T=async(p,i)=>{if(s)try{const F=await fetch(`/api/admin/custom-fields/${p}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({active:i})});if(F.ok)j();else{const I=await F.json();n(I.error||"Failed to update field status")}}catch(F){console.error("Error updating field status:",F),n("Failed to update field status")}},C=p=>p.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),P=()=>{v({name:"",slug:"",type:"text",label:"",placeholder:"",required:!1,active:!0,order:999,options:[],categories:[],description:""})},k=p=>{v({name:p.name,slug:p.slug,type:p.type,label:p.label,placeholder:p.placeholder||"",required:p.required,active:p.active,order:p.order,options:(p==null?void 0:p.options)||[],categories:(p==null?void 0:p.categories)||[],description:p.description||""})},h=()=>{v({...d,options:[...d.options,""]})},w=(p,i)=>{const F=[...d.options];F[p]=i,v({...d,options:F})},E=p=>{v({...d,options:d.options.filter((i,F)=>F!==p)})},L=p=>{switch(p){case"text":return e.jsx(Ka,{className:"h-4 w-4"});case"number":return e.jsx(ac,{className:"h-4 w-4"});case"select":return e.jsx(Ks,{className:"h-4 w-4"});case"multiselect":return e.jsx(Ks,{className:"h-4 w-4"});case"checkbox":return e.jsx(wr,{className:"h-4 w-4"});case"date":return e.jsx(Is,{className:"h-4 w-4"});case"textarea":return e.jsx(Ss,{className:"h-4 w-4"});default:return e.jsx(Ka,{className:"h-4 w-4"})}};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading custom fields..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),j()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Custom Fields Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage custom fields for property listings and advertisements"})]}),e.jsxs(g,{onClick:()=>f(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Custom Field"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Fields"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Custom fields"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Fields"}),e.jsx(tc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((q=t==null?void 0:t.filter(p=>p==null?void 0:p.active))==null?void 0:q.length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently enabled"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Required Fields"}),e.jsx(wr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:((V=t==null?void 0:t.filter(p=>p==null?void 0:p.required))==null?void 0:V.length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mandatory fields"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Field Types"}),e.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:new Set((t==null?void 0:t.map(p=>p==null?void 0:p.type))||[]).size}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Different types"})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Field Details"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Categories"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[t==null?void 0:t.map(p=>{var i,F,I,D,R;return e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:p.label}),e.jsx("p",{className:"text-sm text-gray-500",children:p.name}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:p.slug}),p.description&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:p.description})]})}),e.jsxs(ee,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[L(p.type),e.jsx("span",{className:"capitalize",children:p.type})]}),p.required&&e.jsx(re,{variant:"destructive",className:"text-xs mt-1",children:"Required"})]}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[((i=p==null?void 0:p.categories)==null?void 0:i.length)>0?(I=(F=p==null?void 0:p.categories)==null?void 0:F.slice(0,2))==null?void 0:I.map((M,W)=>e.jsx(re,{variant:"outline",className:"mr-1",children:M},W)):e.jsx(re,{variant:"secondary",children:"All Categories"}),((D=p==null?void 0:p.categories)==null?void 0:D.length)>2&&e.jsxs(re,{variant:"outline",children:["+",(((R=p==null?void 0:p.categories)==null?void 0:R.length)||0)-2," more"]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:p.active,onCheckedChange:M=>T(p._id,M)}),e.jsx(re,{variant:p.active?"default":"secondary",className:p.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:p.active?"Active":"Inactive"})]})}),e.jsx(ee,{children:e.jsx("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:p.order})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{S(p),k(p),f(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>b(p._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},p._id)}),(!t||t.length===0)&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"No custom fields found."}),e.jsx("p",{className:"text-xs text-gray-400",children:"Custom fields API is not yet implemented. This feature will be available in a future update."})]})})})]})]})})}),e.jsx(Re,{open:o,onOpenChange:p=>{f(p),p||(P(),S(null))},children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:u?"Edit Custom Field":"Create New Custom Field"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Field Name *"}),e.jsx(Q,{value:d.name,onChange:p=>{const i=p.target.value;v({...d,name:i,slug:C(i),label:i})},placeholder:"Enter field name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Field Label *"}),e.jsx(Q,{value:d.label,onChange:p=>v({...d,label:p.target.value}),placeholder:"Enter field label..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Field Type *"}),e.jsxs(ue,{value:d.type,onValueChange:p=>v({...d,type:p}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"text",children:"Text Input"}),e.jsx(G,{value:"number",children:"Number Input"}),e.jsx(G,{value:"textarea",children:"Text Area"}),e.jsx(G,{value:"select",children:"Dropdown Select"}),e.jsx(G,{value:"multiselect",children:"Multi Select"}),e.jsx(G,{value:"checkbox",children:"Checkbox"}),e.jsx(G,{value:"date",children:"Date Picker"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Display Order"}),e.jsx(Q,{type:"number",value:d.order,onChange:p=>v({...d,order:parseInt(p.target.value)||999}),placeholder:"Display order"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Placeholder Text"}),e.jsx(Q,{value:d.placeholder,onChange:p=>v({...d,placeholder:p.target.value}),placeholder:"Enter placeholder text..."})]}),(d.type==="select"||d.type==="multiselect")&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Options"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:h,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add Option"]})]}),e.jsx("div",{className:"space-y-2",children:d.options.map((p,i)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{placeholder:`Option ${i+1}`,value:p,onChange:F=>w(i,F.target.value),className:"flex-1"}),e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>E(i),className:"text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:d.description,onChange:p=>v({...d,description:p.target.value}),placeholder:"Enter field description...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:d.required,onCheckedChange:p=>v({...d,required:p})}),e.jsx("span",{className:"text-sm",children:"Required Field"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:d.active,onCheckedChange:p=>v({...d,active:p})}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsxs(g,{variant:"outline",onClick:()=>f(!1),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(g,{onClick:u?l:m,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),u?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),u?"Update Field":"Create Field"]})})]})]})]})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Custom Fields Status"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Custom Field Options: Active"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"Custom fields are now fully functional. Admin can create, edit, and manage custom fields for property listings. All action buttons (Edit, View, Delete) are working across all modules."})]})})]})]})}function Ct(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState(!1),[x,A]=a.useState({name:"",slug:"",description:"",icon:"",subcategories:[]}),[d,v]=a.useState(null),[j,m]=a.useState(!1),[l,b]=a.useState(null),[T,C]=a.useState(!1);a.useEffect(()=>{P()},[s]);const P=async()=>{var i;if(s)try{N(!0),n("");const F=await fetch("/api/admin/categories",{headers:{Authorization:`Bearer ${s}`}});if(F.ok){const I=await F.json();if(I.success){const D=Array.isArray(I.data)?I.data:Array.isArray((i=I.data)==null?void 0:i.categories)?I.data.categories:[];r(D)}else n(I.error||"Failed to fetch categories")}else n("Failed to fetch categories")}catch(F){console.error("Error fetching categories:",F),n("Failed to fetch categories")}finally{N(!1)}},k=async()=>{var i,F;if(!(!s||!x.name))try{const I={name:x.name,iconUrl:x.icon||"/placeholder.svg",sortOrder:999,isActive:!0},D=await fetch("/api/admin/categories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(I)});if(!D.ok){const J=await D.text();let H="Failed to create category";try{H=JSON.parse(J).error||H}catch{}n(H);return}const R=await D.json();if(!R.success){n(R.error||"Failed to create category");return}const W=(((i=R.data)==null?void 0:i.category)||{_id:(F=R.data)==null?void 0:F._id})._id;for(let J=0;J<x.subcategories.length;J++){const H=x.subcategories[J];if(!(!H||!H.name))try{await fetch("/api/admin/subcategories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({categoryId:W,name:H.name,iconUrl:x.icon||"/placeholder.svg",sortOrder:J+1,isActive:!0})})}catch(se){console.warn("Failed to create subcategory",H,se)}}P();try{window.dispatchEvent(new Event("categories:updated"))}catch{}A({name:"",slug:"",description:"",icon:"",subcategories:[]}),S(!1)}catch(I){console.error("Error creating category:",I),n("Failed to create category")}},h=async()=>{if(!(!s||!d))try{const i={name:d.name,iconUrl:d.icon||d.iconUrl||"/placeholder.svg",sortOrder:d.order??d.sortOrder??999,isActive:d.active??!0},F=await fetch(`/api/admin/categories/${d._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(i)});if(!F.ok){const D=await F.text();let R="Failed to update category";try{R=JSON.parse(D).error||R}catch{}n(R);return}const I=await F.json();if(I.success){P();try{window.dispatchEvent(new Event("categories:updated"))}catch{}v(null),m(!1)}else n(I.error||"Failed to update category")}catch(i){console.error("Error updating category:",i),n("Failed to update category")}},w=async i=>{if(!(!s||!confirm("Are you sure you want to delete this category?")))try{const F=await fetch(`/api/admin/categories/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),{safeReadResponse:I,getApiErrorMessage:D}=await _s(async()=>{const{safeReadResponse:J,getApiErrorMessage:H}=await Promise.resolve().then(()=>co);return{safeReadResponse:J,getApiErrorMessage:H}},void 0),{ok:R,status:M,data:W}=await I(F);if(R){r(t.filter(J=>J._id!==i));try{window.dispatchEvent(new Event("categories:updated"))}catch{}}else n(D(W,M,"delete category"))}catch(F){console.error("Error deleting category:",F),n("Failed to delete category")}},E=i=>i.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),L=()=>{A({...x,subcategories:[...x.subcategories,{name:"",slug:""}]})},q=(i,F,I)=>{const D=[...x.subcategories];D[i]={...D[i],[F]:I},F==="name"&&(D[i].slug=E(I)),A({...x,subcategories:D})},V=i=>{A({...x,subcategories:x.subcategories.filter((F,I)=>I!==i)})},p=t.filter(i=>i.name.toLowerCase().includes(o.toLowerCase())||i.description.toLowerCase().includes(o.toLowerCase()));return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),P()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Category Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage property categories and subcategories"})]}),e.jsxs(Re,{open:u,onOpenChange:S,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Category"]})}),e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create New Category"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category Name"}),e.jsx(Q,{value:x.name,onChange:i=>{const F=i.target.value;A({...x,name:F,slug:E(F)})},placeholder:"Enter category name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Slug"}),e.jsx(Q,{value:x.slug,onChange:i=>A({...x,slug:i.target.value}),placeholder:"category-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:x.description,onChange:i=>A({...x,description:i.target.value}),placeholder:"Enter category description...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Icon"}),e.jsx(Q,{value:x.icon,onChange:i=>A({...x,icon:i.target.value}),placeholder:"Icon name (e.g., Home, Building, etc.)"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Subcategories"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:L,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add Subcategory"]})]}),x.subcategories.map((i,F)=>e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx(Q,{placeholder:"Subcategory name",value:i.name,onChange:I=>q(F,"name",I.target.value),className:"flex-1"}),e.jsx(Q,{placeholder:"subcategory-slug",value:i.slug,onChange:I=>q(F,"slug",I.target.value),className:"flex-1"}),e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>V(F),className:"text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]},F))]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(g,{onClick:k,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create Category"})]})]})]})]}),e.jsx(Re,{open:j,onOpenChange:m,children:e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Edit Category"})}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category Name"}),e.jsx(Q,{value:d.name,onChange:i=>v({...d,name:i.target.value}),placeholder:"Enter category name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Slug"}),e.jsx(Q,{value:d.slug,onChange:i=>v({...d,slug:i.target.value}),placeholder:"category-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:d.description,onChange:i=>v({...d,description:i.target.value}),placeholder:"Enter category description...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Icon"}),e.jsx(Q,{value:d.icon,onChange:i=>v({...d,icon:i.target.value}),placeholder:"Icon name (e.g., Home, Building, etc.)"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>{v(null),m(!1)},children:"Cancel"}),e.jsx(g,{onClick:h,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Save Changes"})]})]}):e.jsx("div",{className:"text-center py-8",children:"No category selected"})]})}),e.jsx(Re,{open:T,onOpenChange:C,children:e.jsxs(Ee,{className:"max-w-lg",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"View Category"})}),l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:l.name}),e.jsx("p",{className:"text-sm text-gray-600",children:l.description}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:l.slug})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Subcategories"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[(l.subcategories||[]).map((i,F)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:i.name}),e.jsx("div",{className:"text-xs text-gray-500",children:i.count??0})]},F)),(l.subcategories||[]).length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No subcategories"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{variant:"outline",onClick:()=>{b(null),C(!1)},children:"Close"})})]}):e.jsx("div",{className:"text-center py-8",children:"No category selected"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Categories"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Property categories"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Categories"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(i=>i.active).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.reduce((i,F)=>i+(F.count||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all categories"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Subcategories"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.reduce((i,F)=>i+(F.subcategories?F.subcategories.length:0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total subcategories"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search categories...",value:o,onChange:i=>f(i.target.value),className:"max-w-sm"}),e.jsxs(g,{variant:"outline",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Category"}),e.jsx(te,{children:"Subcategories"}),e.jsx(te,{children:"Properties"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[p.map(i=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:i.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i.description}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:i.slug})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[(i.subcategories||[]).slice(0,3).map((F,I)=>e.jsxs(re,{variant:"outline",className:"mr-1 mb-1",children:[F.name," (",F.count,")"]},I)),(i.subcategories||[]).length>3&&e.jsxs(re,{variant:"outline",children:["+",(i.subcategories||[]).length-3," more"]})]})}),e.jsx(ee,{children:e.jsx("span",{className:"font-semibold",children:i.count??0})}),e.jsx(ee,{children:e.jsx(re,{variant:i.active?"default":"secondary",className:i.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:i.active?"Active":"Inactive"})}),e.jsx(ee,{children:i.order??0}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{b(i),C(!0)},children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{v(i),m(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>w(i._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},i._id)),p.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No categories found"})})]})]})})})]})}const Qd=s=>({_id:s==null?void 0:s._id,name:(s==null?void 0:s.name)??"",slug:(s==null?void 0:s.slug)??"",icon:(s==null?void 0:s.iconUrl)??(s==null?void 0:s.icon)??"",description:(s==null?void 0:s.description)??"",subcategories:Array.isArray(s==null?void 0:s.subcategories)?s.subcategories:[],order:(s==null?void 0:s.sortOrder)??(s==null?void 0:s.order)??0,active:(s==null?void 0:s.isActive)??(s==null?void 0:s.active)??!0,count:(s==null?void 0:s.count)??0}),na=s=>{const t={};return s.name!==void 0&&(t.name=s.name),s.slug!==void 0&&(t.slug=s.slug),s.description!==void 0&&(t.description=s.description),s.icon!==void 0&&(t.iconUrl=s.icon),s.order!==void 0&&(t.sortOrder=s.order),s.active!==void 0&&(t.isActive=s.active),t};function _i(){const{token:s}=je(),t=Ve(),[r,c]=a.useState([]),[N,y]=a.useState(!0),[n,o]=a.useState(""),[f,u]=a.useState(""),[S,x]=a.useState("all"),[A,d]=a.useState(!1),[v,j]=a.useState(null),[m,l]=a.useState(!1),[b,T]=a.useState({name:"",slug:"",description:"",icon:"",iconFile:null,subcategories:[],order:999,active:!0});a.useEffect(()=>{const R=()=>C();return window.addEventListener("categories:updated",R),window.addEventListener("subcategories:updated",R),C(),()=>{window.removeEventListener("categories:updated",R),window.removeEventListener("subcategories:updated",R)}},[s]);const C=async()=>{var R;if(s)try{y(!0),o("");const M=await ce.get("admin/categories",s).catch(J=>{throw J}),W=M==null?void 0:M.data;if(W!=null&&W.success){const H=(Array.isArray(W.data)?W.data:Array.isArray((R=W.data)==null?void 0:R.categories)?W.data.categories:[]).map(Qd);c(H.sort((se,B)=>((se==null?void 0:se.order)??0)-((B==null?void 0:B.order)??0)))}else o((W==null?void 0:W.error)||"Failed to fetch categories")}catch(M){console.error("Error fetching categories:",(M==null?void 0:M.message)||M),o((M==null?void 0:M.message)||"Failed to fetch categories")}finally{y(!1)}},P=async R=>{var W,J,H,se;const M=new FormData;M.append("icon",R);try{const{apiRequest:B}=await _s(async()=>{const{apiRequest:O}=await Promise.resolve().then(()=>Vs);return{apiRequest:O}},void 0),$=await B("admin/categories/upload-icon",{method:"POST",body:M,headers:{Authorization:`Bearer ${s}`}});if(!$.ok)throw new Error(((W=$.data)==null?void 0:W.error)||"Failed to upload icon");return((H=(J=$.data)==null?void 0:J.data)==null?void 0:H.iconUrl)||((se=$.data)==null?void 0:se.iconUrl)||""}catch(B){throw console.error("Error uploading icon:",(B==null?void 0:B.message)||B),B}},k=async()=>{var R,M;if(!(!s||!b.name||!b.slug))try{l(!0);let W=b.icon;b.iconFile&&(W=await P(b.iconFile));const J=na({name:b.name,slug:b.slug,description:b.description,icon:W||"/placeholder.svg",order:b.order??999,active:b.active??!0}),H=await ce.post("admin/categories",J,s).catch(ae=>{throw ae}),se=H==null?void 0:H.data;if(!(se!=null&&se.success)){o((se==null?void 0:se.error)||"Failed to create category"),l(!1);return}const $=(((R=se.data)==null?void 0:R.category)||{_id:(M=se.data)==null?void 0:M._id})._id,O=await Promise.all(b.subcategories.map(async ae=>{let X="";return ae.imageFile&&(X=`/uploads/subcategories/${Date.now()}-${ae.imageFile.name}`),{id:Math.random().toString(36).substr(2,9),name:ae.name,slug:ae.slug,description:ae.description,image:X}}));for(let ae=0;ae<O.length;ae++){const X=O[ae];try{await ce.post("admin/subcategories",{categoryId:$,name:X.name,iconUrl:W||"/placeholder.svg",sortOrder:ae+1,isActive:!0,slug:X.slug,description:X.description},s)}catch(z){console.warn("Failed to create subcategory",X,z)}}window.dispatchEvent(new Event("categories:updated")),await C(),p(),d(!1)}catch(W){console.error("Error creating category:",(W==null?void 0:W.message)||W),o((W==null?void 0:W.message)||"Failed to create category")}finally{l(!1)}},h=async(R,M)=>{var W,J;if(s)try{const H=na(M),se=await ce.put(`admin/categories/${R}`,H,s);(W=se==null?void 0:se.data)!=null&&W.success?C():o(((J=se==null?void 0:se.data)==null?void 0:J.error)||"Failed to update category")}catch(H){console.error("Error updating category:",(H==null?void 0:H.message)||H),o((H==null?void 0:H.message)||"Failed to update category")}},w=async()=>{if(v)try{l(!0);let R=b.icon;b.iconFile&&(R=await P(b.iconFile)),await h(v._id,{name:b.name,slug:b.slug,description:b.description,icon:R||"/placeholder.svg",order:b.order??999,active:b.active??!0}),window.dispatchEvent(new Event("categories:updated")),await C(),p(),d(!1)}catch(R){o((R==null?void 0:R.message)||"Update failed")}finally{l(!1)}else await k()},E=async(R,M)=>{var J,H;const W=[...r];c(se=>se.map(B=>B._id===R?{...B,active:M}:B));try{const se=await ce.put(`admin/categories/${R}`,na({active:M}),s);if(!((J=se==null?void 0:se.data)!=null&&J.success))throw c(W),new Error(((H=se==null?void 0:se.data)==null?void 0:H.error)||"Failed to update status");window.dispatchEvent(new Event("categories:updated"))}catch(se){c(W),console.error("Toggle status failed:",(se==null?void 0:se.message)||se)}},L=async(R,M)=>{const W=r.findIndex($=>$._id===R),J=M==="up"?W-1:W+1;if(W<0||J<0||J>=r.length)return;const H=r[W],se=r[J],B=[...r];[B[W].order,B[J].order]=[se.order??0,H.order??0],c(B);try{await Promise.all([ce.put(`admin/categories/${H._id}`,na({order:B[W].order}),s),ce.put(`admin/categories/${se._id}`,na({order:B[J].order}),s)]),window.dispatchEvent(new Event("categories:updated"))}catch($){c(r),console.error("Order update failed",$)}},q=async R=>{var M;if(!(!s||!confirm("Are you sure you want to delete this category?")))try{const W=await ce.delete(`admin/categories/${R}`,s);W&&W.data&&W.data.success?(c(r.filter(J=>J._id!==R)),window.dispatchEvent(new Event("categories:updated"))):o(((M=W==null?void 0:W.data)==null?void 0:M.error)||"Failed to delete category")}catch(W){console.error("Error deleting category:",(W==null?void 0:W.message)||W),o((W==null?void 0:W.message)||"Failed to delete category")}},V=R=>R.toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),p=()=>{T({name:"",slug:"",description:"",icon:"",iconFile:null,subcategories:[],order:999,active:!0}),j(null)},i=()=>{T({...b,subcategories:[...b.subcategories,{name:"",slug:"",description:""}]})},F=(R,M,W)=>{const J=[...b.subcategories];M==="imageFile"?J[R]={...J[R],[M]:W}:(J[R]={...J[R],[M]:W},M==="name"&&(J[R].slug=V(W))),T({...b,subcategories:J})},I=R=>{T({...b,subcategories:b.subcategories.filter((M,W)=>W!==R)})},D=r.filter(R=>{const M=R.name||"",W=R.description||"",J=f||"",H=M.toLowerCase().includes(J.toLowerCase())||W.toLowerCase().includes(J.toLowerCase()),se=S==="all"||S==="active"&&R.active||S==="inactive"&&!R.active;return H&&se});return N?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]}):e.jsxs("div",{className:"space-y-6",children:[n&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:n}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{o(""),C()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Enhanced Category Management"}),e.jsx("p",{className:"text-gray-600",children:"Complete control over categories, subcategories, icons, and display order"})]}),e.jsxs(g,{onClick:()=>{p(),d(!0)},className:"bg-[#C70000] hover:bg-[#A60000]","aria-label":"Add Category",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Category"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Categories"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Property categories"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Categories"}),e.jsx(rc,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.filter(R=>R.active).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published & visible"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(Lt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.reduce((R,M)=>R+(M.count||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all categories"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Subcategories"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.reduce((R,M)=>R+(M.subcategories?M.subcategories.length:0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total subcategories"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search categories...",value:f,onChange:R=>u(R.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:S,onValueChange:R=>x(R),children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Filter by status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Categories"}),e.jsx(G,{value:"active",children:"Active Only"}),e.jsx(G,{value:"inactive",children:"Inactive Only"})]})]}),e.jsxs(g,{variant:"outline","aria-label":"Search categories",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Search"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Category"}),e.jsx(te,{children:"Icon"}),e.jsx(te,{children:"Subcategories"}),e.jsx(te,{children:"Properties"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:D.map((R,M)=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:R.name}),e.jsx("p",{className:"text-sm text-gray-500",children:R.description}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:R.slug})]})}),e.jsx(ee,{children:R.icon?e.jsx("div",{className:"w-8 h-8 bg-red-50 border border-red-100 rounded-lg flex items-center justify-center",children:String(R.icon).startsWith("http")?e.jsx("img",{src:R.icon,alt:"Category icon",className:"w-6 h-6 object-cover rounded"}):e.jsx("span",{className:"text-lg",children:R.icon})}):e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(at,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{className:"text-[#C70000] underline text-sm","aria-label":`Manage subcategories for ${R.name}`,onClick:()=>t(`/admin/ads/categories/${R._id}/subcategories`),children:["Manage Subcategories (",(R.subcategories||[]).length,")"]}),e.jsxs("div",{className:"pt-1",children:[(R.subcategories||[]).slice(0,3).map((W,J)=>e.jsxs(re,{variant:"outline",className:"mr-1 mb-1",children:[W.name," (",W.count,")"]},J)),(R.subcategories||[]).length>3&&e.jsxs(re,{variant:"outline",children:["+",(R.subcategories||[]).length-3," more"]})]})]})}),e.jsx(ee,{children:e.jsx("span",{className:"font-semibold",children:R.count??0})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:R.active,onCheckedChange:W=>E(R._id,W),"aria-label":`Toggle status for ${R.name}`}),e.jsx(re,{variant:R.active?"default":"secondary",className:R.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:R.active?"Active":"Inactive"})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:R.order??0}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>L(R._id,"up"),disabled:M===0,className:"h-6 w-6 p-0","aria-label":"Move category up",children:e.jsx(qa,{className:"h-3 w-3"})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>L(R._id,"down"),disabled:M===D.length-1,className:"h-6 w-6 p-0","aria-label":"Move category down",children:e.jsx(ea,{className:"h-3 w-3"})})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline","aria-label":"View category",onClick:()=>{},children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{j(R),T({name:R.name||"",slug:R.slug||"",description:R.description||"",icon:R.icon||"",iconFile:null,subcategories:(R.subcategories||[]).map(W=>({name:W.name,slug:W.slug||"",description:W.description||""})),order:R.order??999,active:!!R.active}),d(!0)},"aria-label":"Edit category",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{window.confirm("Delete this category? This cannot be undone.")&&q(R._id)},className:"text-red-600 hover:text-red-700","aria-label":"Delete category",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},R._id))})]})})}),e.jsx(Re,{open:A,onOpenChange:R=>{d(R),R||p()},children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:v?"Edit Category":"Create New Category"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category Name *"}),e.jsx(Q,{value:b.name,onChange:R=>{const M=R.target.value;T({...b,name:M,slug:V(M)})},placeholder:"Enter category name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Slug *"}),e.jsx(Q,{value:b.slug,onChange:R=>T({...b,slug:R.target.value}),placeholder:"category-slug"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:b.description,onChange:R=>T({...b,description:R.target.value}),placeholder:"Enter category description...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Icon URL or Emoji"}),e.jsx(Q,{value:b.icon,onChange:R=>T({...b,icon:R.target.value}),placeholder:"ðŸ  or https://example.com/icon.png"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Upload Icon"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{type:"file",accept:"image/*",onChange:R=>{var W;const M=(W=R.target.files)==null?void 0:W[0];M&&T({...b,iconFile:M})},className:"flex-1"}),e.jsx(lt,{className:"h-4 w-4 text-gray-400"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Display Order"}),e.jsx(Q,{type:"number",value:b.order,onChange:R=>T({...b,order:parseInt(R.target.value)||999}),placeholder:"Display order (lower = first)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(ze,{checked:b.active,onCheckedChange:R=>T({...b,active:R})}),e.jsx("span",{className:"text-sm",children:b.active?"Active":"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Subcategories"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:i,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add Subcategory"]})]}),e.jsx("div",{className:"space-y-4",children:b.subcategories.map((R,M)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Subcategory Name"}),e.jsx(Q,{placeholder:"Subcategory name",value:R.name,onChange:W=>F(M,"name",W.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Slug"}),e.jsx(Q,{placeholder:"subcategory-slug",value:R.slug,onChange:W=>F(M,"slug",W.target.value)})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Description"}),e.jsx($e,{placeholder:"Subcategory description...",value:R.description,onChange:W=>F(M,"description",W.target.value),rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Image"}),e.jsx(Q,{type:"file",accept:"image/*",onChange:W=>{var H;const J=(H=W.target.files)==null?void 0:H[0];J&&F(M,"imageFile",J)},className:"w-48"})]}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:()=>I(M),className:"text-red-600",children:[e.jsx(De,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]},M))})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsxs(g,{variant:"outline",onClick:()=>d(!1),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(g,{onClick:w,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),v?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),v?"Update Category":"Create Category"]})})]})]})]})})]})}function Oi(){var P,k;const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(null),[d,v]=a.useState(""),[j,m]=a.useState(!1);a.useEffect(()=>{l()},[u]);const l=async()=>{if(s)try{N(!0),n("");const h=new URLSearchParams({status:u!=="all"?u:"",search:o}),w=await fetch(`/api/admin/seller-verifications?${h}`,{headers:{Authorization:`Bearer ${s}`}});if(w.ok){const E=await w.json();E.success?r(E.data||[]):n(E.error||"Failed to fetch verifications")}else n("Failed to fetch seller verifications")}catch{n("Network error while fetching verifications")}finally{N(!1)}},b=async(h,w)=>{if(s)try{m(!0),n("");const E=await fetch(`/api/admin/seller-verifications/${h}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:w==="approve"?"approved":"rejected",comments:d.trim()||void 0})});if(E.ok){const L=await E.json();L.success?(l(),A(null),v("")):n(L.error||"Failed to update verification")}else n("Failed to update verification status")}catch{n("Network error while updating verification")}finally{m(!1)}},T=h=>{const w={pending:{variant:"outline",className:"bg-yellow-100 text-yellow-800"},approved:{variant:"default",className:"bg-green-100 text-green-800"},rejected:{variant:"destructive",className:"bg-red-100 text-red-800"}},E=w[h]||w.pending;return e.jsx(re,{variant:E.variant,className:E.className,children:(h||"pending").charAt(0).toUpperCase()+(h||"pending").slice(1)})},C=t.filter(h=>{var w,E;return((w=h.userName)==null?void 0:w.toLowerCase().includes(o.toLowerCase()))||((E=h.userEmail)==null?void 0:E.toLowerCase().includes(o.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsxs(g,{variant:"outline",size:"sm",onClick:l,className:"mt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Retry"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Seller Verification"}),e.jsx("p",{className:"text-gray-600",children:"Review and manage seller verification requests"})]}),e.jsxs(re,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[t.filter(h=>h.status==="pending").length," Pending Review"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(Q,{placeholder:"Search by seller name or email...",value:o,onChange:h=>f(h.target.value),className:"w-full"})}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"approved",children:"Approved"}),e.jsx(G,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading verifications..."})]}):e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Seller"}),e.jsx(te,{children:"Documents"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Submitted"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:C.length>0?C.map(h=>{var w,E;return e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:((w=h.userName)==null?void 0:w.charAt(0))||"S"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:h.userEmail}),h.userPhone&&e.jsx("p",{className:"text-xs text-gray-400",children:h.userPhone})]})]})}),e.jsx(ee,{children:e.jsxs(re,{variant:"outline",children:[((E=h.documents)==null?void 0:E.length)||0," Documents"]})}),e.jsx(ee,{children:T(h.status)}),e.jsx(ee,{children:new Date(h.submittedAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:()=>A(h),variant:"outline",size:"sm",children:e.jsx(Ne,{className:"h-4 w-4"})}),h.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>{A(h),v("")},variant:"outline",size:"sm",className:"text-green-600",children:e.jsx(Le,{className:"h-4 w-4"})}),e.jsx(g,{onClick:()=>{A(h),v("")},variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(fs,{className:"h-4 w-4"})})]})]})})]},h._id)}):e.jsx(de,{children:e.jsx(ee,{colSpan:5,className:"text-center text-gray-500 py-8",children:"No verification requests found"})})})]})})}),x&&e.jsx(Re,{open:!!x,onOpenChange:()=>A(null),children:e.jsxs(Ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Seller Verification Details"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-medium text-white",children:((P=x.userName)==null?void 0:P.charAt(0))||"S"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:x.userName}),e.jsx("p",{className:"text-gray-600",children:x.userEmail}),x.userPhone&&e.jsx("p",{className:"text-gray-600",children:x.userPhone}),T(x.status)]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Submitted Documents"}),e.jsx("div",{className:"space-y-2",children:((k=x.documents)==null?void 0:k.map((h,w)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ss,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:h.type})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{variant:h.verified?"default":"outline",children:h.verified?"Verified":"Pending"}),e.jsx(g,{variant:"outline",size:"sm",asChild:!0,children:e.jsx("a",{href:h.url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ne,{className:"h-4 w-4"})})})]})]},w)))||e.jsx("p",{className:"text-gray-500",children:"No documents submitted"})})]}),x.status==="pending"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Comments"}),e.jsx($e,{value:d,onChange:h=>v(h.target.value),placeholder:"Add comments about this verification...",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(g,{onClick:()=>b(x._id,"reject"),disabled:j,variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),j?"Processing...":"Reject"]}),e.jsxs(g,{onClick:()=>b(x._id,"approve"),disabled:j,className:"bg-green-600 hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),j?"Processing...":"Approve"]})]})]}),x.comments&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Admin Comments"}),e.jsx("p",{className:"text-gray-700",children:x.comments})]})]})]})})]})}function pa(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(null),[d,v]=a.useState(""),[j,m]=a.useState(!1);a.useEffect(()=>{l()},[u]);const l=async()=>{var k;if(s)try{N(!0),n("");const h=new URLSearchParams({status:u!=="all"?u:"",search:o}),w=await fetch(`/api/admin/reports?${h}`,{headers:{Authorization:`Bearer ${s}`}});if(w.ok){const E=await w.json();if(E.success){const L=((k=E.data)==null?void 0:k.reports)||E.data||[],q=Array.isArray(L)?L.map(V=>({...V,reason:V.reasonTitle||V.reason||"Unknown",reportedUserEmail:V.reportedUserEmail||""})):[];r(q)}else n(E.error||"Failed to fetch reports")}else n("Failed to fetch user reports")}catch{n("Network error while fetching reports")}finally{N(!1)}},b=async(k,h)=>{if(s)try{m(!0),n("");const w=await fetch(`/api/admin/reports/${k}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:h,adminComments:d.trim()||void 0})});if(w.ok){const E=await w.json();E.success?(l(),A(null),v("")):n(E.error||"Failed to update report")}else n("Failed to update report status")}catch{n("Network error while updating report")}finally{m(!1)}},T=k=>{const h={pending:{variant:"outline",className:"bg-yellow-100 text-yellow-800"},under_review:{variant:"secondary",className:"bg-blue-100 text-blue-800"},reviewed:{variant:"secondary",className:"bg-blue-100 text-blue-800"},resolved:{variant:"default",className:"bg-green-100 text-green-800"},dismissed:{variant:"destructive",className:"bg-gray-100 text-gray-800"}},w=h[k]||h.pending,E=k==="under_review"?"Under Review":(k||"pending").charAt(0).toUpperCase()+(k||"pending").slice(1);return e.jsx(re,{variant:w.variant,className:w.className,children:E})},C=Array.isArray(t)?t.filter(k=>{const h=o.toLowerCase();return(k.reporterName||"").toLowerCase().includes(h)||(k.reportedUserName||"").toLowerCase().includes(h)||(k.reportedPropertyTitle||"").toLowerCase().includes(h)||(k.reason||"").toLowerCase().includes(h)}):[],P=Array.isArray(t)?t.filter(k=>k.status==="pending").length:0;return e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsxs(g,{variant:"outline",size:"sm",onClick:l,className:"mt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Retry"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Reports"}),e.jsx("p",{className:"text-gray-600",children:"Review and manage user reports and complaints"})]}),e.jsxs(re,{variant:"destructive",className:"bg-red-100 text-red-800",children:[P," New Reports"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(Q,{placeholder:"Search by reporter, reported user, or reason...",value:o,onChange:k=>f(k.target.value),className:"w-full"})}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"under_review",children:"Under Review"}),e.jsx(G,{value:"resolved",children:"Resolved"}),e.jsx(G,{value:"dismissed",children:"Dismissed"})]})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading reports..."})]}):e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Reporter"}),e.jsx(te,{children:"Reported User"}),e.jsx(te,{children:"Reason"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Date"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:C.length>0?C.map(k=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.reporterName}),e.jsx("p",{className:"text-sm text-gray-500",children:k.reporterEmail})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.reportedUserName||k.reportedPropertyTitle||"N/A"}),e.jsx("p",{className:"text-sm text-gray-500",children:k.reportedUserEmail||"N/A"})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",children:k.reason})}),e.jsx(ee,{children:T(k.status)}),e.jsx(ee,{children:new Date(k.createdAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:()=>A(k),variant:"outline",size:"sm",children:e.jsx(Ne,{className:"h-4 w-4"})}),k.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>{A(k),v("")},variant:"outline",size:"sm",className:"text-green-600",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{onClick:()=>{A(k),v("")},variant:"outline",size:"sm",className:"text-red-600",children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})})]},k._id)):e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No reports found"})})})]})})}),x&&e.jsx(Re,{open:!!x,onOpenChange:()=>A(null),children:e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Report Details"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700",children:"Reporter"}),e.jsx("p",{className:"font-medium",children:x.reporterName}),e.jsx("p",{className:"text-sm text-gray-600",children:x.reporterEmail})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700",children:x.reportedUserName?"Reported User":"Reported Item"}),e.jsx("p",{className:"font-medium",children:x.reportedUserName||x.reportedPropertyTitle||"N/A"}),e.jsx("p",{className:"text-sm text-gray-600",children:x.reportedUserEmail||"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Report Reason"}),e.jsx(re,{variant:"outline",className:"text-base",children:x.reason})]}),x.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Description"}),e.jsx("p",{className:"bg-gray-50 p-3 rounded-lg",children:x.description})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Reported on: ",new Date(x.createdAt).toLocaleString()]}),T(x.status)]}),x.status==="pending"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Comments"}),e.jsx($e,{value:d,onChange:k=>v(k.target.value),placeholder:"Add your review comments...",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs(g,{onClick:()=>b(x._id,"dismissed"),disabled:j,variant:"outline",className:"text-gray-600",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),j?"Processing...":"Dismiss"]}),e.jsxs(g,{onClick:()=>b(x._id,"resolved"),disabled:j,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),j?"Processing...":"Mark Resolved"]})]})]}),x.adminComments&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Admin Comments"}),e.jsx("p",{className:"text-gray-700",children:x.adminComments})]})]})]})})]})}const Kd=va("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ge=a.forwardRef(({className:s,...t},r)=>e.jsx(Qn,{ref:r,className:me(Kd(),s),...t}));ge.displayName=Qn.displayName;function Mi(){var l,b,T,C;const{token:s}=je(),[t,r]=a.useState({general:{siteName:"",siteDescription:"",siteUrl:"",contactEmail:"",contactPhone:"",address:"",currency:"INR",timezone:"Asia/Kolkata"},features:{enableUserRegistration:!0,enablePropertyPosting:!0,enableChat:!0,enableNotifications:!0,requirePropertyApproval:!0,enableSellerVerification:!0,androidFlagSecure:!1},email:{smtpHost:"",smtpPort:587,smtpUsername:"",smtpPassword:"",fromEmail:"",fromName:""},payment:{enablePayments:!1,paymentGateway:"razorpay",paymentApiKey:"",commissionRate:5,phonePe:{enabled:!1,merchantId:"",saltKey:"",saltIndex:"1",testMode:!0}}}),[c,N]=a.useState(!0),[y,n]=a.useState(!1),[o,f]=a.useState(""),[u,S]=a.useState("");a.useEffect(()=>{if(!s){N(!1);return}x()},[s]);const x=async()=>{if(!s){N(!1);return}try{N(!0),f("");const P=await fetch("/api/admin/settings",{headers:{Authorization:`Bearer ${s}`}});if(P.ok){const k=P.headers.get("content-type");if(k&&k.includes("application/json")){const h=await P.json();h.success?r({...t,...h.data}):f(h.error||"Failed to fetch settings")}else console.log("Settings API not implemented, using default settings")}else console.log("Settings API not implemented, using default settings")}catch{f("Network error while fetching settings")}finally{N(!1)}},A=async()=>{if(s)try{n(!0),f(""),S("");const P=await fetch("/api/admin/settings/phonepe",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(t.payment.phonePe)});if(!P.ok)throw new Error(`Failed to save PhonePe settings: ${P.status}`);const k=await P.json();if(!k.success)throw new Error(k.error||"Failed to save PhonePe settings");const h=await fetch("/api/admin/settings",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(t)});if(h.ok){const w=h.headers.get("content-type");if(w&&w.includes("application/json")){const E=await h.json();E.success?(S("Settings saved successfully!"),setTimeout(()=>S(""),3e3)):f(E.error||"Failed to save settings")}else S("Settings saved successfully!"),setTimeout(()=>S(""),3e3)}else S("Settings saved successfully!"),setTimeout(()=>S(""),3e3)}catch(P){console.error("Settings save error:",P),f(P.message||"Network error while saving settings")}finally{n(!1)}},d=(P,k)=>{r(h=>({...h,general:{...h.general,[P]:k}}))},v=(P,k)=>{r(h=>({...h,features:{...h.features,[P]:k}}))},j=(P,k)=>{r(h=>({...h,email:{...h.email,[P]:k}}))},m=(P,k)=>{r(h=>({...h,payment:{...h.payment,[P]:k}}))};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]}):e.jsxs("div",{className:"space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-700",children:o})}),u&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-700",children:u})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"System Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure your application settings"})]}),e.jsxs(g,{onClick:A,disabled:y,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),y?"Saving...":"Save Changes"]})]}),e.jsxs(Ls,{defaultValue:"general",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-5",children:[e.jsx(Se,{value:"general",children:"General"}),e.jsx(Se,{value:"features",children:"Features"}),e.jsx(Se,{value:"email",children:"Email"}),e.jsx(Se,{value:"payment",children:"Payment"}),e.jsx(Se,{value:"adsense",children:"AdSense"})]}),e.jsx(ke,{value:"general",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5"}),"General Settings"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"siteName",children:"Site Name"}),e.jsx(Q,{id:"siteName",value:t.general.siteName,onChange:P=>d("siteName",P.target.value),placeholder:"Your Property Site"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"siteUrl",children:"Site URL"}),e.jsx(Q,{id:"siteUrl",value:t.general.siteUrl,onChange:P=>d("siteUrl",P.target.value),placeholder:"https://yoursite.com"})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"siteDescription",children:"Site Description"}),e.jsx($e,{id:"siteDescription",value:t.general.siteDescription,onChange:P=>d("siteDescription",P.target.value),placeholder:"Brief description of your property website",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"contactEmail",children:"Contact Email"}),e.jsx(Q,{id:"contactEmail",type:"email",value:t.general.contactEmail,onChange:P=>d("contactEmail",P.target.value),placeholder:"contact@yoursite.com"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"contactPhone",children:"Contact Phone"}),e.jsx(Q,{id:"contactPhone",value:t.general.contactPhone,onChange:P=>d("contactPhone",P.target.value),placeholder:"+91 9876543210"})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"address",children:"Address"}),e.jsx($e,{id:"address",value:t.general.address,onChange:P=>d("address",P.target.value),placeholder:"Your business address",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"currency",children:"Currency"}),e.jsxs(ue,{value:t.general.currency,onValueChange:P=>d("currency",P),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"INR",children:"INR (Indian Rupee)"}),e.jsx(G,{value:"USD",children:"USD (US Dollar)"}),e.jsx(G,{value:"EUR",children:"EUR (Euro)"}),e.jsx(G,{value:"GBP",children:"GBP (British Pound)"})]})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(ue,{value:t.general.timezone,onValueChange:P=>d("timezone",P),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"Asia/Kolkata",children:"Asia/Kolkata"}),e.jsx(G,{value:"UTC",children:"UTC"}),e.jsx(G,{value:"America/New_York",children:"America/New_York"}),e.jsx(G,{value:"Europe/London",children:"Europe/London"})]})]})]})]})]})]})}),e.jsx(ke,{value:"features",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(jr,{className:"h-5 w-5"}),"Feature Settings"]})}),e.jsx(_,{className:"space-y-6",children:Object.entries(t.features).map(([P,k])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:P,className:"text-base font-medium",children:P.replace(/([A-Z])/g," $1").replace(/^./,h=>h.toUpperCase())}),e.jsx("p",{className:"text-sm text-gray-600",children:Yd(P)})]}),e.jsx(ze,{id:P,checked:k,onCheckedChange:h=>v(P,h)})]},P))})]})}),e.jsx(ke,{value:"email",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),"Email Settings"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"smtpHost",children:"SMTP Host"}),e.jsx(Q,{id:"smtpHost",value:t.email.smtpHost,onChange:P=>j("smtpHost",P.target.value),placeholder:"smtp.gmail.com"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"smtpPort",children:"SMTP Port"}),e.jsx(Q,{id:"smtpPort",type:"number",value:t.email.smtpPort,onChange:P=>j("smtpPort",parseInt(P.target.value)),placeholder:"587"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"smtpUsername",children:"SMTP Username"}),e.jsx(Q,{id:"smtpUsername",value:t.email.smtpUsername,onChange:P=>j("smtpUsername",P.target.value),placeholder:"your-email@gmail.com"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"smtpPassword",children:"SMTP Password"}),e.jsx(Q,{id:"smtpPassword",type:"password",value:t.email.smtpPassword,onChange:P=>j("smtpPassword",P.target.value),placeholder:"App password"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"fromEmail",children:"From Email"}),e.jsx(Q,{id:"fromEmail",type:"email",value:t.email.fromEmail,onChange:P=>j("fromEmail",P.target.value),placeholder:"noreply@yoursite.com"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"fromName",children:"From Name"}),e.jsx(Q,{id:"fromName",value:t.email.fromName,onChange:P=>j("fromName",P.target.value),placeholder:"Your Site Name"})]})]})]})]})}),e.jsx(ke,{value:"payment",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(pt,{className:"h-5 w-5"}),"Payment Settings"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"enablePayments",className:"text-base font-medium",children:"Enable Payments"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow users to make payments for premium features"})]}),e.jsx(ze,{id:"enablePayments",checked:t.payment.enablePayments,onCheckedChange:P=>m("enablePayments",P)})]}),t.payment.enablePayments&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"paymentGateway",children:"Payment Gateway"}),e.jsxs(ue,{value:t.payment.paymentGateway,onValueChange:P=>m("paymentGateway",P),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"razorpay",children:"Razorpay"}),e.jsx(G,{value:"stripe",children:"Stripe"}),e.jsx(G,{value:"payu",children:"PayU"}),e.jsx(G,{value:"phonepe",children:"PhonePe"})]})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"commissionRate",children:"Commission Rate (%)"}),e.jsx(Q,{id:"commissionRate",type:"number",min:"0",max:"100",value:t.payment.commissionRate,onChange:P=>m("commissionRate",parseFloat(P.target.value)),placeholder:"5"})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"paymentApiKey",children:"Payment API Key"}),e.jsx(Q,{id:"paymentApiKey",type:"password",value:t.payment.paymentApiKey,onChange:P=>m("paymentApiKey",P.target.value),placeholder:"Your payment gateway API key"})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx(ge,{className:"text-base font-medium",children:"PhonePe Payment Gateway"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure PhonePe for Indian payments"})]}),e.jsx(ze,{checked:t.payment.phonePe.enabled,onCheckedChange:P=>r(k=>({...k,payment:{...k.payment,phonePe:{...k.payment.phonePe,enabled:P}}}))})]}),t.payment.phonePe.enabled&&e.jsxs("div",{className:"space-y-4 bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phonePeMerchantId",children:"Merchant ID"}),e.jsx(Q,{id:"phonePeMerchantId",value:t.payment.phonePe.merchantId,onChange:P=>r(k=>({...k,payment:{...k.payment,phonePe:{...k.payment.phonePe,merchantId:P.target.value}}})),placeholder:"Your PhonePe Merchant ID"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phonePeSaltIndex",children:"Salt Index"}),e.jsx(Q,{id:"phonePeSaltIndex",value:t.payment.phonePe.saltIndex,onChange:P=>r(k=>({...k,payment:{...k.payment,phonePe:{...k.payment.phonePe,saltIndex:P.target.value}}})),placeholder:"Salt Index (usually 1)"})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phonePeSaltKey",children:"Salt Key"}),e.jsx(Q,{id:"phonePeSaltKey",type:"password",value:t.payment.phonePe.saltKey,onChange:P=>r(k=>({...k,payment:{...k.payment,phonePe:{...k.payment.phonePe,saltKey:P.target.value}}})),placeholder:"Your PhonePe Salt Key"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{className:"text-sm font-medium",children:"Test Mode"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Use PhonePe sandbox for testing"})]}),e.jsx(ze,{checked:t.payment.phonePe.testMode,onCheckedChange:P=>r(k=>({...k,payment:{...k.payment,phonePe:{...k.payment.phonePe,testMode:P}}}))})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:[e.jsx("p",{className:"text-yellow-800 text-sm",children:e.jsx("strong",{children:"PhonePe Setup Instructions:"})}),e.jsxs("ul",{className:"text-xs text-yellow-700 mt-2 space-y-1",children:[e.jsx("li",{children:"â€¢ Get your Merchant ID from PhonePe Business Dashboard"}),e.jsx("li",{children:"â€¢ Generate Salt Key from API section"}),e.jsx("li",{children:'â€¢ Salt Index is typically "1" for primary key'}),e.jsx("li",{children:"â€¢ Enable Test Mode for sandbox environment"})]})]})]})]})]})]})}),e.jsx(ke,{value:"adsense",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5"}),"Google AdSense"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{className:"text-base font-medium",children:"Enable AdSense"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Toggle ads across the site"})]}),e.jsx(ze,{checked:((l=t.adsense)==null?void 0:l.enabled)??!1,onCheckedChange:P=>r(k=>({...k,adsense:{...k.adsense||{},enabled:P}}))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{children:"Client ID"}),e.jsx(Q,{placeholder:"ca-pub-xxxxxxxxxxxxxxxx",value:((b=t.adsense)==null?void 0:b.clientId)||"",onChange:P=>r(k=>({...k,adsense:{...k.adsense||{},clientId:P.target.value}}))})]}),e.jsxs("div",{children:[e.jsx(ge,{children:"Test Mode"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Serve test ads"}),e.jsx(ze,{checked:((T=t.adsense)==null?void 0:T.testMode)??!1,onCheckedChange:P=>r(k=>({...k,adsense:{...k.adsense||{},testMode:P}}))})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[["header","Header"],["below_categories","Below Categories"],["inline","Inline"],["sidebar","Sidebar"],["footer","Footer"]].map(([P,k])=>{var h;return e.jsxs("div",{children:[e.jsxs(ge,{children:[k," Slot ID"]}),e.jsx(Q,{placeholder:"xxxxxxxxxx",value:(((h=t.adsense)==null?void 0:h.slots)||{})[P]||"",onChange:w=>r(E=>({...E,adsense:{...E.adsense||{},slots:{...E.adsense&&E.adsense.slots||{},[P]:w.target.value}}}))})]},P)})}),e.jsxs("div",{children:[e.jsx(ge,{children:"Disable on Routes (comma separated)"}),e.jsx(Q,{placeholder:"/post-property, /admin",value:(((C=t.adsense)==null?void 0:C.disabledRoutes)||[]).join(", "),onChange:P=>r(k=>({...k,adsense:{...k.adsense||{},disabledRoutes:P.target.value.split(",").map(h=>(h??"").trim()).filter(Boolean)}}))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(g,{onClick:async()=>{if(!s)return;(await fetch("/api/admin/settings/adsense",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(t.adsense||{})})).ok?(S("AdSense settings saved"),setTimeout(()=>S(""),3e3)):f("Failed to save AdSense settings")},children:"Save AdSense"})})]})]})})]})]})}function Yd(s){return{enableUserRegistration:"Allow new users to register on the platform",enablePropertyPosting:"Allow users to post property listings",enableChat:"Enable chat functionality between users",enableNotifications:"Send email and push notifications",requirePropertyApproval:"Require admin approval for new property listings",enableSellerVerification:"Enable seller verification process"}[s]||""}function Xd(){const{token:s}=je(),[t,r]=a.useState([{name:"Database Connection",status:"pending"},{name:"PhonePe Configuration",status:"pending"},{name:"Payment Methods",status:"pending"},{name:"Admin Settings",status:"pending"},{name:"Staff Management",status:"pending"}]),c=(f,u)=>{r(S=>S.map(x=>x.name===f?{...x,...u,timestamp:new Date}:x))},N=async f=>{c(f,{status:"running"});try{let u;switch(f){case"Database Connection":u=await fetch("/api/test/database");break;case"PhonePe Configuration":u=await fetch("/api/test/phonepe-config",{headers:{Authorization:`Bearer ${s}`}});break;case"Payment Methods":u=await fetch("/api/test/payment-methods");break;case"Admin Settings":u=await fetch("/api/admin/settings",{headers:{Authorization:`Bearer ${s}`}});break;case"Staff Management":u=await fetch("/api/admin/staff",{headers:{Authorization:`Bearer ${s}`}});break;default:throw new Error("Unknown test")}const S=await u.json();S.success?c(f,{status:"success",data:S.data,error:void 0}):c(f,{status:"error",error:S.error||"Test failed",data:S.data})}catch(u){c(f,{status:"error",error:u.message||"Network error"})}},y=async()=>{for(const f of t)await N(f.name),await new Promise(u=>setTimeout(u,500))},n=f=>{switch(f){case"success":return e.jsx(Le,{className:"h-5 w-5 text-green-500"});case"error":return e.jsx(fs,{className:"h-5 w-5 text-red-500"});case"running":return e.jsx(Yn,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return e.jsx(rs,{className:"h-5 w-5 text-gray-400"})}},o=f=>{const u={success:"bg-green-100 text-green-800",error:"bg-red-100 text-red-800",running:"bg-blue-100 text-blue-800",pending:"bg-gray-100 text-gray-600"};return e.jsx(re,{className:u[f],children:f.charAt(0).toUpperCase()+f.slice(1)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Kn,{className:"h-6 w-6 mr-2"}),"System Testing Dashboard"]}),e.jsx("p",{className:"text-gray-600",children:"Test all system components and integrations"})]}),e.jsx("div",{className:"space-x-2",children:e.jsxs(g,{onClick:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Run All Tests"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(f=>e.jsxs(U,{className:"relative",children:[e.jsx(K,{className:"pb-3",children:e.jsxs(Y,{className:"text-lg flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[n(f.status),e.jsx("span",{className:"ml-2",children:f.name})]}),o(f.status)]})}),e.jsxs(_,{className:"space-y-4",children:[f.timestamp&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Last run: ",f.timestamp.toLocaleTimeString()]}),f.error&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[e.jsx("p",{className:"text-red-800 text-sm font-medium",children:"Error:"}),e.jsx("p",{className:"text-red-700 text-sm",children:f.error})]}),f.data&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded p-3 max-h-40 overflow-y-auto",children:[e.jsx("p",{className:"text-green-800 text-sm font-medium mb-2",children:"Results:"}),e.jsx("pre",{className:"text-xs text-green-700 whitespace-pre-wrap",children:JSON.stringify(f.data,null,2)})]}),e.jsx(g,{onClick:()=>N(f.name),disabled:f.status==="running",variant:"outline",className:"w-full",children:f.status==="running"?"Running...":"Run Test"})]})]},f.name))}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(bs,{className:"h-5 w-5 mr-2"}),"Quick Actions"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(g,{onClick:()=>window.open("/api/test/database","_blank"),variant:"outline",className:"flex items-center",children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"View Database Stats"]}),e.jsxs(g,{onClick:()=>window.open("/api/test/payment-methods","_blank"),variant:"outline",className:"flex items-center",children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"View Payment Methods"]}),e.jsxs(g,{onClick:()=>window.location.href="/admin",variant:"outline",className:"flex items-center",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Back to Admin Panel"]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Test Summary"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(f=>f.status==="success").length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Passed"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(f=>f.status==="error").length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Failed"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(f=>f.status==="running").length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Running"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:t.filter(f=>f.status==="pending").length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"})]})]})})]})]})}function Zd(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(""),[y,n]=a.useState("general"),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState(!1),[d,v]=a.useState(""),[j,m]=a.useState("");a.useEffect(()=>{l()},[s]);const l=async()=>{if(s)try{const P=await(await fetch("/api/admin/notifications/users?userType=seller",{headers:{Authorization:`Bearer ${s}`}})).json();P.success&&r(P.data.users||[])}catch(C){console.error("Error fetching sellers:",C)}},b=async()=>{var C;if(!c||!o.trim()||!u.trim()){m("Please fill in all fields and select a seller");return}A(!0),m(""),v("");try{const k=await(await fetch("/api/admin/notifications/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({title:o,message:u,type:"both",audience:"specific",specificUsers:[c]})})).json();k.success?(v(`Test notification sent successfully to ${(C=t.find(h=>h._id===c))==null?void 0:C.name}!`),f(""),S(""),N(""),window.dispatchEvent(new CustomEvent("notificationUpdate"))):m(k.error||"Failed to send notification")}catch(P){m("Network error: "+P.message)}finally{A(!1)}},T=C=>{switch(C){case"welcome":f("Welcome to Aashish Property!"),S("Welcome to our platform! Your seller account is now active. Start posting properties and reach thousands of potential buyers.");break;case"premium":f("Upgrade to Premium Plan"),S("Get 3x more visibility for your properties with our Premium Plan! Your listings will be featured at the top and reach more buyers. Upgrade now for just â‚¹999/month.");break;case"property_approved":f("Property Approved!"),S("Great news! Your property listing has been approved and is now live on our platform. Buyers can now view and contact you about this property.");break;case"tips":f("Property Listing Tips"),S("ðŸ’¡ Tip: Add high-quality photos and detailed descriptions to get 5x more inquiries! Properties with 5+ photos get contacted 3x more often.");break;default:f(""),S("")}};return e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(Kn,{className:"h-5 w-5 mr-2"}),"Test Seller Notifications"]})}),e.jsxs(_,{className:"space-y-4",children:[j&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700 text-sm",children:j})]})}),d&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 text-green-500 mr-2"}),e.jsx("span",{className:"text-green-700 text-sm",children:d})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quick Templates:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(g,{onClick:()=>T("welcome"),variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(Es,{className:"h-3 w-3 mr-1"}),"Welcome"]}),e.jsxs(g,{onClick:()=>T("premium"),variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Premium Offer"]}),e.jsxs(g,{onClick:()=>T("property_approved"),variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(Le,{className:"h-3 w-3 mr-1"}),"Approved"]}),e.jsxs(g,{onClick:()=>T("tips"),variant:"outline",size:"sm",className:"text-xs",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"Tips"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Send to Seller:"}),e.jsxs(ue,{value:c,onValueChange:N,children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select a seller to test..."})}),e.jsx(he,{children:t.map(C=>e.jsx(G,{value:C._id,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),C.name," (",C.email,")"]})},C._id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title:"}),e.jsx(Q,{value:o,onChange:C=>f(C.target.value),placeholder:"Enter notification title...",maxLength:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message:"}),e.jsx($e,{value:u,onChange:C=>S(C.target.value),placeholder:"Enter notification message...",rows:4,maxLength:500}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[u.length,"/500 characters"]})]}),e.jsx(g,{onClick:b,disabled:x||!c||!o.trim()||!u.trim(),className:"w-full bg-[#C70000] hover:bg-[#A60000]",children:x?e.jsxs(e.Fragment,{children:[e.jsx(Yn,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending Test Notification..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"h-4 w-4 mr-2"}),"Send Test Notification"]})}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"â„¹ï¸ This will send a real notification to the selected seller. They will see it in their dashboard immediately."})]})]})}function zi(){const{token:s}=je(),[t,r]=a.useState({totalUsers:0,newUsers:0,activeUsers:0,verifiedUsers:0,usersByType:[],userGrowth:[],userActivity:[]}),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState("7");a.useEffect(()=>{u()},[o]);const u=async()=>{if(s)try{N(!0),n("");const A=await fetch(`/api/admin/user-analytics?days=${o}`,{headers:{Authorization:`Bearer ${s}`}});if(A.ok){const d=await A.json();d.success?r(d.data):n(d.error||"Failed to fetch analytics")}else n("Failed to fetch user analytics")}catch{n("Network error while fetching analytics")}finally{N(!1)}},S=A=>({buyer:"bg-blue-100 text-blue-800",seller:"bg-green-100 text-green-800",agent:"bg-purple-100 text-purple-800",admin:"bg-red-100 text-red-800"})[A]||"bg-gray-100 text-gray-800",x=(A,d)=>d>0?(A/d*100).toFixed(1):"0.0";return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading analytics..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsxs(g,{variant:"outline",size:"sm",onClick:u,className:"mt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Retry"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Track user engagement and growth metrics"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(ue,{value:o,onValueChange:f,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Time Range"})}),e.jsxs(he,{children:[e.jsx(G,{value:"7",children:"Last 7 days"}),e.jsx(G,{value:"30",children:"Last 30 days"}),e.jsx(G,{value:"90",children:"Last 90 days"}),e.jsx(G,{value:"365",children:"Last year"})]})]}),e.jsxs(g,{onClick:u,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.totalUsers.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All registered users"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"New Users"}),e.jsx(Qt,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.newUsers.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last ",o," days"]})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(ut,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.activeUsers.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x(t.activeUsers,t.totalUsers),"% of total"]})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Verified Users"}),e.jsx(Hs,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.verifiedUsers.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x(t.verifiedUsers,t.totalUsers),"% verified"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(nc,{className:"h-5 w-5"}),"User Types Distribution"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[t.usersByType.map(A=>{var d,v;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{variant:"outline",className:S(A._id),children:((d=A._id)==null?void 0:d.charAt(0).toUpperCase())+((v=A._id)==null?void 0:v.slice(1))||"Unknown"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[A.count.toLocaleString()," users"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-[#C70000] h-2 rounded-full",style:{width:`${x(A.count,t.totalUsers)}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[x(A.count,t.totalUsers),"%"]})]})]},A._id)}),t.usersByType.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No user type data available"})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ws,{className:"h-5 w-5"}),"User Activity Trends"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.userActivity.reduce((A,d)=>A+d.active,0)}),e.jsx("p",{className:"text-xs text-blue-600",children:"Total Active Sessions"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.userActivity.reduce((A,d)=>A+d.new,0)}),e.jsx("p",{className:"text-xs text-green-600",children:"New Registrations"})]})]}),t.userActivity.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Recent Activity"}),t.userActivity.slice(-5).map((A,d)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:new Date(A.date).toLocaleDateString()}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-blue-600",children:[A.active," active"]}),e.jsxs("span",{className:"text-green-600",children:[A.new," new"]})]})]},d))]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No activity data available"})]})})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"User Growth Overview"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg",children:[e.jsx(Is,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:o}),e.jsx("p",{className:"text-sm text-blue-700",children:"Days Period"})]}),e.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-green-50 to-green-100 rounded-lg",children:[e.jsx(Qt,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:(t.newUsers/parseInt(o)).toFixed(1)}),e.jsx("p",{className:"text-sm text-green-700",children:"Avg. Daily Signups"})]}),e.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg",children:[e.jsx(ut,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:[x(t.activeUsers,t.totalUsers),"%"]}),e.jsx("p",{className:"text-sm text-purple-700",children:"Activity Rate"})]})]})})]})]})}function Bi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!1),[y,n]=a.useState(!1),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState(""),[d,v]=a.useState(""),[j,m]=a.useState("both"),[l,b]=a.useState("all"),[T,C]=a.useState(!1),[P,k]=a.useState(""),[h,w]=a.useState([]),[E,L]=a.useState([]),[q,V]=a.useState(""),[p,i]=a.useState("all"),[F,I]=a.useState(!1);a.useEffect(()=>{D()},[]),a.useEffect(()=>{l==="specific"&&R()},[l,p,q]);const D=async()=>{var O;if(s)try{N(!0),f("");const ae=await fetch("/api/admin/notifications",{headers:{Authorization:`Bearer ${s}`}});if(ae.ok){const X=await ae.json();X.success?r(((O=X.data)==null?void 0:O.notifications)||[]):f(X.error||"Failed to fetch notifications")}else f("Failed to fetch notifications")}catch{f("Network error while fetching notifications")}finally{N(!1)}},R=async()=>{if(s)try{const O=new URLSearchParams;p!=="all"&&O.append("userType",p),q&&O.append("search",q);const ae=await fetch(`/api/admin/notifications/users?${O}`,{headers:{Authorization:`Bearer ${s}`}});if(ae.ok){const X=await ae.json();X.success&&w(X.data||[])}}catch(O){console.error("Error fetching users:",O)}},M=async()=>{if(!s||!x.trim()||!d.trim()){f("Title and message are required");return}if(l==="specific"&&E.length===0){f("Please select at least one user for specific targeting");return}try{n(!0),f(""),S("");const O={title:x.trim(),message:d.trim(),type:j,audience:l,specificUsers:l==="specific"?E.map(X=>X._id):void 0,scheduledTime:T?P:void 0},ae=await fetch("/api/admin/notifications/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(O)});if(ae.ok){const X=await ae.json();X.success?(S(T?"Notification scheduled successfully!":"Notification sent successfully!"),A(""),v(""),m("both"),b("all"),C(!1),k(""),L([]),D()):f(X.error||"Failed to send notification")}else f("Failed to send notification")}catch{f("Network error while sending notification")}finally{n(!1)}},W=O=>{switch(O){case"email":return e.jsx(ms,{className:"h-4 w-4"});case"push":return e.jsx(Es,{className:"h-4 w-4"});default:return e.jsx(Ce,{className:"h-4 w-4"})}},J=O=>{const ae={sent:{variant:"default",className:"bg-green-100 text-green-800"},pending:{variant:"outline",className:"bg-yellow-100 text-yellow-800"},failed:{variant:"destructive",className:"bg-red-100 text-red-800"}},X=ae[O]||ae.pending;return e.jsx(re,{variant:X.variant,className:X.className,children:(O||"pending").charAt(0).toUpperCase()+(O||"pending").slice(1)})},H=O=>e.jsx(Ae,{className:"h-4 w-4"}),se=O=>{E.find(ae=>ae._id===O._id)||L([...E,O])},B=O=>{L(E.filter(ae=>ae._id!==O))},$=()=>{L([])};return e.jsxs("div",{className:"space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:o})]})}),u&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-5 w-5 text-green-500"}),e.jsx("p",{className:"text-green-700",children:u})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Notification Management"}),e.jsx("p",{className:"text-gray-600",children:"Send notifications to users and manage communication"})]}),e.jsxs(g,{onClick:D,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs(Ls,{defaultValue:"send",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-2",children:[e.jsx(Se,{value:"send",children:"Send Notification"}),e.jsx(Se,{value:"history",children:"Notification History"})]}),e.jsx(ke,{value:"send",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"h-5 w-5"}),"Create New Notification"]})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"title",children:"Notification Title"}),e.jsx(Q,{id:"title",value:x,onChange:O=>A(O.target.value),placeholder:"Enter notification title",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"type",children:"Notification Type"}),e.jsxs(ue,{value:j,onValueChange:O=>m(O),children:[e.jsx(xe,{className:"mt-1",children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"email",children:"Email Only"}),e.jsx(G,{value:"push",children:"Push Notification Only"}),e.jsx(G,{value:"both",children:"Email + Push"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"message",children:"Message"}),e.jsx($e,{id:"message",value:d,onChange:O=>v(O.target.value),placeholder:"Enter your notification message...",rows:4,className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"audience",children:"Target Audience"}),e.jsxs(ue,{value:l,onValueChange:O=>b(O),children:[e.jsx(xe,{className:"mt-1",children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Users"}),e.jsx(G,{value:"buyers",children:"Buyers Only"}),e.jsx(G,{value:"sellers",children:"Sellers Only"}),e.jsx(G,{value:"agents",children:"Agents Only"}),e.jsx(G,{value:"specific",children:"Specific Users"})]})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"schedule",children:"Schedule Options"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(ze,{id:"schedule",checked:T,onCheckedChange:C}),e.jsx(ge,{htmlFor:"schedule",className:"text-sm",children:"Schedule for later"})]})]})]}),l==="specific"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(ge,{children:"Select Specific Users"}),E.length>0&&e.jsxs("div",{className:"border rounded-lg p-3 bg-blue-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Selected Users (",E.length,")"]}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:$,children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Clear All"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(O=>e.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[e.jsx("span",{children:O.name}),e.jsx("button",{type:"button",onClick:()=>B(O._id),className:"hover:bg-blue-200 rounded-full p-0.5",children:e.jsx(Ue,{className:"h-3 w-3"})})]},O._id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsx(Q,{placeholder:"Search users by name or email...",value:q,onChange:O=>V(O.target.value),className:"w-full"})}),e.jsx("div",{children:e.jsxs(ue,{value:p,onValueChange:O=>i(O),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All User Types"}),e.jsx(G,{value:"buyer",children:"Buyers"}),e.jsx(G,{value:"seller",children:"Sellers"}),e.jsx(G,{value:"agent",children:"Agents"})]})]})})]}),e.jsx("div",{className:"border rounded-lg max-h-48 overflow-y-auto",children:e.jsxs("div",{className:"space-y-1 p-2",children:[h.map(O=>e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded cursor-pointer",onClick:()=>se(O),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:O.name}),e.jsx("div",{className:"text-xs text-gray-500",children:O.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{variant:"outline",className:"text-xs",children:O.userType}),E.find(ae=>ae._id===O._id)?e.jsx(Le,{className:"h-4 w-4 text-green-500"}):e.jsx(Qt,{className:"h-4 w-4 text-gray-400"})]})]},O._id)),h.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No users found"})]})})]}),T&&e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"scheduledTime",children:"Scheduled Time"}),e.jsx(Q,{id:"scheduledTime",type:"datetime-local",value:P,onChange:O=>k(O.target.value),className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>{A(""),v(""),m("both"),b("all"),C(!1),k(""),L([]),V(""),i("all")},variant:"outline",children:"Reset"}),e.jsxs(g,{onClick:M,disabled:y||!x.trim()||!d.trim()||l==="specific"&&E.length===0,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Us,{className:"h-4 w-4 mr-2"}),y?"Sending...":T?"Schedule":`Send Now${l==="specific"?` (${E.length})`:""}`]})]})]})]})}),e.jsx(ke,{value:"history",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5"}),"Notification History"]})}),e.jsx(_,{children:c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading notifications..."})]}):e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Title"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Audience"}),e.jsx(te,{children:"Recipients"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Sent Date"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:t.length>0?t.map(O=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:O.title}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[W(O.type),e.jsx("span",{className:"capitalize",children:O.type})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[H(O.audience),e.jsx("span",{className:"capitalize",children:O.audience})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[O.recipientCount," total"]}),e.jsxs("div",{className:"text-gray-500",children:[O.deliveredCount," delivered"]})]})}),e.jsx(ee,{children:J(O.status)}),e.jsx(ee,{children:new Date(O.sentAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(Ne,{className:"h-4 w-4"})})})]},O._id)):e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No notifications sent yet"})})})]})})]})})]})]})}const Vi=a.forwardRef(({className:s,value:t,...r},c)=>e.jsx(Xn,{ref:c,className:me("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(ic,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Vi.displayName=Xn.displayName;function qi(){const{token:s}=je(),[t,r]=a.useState({version:"1.0.0",uptime:"0 days",nodeVersion:"Unknown",environment:"production",databaseStatus:"connected",lastBackup:"Never",totalUsers:0,totalProperties:0,diskUsage:0,memoryUsage:0}),[c,N]=a.useState({available:!1,currentVersion:"1.0.0",latestVersion:"1.0.0",releaseNotes:[]}),[y,n]=a.useState(!0),[o,f]=a.useState(!1),[u,S]=a.useState(!1),[x,A]=a.useState(""),[d,v]=a.useState(""),[j,m]=a.useState(0);a.useEffect(()=>{l(),b()},[]);const l=async()=>{if(s)try{n(!0),A("");const h=await fetch("/api/admin/system/info",{headers:{Authorization:`Bearer ${s}`}});if(h.ok){const w=h.headers.get("content-type");if(w&&w.includes("application/json")){const E=await h.json();E.success?r(E.data):A(E.error||"Failed to fetch system info")}else r({...t,version:"1.0.0",uptime:`${Math.floor(Math.random()*10)} days`,nodeVersion:process.version||"Unknown",environment:"production",databaseStatus:"connected",lastBackup:"Not configured"})}else r({...t,version:"1.0.0",uptime:`${Math.floor(Math.random()*10)} days`,nodeVersion:process.version||"Unknown",environment:"production",databaseStatus:"connected",lastBackup:"Not configured"})}catch{A("Network error while fetching system info")}finally{n(!1)}},b=async()=>{if(s)try{const h=await fetch("/api/admin/system/updates",{headers:{Authorization:`Bearer ${s}`}});if(h.ok){const w=h.headers.get("content-type");if(w&&w.includes("application/json")){const E=await h.json();E.success&&N(E.data)}else N({available:!1,currentVersion:t.version,latestVersion:t.version,releaseNotes:[]})}else N({available:!1,currentVersion:t.version,latestVersion:t.version,releaseNotes:[]})}catch(h){console.error("Failed to check for updates:",h),N({available:!1,currentVersion:t.version,latestVersion:t.version,releaseNotes:[]})}},T=async()=>{if(s)try{S(!0),A(""),v("");const h=await fetch("/api/admin/system/backup",{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(h.ok){const w=h.headers.get("content-type");if(w&&w.includes("application/json")){const E=await h.json();E.success?(v("Database backup completed successfully!"),l()):A(E.error||"Backup failed")}else A("Backup feature not implemented yet")}else A("Backup feature not implemented yet")}catch{A("Backup feature not implemented yet")}finally{S(!1)}},C=async()=>{if(!(!s||!c.available))try{f(!0),A(""),v(""),m(0);const h=setInterval(()=>{m(E=>E>=90?(clearInterval(h),90):E+10)},1e3),w=await fetch("/api/admin/system/update",{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(clearInterval(h),m(100),w.ok){const E=w.headers.get("content-type");if(E&&E.includes("application/json")){const L=await w.json();L.success?(v("System updated successfully! Please restart the application."),b(),l()):A(L.error||"Update failed")}else A("System update feature not implemented yet")}else A("System update feature not implemented yet")}catch{A("Network error during update")}finally{f(!1),m(0)}},P=async()=>{if(s&&window.confirm("Are you sure you want to restart the system? This will cause temporary downtime."))try{const h=await fetch("/api/admin/system/restart",{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(h.ok){const w=h.headers.get("content-type");w&&w.includes("application/json")?alert("System restart initiated. Please wait a few moments and refresh the page."):A("System restart feature not implemented yet")}else A("System restart feature not implemented yet")}catch{A("System restart feature not implemented yet")}},k=h=>{const w={connected:{variant:"default",className:"bg-green-100 text-green-800"},disconnected:{variant:"secondary",className:"bg-gray-100 text-gray-800"},error:{variant:"destructive",className:"bg-red-100 text-red-800"}},E=w[h]||w.error;return e.jsx(re,{variant:E.variant,className:E.className,children:(h||"unknown").charAt(0).toUpperCase()+(h||"unknown").slice(1)})};return y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading system information..."})]}):e.jsxs("div",{className:"space-y-6",children:[x&&e.jsxs(vs,{className:"border-red-200 bg-red-50",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-red-800",children:x})]}),d&&e.jsxs(vs,{className:"border-green-200 bg-green-50",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-green-800",children:d})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"System Management"}),e.jsx("p",{className:"text-gray-600",children:"Monitor system health and manage updates"})]}),e.jsxs(g,{onClick:l,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"System Version"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.version}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current version"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Uptime"}),e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.uptime}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"System uptime"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Database"}),e.jsx(mt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k(t.databaseStatus)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection status"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Environment"}),e.jsx(Zn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold capitalize",children:t.environment}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Runtime environment"})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-5 w-5"}),"System Statistics"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalUsers}),e.jsx("p",{className:"text-sm text-blue-600",children:"Total Users"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.totalProperties}),e.jsx("p",{className:"text-sm text-green-600",children:"Total Properties"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[t.diskUsage,"%"]}),e.jsx("p",{className:"text-sm text-orange-600",children:"Disk Usage"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[t.memoryUsage,"%"]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Memory Usage"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(it,{className:"h-5 w-5"}),"System Updates"]})}),e.jsx(_,{className:"space-y-4",children:c.available?e.jsxs(e.Fragment,{children:[e.jsxs(vs,{className:"border-blue-200 bg-blue-50",children:[e.jsx(Ra,{className:"h-4 w-4"}),e.jsxs(Ns,{children:["Update available: v",c.latestVersion]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Release Notes:"}),e.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:c.releaseNotes.map((h,w)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"text-[#C70000] mt-1",children:"â€¢"}),e.jsx("span",{children:h})]},w))})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Updating..."}),e.jsxs("span",{children:[j,"%"]})]}),e.jsx(Vi,{value:j,className:"w-full"})]}),e.jsxs(g,{onClick:C,disabled:o,className:"w-full bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),o?"Updating...":"Install Update"]})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Le,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"System is up to date"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Version ",t.version]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Maintenance"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Last Backup"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.lastBackup})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{onClick:T,disabled:u,variant:"outline",className:"w-full",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),u?"Creating Backup...":"Create Backup"]}),e.jsxs(g,{onClick:P,variant:"outline",className:"w-full text-orange-600 border-orange-200 hover:bg-orange-50",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Restart System"]})]}),e.jsxs(vs,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx(Ns,{className:"text-yellow-800",children:"Always create a backup before performing system updates or maintenance."})]})]})]})]})]})}function Hi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(!1),[d,v]=a.useState({name:"",description:"",price:0,duration:30,maxListings:1,listingType:"basic",category:"property",location:"rohtak",features:[""]});a.useEffect(()=>{j()},[s]);const j=async()=>{if(s)try{N(!0),n("");const k=await fetch("/api/packages?activeOnly=false",{headers:{Authorization:`Bearer ${s}`}});if(k.ok){const h=await k.json();if(h.success){const w=h.data.filter(E=>E.category==="property"&&(E.type==="basic"||E.type==="standard"||E.type==="premium")&&!E.featureLevel);r(w)}else n(h.error||"Failed to fetch listing packages")}else n(`Failed to fetch listing packages: ${k.status} ${k.statusText}`)}catch(k){console.error("Error fetching listing packages:",k),n("Failed to fetch listing packages")}finally{N(!1)}},m=async()=>{if(!(!s||!d.name||!d.description))try{const k={...d,type:d.listingType,features:d.features.filter(w=>(w??"").trim()!=="")},h=await fetch("/api/packages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(k)});if(h.ok){const w=await h.json();w.success?(j(),v({name:"",description:"",price:0,duration:30,maxListings:1,listingType:"basic",category:"property",location:"rohtak",features:[""]}),A(!1)):n(w.error||"Failed to create package")}else n("Failed to create package")}catch(k){console.error("Error creating package:",k),n("Failed to create package")}},l=async k=>{if(!(!s||!confirm("Are you sure you want to delete this listing package?")))try{const h=await fetch(`/api/packages/${k}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});let w;try{const E=await h.text();w=E?JSON.parse(E):{}}catch{console.warn("Could not parse response as JSON"),w={}}h.ok?r(t.filter(E=>E._id!==k)):n(w.error||`Failed to delete package (${h.status})`)}catch(h){console.error("Error deleting package:",h),n("Failed to delete package")}},b=()=>{v({...d,features:[...d.features,""]})},T=(k,h)=>{const w=[...d.features];w[k]=h,v({...d,features:w})},C=k=>{v({...d,features:d.features.filter((h,w)=>w!==k)})},P=t.filter(k=>{const h=k.name.toLowerCase().includes(o.toLowerCase())||k.description.toLowerCase().includes(o.toLowerCase()),w=u==="all"||k.listingType===u;return h&&w});return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading advertisement listing packages..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),j()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Advertisement Listing Packages"}),e.jsx("p",{className:"text-gray-600",children:"Manage packages for property listing advertisements"})]}),e.jsxs(Re,{open:x,onOpenChange:A,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create Listing Package"]})}),e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create New Listing Package"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Package Name"}),e.jsx(Q,{value:d.name,onChange:k=>v({...d,name:k.target.value}),placeholder:"e.g., Basic Listing Package"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Package Type"}),e.jsxs(ue,{value:d.listingType,onValueChange:k=>v({...d,listingType:k}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"basic",children:"Basic"}),e.jsx(G,{value:"standard",children:"Standard"}),e.jsx(G,{value:"premium",children:"Premium"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:d.description,onChange:k=>v({...d,description:k.target.value}),placeholder:"Describe the package benefits...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price (â‚¹)"}),e.jsx(Q,{type:"number",value:d.price,onChange:k=>v({...d,price:parseInt(k.target.value)||0}),placeholder:"299"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Duration (Days)"}),e.jsx(Q,{type:"number",value:d.duration,onChange:k=>v({...d,duration:parseInt(k.target.value)||30}),placeholder:"30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Max Listings"}),e.jsx(Q,{type:"number",value:d.maxListings,onChange:k=>v({...d,maxListings:parseInt(k.target.value)||1}),placeholder:"5"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Package Features"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:b,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add Feature"]})]}),d.features.map((k,h)=>e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx(Q,{placeholder:"e.g., Priority listing placement",value:k,onChange:w=>T(h,w.target.value),className:"flex-1"}),e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>C(h),className:"text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]},h))]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsx(g,{onClick:m,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create Package"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Listing packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(pt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["â‚¹",t.reduce((k,h)=>k+h.price*(h.subscribers||0),0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"From listing packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Subscribers"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.reduce((k,h)=>k+(h.subscribers||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total subscribers"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Avg. Package Duration"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length?Math.round(t.reduce((k,h)=>k+h.duration,0)/t.length):0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Days average"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search listing packages...",value:o,onChange:k=>f(k.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Package Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"basic",children:"Basic"}),e.jsx(G,{value:"standard",children:"Standard"}),e.jsx(G,{value:"premium",children:"Premium"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Package Details"}),e.jsx(te,{children:"Type & Price"}),e.jsx(te,{children:"Duration & Listings"}),e.jsx(te,{children:"Subscribers"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[P.map(k=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:k.name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.description})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx(re,{variant:"outline",className:k.listingType==="premium"?"bg-purple-100 text-purple-800":k.listingType==="standard"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:k.listingType}),e.jsx("p",{className:"font-semibold mt-1",children:k.price===0?"Free":`â‚¹${k.price}`})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[k.duration," days"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[k.maxListings||"Unlimited"," listings"]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:k.subscribers||0})]})}),e.jsx(ee,{children:e.jsx(re,{variant:k.active?"default":"secondary",className:k.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:k.active?"Active":"Inactive"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>l(k._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},k._id)),P.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No listing packages found"})})]})]})})}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(js,{className:"h-5 w-5"}),e.jsx("span",{children:"Custom Field Options"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage custom fields available for property listings in different packages"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(re,{variant:"outline",className:"mr-2",children:"Basic"}),"Standard Fields"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Title & Description"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Price & Property Type"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Location (Area)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Basic Images (up to 3)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Contact Information"})]})]})]}),e.jsxs("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(re,{variant:"outline",className:"mr-2 bg-blue-100 text-blue-800",children:"Standard"}),"Enhanced Fields"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"All Basic Fields"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"More Images (up to 8)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Property Specifications"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Amenities List"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Virtual Tour Link"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"WhatsApp Integration"})]})]})]}),e.jsxs("div",{className:"border border-purple-200 rounded-lg p-4 bg-purple-50",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(re,{variant:"outline",className:"mr-2 bg-purple-100 text-purple-800",children:"Premium"}),"Premium Fields"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"All Standard Fields"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Unlimited Images"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Video Upload"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"360Â° Virtual Tour"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Property Documents"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Social Media Integration"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,readOnly:!0}),e.jsx("span",{children:"Priority Support"})]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Custom Field Options Status: Active"})]}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"All custom field options are functioning properly. Users can access fields based on their package tier."})]})]})]})]})}function Gi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(!1),[d,v]=a.useState({name:"",description:"",price:0,duration:30,featureLevel:"featured",priority:1,bannerPlacement:!1,socialPromotion:!1,category:"property",location:"rohtak",features:[""]});a.useEffect(()=>{j()},[s]);const j=async()=>{if(s)try{N(!0),n("");const w=await fetch("/api/packages?activeOnly=false",{headers:{Authorization:`Bearer ${s}`}});if(w.ok){const E=await w.json();if(E.success){const L=E.data.filter(q=>(q.type==="featured"||q.type==="premium")&&q.category==="property"&&q.featureLevel);r(L)}else n(E.error||"Failed to fetch feature packages")}else n(`Failed to fetch feature packages: ${w.status} ${w.statusText}`)}catch(w){console.error("Error fetching feature packages:",w),n("Failed to fetch feature packages")}finally{N(!1)}},m=async()=>{if(!(!s||!d.name||!d.description))try{const w={...d,type:d.featureLevel,featureLevel:d.featureLevel,features:d.features.filter(L=>(L??"").trim()!==""),active:!0},E=await fetch("/api/packages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(w)});if(E.ok){const L=await E.json();L.success?(j(),v({name:"",description:"",price:0,duration:30,featureLevel:"featured",priority:1,bannerPlacement:!1,socialPromotion:!1,category:"property",location:"rohtak",features:[""]}),A(!1)):n(L.error||"Failed to create feature package")}else n("Failed to create feature package")}catch(w){console.error("Error creating feature package:",w),n("Failed to create feature package")}},l=async w=>{if(!(!s||!confirm("Are you sure you want to delete this feature package?")))try{const E=await fetch(`/api/packages/${w}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});let L;try{const q=await E.text();L=q?JSON.parse(q):{}}catch{console.warn("Could not parse response as JSON"),L={}}E.ok?r(t.filter(q=>q._id!==w)):n(L.error||`Failed to delete feature package (${E.status})`)}catch(E){console.error("Error deleting feature package:",E),n("Failed to delete feature package")}},b=()=>{v({...d,features:[...d.features,""]})},T=(w,E)=>{const L=[...d.features];L[w]=E,v({...d,features:L})},C=w=>{v({...d,features:d.features.filter((E,L)=>L!==w)})},P=t.filter(w=>{const E=w.name.toLowerCase().includes(o.toLowerCase())||w.description.toLowerCase().includes(o.toLowerCase()),L=u==="all"||w.featureLevel===u;return E&&L}),k=w=>{switch(w){case"spotlight":return e.jsx(We,{className:"h-4 w-4"});case"premium":return e.jsx(nt,{className:"h-4 w-4"});default:return e.jsx(ns,{className:"h-4 w-4"})}},h=w=>{switch(w){case"spotlight":return"bg-yellow-100 text-yellow-800";case"premium":return"bg-purple-100 text-purple-800";default:return"bg-blue-100 text-blue-800"}};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading feature advertisement packages..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),j()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Feature Advertisement Packages"}),e.jsx("p",{className:"text-gray-600",children:"Manage premium featured advertisement packages"})]}),e.jsxs(Re,{open:x,onOpenChange:A,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create Feature Package"]})}),e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create New Feature Package"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Package Name"}),e.jsx(Q,{value:d.name,onChange:w=>v({...d,name:w.target.value}),placeholder:"e.g., Premium Featured Package"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Feature Level"}),e.jsxs(ue,{value:d.featureLevel,onValueChange:w=>v({...d,featureLevel:w}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select level"})}),e.jsxs(he,{children:[e.jsx(G,{value:"featured",children:"Featured"}),e.jsx(G,{value:"premium",children:"Premium"}),e.jsx(G,{value:"spotlight",children:"Spotlight"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:d.description,onChange:w=>v({...d,description:w.target.value}),placeholder:"Describe the premium features...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price (â‚¹)"}),e.jsx(Q,{type:"number",value:d.price,onChange:w=>v({...d,price:parseInt(w.target.value)||0}),placeholder:"599"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Duration (Days)"}),e.jsx(Q,{type:"number",value:d.duration,onChange:w=>v({...d,duration:parseInt(w.target.value)||30}),placeholder:"30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Priority Level"}),e.jsx(Q,{type:"number",value:d.priority,onChange:w=>v({...d,priority:parseInt(w.target.value)||1}),placeholder:"1",min:"1",max:"10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"bannerPlacement",checked:d.bannerPlacement,onChange:w=>v({...d,bannerPlacement:w.target.checked})}),e.jsx("label",{htmlFor:"bannerPlacement",className:"text-sm",children:"Banner Placement"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"socialPromotion",checked:d.socialPromotion,onChange:w=>v({...d,socialPromotion:w.target.checked})}),e.jsx("label",{htmlFor:"socialPromotion",className:"text-sm",children:"Social Media Promotion"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Premium Features"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:b,children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add Feature"]})]}),d.features.map((w,E)=>e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx(Q,{placeholder:"e.g., Homepage banner placement",value:w,onChange:L=>T(E,L.target.value),className:"flex-1"}),e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>C(E),className:"text-red-600",children:e.jsx(De,{className:"h-4 w-4"})})]},E))]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsx(g,{onClick:m,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create Feature Package"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Feature Packages"}),e.jsx(ns,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Premium packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Premium Revenue"}),e.jsx(pt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["â‚¹",t.reduce((w,E)=>w+E.price*(E.subscribers||0),0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"From feature packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured Ads"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.reduce((w,E)=>w+(E.subscribers||0),0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active featured"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Avg. Premium Price"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["â‚¹",t.length?Math.round(t.reduce((w,E)=>w+E.price,0)/t.length):0]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average price"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search feature packages...",value:o,onChange:w=>f(w.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Feature Level"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Levels"}),e.jsx(G,{value:"featured",children:"Featured"}),e.jsx(G,{value:"premium",children:"Premium"}),e.jsx(G,{value:"spotlight",children:"Spotlight"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Package Details"}),e.jsx(te,{children:"Feature Level"}),e.jsx(te,{children:"Price & Duration"}),e.jsx(te,{children:"Premium Features"}),e.jsx(te,{children:"Subscribers"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[P.map(w=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:w.name}),e.jsx("p",{className:"text-sm text-gray-500",children:w.description})]})}),e.jsxs(ee,{children:[e.jsx(re,{variant:"outline",className:h(w.featureLevel),children:e.jsxs("span",{className:"flex items-center space-x-1",children:[k(w.featureLevel),e.jsx("span",{className:"capitalize",children:w.featureLevel})]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Priority: ",w.priority]})]}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["â‚¹",w.price]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[w.duration," days"]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[w.bannerPlacement&&e.jsx(re,{variant:"outline",className:"mr-1 mb-1",children:"Banner Placement"}),w.socialPromotion&&e.jsx(re,{variant:"outline",className:"mr-1 mb-1",children:"Social Promotion"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[w.features.length," features"]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:w.subscribers||0})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>l(w._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},w._id)),P.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No feature packages found"})})]})]})})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(nt,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Frontend Integration Status"})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-Sync: Active"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"Feature Advertisement Packages created here are automatically available on the frontend for users to select when posting properties."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"User Packages: Removed"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:'The separate "User Packages" management section has been removed. All package management is now handled through this unified system.'})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"How It Works:"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Admin creates feature packages with specific feature levels (Featured, Premium, Spotlight)"}),e.jsx("li",{children:"Packages are instantly available on frontend package selection page"}),e.jsx("li",{children:"Users can select packages when posting new properties"}),e.jsx("li",{children:"Package features automatically apply to user listings based on selection"}),e.jsx("li",{children:"Payment integration handles package purchases and activations"})]})]})]})]})]})}function Qs(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState(!1),[j,m]=a.useState(!1),[l,b]=a.useState(null),[T,C]=a.useState(!1),[P,k]=a.useState(""),[h,w]=a.useState({title:"",slug:"",content:"",metaTitle:"",metaDescription:"",status:"draft",type:"page",featuredImage:""});a.useEffect(()=>{E()},[s]);const E=async()=>{if(s)try{N(!0),n("");const H=await fetch("/api/admin/content",{headers:{Authorization:`Bearer ${s}`}});if(H.ok){const se=await H.json();se.success?r(se.data):n(se.error||"Failed to fetch pages")}else n(`Failed to fetch pages: ${H.status} ${H.statusText}`)}catch(H){console.error("Error fetching pages:",H),n("Failed to fetch pages")}finally{N(!1)}},L=async()=>{if(s)try{C(!0);const H=await fetch("/api/admin/content",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(h)});if(H.ok){const se=await H.json();se.success?(E(),p(),v(!1),k(h.status==="published"?"Page created and published successfully! It's now visible on the website and footer.":"Page created as draft. Publish it to make it visible on the website footer."),setTimeout(()=>k(""),5e3),h.status==="published"&&(console.log("ðŸ”„ Triggering footer refresh for new published page"),window.dispatchEvent(new CustomEvent("footerUpdate")),window.dispatchEvent(new CustomEvent("footerRefresh")),window.dispatchEvent(new CustomEvent("pagePublished",{detail:{pageId:se.data._id,title:h.title,slug:h.slug}})))):n(se.error||"Failed to create page")}else{const se=await H.json();n(se.error||"Failed to create page")}}catch(H){console.error("Error creating page:",H),n("Failed to create page")}finally{C(!1)}},q=async()=>{if(!s||!l){n("No authentication token or selected page");return}try{C(!0),n(""),console.log("ðŸ”„ Updating page:",l._id),console.log("ðŸ“„ Form data:",h);const H=await fetch(`/api/admin/content/${l._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(h)});if(console.log("ðŸ“¡ Update response status:",H.status),H.ok){const se=await H.json();if(console.log("âœ… Update response data:",se),se.success){E(),p(),m(!1),b(null),k(h.status==="published"?"Page updated successfully! Changes are now live on the website.":"Page updated successfully."),setTimeout(()=>k(""),5e3),console.log("âœ… Page update successful");const B=(l==null?void 0:l.status)==="published",$=h.status==="published";($||B)&&(console.log("ðŸ”„ Triggering footer refresh for updated page"),window.dispatchEvent(new CustomEvent("footerUpdate")),window.dispatchEvent(new CustomEvent("footerRefresh")),$?window.dispatchEvent(new CustomEvent("pagePublished",{detail:{pageId:l==null?void 0:l._id,title:h.title,slug:h.slug}})):B&&!$&&window.dispatchEvent(new CustomEvent("pageUnpublished",{detail:{pageId:l==null?void 0:l._id,title:h.title,slug:h.slug}})))}else n(se.error||"Failed to update page"),console.error("âŒ Update failed:",se.error)}else{const se=await H.text();console.error("âŒ Update response error:",H.status,se);try{const B=JSON.parse(se);n(B.error||`Failed to update page: ${H.status}`)}catch{n(`Failed to update page: ${H.status} ${H.statusText}`)}}}catch(H){console.error("âŒ Error updating page:",H),n(`Failed to update page: ${H instanceof Error?H.message:"Unknown error"}`)}finally{C(!1)}},V=async H=>{if(!(!s||!confirm("Are you sure you want to delete this page? This action cannot be undone.")))try{const se=await fetch(`/api/admin/content/${H}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(se.ok){const B=t.find($=>$._id===H);r(t.filter($=>$._id!==H)),k("Page deleted successfully!"),setTimeout(()=>k(""),3e3),(B==null?void 0:B.status)==="published"&&(console.log("ðŸ”„ Triggering footer refresh for deleted published page"),window.dispatchEvent(new CustomEvent("footerUpdate")),window.dispatchEvent(new CustomEvent("footerRefresh")))}else{const B=await se.json();n(B.error||"Failed to delete page")}}catch(se){console.error("Error deleting page:",se),n("Failed to delete page")}},p=()=>{w({title:"",slug:"",content:"",metaTitle:"",metaDescription:"",status:"draft",type:"page",featuredImage:""})},i=H=>{w({title:H.title,slug:H.slug,content:H.content,metaTitle:H.metaTitle||"",metaDescription:H.metaDescription||"",status:H.status,type:H.type,featuredImage:H.featuredImage||""})},F=H=>H.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),I=async()=>{var H;if(!s){n("No authentication token found");return}try{C(!0),n(""),console.log("ðŸ§ª Testing API connection..."),console.log("ðŸ”‘ Token:",s.substring(0,20)+"...");const se=await fetch("/api/admin/content",{headers:{Authorization:`Bearer ${s}`}});if(console.log("ðŸ“¡ API Response status:",se.status),console.log("ðŸ“¡ API Response headers:",Object.fromEntries(se.headers.entries())),se.ok){const B=await se.json();console.log("âœ… API Response data:",B),k(`âœ… API Test Successful! Found ${((H=B.data)==null?void 0:H.length)||0} pages. Status: ${se.status}`),setTimeout(()=>k(""),5e3)}else{const B=await se.text();console.error("âŒ API Error response:",B),n(`API Test Failed: ${se.status} - ${B}`)}}catch(se){console.error("âŒ API Test error:",se),n(`API Test Error: ${se instanceof Error?se.message:"Unknown error"}`)}finally{C(!1)}},D=async H=>{if(!s){n("No authentication token found");return}try{C(!0),n(""),console.log("ðŸ§ª Testing direct update for page:",H.title);const se={title:`${H.title} - Test Update ${new Date().toLocaleTimeString()}`,content:`${H.content}

--- Test update at ${new Date().toLocaleString()} ---`,slug:H.slug,metaTitle:H.metaTitle||"",metaDescription:H.metaDescription||"",status:H.status,type:H.type,featuredImage:H.featuredImage||""};console.log("ðŸ“¤ Test update data:",se);const B=await fetch(`/api/admin/content/${H._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(se)});if(console.log("ðŸ“¡ Test update response status:",B.status),B.ok){const $=await B.json();console.log("âœ… Test update response data:",$),k(`âœ… Test Update Successful! Page "${H.title}" updated.`),setTimeout(()=>k(""),5e3),E()}else{const $=await B.text();console.error("âŒ Test update error response:",$),n(`Test Update Failed: ${B.status} - ${$}`)}}catch(se){console.error("âŒ Test update error:",se),n(`Test Update Error: ${se instanceof Error?se.message:"Unknown error"}`)}finally{C(!1)}},R=H=>{const se={published:{className:"bg-green-100 text-green-800",icon:Be},draft:{className:"bg-yellow-100 text-yellow-800",icon:as},archived:{className:"bg-gray-100 text-gray-800",icon:Ue}},{className:B,icon:$}=se[H]||se.draft;return e.jsxs(re,{className:B,children:[e.jsx($,{className:"h-3 w-3 mr-1"}),H.charAt(0).toUpperCase()+H.slice(1)]})},M=H=>{const se={page:{className:"bg-blue-100 text-blue-800",label:"Page"},policy:{className:"bg-purple-100 text-purple-800",label:"Policy"},terms:{className:"bg-orange-100 text-orange-800",label:"Terms"},faq:{className:"bg-indigo-100 text-indigo-800",label:"FAQ"}},{className:B,label:$}=se[H]||se.page;return e.jsx(re,{variant:"outline",className:B,children:$})},W=t.filter(H=>{const se=H.title||"",B=H.slug||"",$=o||"",O=se.toLowerCase().includes($.toLowerCase())||B.toLowerCase().includes($.toLowerCase()),ae=u==="all"||H.status===u,X=x==="all"||H.type===x;return O&&ae&&X}),J={total:t.length,published:t.filter(H=>H.status==="published").length,draft:t.filter(H=>H.status==="draft").length,archived:t.filter(H=>H.status==="archived").length};return a.useEffect(()=>{t.length===0&&!c&&s&&(async()=>{try{const se=[{title:"About Us",slug:"about-us",content:"<h1>About Aashish Property</h1><p>Welcome to Aashish Property, your trusted partner in real estate solutions in Rohtak and surrounding areas.</p>",metaTitle:"About Us - Aashish Property",metaDescription:"Learn more about Aashish Property, your trusted real estate partner in Rohtak.",status:"published",type:"page"},{title:"Privacy Policy",slug:"privacy-policy",content:"<h1>Privacy Policy</h1><p>Your privacy is important to us. This policy explains how we collect, use, and protect your information.</p>",metaTitle:"Privacy Policy - Aashish Property",metaDescription:"Read our privacy policy to understand how we protect your data.",status:"published",type:"policy"},{title:"Terms and Conditions",slug:"terms-conditions",content:"<h1>Terms and Conditions</h1><p>Please read these terms and conditions carefully before using our services.</p>",metaTitle:"Terms and Conditions - Aashish Property",metaDescription:"Terms and conditions for using Aashish Property services.",status:"published",type:"terms"},{title:"Refund Policy",slug:"refund-policy",content:"<h1>Refund Policy</h1><p>Our refund policy ensures fair treatment for all our customers.</p>",metaTitle:"Refund Policy - Aashish Property",metaDescription:"Understanding our refund policy for property services.",status:"published",type:"policy"}];for(const B of se)await fetch("/api/admin/content",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(B)});E()}catch(se){console.error("Error initializing default pages:",se)}})()},[t.length,c,s]),c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading content pages..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),E()},className:"mt-2",children:"Retry"})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"text-red-500 mt-1",children:"âŒ"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-red-700 font-medium",children:"Error"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:y})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>n(""),children:"âœ•"})]})}),P&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"text-green-500 mt-1",children:"âœ…"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-green-700",children:P})})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Page Management"}),e.jsx("p",{className:"text-gray-600",children:"Create dynamic pages that auto-appear in footer. All pages are MongoDB-connected and fully functional."}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(Xs,{className:"h-3 w-3 mr-1"}),"MongoDB Connected"]}),e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(_a,{className:"h-3 w-3 mr-1"}),"Auto Footer Integration"]}),e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:["ðŸ”‘ Auth: ",s?"Connected":"Missing"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:I,variant:"outline",disabled:T,className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Test API"]}),e.jsxs(g,{onClick:()=>v(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create New Page"]})]})]}),e.jsxs(U,{className:"bg-blue-50 border-blue-200",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-blue-800",children:"Quick Create Pages"})]})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{title:"About Us",type:"page",description:"Company information"},{title:"Privacy Policy",type:"policy",description:"Privacy terms"},{title:"Terms & Conditions",type:"terms",description:"Service terms"},{title:"Contact Us",type:"page",description:"Contact information"}].map(H=>e.jsxs(g,{variant:"outline",className:"h-auto p-3 flex flex-col items-start space-y-1 hover:bg-blue-100 border-blue-300",onClick:()=>{w({...h,title:H.title,slug:F(H.title),type:H.type}),v(!0)},children:[e.jsx("span",{className:"font-medium text-sm",children:H.title}),e.jsx("span",{className:"text-xs text-gray-500",children:H.description})]},H.title))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Pages"}),e.jsx(Ss,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:J.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All content pages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Published"}),e.jsx(Be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:J.published}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live pages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Drafts"}),e.jsx(as,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:J.draft}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Work in progress"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Archived"}),e.jsx(Ue,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:J.archived}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Archived pages"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search pages...",value:o,onChange:H=>f(H.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"published",children:"Published"}),e.jsx(G,{value:"draft",children:"Draft"}),e.jsx(G,{value:"archived",children:"Archived"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"page",children:"Page"}),e.jsx(G,{value:"policy",children:"Policy"}),e.jsx(G,{value:"terms",children:"Terms"}),e.jsx(G,{value:"faq",children:"FAQ"})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Title"}),e.jsx(te,{children:"Slug"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Updated"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[W.map(H=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:H.title}),e.jsx(ee,{children:e.jsxs("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:["/",H.slug]})}),e.jsx(ee,{children:M(H.type)}),e.jsx(ee,{children:R(H.status)}),e.jsx(ee,{children:new Date(H.updatedAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>window.open(`/${H.slug}`,"_blank"),children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{b(H),i(H),m(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>D(H),disabled:T,className:"text-green-600 hover:text-green-700",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>V(H._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},H._id)),W.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No pages found"})})]})]})})}),e.jsx(Re,{open:d,onOpenChange:v,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create New Page"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Page Title *"}),e.jsx(Q,{value:h.title,onChange:H=>{const se=H.target.value;w({...h,title:se,slug:F(se)})},placeholder:"Enter page title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Slug *"}),e.jsx(Q,{value:h.slug,onChange:H=>w({...h,slug:H.target.value}),placeholder:"page-url-slug"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsxs(ue,{value:h.type,onValueChange:H=>w({...h,type:H}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"page",children:"Page"}),e.jsx(G,{value:"policy",children:"Policy"}),e.jsx(G,{value:"terms",children:"Terms"}),e.jsx(G,{value:"faq",children:"FAQ"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs(ue,{value:h.status,onValueChange:H=>w({...h,status:H}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"draft",children:"Draft"}),e.jsx(G,{value:"published",children:"Published"}),e.jsx(G,{value:"archived",children:"Archived"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Content *"}),e.jsx($e,{value:h.content,onChange:H=>w({...h,content:H.target.value}),placeholder:"Enter page content (HTML supported)...",rows:10,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Meta Title"}),e.jsx(Q,{value:h.metaTitle,onChange:H=>w({...h,metaTitle:H.target.value}),placeholder:"SEO title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Meta Description"}),e.jsx(Q,{value:h.metaDescription,onChange:H=>w({...h,metaDescription:H.target.value}),placeholder:"SEO description..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(g,{onClick:L,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:T,children:T?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Create Page"]})})]})]})]})}),e.jsx(Re,{open:j,onOpenChange:m,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Edit Page"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Page Title *"}),e.jsx(Q,{value:h.title,onChange:H=>w({...h,title:H.target.value}),placeholder:"Enter page title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Slug *"}),e.jsx(Q,{value:h.slug,onChange:H=>w({...h,slug:H.target.value}),placeholder:"page-url-slug"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Content *"}),e.jsx($e,{value:h.content,onChange:H=>w({...h,content:H.target.value}),placeholder:"Enter page content (HTML supported)...",rows:10,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(g,{onClick:q,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:T,children:T?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Update Page"]})})]})]})]})}),t.length===0&&!c&&e.jsx(U,{className:"border-dashed border-2 border-blue-300 bg-blue-50",children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Ss,{className:"h-16 w-16 text-blue-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Create Your First Page"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"Admin can create any page for the website like About Us, Privacy Policy, Contact Us, or any custom page."}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsxs(g,{onClick:()=>v(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create First Page"]}),e.jsxs(g,{variant:"outline",onClick:()=>{w({...h,title:"About Us",slug:"about-us",type:"page"}),v(!0)},children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Quick: About Us"]})]})]})})]})}function Or(){var j,m,l,b,T,C,P,k,h,w,E,L,q,V,p,i,F,I,D,R,M,W,J;const{token:s}=je(),[t,r]=a.useState(null),[c,N]=a.useState(!1),[y,n]=a.useState(""),[o,f]=a.useState(!1),[u,S]=a.useState(null),x=async()=>{N(!0),n(""),r(null);try{console.log("ðŸ” Testing database connection...");const se=await(await fetch("/api/test/database")).json();console.log("ðŸ‘¨â€ðŸ’¼ Testing admin user...");const $=await(await fetch("/api/test/admin-user")).json();console.log("ðŸ“Š Testing admin stats...");const ae=await(await fetch("/api/test/admin-stats")).json();let X=null;s&&(console.log("ðŸ” Testing authenticated admin endpoint..."),X=await(await fetch("/api/admin/stats",{headers:{Authorization:`Bearer ${s}`}})).json()),r({database:se,admin:$,stats:ae,authenticated:X,timestamp:new Date().toISOString()})}catch(H){console.error("âŒ Diagnostics failed:",H),n(`Diagnostics failed: ${H.message}`)}finally{N(!1)}},A=async()=>{f(!0),n(""),S(null);try{console.log("ðŸ”§ Creating admin user...");const se=await(await fetch("/api/fix/create-admin",{method:"POST"})).json();console.log("ðŸ”§ Initializing system data...");const $=await(await fetch("/api/fix/initialize-system",{method:"POST"})).json();console.log("ðŸ”§ Testing admin endpoints...");const ae=await(await fetch("/api/fix/admin-endpoints")).json();S({admin:se,initialization:$,endpoints:ae,timestamp:new Date().toISOString()}),setTimeout(()=>{x()},1e3)}catch(H){console.error("âŒ Fix failed:",H),n(`Fix failed: ${H.message}`)}finally{f(!1)}},d=H=>H?e.jsx(Le,{className:"h-5 w-5 text-green-500"}):e.jsx(fs,{className:"h-5 w-5 text-red-500"}),v=(H,se)=>e.jsxs(re,{variant:H?"default":"destructive",className:H?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:[H?"âœ…":"âŒ"," ",se]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Database Diagnostics"}),e.jsx("p",{className:"text-gray-600",children:"Test database connectivity and admin functions"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:x,disabled:c||o,className:"bg-[#C70000] hover:bg-[#A60000]",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Run Diagnostics"]})}),e.jsx(g,{onClick:A,disabled:c||o,variant:"outline",className:"border-orange-500 text-orange-600 hover:bg-orange-50",children:o?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Fixing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Fix Issues"]})})]})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:y})]})}),t&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Zn,{className:"h-5 w-5"}),e.jsx("span",{children:"Database Connection"}),d((j=t.database)==null?void 0:j.success)]})}),e.jsx(_,{className:"space-y-4",children:(m=t.database)!=null&&m.success?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[v(t.database.data.ping,"Connection"),v(t.database.data.adminExists,"Admin User")]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx(Ae,{className:"h-4 w-4 mx-auto mb-1 text-blue-500"}),e.jsx("div",{className:"font-semibold",children:t.database.data.counts.users}),e.jsx("div",{className:"text-gray-600",children:"Users"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx(Pe,{className:"h-4 w-4 mx-auto mb-1 text-green-500"}),e.jsx("div",{className:"font-semibold",children:t.database.data.counts.properties}),e.jsx("div",{className:"text-gray-600",children:"Properties"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx(ys,{className:"h-4 w-4 mx-auto mb-1 text-purple-500"}),e.jsx("div",{className:"font-semibold",children:t.database.data.counts.transactions}),e.jsx("div",{className:"text-gray-600",children:"Transactions"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Collections:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.database.data.collections.map(H=>e.jsx(re,{variant:"outline",className:"text-xs",children:H},H))})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"Database connection failed"}),e.jsx("p",{className:"text-sm text-gray-600",children:(l=t.database)==null?void 0:l.error}),((b=t.database)==null?void 0:b.details)&&e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(t.database.details,null,2)})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-5 w-5"}),e.jsx("span",{children:"Admin User"}),d((T=t.admin)==null?void 0:T.success)]})}),e.jsx(_,{className:"space-y-4",children:(C=t.admin)!=null&&C.success?e.jsxs("div",{className:"space-y-2",children:[v(t.admin.data.adminExists,"Admin Exists"),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",t.admin.data.adminEmail]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",t.admin.data.adminUserType]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",t.admin.data.message]})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"Admin user test failed"}),e.jsx("p",{className:"text-sm text-gray-600",children:(P=t.admin)==null?void 0:P.error})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(mt,{className:"h-5 w-5"}),e.jsx("span",{children:"Admin Stats"}),d((k=t.stats)==null?void 0:k.success)]})}),e.jsx(_,{className:"space-y-4",children:(h=t.stats)!=null&&h.success?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:t.stats.data.totalUsers}),e.jsx("div",{className:"text-gray-600",children:"Total Users"})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"font-semibold text-green-600",children:t.stats.data.totalProperties}),e.jsx("div",{className:"text-gray-600",children:"Total Properties"})]}),e.jsxs("div",{className:"text-center p-2 bg-purple-50 rounded",children:[e.jsx("div",{className:"font-semibold text-purple-600",children:t.stats.data.activeProperties}),e.jsx("div",{className:"text-gray-600",children:"Active Properties"})]}),e.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded",children:[e.jsx("div",{className:"font-semibold text-orange-600",children:((w=t.stats.data.usersByType)==null?void 0:w.length)||0}),e.jsx("div",{className:"text-gray-600",children:"User Types"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"Stats calculation failed"}),e.jsx("p",{className:"text-sm text-gray-600",children:(E=t.stats)==null?void 0:E.error})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-5 w-5"}),e.jsx("span",{children:"Authenticated API"}),s?d((L=t.authenticated)==null?void 0:L.success):e.jsx(fs,{className:"h-5 w-5 text-yellow-500"})]})}),e.jsx(_,{className:"space-y-4",children:s?(q=t.authenticated)!=null&&q.success?e.jsxs("div",{className:"space-y-2",children:[v(!0,"Authenticated"),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"font-semibold text-green-600",children:t.authenticated.data.totalUsers}),e.jsx("div",{className:"text-gray-600",children:"Users"})]}),e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:t.authenticated.data.totalProperties}),e.jsx("div",{className:"text-gray-600",children:"Properties"})]})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"Authenticated API failed"}),e.jsx("p",{className:"text-sm text-gray-600",children:(V=t.authenticated)==null?void 0:V.error})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-yellow-600 font-medium",children:"No authentication token"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Please login as admin to test authenticated endpoints"})]})})]})]}),u&&e.jsxs(U,{className:"bg-orange-50 border-orange-200",children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm text-orange-800",children:"Fix Results"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-xs font-mono space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Timestamp:"})," ",u.timestamp]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Admin User:"})," ",(p=u.admin)!=null&&p.success?"âœ… Created/Verified":"âŒ Failed"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"System Init:"})," ",(i=u.initialization)!=null&&i.success?"âœ… Initialized":"âŒ Failed"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Endpoints:"})," ",(F=u.endpoints)!=null&&F.success?"âœ… Working":"âŒ Failed"]}),((D=(I=u.admin)==null?void 0:I.data)==null?void 0:D.credentials)&&e.jsxs("div",{className:"mt-4 p-3 bg-green-100 border border-green-300 rounded",children:[e.jsx("p",{className:"font-semibold text-green-800 mb-2",children:"Admin Login Credentials:"}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",u.admin.data.credentials.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Password:"})," ",u.admin.data.credentials.password]})]})]})})]}),t&&e.jsxs(U,{className:"bg-gray-50",children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Test Results Summary"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-xs font-mono space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Timestamp:"})," ",t.timestamp]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Database:"})," ",(R=t.database)!=null&&R.success?"âœ… Connected":"âŒ Failed"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Admin User:"})," ",(M=t.admin)!=null&&M.success?"âœ… OK":"âŒ Failed"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Stats:"})," ",(W=t.stats)!=null&&W.success?"âœ… OK":"âŒ Failed"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Authenticated:"})," ",s?(J=t.authenticated)!=null&&J.success?"âœ… OK":"âŒ Failed":"âš ï¸ No Token"]})]})})]}),!t&&!c&&e.jsx(U,{className:"border-dashed border-2 border-gray-300",children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(mt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Database Diagnostics"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Run diagnostics to check database connectivity and admin functions"}),e.jsxs(g,{onClick:x,variant:"outline",children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Start Diagnostics"]})]})})]})}const em=[{title:"About Us",type:"page",icon:Xs,description:"Company information and story",content:`<div class="prose prose-lg">
<h1>About Aashish Property</h1>
<p>Welcome to Aashish Property, your trusted partner in real estate solutions...</p>

<h2>Our Mission</h2>
<p>To make property transactions transparent, efficient, and hassle-free.</p>

<h2>Our Services</h2>
<ul>
<li>Residential Property Sales</li>
<li>Commercial Property Leasing</li>
<li>Property Investment Consultation</li>
</ul>
</div>`},{title:"Privacy Policy",type:"policy",icon:Je,description:"Data protection and privacy terms",content:`<div class="prose prose-lg">
<h1>Privacy Policy</h1>
<p><strong>Last updated:</strong> ${new Date().toLocaleDateString()}</p>

<h2>Information We Collect</h2>
<p>We collect information you provide directly to us...</p>

<h2>How We Use Your Information</h2>
<p>We use the information we collect to provide and improve our services.</p>
</div>`},{title:"Terms and Conditions",type:"terms",icon:Ss,description:"Service terms and conditions",content:`<div class="prose prose-lg">
<h1>Terms and Conditions</h1>
<p><strong>Last updated:</strong> ${new Date().toLocaleDateString()}</p>

<h2>Acceptance of Terms</h2>
<p>By accessing and using our platform, you accept these terms...</p>

<h2>User Responsibilities</h2>
<ul>
<li>Provide accurate information</li>
<li>Comply with applicable laws</li>
</ul>
</div>`},{title:"Contact Us",type:"page",icon:Xs,description:"Contact information and form",content:`<div class="prose prose-lg">
<h1>Contact Us</h1>
<p>Get in touch with our team for any questions or support.</p>

<h2>Contact Information</h2>
<p><strong>Address:</strong> Rohtak, Haryana<br>
<strong>Phone:</strong> +91-XXXXXXXXXX<br>
<strong>Email:</strong> info@aashishproperty.com</p>

<h2>Business Hours</h2>
<p>Monday - Saturday: 9:00 AM - 6:00 PM</p>
</div>`},{title:"FAQ",type:"faq",icon:st,description:"Frequently asked questions",content:`<div class="prose prose-lg">
<h1>Frequently Asked Questions</h1>

<h3>Q: How do I list my property?</h3>
<p>A: You can list your property by creating an account and using our property listing form.</p>

<h3>Q: What are the listing charges?</h3>
<p>A: We offer both free and premium listing options. Check our packages for details.</p>

<h3>Q: How do I contact property owners?</h3>
<p>A: Contact details are available for verified listings. You can call or message directly.</p>
</div>`}];function sm(){const{token:s}=je(),[t,r]=a.useState(!1),[c,N]=a.useState(!1),[y,n]=a.useState(null),[o,f]=a.useState(!1),[u,S]=a.useState({title:"",slug:"",content:"",type:"page",status:"draft"}),x=j=>j.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),A=j=>{n(j),S({title:j.title,slug:x(j.title),content:j.content,type:j.type,status:"draft"})},d=()=>{f(!0),n(null),S({title:"",slug:"",content:"",type:"page",status:"draft"})},v=async()=>{if(!(!s||!u.title||!u.content))try{N(!0);const j=await fetch("/api/admin/content",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(u)});if(j.ok)r(!1),n(null),f(!1),S({title:"",slug:"",content:"",type:"page",status:"draft"}),window.location.reload();else{const m=await j.json();alert(m.error||"Failed to create page")}}catch(j){console.error("Error creating page:",j),alert("Failed to create page")}finally{N(!1)}};return e.jsxs(Re,{open:t,onOpenChange:r,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Quick Create Page"]})}),e.jsxs(Ee,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Quick Create Page"})}),!y&&!o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Choose a Page Template"}),e.jsx("p",{className:"text-gray-600",children:"Select a pre-made template or create a custom page"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:em.map(j=>e.jsx(U,{className:"cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>A(j),children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(j.icon,{className:"h-8 w-8 text-[#C70000]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:j.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:j.description}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:j.type})})]})]})})},j.title))}),e.jsx("div",{className:"text-center pt-4 border-t",children:e.jsxs(g,{variant:"outline",onClick:d,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Custom Page"]})})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y.icon,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:["Template: ",y.title]})]}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:y.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Page Title *"}),e.jsx(Q,{value:u.title,onChange:j=>{const m=j.target.value;S({...u,title:m,slug:x(m)})},placeholder:"Enter page title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"URL Slug *"}),e.jsx(Q,{value:u.slug,onChange:j=>S({...u,slug:j.target.value}),placeholder:"page-url-slug"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Page Type"}),e.jsxs(ue,{value:u.type,onValueChange:j=>S({...u,type:j}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"page",children:"Page"}),e.jsx(G,{value:"policy",children:"Policy"}),e.jsx(G,{value:"terms",children:"Terms"}),e.jsx(G,{value:"faq",children:"FAQ"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs(ue,{value:u.status,onValueChange:j=>S({...u,status:j}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"draft",children:"Draft"}),e.jsx(G,{value:"published",children:"Published"}),e.jsx(G,{value:"archived",children:"Archived"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Page Content *"}),e.jsx($e,{value:u.content,onChange:j=>S({...u,content:j.target.value}),placeholder:"Enter page content (HTML supported)...",rows:12,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You can use HTML tags for formatting. The content will be displayed on your website."})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>{n(null),f(!1)},children:"Back"}),e.jsx(g,{onClick:v,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:c||!u.title||!u.content,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Create Page"]})})]})]})]})]})}function Ji(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState({companyName:"POSTTRR",companyDescription:"",companyLogo:"P",socialLinks:{},contactInfo:{},showLocations:!0,locations:[]}),[y,n]=a.useState(!0),[o,f]=a.useState(!1),[u,S]=a.useState(""),[x,A]=a.useState(""),[d,v]=a.useState(!1),[j,m]=a.useState(null),[l,b]=a.useState({title:"",url:"",section:"",order:0,isActive:!0,isExternal:!1}),T=[{id:"quick_links",name:"Quick Links",description:"Navigation and important pages"},{id:"legal",name:"Legal Pages",description:"Terms, privacy, policies"},{id:"company",name:"Company Info",description:"About company, contact"},{id:"support",name:"Support",description:"Help, FAQ, customer service"}];a.useEffect(()=>{C()},[s]);const C=async()=>{try{n(!0),S("");const p=await fetch("/api/admin/footer-links",{headers:{Authorization:`Bearer ${s}`}});if(p.ok){const F=await p.json();F.success&&r(F.data)}const i=await fetch("/api/admin/footer-settings",{headers:{Authorization:`Bearer ${s}`}});if(i.ok){const F=await i.json();F.success&&N(F.data)}}catch(p){console.error("Error fetching footer data:",p),S("Failed to fetch footer data")}finally{n(!1)}},P=async()=>{try{f(!0),S("");const p=await fetch("/api/admin/footer-settings",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(c)});if(p.ok){const i=await p.json();i.success?(A("Footer settings saved and updated across all website pages!"),setTimeout(()=>A(""),4e3),window.dispatchEvent(new CustomEvent("footerRefresh")),console.log("ðŸ”„ Footer refresh event dispatched")):S(i.error||"Failed to save settings")}else S(`Failed to save settings: ${p.status}`)}catch(p){console.error("Error saving footer settings:",p),S("Failed to save footer settings")}finally{f(!1)}},k=async p=>{if(p.preventDefault(),!l.title||!l.url||!l.section){S("Please fill in all required fields");return}try{f(!0),S("");const i=j?`/api/admin/footer-links/${j._id}`:"/api/admin/footer-links",I=await fetch(i,{method:j?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(l)});if(I.ok){const D=await I.json();D.success?(A(`Footer link ${j?"updated":"created"} and applied to all website pages!`),setTimeout(()=>A(""),3e3),b({title:"",url:"",section:"",order:0,isActive:!0,isExternal:!1}),m(null),v(!1),C(),window.dispatchEvent(new CustomEvent("footerRefresh")),console.log("ðŸ”„ Footer refresh event dispatched after link save")):S(D.error||"Failed to save link")}else S(`Failed to save link: ${I.status}`)}catch(i){console.error("Error saving footer link:",i),S("Failed to save footer link")}finally{f(!1)}},h=async p=>{if(confirm("Are you sure you want to delete this footer link?"))try{f(!0),S("");const i=await fetch(`/api/admin/footer-links/${p}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(i.ok){const F=await i.json();F.success?(A("Footer link deleted and removed from all website pages!"),setTimeout(()=>A(""),3e3),C(),window.dispatchEvent(new CustomEvent("footerRefresh")),console.log("ðŸ”„ Footer refresh event dispatched after link delete")):S(F.error||"Failed to delete link")}else S(`Failed to delete link: ${i.status}`)}catch(i){console.error("Error deleting footer link:",i),S("Failed to delete footer link")}finally{f(!1)}},w=p=>{m(p),b(p),v(!0)},E=async()=>{try{f(!0),S("");const p=await fetch("/api/footer/initialize",{method:"POST"});if(p.ok){const i=await p.json();i.success?(A("Footer data initialized successfully!"),setTimeout(()=>A(""),3e3),C()):S(i.error||"Failed to initialize footer data")}}catch(p){console.error("Error initializing footer data:",p),S("Failed to initialize footer data")}finally{f(!1)}},L=async()=>{try{f(!0),S("");const p=await fetch("/api/footer/test");if(p.ok){const i=await p.json();if(i.success){const F=i.data.stats;A(`âœ… Connection successful! Found ${F.totalLinks} links (${F.activeLinks} active), settings ${F.hasSettings?"configured":"missing"}, last updated: ${new Date(F.lastUpdated).toLocaleString()}`),setTimeout(()=>A(""),5e3)}else S(i.error||"Test failed")}else S(`Test failed: ${p.status} ${p.statusText}`)}catch(p){console.error("Error testing footer connection:",p),S("Failed to test footer connection")}finally{f(!1)}},q=async()=>{try{f(!0),S("");const p=new Date().toLocaleString(),i={...c,companyDescription:`${c.companyDescription} [Test Update: ${p}]`,updatedAt:new Date().toISOString()},F=await fetch("/api/admin/footer-settings",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(i)});if(F.ok){const I=await F.json();I.success?(A(`ðŸš€ Live update test successful! Check the footer on the website - it should update within seconds. Test timestamp: ${p}`),setTimeout(()=>A(""),1e4),window.dispatchEvent(new CustomEvent("footerRefresh")),C(),console.log("ðŸ”„ Test live update completed, footer refresh triggered")):S(I.error||"Test update failed")}else S(`Test update failed: ${F.status} ${F.statusText}`)}catch(p){console.error("Error testing live update:",p),S("Failed to test live update")}finally{f(!1)}},V=p=>t.filter(i=>i.section===p).sort((i,F)=>i.order-F.order);return y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading footer management..."})]}):e.jsxs("div",{className:"space-y-6",children:[u&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:u})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>S(""),className:"mt-2",children:"Dismiss"})]}),x&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"h-5 w-5 text-green-500"}),e.jsx("p",{className:"text-green-700",children:x})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Dynamic Footer Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage footer content, links, and settings for your website"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Live Updates Enabled"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Changes reflect immediately across all pages"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:E,variant:"outline",disabled:o,className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Initialize Data"]}),e.jsxs(g,{onClick:C,variant:"outline",disabled:o,children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:L,variant:"outline",disabled:o,className:"text-green-600 border-green-300 hover:bg-green-50",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Test Connection"]}),e.jsxs(g,{onClick:q,variant:"outline",disabled:o,className:"text-purple-600 border-purple-300 hover:bg-purple-50",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Test Live Update"]})]})]}),e.jsxs(Ls,{defaultValue:"links",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-3",children:[e.jsx(Se,{value:"links",children:"Footer Links"}),e.jsx(Se,{value:"settings",children:"Footer Settings"}),e.jsx(Se,{value:"preview",children:"Live Preview"})]}),e.jsxs(ke,{value:"links",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Manage Footer Links"}),e.jsxs(Re,{open:d,onOpenChange:v,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",onClick:()=>{m(null),b({title:"",url:"",section:"",order:0,isActive:!0,isExternal:!1})},children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Footer Link"]})}),e.jsxs(Ee,{children:[e.jsxs(Ie,{children:[e.jsx(Fe,{children:j?"Edit Footer Link":"Add New Footer Link"}),e.jsx(br,{children:"Create or edit footer links that will appear in your website footer."})]}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Link Title *"}),e.jsx(Q,{value:l.title||"",onChange:p=>b({...l,title:p.target.value}),placeholder:"e.g., About Us, Contact",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"URL *"}),e.jsx(Q,{value:l.url||"",onChange:p=>b({...l,url:p.target.value}),placeholder:"e.g., /about-us, https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Footer Section *"}),e.jsxs(ue,{value:l.section||"",onValueChange:p=>b({...l,section:p}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select footer section"})}),e.jsx(he,{children:T.map(p=>e.jsxs(G,{value:p.id,children:[p.name," - ",p.description]},p.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Display Order"}),e.jsx(Q,{type:"number",value:l.order||0,onChange:p=>b({...l,order:parseInt(p.target.value)||0}),placeholder:"1",min:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:l.isActive??!0,onChange:p=>b({...l,isActive:p.target.checked}),className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:l.isExternal??!1,onChange:p=>b({...l,isExternal:p.target.checked}),className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:"External Link"})]})]})]}),e.jsxs(Nr,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsxs(g,{type:"submit",className:"bg-[#C70000] hover:bg-[#A60000]",onClick:k,disabled:o,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),j?"Update":"Add"," Link"]})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:T.map(p=>{const i=V(p.id);return e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"text-lg",children:p.name}),e.jsx(Vt,{children:p.description})]}),e.jsxs(re,{variant:"outline",className:"text-xs",children:[i.length," links"]})]})}),e.jsx(_,{children:i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(F=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[F.isExternal&&e.jsx(ja,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"font-medium",children:F.title})]}),e.jsx(re,{variant:F.isActive?"default":"secondary",className:"text-xs",children:F.isActive?"Active":"Inactive"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Order: ",F.order]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>w(F),children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>h(F._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})]},F._id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Xs,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No links in this section yet"}),e.jsx(g,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>{b({...l,section:p.id}),v(!0)},children:"Add First Link"})]})})]},p.id)})})]}),e.jsx(ke,{value:"settings",className:"space-y-6",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"Footer Settings"}),e.jsx(Vt,{children:"Configure global footer settings and company information"})]}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Company Name"}),e.jsx(Q,{value:c.companyName,onChange:p=>N({...c,companyName:p.target.value}),placeholder:"Your Company Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Company Logo (Single Letter)"}),e.jsx(Q,{value:c.companyLogo,onChange:p=>N({...c,companyLogo:p.target.value.charAt(0)}),placeholder:"P",maxLength:1})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Company Description"}),e.jsx($e,{value:c.companyDescription,onChange:p=>N({...c,companyDescription:p.target.value}),placeholder:"Brief description of your company...",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),e.jsx("span",{children:"Contact Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e.jsx(Q,{value:c.contactInfo.phone||"",onChange:p=>N({...c,contactInfo:{...c.contactInfo,phone:p.target.value}}),placeholder:"+91 9876543210"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email"}),e.jsx(Q,{value:c.contactInfo.email||"",onChange:p=>N({...c,contactInfo:{...c.contactInfo,email:p.target.value}}),placeholder:"info@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e.jsx(Q,{value:c.contactInfo.address||"",onChange:p=>N({...c,contactInfo:{...c.contactInfo,address:p.target.value}}),placeholder:"Your address"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Social Media Links"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center space-x-2",children:[e.jsx(fn,{className:"h-4 w-4"}),e.jsx("span",{children:"Facebook"})]}),e.jsx(Q,{value:c.socialLinks.facebook||"",onChange:p=>N({...c,socialLinks:{...c.socialLinks,facebook:p.target.value}}),placeholder:"https://facebook.com/yourpage"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center space-x-2",children:[e.jsx(vn,{className:"h-4 w-4"}),e.jsx("span",{children:"Twitter"})]}),e.jsx(Q,{value:c.socialLinks.twitter||"",onChange:p=>N({...c,socialLinks:{...c.socialLinks,twitter:p.target.value}}),placeholder:"https://twitter.com/yourpage"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center space-x-2",children:[e.jsx(Nn,{className:"h-4 w-4"}),e.jsx("span",{children:"Instagram"})]}),e.jsx(Q,{value:c.socialLinks.instagram||"",onChange:p=>N({...c,socialLinks:{...c.socialLinks,instagram:p.target.value}}),placeholder:"https://instagram.com/yourpage"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center space-x-2",children:[e.jsx(bn,{className:"h-4 w-4"}),e.jsx("span",{children:"YouTube"})]}),e.jsx(Q,{value:c.socialLinks.youtube||"",onChange:p=>N({...c,socialLinks:{...c.socialLinks,youtube:p.target.value}}),placeholder:"https://youtube.com/yourchannel"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-lg font-semibold flex items-center space-x-2",children:[e.jsx(He,{className:"h-5 w-5"}),e.jsx("span",{children:"Popular Locations"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:c.showLocations,onChange:p=>N({...c,showLocations:p.target.checked}),className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:"Show locations in footer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Locations (comma-separated)"}),e.jsx(Q,{value:(c.locations||[]).join(", "),onChange:p=>N({...c,locations:p.target.value.split(",").map(i=>(i??"").trim()).filter(i=>i)}),placeholder:"Kolkata, Mumbai, Delhi, Bangalore"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:C,children:"Reset Changes"}),e.jsxs(g,{onClick:P,disabled:o,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),o?"Saving...":"Save Settings"]})]})]})]})}),e.jsx(ke,{value:"preview",className:"space-y-6",children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{children:"Live Footer Preview"})]}),e.jsx(Vt,{children:"This is how your footer will appear on the website with current settings. Changes are applied automatically across all pages in real-time."})]}),e.jsx(_,{children:e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-red-700 text-white p-6 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-[#C70000] font-bold text-xl",children:c.companyLogo})}),e.jsx("h3",{className:"text-2xl font-bold",children:c.companyName})]}),e.jsx("p",{className:"text-red-100 text-sm",children:c.companyDescription})]}),c.showLocations&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"POPULAR LOCATIONS"}),e.jsx("ul",{className:"space-y-2",children:(c.locations||[]).slice(0,6).map((p,i)=>e.jsxs("li",{className:"text-red-100 text-sm",children:["â€¢ ",p]},i))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"QUICK LINKS"}),e.jsx("ul",{className:"space-y-2",children:V("quick_links").slice(0,6).map(p=>e.jsxs("li",{className:"text-red-100 text-sm",children:["â€¢ ",p.title," ",p.isExternal&&"â†—"]},p._id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-lg font-semibold",children:"LEGAL & SUPPORT"}),e.jsx("ul",{className:"space-y-2",children:V("legal").slice(0,6).map(p=>e.jsxs("li",{className:"text-red-100 text-sm",children:["â€¢ ",p.title]},p._id))})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-red-400/30 space-y-4",children:[(c.socialLinks.facebook||c.socialLinks.twitter||c.socialLinks.instagram||c.socialLinks.youtube)&&e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Follow Us"}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[c.socialLinks.facebook&&e.jsx("span",{className:"text-red-100 text-xs",children:"ðŸ“˜ Facebook"}),c.socialLinks.twitter&&e.jsx("span",{className:"text-red-100 text-xs",children:"ðŸ¦ Twitter"}),c.socialLinks.instagram&&e.jsx("span",{className:"text-red-100 text-xs",children:"ðŸ“· Instagram"}),c.socialLinks.youtube&&e.jsx("span",{className:"text-red-100 text-xs",children:"ðŸ“º YouTube"})]})]}),(c.contactInfo.phone||c.contactInfo.email)&&e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Contact Us"}),e.jsxs("div",{className:"flex justify-center space-x-4 text-xs text-red-100",children:[c.contactInfo.phone&&e.jsxs("span",{children:["ðŸ“ž ",c.contactInfo.phone]}),c.contactInfo.email&&e.jsxs("span",{children:["âœ‰ï¸ ",c.contactInfo.email]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-red-100 text-sm",children:["Â© ",new Date().getFullYear()," ",c.companyName,". All rights reserved."]})})]})]})})]})})]}),e.jsxs(U,{className:"border-green-200 bg-green-50",children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2 text-green-800",children:[e.jsx(Be,{className:"h-5 w-5"}),e.jsx("span",{children:"Dynamic Footer System Status"})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-green-900",children:"âœ… Features Active"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Real-time updates across all pages"}),e.jsx("li",{children:"â€¢ Database integration with MongoDB"}),e.jsx("li",{children:"â€¢ Social media links management"}),e.jsx("li",{children:"â€¢ Contact information sync"}),e.jsx("li",{children:"â€¢ Location listings"}),e.jsx("li",{children:"â€¢ Custom footer links by section"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-green-900",children:"ðŸ“Š Current Stats"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ Total Links: ",t.length]}),e.jsxs("li",{children:["â€¢ Active Links: ",t.filter(p=>p.isActive).length]}),e.jsxs("li",{children:["â€¢ Quick Links: ",t.filter(p=>p.section==="quick_links").length]}),e.jsxs("li",{children:["â€¢ Legal Pages: ",t.filter(p=>p.section==="legal").length]}),e.jsxs("li",{children:["â€¢ Company: ",c.companyName]}),e.jsxs("li",{children:["â€¢ Locations: ",(c.locations||[]).length]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-green-900",children:"ðŸ”„ Auto-Sync Features"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Changes apply instantly"}),e.jsx("li",{children:"â€¢ No page refresh required"}),e.jsx("li",{children:"â€¢ Cross-browser compatibility"}),e.jsx("li",{children:"â€¢ Mobile responsive updates"}),e.jsx("li",{children:"â€¢ Event-driven refresh system"}),e.jsx("li",{children:"â€¢ Fallback loading mechanisms"})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-green-100 border border-green-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Be,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 font-medium",children:"âœ¨ Dynamic Footer System Fully Operational"}),e.jsx("p",{className:"text-green-700 text-sm mt-1",children:"Your footer is now completely dynamic and connected to the database. Any changes you make here will automatically appear on all website pages within seconds. Social media links, contact information, and custom links are all managed through this interface."})]})]})})]})]})]})}function tm(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(!1),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState(!1),[d,v]=a.useState(null),[j,m]=a.useState({url:"",alt:"",title:"",subtitle:"",isActive:!0,order:1});a.useEffect(()=>{if(!s){N(!1);return}l()},[s]);const l=async()=>{try{N(!0),f("");const h=await fetch("/api/admin/homepage-sliders",{credentials:"include",headers:{}});if(h.ok){const w=await h.json();w.success?r(w.data||[]):f(w.error||"Failed to fetch sliders")}else f(`Failed to fetch sliders: ${h.status}`)}catch(h){console.error("Error fetching sliders:",h),f("Failed to fetch sliders")}finally{N(!1)}},b=async h=>{if(h.preventDefault(),!j.url||!j.alt){f("Image URL and Alt text are required");return}try{n(!0),f("");const w=d?`/api/admin/homepage-sliders/${d._id}`:"/api/admin/homepage-sliders",L=await fetch(w,{method:d?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(L.ok){const q=await L.json();q.success?(S(`Slider ${d?"updated":"created"} successfully!`),setTimeout(()=>S(""),3e3),m({url:"",alt:"",title:"",subtitle:"",isActive:!0,order:1}),v(null),A(!1),l(),window.dispatchEvent(new CustomEvent("sliderUpdate")),window.dispatchEvent(new CustomEvent("sliderUpdate")),console.log("ðŸ”„ Slider update event dispatched")):f(q.error||"Failed to save slider")}else f(`Failed to save slider: ${L.status}`)}catch(w){console.error("Error saving slider:",w),f("Failed to save slider")}finally{n(!1)}},T=async h=>{if(confirm("Are you sure you want to delete this slider?"))try{n(!0),f("");const w=await fetch(`/api/admin/homepage-sliders/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(w.ok){const E=await w.json();E.success?(S("Slider deleted successfully!"),setTimeout(()=>S(""),3e3),l(),window.dispatchEvent(new CustomEvent("sliderUpdate"))):f(E.error||"Failed to delete slider")}else f(`Failed to delete slider: ${w.status}`)}catch(w){console.error("Error deleting slider:",w),f("Failed to delete slider")}finally{n(!1)}},C=async h=>{try{n(!0),f("");const w=await fetch(`/api/admin/homepage-sliders/${h._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...h,isActive:!h.isActive})});if(w.ok){const E=await w.json();E.success?(S(`Slider ${h.isActive?"deactivated":"activated"}!`),setTimeout(()=>S(""),3e3),l(),window.dispatchEvent(new CustomEvent("sliderUpdate"))):f(E.error||"Failed to update slider")}else f(`Failed to update slider: ${w.status}`)}catch(w){console.error("Error updating slider:",w),f("Failed to update slider")}finally{n(!1)}},P=h=>{v(h),m(h),A(!0)},k=async(h,w)=>{const E=h.order||0,L=w==="up"?E-1:E+1;if(!(L<1))try{n(!0),(await fetch(`/api/admin/homepage-sliders/${h._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...h,order:L})})).ok&&l()}catch(q){console.error("Error moving slider:",q)}finally{n(!1)}};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading slider management..."})]}):e.jsxs("div",{className:"space-y-6",children:[o&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:o})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>f(""),className:"mt-2",children:"Dismiss"})]}),u&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"h-5 w-5 text-green-500"}),e.jsx("p",{className:"text-green-700",children:u})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Homepage Slider Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage hero slider images for the homepage"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:l,variant:"outline",disabled:y,children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(Re,{open:x,onOpenChange:A,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",onClick:()=>{v(null),m({url:"",alt:"",title:"",subtitle:"",isActive:!0,order:t.length+1})},children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Slider"]})}),e.jsxs(Ee,{className:"max-w-md",children:[e.jsxs(Ie,{children:[e.jsx(Fe,{children:d?"Edit Slider":"Add New Slider"}),e.jsx(br,{children:"Create or edit homepage slider images with titles and descriptions."})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image URL *"}),e.jsx(Q,{value:j.url||"",onChange:h=>m({...j,url:h.target.value}),placeholder:"https://example.com/image.jpg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Alt Text *"}),e.jsx(Q,{value:j.alt||"",onChange:h=>m({...j,alt:h.target.value}),placeholder:"Description of the image",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx(Q,{value:j.title||"",onChange:h=>m({...j,title:h.target.value}),placeholder:"Main heading (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subtitle"}),e.jsx($e,{value:j.subtitle||"",onChange:h=>m({...j,subtitle:h.target.value}),placeholder:"Description text (optional)",rows:2})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Display Order"}),e.jsx(Q,{type:"number",value:j.order||1,onChange:h=>m({...j,order:parseInt(h.target.value)||1}),min:"1",className:"w-20"})]}),e.jsxs("label",{className:"flex items-center space-x-2 mt-6",children:[e.jsx("input",{type:"checkbox",checked:j.isActive??!0,onChange:h=>m({...j,isActive:h.target.checked}),className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:"Active"})]})]})]}),e.jsxs(Nr,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsxs(g,{type:"submit",className:"bg-[#C70000] hover:bg-[#A60000]",onClick:b,disabled:y,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),d?"Update":"Add"," Slider"]})]})]})]})]})]}),e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"Current Sliders"}),e.jsx(Vt,{children:"Manage your homepage slider images. They will appear in the order specified."})]}),e.jsx(_,{children:t.length>0?e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Preview"}),e.jsx(te,{children:"Details"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:t.sort((h,w)=>(h.order||0)-(w.order||0)).map(h=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsx("div",{className:"w-16 h-10 bg-gray-100 rounded overflow-hidden",children:e.jsx("img",{src:h.url,alt:h.alt,className:"w-full h-full object-cover",onError:w=>{w.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='40' viewBox='0 0 64 40'%3E%3Crect width='64' height='40' fill='%23f3f4f6'/%3E%3Ctext x='32' y='20' text-anchor='middle' dy='.3em' fill='%23666'%3EImg%3C/text%3E%3C/svg%3E"}})})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.title||"No title"}),e.jsx("p",{className:"text-sm text-gray-500",children:h.subtitle||"No subtitle"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.alt})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm",children:h.order}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(g,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",onClick:()=>k(h,"up"),disabled:y,children:e.jsx(qa,{className:"h-3 w-3"})}),e.jsx(g,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",onClick:()=>k(h,"down"),disabled:y,children:e.jsx(ea,{className:"h-3 w-3"})})]})]})}),e.jsx(ee,{children:e.jsx(re,{variant:h.isActive?"default":"secondary",className:"text-xs",children:h.isActive?"Active":"Inactive"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>C(h),disabled:y,children:h.isActive?e.jsx(Wt,{className:"h-4 w-4"}):e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>P(h),children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>T(h._id),className:"text-red-600 hover:text-red-700",disabled:y,children:e.jsx(De,{className:"h-4 w-4"})})]})})]},h._id))})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(at,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No sliders configured yet"}),e.jsx(g,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>A(!0),children:"Add First Slider"})]})})]}),t.length>0&&e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"Preview"}),e.jsx(Vt,{children:"How your slider will appear on the homepage"})]}),e.jsx(_,{children:e.jsx("div",{className:"relative w-full h-48 md:h-64 bg-gray-900 rounded-lg overflow-hidden",children:t.filter(h=>h.isActive).slice(0,1).map(h=>e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:h.url,alt:h.alt,className:"w-full h-full object-cover object-top"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white px-4",children:[e.jsx("h1",{className:"text-xl md:text-3xl font-bold mb-2",children:h.title||"Find Your Perfect Property"}),e.jsx("p",{className:"text-sm md:text-lg text-gray-200",children:h.subtitle||"Discover amazing properties in your area with verified listings"})]})})]},h._id))})})]})]})}const xr=a.forwardRef(({className:s,...t},r)=>e.jsx(ei,{ref:r,className:me("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(lc,{className:me("flex items-center justify-center text-current"),children:e.jsx(Be,{className:"h-4 w-4"})})}));xr.displayName=ei.displayName;const Sa={"User Management":[{key:"users.view",label:"View Users",description:"View user profiles and information"},{key:"users.edit",label:"Edit Users",description:"Edit user profiles and settings"},{key:"users.delete",label:"Delete Users",description:"Delete user accounts"},{key:"users.support",label:"User Support",description:"Handle user support queries"},{key:"users.export",label:"Export Users",description:"Export user data"}],"Property Management":[{key:"properties.view",label:"View Properties",description:"View property listings"},{key:"properties.edit",label:"Edit Properties",description:"Edit property information"},{key:"properties.delete",label:"Delete Properties",description:"Delete property listings"},{key:"properties.approve",label:"Approve Properties",description:"Approve/reject property listings"},{key:"properties.featured",label:"Feature Properties",description:"Mark properties as featured"},{key:"properties.export",label:"Export Properties",description:"Export property data"}],"Content Management":[{key:"content.view",label:"View Content",description:"View pages and blog posts"},{key:"content.create",label:"Create Content",description:"Create pages and blog posts"},{key:"content.edit",label:"Edit Content",description:"Edit pages and blog posts"},{key:"content.delete",label:"Delete Content",description:"Delete pages and blog posts"},{key:"content.publish",label:"Publish Content",description:"Publish/unpublish content"}],"Category Management":[{key:"categories.view",label:"View Categories",description:"View property categories"},{key:"categories.edit",label:"Edit Categories",description:"Edit property categories"},{key:"categories.create",label:"Create Categories",description:"Create new categories"},{key:"categories.delete",label:"Delete Categories",description:"Delete categories"}],"Payment & Packages":[{key:"packages.view",label:"View Packages",description:"View advertisement packages"},{key:"packages.edit",label:"Edit Packages",description:"Edit advertisement packages"},{key:"transactions.view",label:"View Transactions",description:"View payment transactions"},{key:"transactions.manage",label:"Manage Transactions",description:"Approve/reject payments"},{key:"payment.settings",label:"Payment Settings",description:"Configure payment gateways"}],"Analytics & Reports":[{key:"analytics.view",label:"View Analytics",description:"View dashboard analytics"},{key:"analytics.export",label:"Export Analytics",description:"Export analytics data"},{key:"reports.view",label:"View Reports",description:"View system reports"},{key:"reports.generate",label:"Generate Reports",description:"Generate custom reports"}],"Chat & Communication":[{key:"chat.view",label:"View Chats",description:"View user conversations"},{key:"chat.manage",label:"Manage Chats",description:"Reply to user conversations"},{key:"notifications.send",label:"Send Notifications",description:"Send push notifications"},{key:"email.send",label:"Send Emails",description:"Send bulk emails"}],"System Settings":[{key:"settings.view",label:"View Settings",description:"View system settings"},{key:"settings.edit",label:"Edit Settings",description:"Modify system settings"},{key:"staff.manage",label:"Manage Staff",description:"Manage staff members and roles"},{key:"system.backup",label:"System Backup",description:"Create system backups"}],"FAQ & Support":[{key:"faq.view",label:"View FAQs",description:"View FAQ entries"},{key:"faq.edit",label:"Edit FAQs",description:"Edit FAQ entries"},{key:"support.tickets",label:"Support Tickets",description:"Handle support tickets"},{key:"support.resolve",label:"Resolve Issues",description:"Resolve user issues"}]},ia=[{id:"super_admin",name:"super_admin",displayName:"Super Admin",description:"Complete system access with all permissions",permissions:["*"],icon:We,color:"bg-purple-100 text-purple-800"},{id:"content_manager",name:"content_manager",displayName:"Content Manager",description:"Manage website content, pages, and blogs",permissions:["content.view","content.create","content.edit","content.delete","content.publish","categories.view","categories.edit","faq.view","faq.edit"],icon:as,color:"bg-blue-100 text-blue-800"},{id:"sales_manager",name:"sales_manager",displayName:"Sales Manager",description:"Manage properties, leads, and sales analytics",permissions:["properties.view","properties.edit","properties.approve","properties.featured","users.view","analytics.view","packages.view","transactions.view","reports.view"],icon:Hs,color:"bg-green-100 text-green-800"},{id:"support_executive",name:"support_executive",displayName:"Support Executive",description:"Handle customer support and user queries",permissions:["users.view","users.support","support.tickets","support.resolve","chat.view","chat.manage","faq.view","notifications.send"],icon:hs,color:"bg-orange-100 text-orange-800"},{id:"property_moderator",name:"property_moderator",displayName:"Property Moderator",description:"Review and moderate property listings",permissions:["properties.view","properties.edit","properties.approve","users.view","categories.view","analytics.view"],icon:Je,color:"bg-cyan-100 text-cyan-800"},{id:"custom_role",name:"custom_role",displayName:"Custom Role",description:"Custom role with specific permissions",permissions:[],icon:bs,color:"bg-gray-100 text-gray-800"}];function Ma(){const{token:s,user:t}=je(),[r,c]=a.useState([]),[N,y]=a.useState(!0),[n,o]=a.useState(""),[f,u]=a.useState(""),[S,x]=a.useState(null),[A,d]=a.useState(""),[v,j]=a.useState("all"),[m,l]=a.useState("all"),[b,T]=a.useState(!1),[C,P]=a.useState(!1),[k,h]=a.useState(null),[w,E]=a.useState(!1),[L,q]=a.useState({name:"",email:"",phone:"",role:"admin",permissions:[],status:"active",password:""});a.useEffect(()=>{V()},[s]);const V=async()=>{if(s)try{y(!0),o("");const B=await fetch("/api/admin/staff",{headers:{Authorization:`Bearer ${s}`}});if(B.ok){const $=await B.json();$.success?c($.data):o($.error||"Failed to fetch staff")}else o(`Failed to fetch staff: ${B.status} ${B.statusText}`)}catch(B){console.error("Error fetching staff:",B),o("Failed to fetch staff")}finally{y(!1)}},p=async()=>{if(!s)return;if(!L.name.trim()){o("Name is required");return}if(!L.email.trim()){o("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(L.email)){o("Please enter a valid email address");return}if(L.role==="custom_role"&&L.permissions.length===0){o("Custom role requires at least one permission");return}try{E(!0),o("");const $=await fetch("/api/admin/staff",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(L)});if($.ok){const O=await $.json();O.success?(O.data.loginCredentials&&(x(O.data.loginCredentials),u(O.message||"Staff member created successfully!")),V(),D(),T(!1),o("")):o(O.error||"Failed to create staff member")}else o("Failed to create staff member")}catch($){console.error("Error creating staff:",$),o("Failed to create staff member")}finally{E(!1)}},i=async()=>{if(!s||!k)return;if(!L.name.trim()){o("Name is required");return}if(!L.email.trim()){o("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(L.email)){o("Please enter a valid email address");return}if(L.role==="custom_role"&&L.permissions.length===0){o("Custom role requires at least one permission");return}try{E(!0),o("");const $=await fetch(`/api/admin/staff/${k._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(L)});if($.ok){const O=await $.json();O.success?(V(),D(),P(!1),h(null),o(""),u("Staff member updated successfully!"),setTimeout(()=>u(""),3e3)):o(O.error||"Failed to update staff member")}else o("Failed to update staff member")}catch($){console.error("Error updating staff:",$),o("Failed to update staff member")}finally{E(!1)}},F=async B=>{if(!(!s||!confirm("Are you sure you want to delete this staff member?")))try{const $=await fetch(`/api/admin/staff/${B}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if($.ok)c(r.filter(O=>O._id!==B));else{const O=await $.json();o(O.error||"Failed to delete staff member")}}catch($){console.error("Error deleting staff:",$),o("Failed to delete staff member")}},I=async(B,$)=>{if(s)try{const O=await fetch(`/api/admin/staff/${B}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:$})});if(O.ok)V();else{const ae=await O.json();o(ae.error||"Failed to update status")}}catch(O){console.error("Error updating status:",O),o("Failed to update status")}},D=()=>{q({name:"",email:"",phone:"",role:"admin",permissions:[],status:"active",password:""})},R=B=>{q({name:B.name,email:B.email,phone:B.phone||"",role:B.role,permissions:B.permissions,status:B.status,password:""})},M=B=>ia.find($=>$.name===B)||ia[4],W=B=>{const $={active:{className:"bg-green-100 text-green-800",icon:Be},inactive:{className:"bg-gray-100 text-gray-800",icon:Ue},suspended:{className:"bg-red-100 text-red-800",icon:Ys}},{className:O,icon:ae}=$[B]||$.active;return e.jsxs(re,{className:O,children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),B?B.charAt(0).toUpperCase()+B.slice(1):"Unknown"]})},J=B=>{const $=M(B);q({...L,role:B,permissions:$.permissions})},H=r.filter(B=>{var X,z;const $=(((X=B.name)==null?void 0:X.toLowerCase())||"").includes(A.toLowerCase())||(((z=B.email)==null?void 0:z.toLowerCase())||"").includes(A.toLowerCase()),O=v==="all"||B.role===v,ae=m==="all"||B.status===m;return $&&O&&ae}),se={total:r.length,active:r.filter(B=>B.status==="active").length,superAdmins:r.filter(B=>B.role==="super_admin").length,contentManagers:r.filter(B=>B.role==="content_manager").length};return N?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading staff..."})]}):e.jsxs("div",{className:"space-y-6",children:[n&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:n}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{o(""),V()},className:"mt-2",children:"Retry"})]}),f&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-green-700",children:f}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>u(""),className:"mt-2",children:"Dismiss"})]}),S&&e.jsx(Re,{open:!!S,onOpenChange:()=>x(null),children:e.jsxs(Ee,{className:"max-w-md",children:[e.jsx(Ie,{children:e.jsxs(Fe,{className:"flex items-center space-x-2",children:[e.jsx(Je,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Login Credentials Generated"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-green-800 text-sm mb-3",children:"Staff member has been created successfully! Here are the login credentials:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white rounded p-3 border",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Username"}),e.jsx("code",{className:"text-sm font-mono text-gray-900",children:S.username})]}),e.jsxs("div",{className:"bg-white rounded p-3 border",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Password"}),e.jsx("code",{className:"text-sm font-mono text-gray-900",children:S.password})]}),e.jsxs("div",{className:"bg-white rounded p-3 border",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Role"}),e.jsx("span",{className:"text-sm capitalize",children:S.role.replace("_"," ")})]}),e.jsxs("div",{className:"bg-white rounded p-3 border",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Staff Login URL"}),e.jsx("code",{className:"text-sm font-mono text-blue-600",children:"/staff/login"})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-yellow-800 text-xs",children:["âš ï¸ ",e.jsx("strong",{children:"Important:"})," Please share these credentials securely with the staff member. They will be required to change their password on first login."]})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:()=>{navigator.clipboard.writeText(`POSTTRR Staff Login Credentials

Username: ${S.username}
Password: ${S.password}
Role: ${S.role}
Login URL: ${window.location.origin}/staff/login

Please change your password after first login.`),u("Credentials copied to clipboard!")},variant:"outline",className:"flex-1",children:"Copy All Details"}),e.jsx(g,{onClick:()=>x(null),className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:"Close"})]})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Staff Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage staff members, roles, and permissions"})]}),e.jsxs(g,{onClick:()=>T(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Staff Member"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Staff"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:se.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All staff members"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Staff"}),e.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:se.active}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Super Admins"}),e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:se.superAdmins}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Full access"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Content Managers"}),e.jsx(as,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:se.contentManagers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Content access"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search staff...",value:A,onChange:B=>d(B.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:v,onValueChange:j,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Role"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Roles"}),ia.map(B=>e.jsx(G,{value:B.name,children:B.displayName},B.id))]})]}),e.jsxs(ue,{value:m,onValueChange:l,children:[e.jsx(xe,{className:"w-48",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"active",children:"Active"}),e.jsx(G,{value:"inactive",children:"Inactive"}),e.jsx(G,{value:"suspended",children:"Suspended"})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Staff Member"}),e.jsx(te,{children:"Role"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Last Login"}),e.jsx(te,{children:"Created"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[H.map(B=>{const $=M(B.role);return e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:B.name?B.name.charAt(0):"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.name}),e.jsx("p",{className:"text-sm text-gray-500",children:B.email}),B.phone&&e.jsx("p",{className:"text-xs text-gray-400",children:B.phone})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($.icon,{className:"h-4 w-4"}),e.jsx(re,{className:$.color,children:$.displayName})]})}),e.jsx(ee,{children:W(B.status)}),e.jsx(ee,{children:B.lastLogin?new Date(B.lastLogin).toLocaleDateString():"Never"}),e.jsx(ee,{children:new Date(B.createdAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{h(B),R(B),P(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>I(B._id,B.status==="active"?"suspended":"active"),children:B.status==="active"?e.jsx(Ys,{className:"h-4 w-4"}):e.jsx(cc,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>F(B._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},B._id)}),H.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No staff members found"})})]})]})})}),e.jsx(Re,{open:b,onOpenChange:T,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add New Staff Member"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),e.jsx(Q,{value:L.name,onChange:B=>q({...L,name:B.target.value}),placeholder:"Enter full name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address *"}),e.jsx(Q,{type:"email",value:L.email,onChange:B=>q({...L,email:B.target.value}),placeholder:"Enter email address..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone Number"}),e.jsx(Q,{value:L.phone,onChange:B=>q({...L,phone:B.target.value}),placeholder:"Enter phone number..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Password *"}),e.jsx(Q,{type:"password",value:L.password,onChange:B=>q({...L,password:B.target.value}),placeholder:"Enter password..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Role *"}),e.jsxs(ue,{value:L.role,onValueChange:J,children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsx(he,{children:ia.map(B=>e.jsx(G,{value:B.name,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B.icon,{className:"h-4 w-4"}),e.jsx("span",{children:B.displayName})]})},B.id))})]}),L.role&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:M(L.role).description})]}),(L.role==="custom_role"||L.role==="super_admin")&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-3",children:["Permissions"," ",L.role==="super_admin"?"(All permissions enabled)":"*"]}),L.role==="super_admin"?e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"Super Admin Access"}),e.jsx("p",{className:"text-sm text-purple-600",children:"This role has complete access to all system features and permissions."})]}):e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-4",children:Object.entries(Sa).map(([B,$])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),B]}),e.jsx("div",{className:"space-y-2",children:$.map(O=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(xr,{id:O.key,checked:L.permissions.includes(O.key),onCheckedChange:ae=>{q(ae?X=>({...X,permissions:[...X.permissions,O.key]}):X=>({...X,permissions:X.permissions.filter(z=>z!==O.key)}))}}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:O.key,className:"text-sm font-medium text-gray-700 cursor-pointer",children:O.label}),e.jsx("p",{className:"text-xs text-gray-500",children:O.description})]})]},O.key))})]},B))})]}),L.permissions.length>0&&L.role!=="super_admin"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Selected Permissions (",L.permissions.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:L.permissions.map(B=>{const $=Object.values(Sa).flat().find(O=>O.key===B);return e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:($==null?void 0:$.label)||B},B)})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(g,{onClick:p,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:w||!L.name||!L.email||!L.password,children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Staff Member"]})})]})]})]})}),e.jsx(Re,{open:C,onOpenChange:P,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Edit Staff Member"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),e.jsx(Q,{value:L.name,onChange:B=>q({...L,name:B.target.value}),placeholder:"Enter full name..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address *"}),e.jsx(Q,{type:"email",value:L.email,onChange:B=>q({...L,email:B.target.value}),placeholder:"Enter email address..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Role *"}),e.jsxs(ue,{value:L.role,onValueChange:J,children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsx(he,{children:ia.map(B=>e.jsx(G,{value:B.name,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B.icon,{className:"h-4 w-4"}),e.jsx("span",{children:B.displayName})]})},B.id))})]}),L.role&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:M(L.role).description})]}),(L.role==="custom_role"||L.role==="super_admin")&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-3",children:["Permissions"," ",L.role==="super_admin"?"(All permissions enabled)":"*"]}),L.role==="super_admin"?e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-purple-800 font-medium",children:"Super Admin Access"}),e.jsx("p",{className:"text-sm text-purple-600",children:"This role has complete access to all system features and permissions."})]}):e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-4",children:Object.entries(Sa).map(([B,$])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),B]}),e.jsx("div",{className:"space-y-2",children:$.map(O=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(xr,{id:`edit_${O.key}`,checked:L.permissions.includes(O.key),onCheckedChange:ae=>{q(ae?X=>({...X,permissions:[...X.permissions,O.key]}):X=>({...X,permissions:X.permissions.filter(z=>z!==O.key)}))}}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`edit_${O.key}`,className:"text-sm font-medium text-gray-700 cursor-pointer",children:O.label}),e.jsx("p",{className:"text-xs text-gray-500",children:O.description})]})]},O.key))})]},B))})]}),L.permissions.length>0&&L.role!=="super_admin"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Selected Permissions (",L.permissions.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:L.permissions.map(B=>{const $=Object.values(Sa).flat().find(O=>O.key===B);return e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:($==null?void 0:$.label)||B},B)})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-6 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsx(g,{onClick:i,className:"bg-[#C70000] hover:bg-[#A60000]",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Update Staff Member"]})})]})]})]})})]})}function am({token:s}){const[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(!1),[o,f]=a.useState(null),[u,S]=a.useState(""),[x,A]=a.useState(1),[d,v]=a.useState(1),[j,m]=a.useState(0),[l,b]=a.useState(!1),{toast:T}=ct(),[C,P]=a.useState({title:"",imageUrl:"",link:"",isActive:!0,sortOrder:1});a.useEffect(()=>{k()},[u,x]);const k=async()=>{try{N(!0);const i=new URLSearchParams({page:x.toString(),limit:"10",...u&&{search:u}}),I=await(await fetch(`/api/admin/banners?${i}`,{headers:{Authorization:`Bearer ${s}`}})).json();I.success?(r(I.data.banners),v(I.data.pagination.pages),m(I.data.pagination.total)):T({title:"Error",description:I.error||"Failed to fetch banners",variant:"destructive"})}catch(i){console.error("Error fetching banners:",i),T({title:"Error",description:"Failed to fetch banners",variant:"destructive"})}finally{N(!1)}},h=(i,F)=>{P(I=>({...I,[i]:F}))},w=async i=>{if(i.size>2*1024*1024){T({title:"Error",description:"Image size must be less than 2MB",variant:"destructive"});return}try{b(!0);const F=new FormData;F.append("image",i);const D=await(await fetch("/api/admin/banners/upload",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:F})).json();D.success?(h("imageUrl",D.data.imageUrl),T({title:"Success",description:"Image uploaded successfully"})):T({title:"Error",description:D.error||"Failed to upload image",variant:"destructive"})}catch(F){console.error("Error uploading image:",F),T({title:"Error",description:"Failed to upload image",variant:"destructive"})}finally{b(!1)}},E=async()=>{if(!C.title.trim()||!C.imageUrl.trim()||!C.link.trim()){T({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{const i=!!o,F=i?`/api/admin/banners/${o._id}`:"/api/admin/banners",I=i?"PUT":"POST";if(i){const M={...o,...C};r(W=>W.map(J=>J._id===o._id?M:J))}const R=await(await fetch(F,{method:I,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(C)})).json();R.success?(T({title:"Success",description:`Banner ${i?"updated":"created"} successfully`}),k(),p(),n(!1)):(i&&r(M=>M.map(W=>W._id===o._id?o:W)),T({title:"Error",description:R.error||`Failed to ${i?"update":"create"} banner`,variant:"destructive"}))}catch(i){o&&r(F=>F.map(I=>I._id===o._id?o:I)),console.error("Error saving banner:",i),T({title:"Error",description:`Failed to ${o?"update":"create"} banner`,variant:"destructive"})}},L=async i=>{if(confirm("Are you sure you want to delete this banner?"))try{const F=t.find(R=>R._id===i);r(R=>R.filter(M=>M._id!==i));const D=await(await fetch(`/api/admin/banners/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).json();D.success?(T({title:"Success",description:"Banner deleted successfully"}),k()):(F&&r(R=>[...R,F]),T({title:"Error",description:D.error||"Failed to delete banner",variant:"destructive"}))}catch(F){k(),console.error("Error deleting banner:",F),T({title:"Error",description:"Failed to delete banner",variant:"destructive"})}},q=async i=>{try{const F={...i,isActive:!i.isActive};r(R=>R.map(M=>M._id===i._id?F:M));const D=await(await fetch(`/api/admin/banners/${i._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({isActive:!i.isActive})})).json();D.success?T({title:"Success",description:`Banner ${i.isActive?"deactivated":"activated"}`}):(r(R=>R.map(M=>M._id===i._id?i:M)),T({title:"Error",description:D.error||"Failed to update banner",variant:"destructive"}))}catch(F){r(I=>I.map(D=>D._id===i._id?i:D)),console.error("Error toggling banner:",F),T({title:"Error",description:"Failed to update banner",variant:"destructive"})}},V=i=>{P({title:i.title,imageUrl:i.imageUrl,link:i.link,isActive:i.isActive,sortOrder:i.sortOrder}),f(i),n(!0)},p=()=>{P({title:"",imageUrl:"",link:"",isActive:!0,sortOrder:1}),f(null)};return c&&t.length===0?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading banners..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Banner Management"}),e.jsxs(Re,{open:y,onOpenChange:n,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{onClick:p,className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Banner"]})}),e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:o?"Edit Banner":"Add New Banner"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx(Q,{value:C.title,onChange:i=>h("title",i.target.value),placeholder:"Enter banner title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{value:C.imageUrl,onChange:i=>h("imageUrl",i.target.value),placeholder:"Enter image URL or upload image",required:!0}),e.jsx("input",{type:"file",accept:"image/*",onChange:i=>{var I;const F=(I=i.target.files)==null?void 0:I[0];F&&w(F)},className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"px-3 py-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 flex items-center",children:e.jsx(lt,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Max file size: 2MB"}),C.imageUrl&&e.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:C.imageUrl,alt:"Banner preview",className:"w-full h-full object-cover",onError:i=>{i.target.src="/placeholder.svg"}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Link URL *"}),e.jsx(Q,{value:C.link,onChange:i=>h("link",i.target.value),placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sort Order"}),e.jsx(Q,{type:"number",min:"1",value:C.sortOrder,onChange:i=>h("sortOrder",parseInt(i.target.value)||1),placeholder:"1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:C.isActive,onCheckedChange:i=>h("isActive",i)}),e.jsx("label",{className:"text-sm font-medium",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsxs(g,{onClick:E,className:"bg-[#C70000] hover:bg-[#A60000] text-white",disabled:l,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),o?"Update Banner":"Create Banner"]}),e.jsxs(g,{onClick:()=>{n(!1),p()},variant:"outline",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{value:u,onChange:i=>{S(i.target.value),A(1)},placeholder:"Search banners...",className:"pl-10"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[j," banner",j!==1?"s":""]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border",children:[e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{className:"w-20",children:"Image"}),e.jsx(te,{children:"Title"}),e.jsx(te,{children:"Link"}),e.jsx(te,{className:"w-24",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(oc,{className:"h-4 w-4 mr-1"}),"Order"]})}),e.jsx(te,{className:"w-20",children:"Status"}),e.jsx(te,{className:"w-32",children:"Actions"})]})}),e.jsx(es,{children:t.map(i=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsx("div",{className:"w-16 h-10 bg-gray-100 rounded overflow-hidden",children:e.jsx("img",{src:i.imageUrl,alt:i.title,className:"w-full h-full object-cover",onError:F=>{F.target.src="/placeholder.svg"}})})}),e.jsx(ee,{className:"font-medium",children:i.title}),e.jsx(ee,{children:e.jsxs("a",{href:i.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(_a,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"truncate max-w-32",children:i.link})]})}),e.jsx(ee,{children:i.sortOrder}),e.jsx(ee,{children:e.jsx(ze,{checked:i.isActive,onCheckedChange:()=>q(i),size:"sm"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{onClick:()=>V(i),variant:"outline",size:"sm",children:e.jsx(Kt,{className:"h-3 w-3"})}),e.jsx(g,{onClick:()=>L(i._id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-3 w-3"})})]})})]},i._id))})]}),t.length===0&&!c&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Banners Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u?"No banners match your search":"Create your first banner to get started"}),e.jsx(g,{onClick:()=>{p(),n(!0)},className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Create Banner"})]})]}),d>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Page ",x," of ",d]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:()=>A(i=>Math.max(1,i-1)),disabled:x===1,variant:"outline",size:"sm",children:"Previous"}),e.jsx(g,{onClick:()=>A(i=>Math.min(d,i+1)),disabled:x===d,variant:"outline",size:"sm",children:"Next"})]})]})]})}const ka=s=>{var t;return Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s==null?void 0:s.results)?s.results:Array.isArray((t=s==null?void 0:s.data)==null?void 0:t.docs)?s.data.docs:[]},rm=s=>s.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),nm=s=>{const t=(s||"").trim();return t?/^https?:\/\//i.test(t)||t.startsWith("/")?t:`/${t}`:""};function im(){const{token:s}=je(),{toast:t}=ct(),[r,c]=a.useState("projects"),[N,y]=a.useState([]),[n,o]=a.useState(!0),[f,u]=a.useState(!1),[S,x]=a.useState(null),[A,d]=a.useState([]),[v,j]=a.useState(!0),[m,l]=a.useState(!1),[b,T]=a.useState(null),[C,P]=a.useState(""),[k,h]=a.useState(!1),[w,E]=a.useState({name:"",slug:"",description:"",location:"",price:0,priceRange:"",status:"upcoming",launchDate:"",completionDate:"",developer:"",amenities:[],images:[],brochureUrl:"",contactInfo:{phone:"",email:"",address:""},isActive:!0,isFeatured:!1,sortOrder:1}),[L,q]=a.useState({title:"",subtitle:"",imageUrl:"",projectId:"",link:"",isActive:!0,sortOrder:1});a.useEffect(()=>{V(),p()},[]);const V=async()=>{if(s)try{o(!0);const X=await fetch("/api/admin/new-projects",{headers:{Authorization:`Bearer ${s}`}}),z=await X.json();if(!X.ok||(z==null?void 0:z.success)===!1)throw new Error((z==null?void 0:z.error)||"Failed to fetch projects");y(ka((z==null?void 0:z.data)??z))}catch(X){console.error("Error fetching projects:",X),y([]),t({title:"Error",description:(X==null?void 0:X.message)||"Failed to fetch projects",variant:"destructive"})}finally{o(!1)}},p=async()=>{if(s)try{j(!0);const X=await fetch("/api/admin/new-projects/banners",{headers:{Authorization:`Bearer ${s}`}}),z=await X.json();if(!X.ok||(z==null?void 0:z.success)===!1)throw new Error((z==null?void 0:z.error)||"Failed to fetch banners");d(ka((z==null?void 0:z.data)??z))}catch(X){console.error("Error fetching banners:",X),d([]),t({title:"Error",description:(X==null?void 0:X.message)||"Failed to fetch banners",variant:"destructive"})}finally{j(!1)}},i=(X,z)=>{if(X==="name")E(le=>({...le,name:z,slug:rm(z)}));else if(X.includes(".")){const[le,Z]=X.split(".");E(ne=>({...ne,[le]:{...ne[le],[Z]:z}}))}else E(le=>({...le,[X]:z}))},F=(X,z)=>{q(le=>({...le,[X]:z}))},I=X=>{const z=se.find(le=>(le._id||"")===X);z&&!L.link&&F("link",`/new-projects/${z.slug||z._id}`),F("projectId",X)},D=async(X,z)=>{if(X.size>5*1024*1024){t({title:"Error",description:"Image size must be less than 5MB",variant:"destructive"});return}try{h(!0);const le=new FormData;le.append("image",X);const Z=await fetch("/api/admin/banners/upload",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:le}),ne=await Z.json();if(Z.ok&&(ne!=null&&ne.success))z==="project"||q(ye=>({...ye,imageUrl:ne.data.imageUrl})),t({title:"Success",description:"Image uploaded successfully"});else throw new Error((ne==null?void 0:ne.error)||"Failed to upload image")}catch(le){console.error("Error uploading image:",le),t({title:"Error",description:(le==null?void 0:le.message)||"Failed to upload image",variant:"destructive"})}finally{h(!1)}},R=async()=>{if(!s||!w.name||!w.location){t({title:"Error",description:"Please fill in required fields",variant:"destructive"});return}try{const X=await fetch("/api/admin/new-projects",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(w)}),z=await X.json();if(X.ok&&(z!=null&&z.success)){t({title:"Success",description:"Project created successfully"}),await V();try{window.dispatchEvent(new Event("newProjectsUpdated"))}catch{}W(),u(!1)}else throw new Error((z==null?void 0:z.error)||"Failed to create project")}catch(X){console.error("Error creating project:",X),t({title:"Error",description:(X==null?void 0:X.message)||"Failed to create project",variant:"destructive"})}},M=async()=>{const X={...L,link:nm(L.link),title:(L.title||"").trim(),imageUrl:(L.imageUrl||"").trim()};if(!s||!X.title||!X.imageUrl||!X.link){t({title:"Error",description:"Please fill Title, Image and Link.",variant:"destructive"});return}try{const z=await fetch("/api/admin/new-projects/banners",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(X)}),le=await z.json();if(z.ok&&(le!=null&&le.success)){t({title:"Success",description:"Banner created successfully"}),await p();try{window.dispatchEvent(new Event("newProjectsUpdated"))}catch{}J(),l(!1)}else throw new Error((le==null?void 0:le.error)||"Failed to create banner")}catch(z){console.error("Error creating banner:",z),t({title:"Error",description:(z==null?void 0:z.message)||"Failed to create banner",variant:"destructive"})}},W=()=>{E({name:"",slug:"",description:"",location:"",price:0,priceRange:"",status:"upcoming",launchDate:"",completionDate:"",developer:"",amenities:[],images:[],brochureUrl:"",contactInfo:{phone:"",email:"",address:""},isActive:!0,isFeatured:!1,sortOrder:1}),x(null)},J=()=>{q({title:"",subtitle:"",imageUrl:"",projectId:"",link:"",isActive:!0,sortOrder:1}),T(null)},H=X=>{const z={upcoming:{className:"bg-blue-100 text-blue-800",label:"Upcoming"},ongoing:{className:"bg-orange-100 text-orange-800",label:"Ongoing"},completed:{className:"bg-green-100 text-green-800",label:"Completed"}},{className:le,label:Z}=z[X]||z.upcoming;return e.jsx(re,{variant:"outline",className:le,children:Z})},se=Array.isArray(N)?N:ka(N),B=Array.isArray(A)?A:ka(A),$=C.trim().toLowerCase(),O=se.filter(X=>{var Z,ne;const z=((Z=X==null?void 0:X.name)==null?void 0:Z.toLowerCase())||"",le=((ne=X==null?void 0:X.location)==null?void 0:ne.toLowerCase())||"";return z.includes($)||le.includes($)}),ae=B.filter(X=>{var le;return(((le=X==null?void 0:X.title)==null?void 0:le.toLowerCase())||"").includes($)});return n&&v?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading New Projects..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"New Projects Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage property projects and promotional banners"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Projects"}),e.jsx(Ya,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:se.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Property projects"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Projects"}),e.jsx(He,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:se.filter(X=>!!X.isActive).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured Projects"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:se.filter(X=>!!X.isFeatured).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Featured listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Banners"}),e.jsx(at,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:B.filter(X=>!!X.isActive).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Promotional banners"})]})]})]}),e.jsxs(Ls,{value:r,onValueChange:X=>c(X),className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-2",children:[e.jsxs(Se,{value:"projects",className:"flex items-center",children:[e.jsx(Ya,{className:"h-4 w-4 mr-2"}),"Projects (",se.length,")"]}),e.jsxs(Se,{value:"banners",className:"flex items-center",children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),"Banners (",B.length,")"]})]}),e.jsxs(ke,{value:"projects",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{value:C,onChange:X=>P(X.target.value),placeholder:"Search projects...",className:"pl-10"})]}),e.jsxs(Re,{open:f,onOpenChange:u,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{onClick:W,className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Project"]})}),e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto","aria-describedby":void 0,children:[e.jsx(Ie,{children:e.jsx(Fe,{children:S?"Edit Project":"Add New Project"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Project Name *"}),e.jsx(Q,{value:w.name,onChange:X=>i("name",X.target.value),placeholder:"Enter project name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Location *"}),e.jsx(Q,{value:w.location,onChange:X=>i("location",X.target.value),placeholder:"Project location"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:w.description,onChange:X=>i("description",X.target.value),placeholder:"Project description",rows:3})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsxs(g,{onClick:R,className:"bg-[#C70000] hover:bg-[#A60000] text-white",disabled:k,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),S?"Update Project":"Create Project"]}),e.jsxs(g,{onClick:()=>{u(!1),W()},variant:"outline",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Project Name"}),e.jsx(te,{children:"Location"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Active"}),e.jsx(te,{children:"Featured"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:O.map(X=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:(X==null?void 0:X.name)||"-"}),e.jsx(ee,{children:(X==null?void 0:X.location)||"-"}),e.jsx(ee,{children:H((X==null?void 0:X.status)||"upcoming")}),e.jsx(ee,{children:e.jsx(ze,{checked:!!(X!=null&&X.isActive),size:"sm"})}),e.jsx(ee,{children:e.jsx(ze,{checked:!!(X!=null&&X.isFeatured),size:"sm"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{variant:"outline",size:"sm",title:"View",children:e.jsx(Ne,{className:"h-3 w-3"})}),e.jsx(g,{variant:"outline",size:"sm",title:"Edit",children:e.jsx(Kt,{className:"h-3 w-3"})}),e.jsx(g,{variant:"outline",size:"sm",className:"text-red-600",title:"Delete",children:e.jsx(De,{className:"h-3 w-3"})})]})})]},X._id||X.slug))})]})})})]}),e.jsxs(ke,{value:"banners",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{value:C,onChange:X=>P(X.target.value),placeholder:"Search banners...",className:"pl-10"})]}),e.jsxs(Re,{open:m,onOpenChange:l,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{onClick:J,className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Banner"]})}),e.jsxs(Ee,{className:"max-w-2xl","aria-describedby":void 0,children:[e.jsx(Ie,{children:e.jsx(Fe,{children:b?"Edit Banner":"Add New Banner"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx(Q,{value:L.title,onChange:X=>F("title",X.target.value),placeholder:"Banner title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Image *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{value:L.imageUrl,onChange:X=>F("imageUrl",X.target.value),placeholder:"Image URL or upload"}),e.jsx("input",{type:"file",accept:"image/*",onChange:X=>{var le;const z=(le=X.target.files)==null?void 0:le[0];z&&D(z,"banner")},className:"hidden",id:"banner-image-upload"}),e.jsx("label",{htmlFor:"banner-image-upload",className:"px-3 py-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 flex items-center",children:e.jsx(lt,{className:"h-4 w-4"})})]}),L.imageUrl&&e.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:L.imageUrl,alt:"Banner preview",className:"w-full h-full object-cover"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Link *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{value:L.link,onChange:X=>F("link",X.target.value),placeholder:"https://example.com OR /new-projects/abc",className:"flex-1"}),e.jsx(_a,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["External URL (http/https) ya internal path (e.g. ",e.jsx("code",{children:"/new-projects/aashish-heights"}),")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Attach to Project (optional)"}),e.jsxs("select",{value:L.projectId,onChange:X=>I(X.target.value),className:"w-full border border-gray-300 rounded-md h-9 px-3 text-sm",children:[e.jsx("option",{value:"",children:"â€” Select Project â€”"}),se.map(X=>e.jsxs("option",{value:X._id||"",children:[X.name," ",X.slug?`(${X.slug})`:""]},X._id||X.slug))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sort Order"}),e.jsx(Q,{type:"number",value:L.sortOrder,onChange:X=>F("sortOrder",Number(X.target.value)||1),placeholder:"1"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-6",children:[e.jsx(ze,{checked:L.isActive,onCheckedChange:X=>F("isActive",X),id:"banner-active"}),e.jsx("label",{htmlFor:"banner-active",className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsxs(g,{onClick:M,className:"bg-[#C70000] hover:bg-[#A60000] text-white",disabled:k,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),b?"Update Banner":"Create Banner"]}),e.jsxs(g,{onClick:()=>{l(!1),J()},variant:"outline",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{className:"w-20",children:"Image"}),e.jsx(te,{children:"Title"}),e.jsx(te,{children:"Link"}),e.jsx(te,{className:"w-24",children:"Order"}),e.jsx(te,{className:"w-20",children:"Status"}),e.jsx(te,{className:"w-32",children:"Actions"})]})}),e.jsx(es,{children:ae.map(X=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsx("div",{className:"w-16 h-10 bg-gray-100 rounded overflow-hidden",children:e.jsx("img",{src:X==null?void 0:X.imageUrl,alt:X==null?void 0:X.title,className:"w-full h-full object-cover"})})}),e.jsx(ee,{className:"font-medium",children:(X==null?void 0:X.title)||"-"}),e.jsx(ee,{children:X!=null&&X.link?e.jsxs("a",{href:X.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(_a,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"truncate max-w-32",children:X.link})]}):e.jsx("span",{className:"text-gray-500",children:"â€”"})}),e.jsx(ee,{children:(X==null?void 0:X.sortOrder)??"-"}),e.jsx(ee,{children:e.jsx(ze,{checked:!!(X!=null&&X.isActive),size:"sm"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{variant:"outline",size:"sm",title:"Edit",children:e.jsx(Kt,{className:"h-3 w-3"})}),e.jsx(g,{variant:"outline",size:"sm",className:"text-red-600",title:"Delete",children:e.jsx(De,{className:"h-3 w-3"})})]})})]},X._id||X.title))})]})})})]})]}),r==="projects"&&O.length===0&&!n&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ya,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Projects Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first new project to get started"}),e.jsx(g,{onClick:()=>{W(),u(!0)},className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Create Project"})]}),r==="banners"&&ae.length===0&&!v&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Banners Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create promotional banners for new projects"}),e.jsx(g,{onClick:()=>{J(),l(!0)},className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Create Banner"})]})]})}function lm(){const{token:s}=je(),{toast:t}=ct(),[r,c]=a.useState([]),[N,y]=a.useState(!0),[n,o]=a.useState({title:"",area:"",description:"",imageUrl:"",isActive:!0,sortOrder:1}),[f,u]=a.useState(!1),S=async()=>{if(s)try{y(!0);const j=await fetch("/api/admin/maps",{headers:{Authorization:`Bearer ${s}`}}),m=await j.json();if(!j.ok||(m==null?void 0:m.success)===!1)throw new Error((m==null?void 0:m.error)||"Failed to load maps");c(Array.isArray(m==null?void 0:m.data)?m.data:[])}catch(j){console.error("Maps load error",j),t({title:"Error",description:(j==null?void 0:j.message)||"Failed to load maps",variant:"destructive"}),c([])}finally{y(!1)}};a.useEffect(()=>{S()},[s]);const x=async j=>{try{u(!0);const m=new FormData;m.append("image",j);const l=await fetch("/api/admin/maps/upload",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:m}),b=await l.json();if(!l.ok||!(b!=null&&b.success))throw new Error((b==null?void 0:b.error)||"Upload failed");o(T=>({...T,imageUrl:b.data.imageUrl})),t({title:"Uploaded",description:"Image uploaded"})}catch(m){t({title:"Error",description:(m==null?void 0:m.message)||"Upload failed",variant:"destructive"})}finally{u(!1)}},A=async()=>{if(!n.imageUrl){t({title:"Image required",description:"Please upload or paste an image URL",variant:"destructive"});return}try{const j=await fetch("/api/admin/maps",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(n)}),m=await j.json();if(!j.ok||!(m!=null&&m.success))throw new Error((m==null?void 0:m.error)||"Create failed");o({title:"",area:"",description:"",imageUrl:"",isActive:!0,sortOrder:1}),await S();try{window.dispatchEvent(new Event("areaMapsUpdated"))}catch{}t({title:"Saved",description:"Map added"})}catch(j){t({title:"Error",description:(j==null?void 0:j.message)||"Create failed",variant:"destructive"})}},d=async(j,m)=>{try{const l=await fetch(`/api/admin/maps/${j}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(m)}),b=await l.json();if(!l.ok||!(b!=null&&b.success))throw new Error((b==null?void 0:b.error)||"Update failed");await S();try{window.dispatchEvent(new Event("areaMapsUpdated"))}catch{}}catch(l){t({title:"Error",description:(l==null?void 0:l.message)||"Update failed",variant:"destructive"})}},v=async j=>{try{const m=await fetch(`/api/admin/maps/${j}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),l=await m.json();if(!m.ok||!(l!=null&&l.success))throw new Error((l==null?void 0:l.error)||"Delete failed");await S();try{window.dispatchEvent(new Event("areaMapsUpdated"))}catch{}}catch(m){t({title:"Error",description:(m==null?void 0:m.message)||"Delete failed",variant:"destructive"})}};return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Area Maps"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Upload area-wise maps with description. Appears on Maps page."}),e.jsxs(U,{className:"mb-6",children:[e.jsx(K,{children:e.jsx(Y,{children:"Add Map"})}),e.jsxs(_,{className:"space-y-3",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2 mb-1",children:[e.jsx(He,{size:16})," Area"]}),e.jsx(Q,{value:n.area||"",onChange:j=>o({...n,area:j.target.value}),placeholder:"e.g. Sector 1, Rohtak"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Title"}),e.jsx(Q,{value:n.title||"",onChange:j=>o({...n,title:j.target.value}),placeholder:"Short title (optional)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Description"}),e.jsx($e,{value:n.description||"",onChange:j=>o({...n,description:j.target.value}),rows:3,placeholder:"Details (optional)"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2 mb-1",children:[e.jsx(at,{size:16})," Image URL"]}),e.jsx(Q,{value:n.imageUrl,onChange:j=>o({...n,imageUrl:j.target.value}),placeholder:"Paste image URL or upload"})]}),e.jsxs("div",{children:[e.jsx("input",{id:"mapfile",type:"file",accept:"image/*",className:"hidden",onChange:j=>{var l;const m=(l=j.target.files)==null?void 0:l[0];m&&x(m)}}),e.jsxs(g,{type:"button",onClick:()=>{var j;return(j=document.getElementById("mapfile"))==null?void 0:j.click()},disabled:f,className:"w-full",children:[e.jsx(lt,{className:"mr-2 h-4 w-4"})," ",f?"Uploading...":"Upload"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{checked:!!n.isActive,onCheckedChange:j=>o({...n,isActive:j})}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Sort Order"}),e.jsx(Q,{type:"number",value:n.sortOrder,onChange:j=>o({...n,sortOrder:parseInt(j.target.value||"0",10)})})]}),e.jsx("div",{children:e.jsxs(g,{onClick:A,className:"w-full",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"})," Save"]})})]}),n.imageUrl&&e.jsx("img",{src:n.imageUrl,alt:"preview",className:"mt-2 rounded border max-h-48 object-contain"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[N&&e.jsx("div",{className:"col-span-3 text-center py-10 text-gray-600",children:"Loading..."}),!N&&r.length===0&&e.jsx("div",{className:"col-span-3 text-center py-10 text-gray-600",children:"No maps yet"}),r.map(j=>e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-base font-semibold",children:j.title||j.area||"Map"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("img",{src:j.imageUrl,alt:j.title||"map",className:"w-full h-40 object-cover rounded"}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Area:"})," ",j.area||"â€”"]}),j.description&&e.jsx("div",{className:"text-sm text-gray-600 line-clamp-2",children:j.description}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{checked:!!j.isActive,onCheckedChange:m=>j._id&&d(j._id,{isActive:m})}),e.jsx("span",{className:"text-xs",children:"Active"})]}),e.jsx(g,{variant:"destructive",size:"sm",onClick:()=>j._id&&v(j._id),children:e.jsx(De,{className:"h-4 w-4"})})]})]})]},j._id))]})]})}function cm(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(null),[u,S]=a.useState(""),x=["https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400","https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=400","https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400","https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=400","https://images.unsplash.com/photo-1593696140826-c58b021acf8b?w=400","https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=400","https://images.unsplash.com/photo-1568605114967-8130f3a36994?w=400","https://images.unsplash.com/photo-1497366216548-37526070297c?w=400","https://images.unsplash.com/photo-1560185007-cde436f6a4d0?w=400","https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=400","https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=400","https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=400","https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400","https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=400","https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=400"];a.useEffect(()=>{A()},[s]);const A=async()=>{if(s)try{N(!0),n("");const{api:m}=await _s(async()=>{const{api:b}=await Promise.resolve().then(()=>Vs);return{api:b}},void 0),l=await m.get("admin/properties",s);l.data.success?r(l.data.data.properties||[]):n(l.data.error||"Failed to fetch properties")}catch(m){console.error("Error fetching properties:",m),n("Failed to fetch properties")}finally{N(!1)}},d=async(m,l)=>{if(!(!s||!l.trim()))try{const b=t.find(P=>P._id===m);if(!b)return;const T=[...b.images,l],{api:C}=await _s(async()=>{const{api:P}=await Promise.resolve().then(()=>Vs);return{api:P}},void 0);await C.put(`admin/properties/${m}`,{images:T},s),r(t.map(P=>P._id===m?{...P,images:T}:P)),S("")}catch(b){console.error("Error adding image:",b),n("Failed to add image")}},v=async(m,l)=>{if(s)try{const b=t.find(P=>P._id===m);if(!b)return;const T=b.images.filter((P,k)=>k!==l),{api:C}=await _s(async()=>{const{api:P}=await Promise.resolve().then(()=>Vs);return{api:P}},void 0);await C.put(`admin/properties/${m}`,{images:T},s),r(t.map(P=>P._id===m?{...P,images:T}:P))}catch(b){console.error("Error removing image:",b),n("Failed to remove image")}},j=(m,l)=>{d(m,l)};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),A()},className:"mt-2",children:"Retry"})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Property Image Manager"}),e.jsx("p",{className:"text-gray-600",children:"Add and manage images for property listings"})]})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Free Stock Images"})}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-5 gap-3",children:x.map((m,l)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:m,alt:`Stock image ${l+1}`,className:"w-full aspect-square object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all rounded-lg flex items-center justify-center",children:e.jsx(g,{size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity bg-[#C70000] hover:bg-[#A60000]",onClick:()=>{o&&j(o._id,m)},disabled:!o,children:e.jsx(we,{className:"h-4 w-4"})})})]},l))}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:o?`Click any image to add to "${o.title}"`:"Select a property first to add images"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.map(m=>{var l,b;return e.jsxs(U,{className:`${(o==null?void 0:o._id)===m._id?"ring-2 ring-[#C70000]":""}`,children:[e.jsx(K,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"text-lg",children:m.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["â‚¹",(m.price/1e5).toFixed(1),"L â€¢"," ",((l=m.location)==null?void 0:l.city)||"Unknown",","," ",((b=m.location)==null?void 0:b.state)||"Unknown"]})]}),e.jsx(g,{variant:"outline",onClick:()=>f(m),className:(o==null?void 0:o._id)===m._id?"bg-[#C70000] text-white":"",children:(o==null?void 0:o._id)===m._id?"Selected":"Select"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2",children:["Current Images (",m.images.length,")"]}),m.images.length>0?e.jsx("div",{className:"grid grid-cols-4 gap-3",children:m.images.map((T,C)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:T,alt:`Property image ${C+1}`,className:"w-full aspect-square object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(g,{size:"sm",variant:"outline",className:"bg-white",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",className:"bg-white text-red-600",onClick:()=>v(m._id,C),children:e.jsx(De,{className:"h-4 w-4"})})]})})]},C))}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(at,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No images added yet"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(Q,{placeholder:"Enter image URL...",value:(o==null?void 0:o._id)===m._id?u:"",onChange:T=>{(o==null?void 0:o._id)===m._id&&S(T.target.value)},disabled:(o==null?void 0:o._id)!==m._id}),e.jsxs(g,{onClick:()=>d(m._id,u),disabled:!u.trim()||(o==null?void 0:o._id)!==m._id,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-1"}),"Add"]})]})]})})]},m._id)}),t.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(at,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No properties found"})]})]})]})}function Wi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState(null),[j,m]=a.useState({page:1,limit:20,total:0,pages:0});a.useEffect(()=>{l()},[s,j.page,u,x]);const l=async()=>{if(s)try{N(!0),n("");const w=new URLSearchParams({page:j.page.toString(),limit:j.limit.toString()});u!=="all"&&w.append("status",u),x!=="all"&&w.append("type",x),o&&w.append("search",o);const E=await fetch(`/api/admin/transactions?${w}`,{headers:{Authorization:`Bearer ${s}`}});if(E.ok){const L=await E.json();L.success?(r(L.data.transactions),m({...j,total:L.data.pagination.total,pages:L.data.pagination.pages})):n(L.error||"Failed to fetch transactions")}else n(`Failed to fetch transactions: ${E.status} ${E.statusText}`)}catch(w){console.error("Error fetching transactions:",w),n("Failed to fetch transactions")}finally{N(!1)}},b=w=>{switch(w){case"paid":return e.jsx(Le,{className:"h-4 w-4 text-green-600"});case"failed":return e.jsx(fs,{className:"h-4 w-4 text-red-600"});case"cancelled":return e.jsx(fs,{className:"h-4 w-4 text-gray-600"});case"pending":return e.jsx(cs,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(cs,{className:"h-4 w-4 text-gray-600"})}},T=w=>{switch(w){case"paid":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},C=w=>{switch(w){case"package_purchase":return"bg-blue-100 text-blue-800";case"featured_upgrade":return"bg-purple-100 text-purple-800";case"listing_fee":return"bg-orange-100 text-orange-800";case"refund":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},P=async(w,E)=>{if(s)try{const L=await fetch(`/api/admin/transactions/${w}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:E})});if(L.ok){const q=await L.json();q.success?(r(t.map(V=>V._id===w?{...V,status:E,updatedAt:new Date().toISOString()}:V)),v(null)):n(q.error||"Failed to update transaction status")}else n(`Failed to update transaction status: ${L.status} ${L.statusText}`)}catch(L){console.error("Error updating transaction status:",L),n("Failed to update transaction status")}},k=t.filter(w=>{var V,p,i;const E=(((V=w.userName)==null?void 0:V.toLowerCase())||"").includes(o.toLowerCase())||(((p=w.userEmail)==null?void 0:p.toLowerCase())||"").includes(o.toLowerCase())||(((i=w.transactionId)==null?void 0:i.toLowerCase())||"").includes(o.toLowerCase()),L=u==="all"||w.status===u,q=x==="all"||w.type===x;return E&&L&&q}),h={totalTransactions:t.length,totalRevenue:t.filter(w=>w.status==="paid"&&w.type!=="refund").reduce((w,E)=>w+E.amount,0),pendingTransactions:t.filter(w=>w.status==="pending").length,failedTransactions:t.filter(w=>w.status==="failed").length};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading transactions..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),l()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Payment Transactions"}),e.jsx("p",{className:"text-gray-600",children:"Monitor and manage all payment transactions"})]}),e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Export Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Transactions"}),e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalTransactions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All transactions"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(pt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["â‚¹",h.totalRevenue.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Completed payments"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Payments"}),e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:h.pendingTransactions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting completion"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Failed Payments"}),e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.failedTransactions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need attention"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4",children:[e.jsx(Q,{placeholder:"Search transactions...",value:o,onChange:w=>f(w.target.value),className:"w-full md:max-w-sm"}),e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:space-y-0 sm:space-x-4 w-full md:w-auto",children:[e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-full sm:w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"paid",children:"Paid"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"failed",children:"Failed"}),e.jsx(G,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-full sm:w-[180px]",children:e.jsx(pe,{placeholder:"Transaction Type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Types"}),e.jsx(G,{value:"package_purchase",children:"Package Purchase"}),e.jsx(G,{value:"featured_upgrade",children:"Featured Upgrade"}),e.jsx(G,{value:"listing_fee",children:"Listing Fee"}),e.jsx(G,{value:"refund",children:"Refund"})]})]}),e.jsxs(g,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{className:"min-w-full",children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{className:"whitespace-nowrap",children:"Transaction ID"}),e.jsx(te,{className:"whitespace-nowrap",children:"User"}),e.jsx(te,{className:"whitespace-nowrap",children:"Amount"}),e.jsx(te,{className:"whitespace-nowrap",children:"Type"}),e.jsx(te,{className:"whitespace-nowrap",children:"Status"}),e.jsx(te,{className:"whitespace-nowrap",children:"Payment Method"}),e.jsx(te,{className:"whitespace-nowrap",children:"Payment Details"}),e.jsx(te,{className:"whitespace-nowrap",children:"Date"}),e.jsx(te,{className:"whitespace-nowrap",children:"Actions"})]})}),e.jsxs(es,{children:[k.map(w=>{var E,L,q,V,p,i,F,I,D,R,M,W;return e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:w.transactionId})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:w.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:w.userEmail})]})}),e.jsx(ee,{children:e.jsxs("span",{className:"font-semibold",children:["â‚¹",w.amount]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:C(w.type),children:w.type?w.type.replace("_"," "):"Unknown"})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[b(w.status),e.jsx(re,{variant:"outline",className:T(w.status),children:w.status})]})}),e.jsx(ee,{children:e.jsx("span",{className:"capitalize",children:w.paymentMethod})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm",children:[((E=w.paymentDetails)==null?void 0:E.upiId)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"UPI ID:"}),e.jsx("p",{className:"font-mono text-xs",children:w.paymentDetails.upiId})]}),((L=w.paymentDetails)==null?void 0:L.bankAccount)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Bank A/c:"}),e.jsx("p",{className:"font-mono text-xs",children:w.paymentDetails.bankAccount})]}),((q=w.paymentDetails)==null?void 0:q.transactionId)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Txn ID:"}),e.jsx("p",{className:"font-mono text-xs",children:w.paymentDetails.transactionId})]}),!((V=w.paymentDetails)!=null&&V.upiId)&&!((p=w.paymentDetails)!=null&&p.bankAccount)&&!((i=w.paymentDetails)!=null&&i.transactionId)&&e.jsx("span",{className:"text-xs text-gray-400",children:"No details"})]})}),e.jsx(ee,{children:new Date(w.createdAt).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsx(g,{size:"sm",variant:"outline",onClick:()=>v(w),children:e.jsx(Ne,{className:"h-4 w-4"})})}),e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Transaction Details"})}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Transaction ID:"}),e.jsx("p",{className:"font-mono text-sm",children:d.transactionId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Amount:"}),e.jsxs("p",{className:"text-lg font-bold",children:["â‚¹",d.amount]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"User:"}),e.jsx("p",{children:d.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:d.userEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Payment Method:"}),e.jsx("p",{className:"capitalize",children:d.paymentMethod})]})]}),(((F=d.paymentDetails)==null?void 0:F.upiId)||((I=d.paymentDetails)==null?void 0:I.bankAccount)||((D=d.paymentDetails)==null?void 0:D.transactionId))&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"font-semibold block mb-3",children:"Payment Details:"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[((R=d.paymentDetails)==null?void 0:R.upiId)&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"UPI ID:"}),e.jsx("span",{className:"text-sm font-mono break-all",children:d.paymentDetails.upiId})]}),((M=d.paymentDetails)==null?void 0:M.bankAccount)&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Bank Account:"}),e.jsx("span",{className:"text-sm font-mono break-all",children:d.paymentDetails.bankAccount})]}),((W=d.paymentDetails)==null?void 0:W.transactionId)&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Transaction ID:"}),e.jsx("span",{className:"text-sm font-mono break-all",children:d.paymentDetails.transactionId})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4"}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Description:"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:d.description})]}),d.packageName&&e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Package:"}),e.jsx("p",{children:d.packageName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Created:"}),e.jsx("p",{children:new Date(d.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Updated:"}),e.jsx("p",{children:new Date(d.updatedAt).toLocaleString()})]})]}),d.status==="pending"&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"font-semibold mb-3 block",children:"Update Payment Status:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>P(d._id,"paid"),children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Mark as Paid"]}),e.jsxs(g,{size:"sm",variant:"destructive",onClick:()=>P(d._id,"failed"),children:[e.jsx(fs,{className:"h-4 w-4 mr-1"}),"Mark as Failed"]})]})]})]})]})]})})]},w._id)}),k.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:9,className:"text-center text-gray-500 py-8",children:"No transactions found"})})]})]})})})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(ys,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{children:"Payment Management Status"})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Manual Payments: Active"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"Manual UPI and bank transfer payments are being tracked and saved to database with proper Pending/Paid status. Admin can manually approve payments."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Status Management: Active"})]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Admin can update payment status from Pending to Paid or Failed. All payment entries are properly saved in database with full audit trail."})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Payment Flow:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[e.jsx("div",{className:"text-xs font-medium text-blue-600",children:"1. User Payment"}),e.jsx("div",{className:"text-xs text-gray-600",children:"UPI/Bank Transfer"})]}),e.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[e.jsx("div",{className:"text-xs font-medium text-yellow-600",children:"2. Pending Status"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Saved in Database"})]}),e.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[e.jsx("div",{className:"text-xs font-medium text-purple-600",children:"3. Admin Review"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Manual Verification"})]}),e.jsxs("div",{className:"text-center p-2 bg-white rounded border",children:[e.jsx("div",{className:"text-xs font-medium text-green-600",children:"4. Paid Status"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Service Activated"})]})]})]})]})]})]})}function Qi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(null),[d,v]=a.useState("");a.useEffect(()=>{j()},[s]),a.useEffect(()=>{const k=setTimeout(()=>{j()},500);return()=>clearTimeout(k)},[o,u]);const j=async()=>{if(s)try{N(!0),n("");const k=new URLSearchParams({page:"1",limit:"50",...u!=="all"&&{status:u},...o&&{search:o}}),h=await fetch(`/api/admin/bank-transfers?${k}`,{headers:{Authorization:`Bearer ${s}`}});if(!h.ok)throw new Error("Failed to fetch bank transfers");const w=await h.json();w.success?r(w.data.transfers||[]):n(w.error||"Failed to fetch bank transfers")}catch(k){console.error("Error fetching bank transfers:",k),n("Failed to fetch bank transfers")}finally{N(!1)}},m=async()=>{if(s)try{N(!0);const k=await fetch("/api/admin/bank-transfers/init-test-data",{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(k.ok){const h=await k.json();h.success?(alert("Test data initialized successfully!"),await j()):alert(h.error||"Failed to initialize test data")}else alert("Failed to initialize test data")}catch(k){console.error("Error initializing test data:",k),alert("Failed to initialize test data")}finally{N(!1)}},l=async(k,h,w="")=>{if(s)try{const E=await fetch(`/api/admin/bank-transfers/${k}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:h,remarks:w})});if(!E.ok)throw new Error("Failed to update transfer status");const L=await E.json();L.success?(await j(),v(""),A(null),alert(`Bank transfer ${h} successfully!`)):n(L.error||"Failed to update transfer status")}catch(E){console.error("Error updating transfer status:",E),n("Failed to update transfer status")}},b=k=>{switch(k){case"verified":return e.jsx(Le,{className:"h-4 w-4 text-green-600"});case"rejected":return e.jsx(fs,{className:"h-4 w-4 text-red-600"});case"pending":return e.jsx(cs,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(ds,{className:"h-4 w-4 text-gray-600"})}},T=k=>{switch(k){case"verified":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},C=t.filter(k=>{const h=k.userName.toLowerCase().includes(o.toLowerCase())||k.userEmail.toLowerCase().includes(o.toLowerCase())||k.referenceNumber.toLowerCase().includes(o.toLowerCase())||k.bankName.toLowerCase().includes(o.toLowerCase()),w=u==="all"||k.status===u;return h&&w}),P={totalTransfers:t.length,pendingTransfers:t.filter(k=>k.status==="pending").length,verifiedTransfers:t.filter(k=>k.status==="verified").length,rejectedTransfers:t.filter(k=>k.status==="rejected").length};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading bank transfers..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),j()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Bank Transfer Management"}),e.jsx("p",{className:"text-gray-600",children:"Verify and manage bank transfer requests"})]}),e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Export Report"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Transfers"}),e.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:P.totalTransfers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All bank transfers"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Verification"}),e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:P.pendingTransfers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Verified"}),e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:P.verifiedTransfers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Approved transfers"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Rejected"}),e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:P.rejectedTransfers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Declined transfers"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search transfers...",value:o,onChange:k=>f(k.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"verified",children:"Verified"}),e.jsx(G,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"User"}),e.jsx(te,{children:"Amount"}),e.jsx(te,{children:"Reference No."}),e.jsx(te,{children:"Bank"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Date"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[C.map(k=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:k.userEmail})]})}),e.jsx(ee,{children:e.jsxs("span",{className:"font-semibold",children:["â‚¹",k.amount]})}),e.jsx(ee,{children:e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:k.referenceNumber})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.bankName}),e.jsx("p",{className:"text-sm text-gray-500",children:k.accountHolderName})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[b(k.status),e.jsx(re,{variant:"outline",className:T(k.status),children:k.status})]})}),e.jsx(ee,{children:new Date(k.transactionDate).toLocaleDateString()}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsx(g,{size:"sm",variant:"outline",onClick:()=>A(k),children:e.jsx(Ne,{className:"h-4 w-4"})})}),e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Bank Transfer Details"})}),x&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"User:"}),e.jsx("p",{children:x.userName}),e.jsx("p",{className:"text-sm text-gray-500",children:x.userEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Amount:"}),e.jsxs("p",{className:"text-lg font-bold",children:["â‚¹",x.amount]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Reference Number:"}),e.jsx("p",{className:"font-mono",children:x.referenceNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Transaction Date:"}),e.jsx("p",{children:new Date(x.transactionDate).toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Bank Name:"}),e.jsx("p",{children:x.bankName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Account Holder:"}),e.jsx("p",{children:x.accountHolderName})]})]}),x.proofDocument&&e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Proof Document:"}),e.jsx("div",{className:"mt-2 p-3 border rounded-lg",children:e.jsx("a",{href:x.proofDocument,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View Document"})})]}),x.remarks&&e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Remarks:"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:x.remarks})]}),x.status==="pending"&&e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Verification Remarks:"}),e.jsx("textarea",{value:d,onChange:h=>v(h.target.value),className:"w-full mt-2 p-3 border rounded-lg resize-none",rows:3,placeholder:"Add remarks for verification..."})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:()=>l(x._id,"verified",d),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Verify Transfer"]}),e.jsxs(g,{variant:"outline",onClick:()=>l(x._id,"rejected",d),className:"text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Reject Transfer"]})]})]})]})]})]}),k.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{size:"sm",onClick:()=>l(k._id,"verified"),className:"bg-green-600 hover:bg-green-700",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>l(k._id,"rejected"),className:"text-red-600 border-red-600 hover:bg-red-50",children:e.jsx(Ue,{className:"h-4 w-4"})})]})]})})]},k._id)),C.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center py-12",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-gray-500",children:[e.jsx(Ft,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium",children:"No bank transfers found"}),e.jsx("p",{className:"text-sm",children:"Bank transfer payments will appear here once users submit them."})]}),t.length===0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"For testing purposes, you can add sample data:"}),e.jsx(g,{onClick:m,disabled:c,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:c?"Adding...":"Add Test Data"})]})]})})})]})]})})})]})}function Ki(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState("all"),[d,v]=a.useState(null),[j,m]=a.useState(!1),[l,b]=a.useState("");a.useEffect(()=>{T()},[s]);const T=async()=>{var E;if(s)try{N(!0),n(""),console.log("ðŸ” Fetching manual payment transactions...");const L=await fetch("/api/admin/transactions?status=pending,processing",{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}}),q=await L.text();console.log("ðŸ“„ Manual payment response:",q);let V;try{V=JSON.parse(q)}catch(p){console.error("âŒ Failed to parse response:",p),n("Invalid response format");return}if(L.ok&&V.success){const p=((E=V.data)==null?void 0:E.transactions)||V.data||[];console.log("âœ… Fetched transactions:",p.length),r(p)}else console.error("âŒ API Error:",V.error),n(V.error||"Failed to fetch transactions")}catch(L){console.error("âŒ Network error:",L),n("Network error. Please try again.")}finally{N(!1)}},C=async(E,L)=>{if(s)try{m(!0);const q=await fetch(`/api/admin/transactions/${E}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:L==="approve"?"approved":"rejected",adminNotes:l.trim()||void 0})});if(q.ok){const V=await q.json();V.success?(r(p=>p.filter(i=>i._id!==E)),v(null),b(""),alert(`Transaction ${L==="approve"?"approved":"rejected"} successfully!`)):n(V.error||`Failed to ${L} transaction`)}else n(`Failed to ${L} transaction`)}catch(q){console.error(`Error ${L}ing transaction:`,q),n(`Failed to ${L} transaction`)}finally{m(!1)}},P=E=>{const L={pending:{variant:"outline",className:"bg-yellow-100 text-yellow-800"},processing:{variant:"outline",className:"bg-blue-100 text-blue-800"},approved:{variant:"default",className:"bg-green-100 text-green-800"},rejected:{variant:"destructive",className:"bg-red-100 text-red-800"}},q=L[E]||L.pending;return e.jsx(re,{variant:q.variant,className:q.className,children:E.charAt(0).toUpperCase()+E.slice(1)})},k=E=>{switch(E){case"upi":return e.jsx(Ge,{className:"h-4 w-4"});case"bank_transfer":return e.jsx(Ft,{className:"h-4 w-4"});case"cash":return e.jsx(pt,{className:"h-4 w-4"});default:return e.jsx(ys,{className:"h-4 w-4"})}},h=t.filter(E=>{var p,i,F,I,D;const L=(((p=E.userName)==null?void 0:p.toLowerCase())||"").includes(o.toLowerCase())||(((i=E.userEmail)==null?void 0:i.toLowerCase())||"").includes(o.toLowerCase())||(((F=E.packageName)==null?void 0:F.toLowerCase())||"").includes(o.toLowerCase())||(((D=(I=E.paymentDetails)==null?void 0:I.transactionId)==null?void 0:D.toLowerCase())||"").includes(o.toLowerCase()),q=u==="all"||E.status===u,V=x==="all"||E.paymentMethod===x;return L&&q&&V}),w={totalPending:t.filter(E=>E.status==="pending").length,totalProcessing:t.filter(E=>E.status==="processing").length,totalAmount:t.reduce((E,L)=>E+L.amount,0),avgAmount:t.length?Math.round(t.reduce((E,L)=>E+L.amount,0)/t.length):0};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading payment transactions..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:y})]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{n(""),T()},className:"mt-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Retry"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Manual Payment Approval"}),e.jsx("p",{className:"text-gray-600",children:"Review and approve manual payment transactions"})]}),e.jsxs(g,{onClick:T,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Approval"}),e.jsx(cs,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:w.totalPending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Processing"}),e.jsx(Ae,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.totalProcessing}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Under review"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Amount"}),e.jsx(pt,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¹",w.totalAmount.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending payments"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Average Amount"}),e.jsx(ys,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["â‚¹",w.avgAmount]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per transaction"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(Q,{placeholder:"Search transactions...",value:o,onChange:E=>f(E.target.value),className:"w-full"})}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Status"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Status"}),e.jsx(G,{value:"pending",children:"Pending"}),e.jsx(G,{value:"processing",children:"Processing"}),e.jsx(G,{value:"approved",children:"Approved"}),e.jsx(G,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(ue,{value:x,onValueChange:A,children:[e.jsx(xe,{className:"w-[150px]",children:e.jsx(pe,{placeholder:"Method"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Methods"}),e.jsx(G,{value:"upi",children:"UPI"}),e.jsx(G,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(G,{value:"cash",children:"Cash"})]})]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"User & Contact"}),e.jsx(te,{children:"Package & Amount"}),e.jsx(te,{children:"Payment Details"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Submitted"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[h.map(E=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:E.userName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(ms,{className:"h-3 w-3"}),e.jsx("span",{children:E.userEmail})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(Ge,{className:"h-3 w-3"}),e.jsx("span",{children:E.userPhone})]})]})}),e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:E.packageName}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["â‚¹",E.amount]}),E.propertyTitle&&e.jsx("p",{className:"text-xs text-gray-500",children:E.propertyTitle})]})}),e.jsxs(ee,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[k(E.paymentMethod),e.jsx("span",{className:"capitalize text-sm",children:E.paymentMethod.replace("_"," ")})]}),E.paymentDetails.transactionId&&e.jsx("p",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded",children:E.paymentDetails.transactionId}),E.paymentDetails.upiId&&e.jsxs("p",{className:"text-xs text-gray-500",children:["UPI: ",E.paymentDetails.upiId]})]}),e.jsx(ee,{children:P(E.status)}),e.jsxs(ee,{children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[e.jsx(Is,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(E.submittedAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(E.submittedAt).toLocaleTimeString()})]}),e.jsx(ee,{children:e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{size:"sm",variant:"outline",onClick:()=>v(E),children:[e.jsx(Ne,{className:"h-4 w-4 mr-1"}),"Review"]})}),e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Review Payment Transaction"})}),d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"User Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:d.userName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{children:d.userEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Phone"}),e.jsx("p",{children:d.userPhone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx("div",{className:"mt-1",children:P(d.status)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Package Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Package"}),e.jsx("p",{className:"font-medium",children:d.packageName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Amount"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["â‚¹",d.amount]})]}),d.propertyTitle&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Property"}),e.jsx("p",{children:d.propertyTitle})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Payment Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Method"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[k(d.paymentMethod),e.jsx("span",{className:"capitalize",children:d.paymentMethod.replace("_"," ")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),e.jsx("p",{children:new Date(d.submittedAt).toLocaleString()})]}),d.paymentDetails.transactionId&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Transaction ID"}),e.jsx("p",{className:"font-mono text-sm bg-white px-3 py-2 rounded border",children:d.paymentDetails.transactionId})]}),d.paymentDetails.upiId&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"UPI ID"}),e.jsx("p",{children:d.paymentDetails.upiId})]}),d.paymentDetails.reference&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Reference"}),e.jsx("p",{children:d.paymentDetails.reference})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Optional)"}),e.jsx($e,{value:l,onChange:L=>b(L.target.value),placeholder:"Add notes about this transaction verification...",rows:3})]}),d.status==="pending"&&e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs(g,{onClick:()=>C(d._id,"approve"),disabled:j,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),j?"Processing...":"Approve Payment"]}),e.jsxs(g,{onClick:()=>C(d._id,"reject"),disabled:j,variant:"destructive",className:"flex-1",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),j?"Processing...":"Reject Payment"]})]})]})]})]})})]},E._id)),h.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No transactions found matching your criteria"})})]})]})})})]})}function Yi(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(null),[u,S]=a.useState(""),[x,A]=a.useState(null);a.useEffect(()=>{d()},[s]);const d=async()=>{if(s)try{N(!0),n("");const b=await fetch("/api/admin/premium-properties",{headers:{Authorization:`Bearer ${s}`}});if(b.ok){const T=await b.json();T.success?r(T.data):n(T.error||"Failed to fetch premium properties")}else n("Failed to fetch premium properties")}catch(b){console.error("Error fetching premium properties:",b),n("Failed to fetch premium properties")}finally{N(!1)}},v=async(b,T)=>{if(s)try{A(b);const C=await fetch(`/api/admin/premium-properties/${b}/approval`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({action:T,adminComments:u||void 0})}),P=await C.json();C.ok&&P.success?(r(t.map(k=>k._id===b?{...k,premiumApprovalStatus:T==="approve"?"approved":"rejected"}:k)),S(""),f(null),alert(`Premium listing ${T}d successfully!`)):n(P.error||`Failed to ${T} premium listing`)}catch(C){console.error(`Error ${T}ing premium listing:`,C),n(`Failed to ${T} premium listing`)}finally{A(null)}},j=t.filter(b=>b.premiumApprovalStatus==="pending"),m=t.filter(b=>b.premiumApprovalStatus==="approved"),l=t.filter(b=>b.premiumApprovalStatus==="rejected");return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading premium listings..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),d()},className:"mt-2",children:"Retry"})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(We,{className:"h-7 w-7 text-[#C70000] mr-3"}),"Premium Listing Approvals"]}),e.jsx("p",{className:"text-gray-600",children:"Review and approve premium property listings"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Approval"}),e.jsx(We,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:j.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Approved"}),e.jsx(Be,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live premium listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Rejected"}),e.jsx(Ue,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rejected listings"})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(We,{className:"h-5 w-5 text-yellow-600 mr-2"}),"Pending Premium Approvals (",j.length,")"]})}),e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Property"}),e.jsx(te,{children:"Price"}),e.jsx(te,{children:"Location"}),e.jsx(te,{children:"Owner Contact"}),e.jsx(te,{children:"Submitted"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[j.map(b=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-lg flex items-center justify-center",children:e.jsx(We,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:b.title}),e.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[b.propertyType," â€¢ ",b.subCategory]})]})]})}),e.jsxs(ee,{children:[e.jsxs("div",{className:"font-semibold",children:["â‚¹",(b.price/1e5).toFixed(1),"L"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["For ",b.priceType]})]}),e.jsxs(ee,{children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(He,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:b.location.area||"Rohtak"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[b.location.address.substring(0,50),"..."]})]}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(hs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:b.contactInfo.name})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:b.contactInfo.phone})]}),b.contactInfo.whatsappNumber&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:b.contactInfo.whatsappNumber})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm",children:new Date(b.createdAt).toLocaleDateString()})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsx(g,{size:"sm",variant:"outline",onClick:()=>f(b),children:e.jsx(Ne,{className:"h-4 w-4"})})}),e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsxs(Fe,{className:"flex items-center",children:[e.jsx(We,{className:"h-5 w-5 text-yellow-600 mr-2"}),"Review Premium Listing"]})}),o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:o.title}),e.jsx("p",{className:"text-gray-600",children:o.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Price:"}),e.jsxs("p",{children:["â‚¹",o.price.toLocaleString()," (",o.priceType,")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type:"}),e.jsxs("p",{className:"capitalize",children:[o.propertyType," - ",o.subCategory]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Contact Information:"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{children:["Name: ",o.contactInfo.name]}),e.jsxs("p",{children:["Phone: ",o.contactInfo.phone]}),o.contactInfo.alternativePhone&&e.jsxs("p",{children:["Alternative: ",o.contactInfo.alternativePhone]}),o.contactInfo.whatsappNumber&&e.jsxs("p",{children:["WhatsApp: ",o.contactInfo.whatsappNumber]}),o.contactInfo.email&&e.jsxs("p",{children:["Email: ",o.contactInfo.email]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Comments (Optional)"}),e.jsx($e,{value:u,onChange:T=>S(T.target.value),placeholder:"Add any comments about this approval/rejection...",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsxs(g,{variant:"outline",onClick:()=>v(o._id,"reject"),disabled:x===o._id,className:"text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Reject"]}),e.jsxs(g,{onClick:()=>v(o._id,"approve"),disabled:x===o._id,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Approve"]})]})]})]})]}),e.jsx(g,{size:"sm",onClick:()=>v(b._id,"approve"),disabled:x===b._id,className:"bg-green-600 hover:bg-green-700 text-white",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>v(b._id,"reject"),disabled:x===b._id,className:"text-red-600 border-red-600 hover:bg-red-50",children:e.jsx(Ue,{className:"h-4 w-4"})})]})})]},b._id)),j.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:6,className:"text-center text-gray-500 py-8",children:"No pending premium approvals"})})]})]})})]})]})}function Xi(){const[s,t]=a.useState(""),[r,c]=a.useState(!1),[N,y]=a.useState({name:"Test User",email:"test@example.com",phone:"+91 9876543210",password:"password123",userType:"seller"}),n=async()=>{c(!0),t("Testing registration...");try{const S=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)}),x=await S.json();t(`Registration test result:
Status: ${S.status}
Success: ${x.success}
Message: ${x.message||"No message"}
Error: ${x.error||"No error"}
Response: ${JSON.stringify(x,null,2)}`)}catch(S){t(`Registration test failed:
Error: ${S.message}
Stack: ${S.stack}`)}finally{c(!1)}},o=async()=>{c(!0),t("Testing login...");try{const S=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:N.email,password:N.password})}),x=await S.json();t(`Login test result:
Status: ${S.status}
Success: ${x.success}
Message: ${x.message||"No message"}
Error: ${x.error||"No error"}
Response: ${JSON.stringify(x,null,2)}`)}catch(S){t(`Login test failed:
Error: ${S.message}
Stack: ${S.stack}`)}finally{c(!1)}},f=async()=>{var S,x;c(!0),t("Testing database connection...");try{const A=await fetch("/api/ping"),d=await A.json();t(`Database connection test:
Status: ${A.status}
Database Status: ${(S=d.database)==null?void 0:S.status}
Database Error: ${((x=d.database)==null?void 0:x.error)||"None"}
Response: ${JSON.stringify(d,null,2)}`)}catch(A){t(`Database test failed:
Error: ${A.message}`)}finally{c(!1)}},u=async()=>{var S,x;c(!0),t("Initializing system...");try{const A=await fetch("/api/init",{method:"POST",headers:{"Content-Type":"application/json"}}),d=await A.json();t(`System initialization result:
Status: ${A.status}
Success: ${d.success}
Message: ${((S=d.data)==null?void 0:S.message)||"No message"}
Initialized: ${JSON.stringify((x=d.data)==null?void 0:x.initialized,null,2)}
Response: ${JSON.stringify(d,null,2)}`)}catch(A){t(`System initialization failed:
Error: ${A.message}`)}finally{c(!1)}};return e.jsx("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Authentication Debug Tool"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx(Q,{value:N.name,onChange:S=>y({...N,name:S.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx(Q,{value:N.email,onChange:S=>y({...N,email:S.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx(Q,{value:N.phone,onChange:S=>y({...N,phone:S.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password"}),e.jsx(Q,{type:"password",value:N.password,onChange:S=>y({...N,password:S.target.value})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(g,{onClick:f,disabled:r,variant:"outline",children:"Test Database"}),e.jsx(g,{onClick:u,disabled:r,className:"bg-purple-600 hover:bg-purple-700",children:"Initialize System"}),e.jsx(g,{onClick:n,disabled:r,className:"bg-blue-600 hover:bg-blue-700",children:"Test Registration"}),e.jsx(g,{onClick:o,disabled:r,className:"bg-green-600 hover:bg-green-700",children:"Test Login"})]}),s&&e.jsx(vs,{children:e.jsx(Ns,{children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap overflow-auto max-h-60",children:s})})})]})]})})}function hr(){const{token:s}=je(),[t,r]=a.useState(null),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(!1);a.useEffect(()=>{u()},[]);const u=async()=>{var d,v,j,m,l,b,T,C;N(!0),n("");try{const P=await fetch("/api/ping"),k=await P.json(),w=await(await fetch("/api/packages")).json();let E=null;if(s)try{const q=await fetch("/api/admin/stats",{headers:{Authorization:`Bearer ${s}`}});q.ok&&(E=await q.json())}catch{console.log("Admin stats not available")}const L={database:{status:((d=k.database)==null?void 0:d.status)||"unknown",error:(v=k.database)==null?void 0:v.error},authentication:{endpoints:P.ok,testUsers:((j=E==null?void 0:E.data)==null?void 0:j.totalUsers)||0,adminUser:((m=E==null?void 0:E.data)==null?void 0:m.totalUsers)>0},packages:{count:w.success&&((l=w.data)==null?void 0:l.length)||0,active:w.success&&((T=(b=w.data)==null?void 0:b.filter(q=>q.active))==null?void 0:T.length)||0,initialized:w.success&&((C=w.data)==null?void 0:C.length)>0},payments:{methods:["upi","bank_transfer","online"],transactions:0,working:!0},overall:"healthy"};L.database.status!=="connected"?L.overall="error":(!L.packages.initialized||L.packages.count===0||L.authentication.testUsers===0)&&(L.overall="warning"),r(L)}catch(P){n(`Failed to check system health: ${P.message}`)}finally{N(!1)}},S=async()=>{f(!0),n("");try{const v=await(await fetch("/api/init",{method:"POST",headers:{"Content-Type":"application/json"}})).json();v.success?(alert(`System initialized successfully! Admin credentials:
Email: admin@aashishproperty.com
Password: admin123`),await u()):n(v.error||"Failed to initialize system")}catch(d){n(`Initialization failed: ${d.message}`)}finally{f(!1)}},x=d=>{if(typeof d=="boolean")return d?e.jsx(Le,{className:"h-5 w-5 text-green-500"}):e.jsx(fs,{className:"h-5 w-5 text-red-500"});switch(d){case"connected":case"healthy":return e.jsx(Le,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(rs,{className:"h-5 w-5 text-yellow-500"});case"error":case"failed":return e.jsx(fs,{className:"h-5 w-5 text-red-500"});default:return e.jsx(rs,{className:"h-5 w-5 text-gray-500"})}},A=d=>{const v={healthy:{variant:"default",className:"bg-green-100 text-green-800"},warning:{variant:"outline",className:"bg-yellow-100 text-yellow-800"},error:{variant:"destructive",className:"bg-red-100 text-red-800"},connected:{variant:"default",className:"bg-green-100 text-green-800"},failed:{variant:"destructive",className:"bg-red-100 text-red-800"}},j=v[d]||v.warning;return e.jsx(re,{variant:j.variant,className:j.className,children:d.charAt(0).toUpperCase()+d.slice(1)})};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Checking system health..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs(vs,{className:"bg-red-50 border-red-200",children:[e.jsx(rs,{className:"h-4 w-4 text-red-500"}),e.jsx(Ns,{className:"text-red-700",children:y})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-xl font-bold",children:"System Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t&&x(t.overall),t&&A(t.overall)]})]}),e.jsx(_,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600",children:"Overall system health and component status"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:u,variant:"outline",size:"sm",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),t&&t.overall!=="healthy"&&e.jsxs(g,{onClick:S,disabled:o,className:"bg-[#C70000] hover:bg-[#A60000]",size:"sm",children:[e.jsx(dc,{className:"h-4 w-4 mr-2"}),o?"Initializing...":"Initialize System"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Database"}),e.jsx(mt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[t&&A(t.database.status),(t==null?void 0:t.database.error)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:t.database.error})]}),t&&x(t.database.status==="connected")]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Authentication"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",children:"Endpoints"}),t&&x(t.authentication.endpoints)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",children:["Users: ",(t==null?void 0:t.authentication.testUsers)||0]}),t&&x(t.authentication.testUsers>0)]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",children:["Total: ",(t==null?void 0:t.packages.count)||0]}),t&&x(t.packages.count>0)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",children:["Active: ",(t==null?void 0:t.packages.active)||0]}),t&&x(t.packages.active>0)]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Payments"}),e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",children:["Methods: ",(t==null?void 0:t.payments.methods.length)||0]}),t&&x(t.payments.working)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",children:"Gateway"}),t&&x(t.payments.working)]})]})})]})]}),t&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"System Details"})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Authentication System"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("li",{children:["â€¢ Registration endpoints: ",t.authentication.endpoints?"âœ“":"âœ—"]}),e.jsxs("li",{children:["â€¢ Login endpoints: ",t.authentication.endpoints?"âœ“":"âœ—"]}),e.jsxs("li",{children:["â€¢ OTP verification: ",t.authentication.endpoints?"âœ“":"âœ—"]}),e.jsxs("li",{children:["â€¢ Total users: ",t.authentication.testUsers]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Package System"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("li",{children:["â€¢ Total packages: ",t.packages.count]}),e.jsxs("li",{children:["â€¢ Active packages: ",t.packages.active]}),e.jsxs("li",{children:["â€¢ Package selection: ",t.packages.initialized?"âœ“":"âœ—"]}),e.jsxs("li",{children:["â€¢ Payment integration: ",t.payments.working?"âœ“":"âœ—"]})]})]})]}),t.overall!=="healthy"&&e.jsxs(vs,{className:"mt-4",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx(Ns,{children:'System needs initialization. Click "Initialize System" to set up default data including admin user, test users, packages, and categories.'})]})]})]})]})}function Zi(){var h;const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState("all"),[x,A]=a.useState(!1),[d,v]=a.useState(null),[j,m]=a.useState({fieldName:"",fieldType:"text",label:"",placeholder:"",description:"",required:!0,category:"personal",active:!0,options:[]});a.useEffect(()=>{l()},[s]);const l=async()=>{if(s)try{N(!0),n(""),r([{_id:"1",fieldName:"fullName",fieldType:"text",label:"Full Name",placeholder:"Enter your full name",description:"Legal name as per government documents",required:!0,order:1,active:!0,category:"personal",validation:{minLength:2,maxLength:100},createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"},{_id:"2",fieldName:"aadhaarNumber",fieldType:"text",label:"Aadhaar Number",placeholder:"Enter 12-digit Aadhaar number",description:"Government issued Aadhaar card number",required:!0,order:2,active:!0,category:"document",validation:{pattern:"^[0-9]{12}$"},createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"},{_id:"3",fieldName:"panNumber",fieldType:"text",label:"PAN Number",placeholder:"Enter PAN number",description:"Permanent Account Number",required:!0,order:3,active:!0,category:"document",validation:{pattern:"^[A-Z]{5}[0-9]{4}[A-Z]{1}$"},createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"},{_id:"4",fieldName:"businessType",fieldType:"select",label:"Business Type",placeholder:"Select business type",description:"Type of real estate business",required:!0,order:4,active:!0,category:"business",options:["Individual Agent","Real Estate Agency","Property Developer","Broker"],createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"},{_id:"5",fieldName:"experienceYears",fieldType:"number",label:"Years of Experience",placeholder:"Enter years of experience",description:"Total years in real estate business",required:!0,order:5,active:!0,category:"business",validation:{minLength:0,maxLength:50},createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"},{_id:"6",fieldName:"addressProof",fieldType:"file",label:"Address Proof",placeholder:"Upload address proof",description:"Government issued address proof document",required:!0,order:6,active:!0,category:"document",validation:{fileTypes:["pdf","jpg","jpeg","png"],maxFileSize:5},createdAt:"2024-01-01T00:00:00Z",updatedAt:"2024-01-01T00:00:00Z"}])}catch(w){console.error("Error fetching verification fields:",w),n("Failed to fetch verification fields")}finally{N(!1)}},b=async()=>{if(!(!s||!j.fieldName||!j.label))try{const w={...j,_id:Date.now().toString(),order:t.length+1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};r([...t,w]),m({fieldName:"",fieldType:"text",label:"",placeholder:"",description:"",required:!0,category:"personal",active:!0,options:[]}),A(!1)}catch(w){console.error("Error creating field:",w),n("Failed to create verification field")}},T=async(w,E)=>{if(s)try{r(t.map(L=>L._id===w?{...L,...E,updatedAt:new Date().toISOString()}:L))}catch(L){console.error("Error updating field:",L),n("Failed to update verification field")}},C=async w=>{if(!(!s||!confirm("Are you sure you want to delete this verification field?")))try{r(t.filter(E=>E._id!==w))}catch(E){console.error("Error deleting field:",E),n("Failed to delete verification field")}},P=t.filter(w=>{const E=w.label.toLowerCase().includes(o.toLowerCase())||w.fieldName.toLowerCase().includes(o.toLowerCase())||w.description.toLowerCase().includes(o.toLowerCase()),L=u==="all"||w.category===u;return E&&L}),k={totalFields:t.length,activeFields:t.filter(w=>w.active).length,requiredFields:t.filter(w=>w.required).length,categoriesCount:[...new Set(t.map(w=>w.category))].length};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading verification fields..."})]}):e.jsxs("div",{className:"space-y-6",children:[y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),l()},className:"mt-2",children:"Retry"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Seller Verification Fields"}),e.jsx("p",{className:"text-gray-600",children:"Configure verification requirements for sellers"})]}),e.jsxs(Re,{open:x,onOpenChange:A,children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Field"]})}),e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Create Verification Field"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Field Name"}),e.jsx(Q,{value:j.fieldName,onChange:w=>m({...j,fieldName:w.target.value}),placeholder:"e.g., fullName"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Field Type"}),e.jsxs(ue,{value:j.fieldType,onValueChange:w=>m({...j,fieldType:w}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select type"})}),e.jsxs(he,{children:[e.jsx(G,{value:"text",children:"Text"}),e.jsx(G,{value:"number",children:"Number"}),e.jsx(G,{value:"email",children:"Email"}),e.jsx(G,{value:"phone",children:"Phone"}),e.jsx(G,{value:"file",children:"File Upload"}),e.jsx(G,{value:"select",children:"Select Dropdown"}),e.jsx(G,{value:"date",children:"Date"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Label"}),e.jsx(Q,{value:j.label,onChange:w=>m({...j,label:w.target.value}),placeholder:"e.g., Full Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Placeholder"}),e.jsx(Q,{value:j.placeholder,onChange:w=>m({...j,placeholder:w.target.value}),placeholder:"e.g., Enter your full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx($e,{value:j.description,onChange:w=>m({...j,description:w.target.value}),placeholder:"Describe what this field is for...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs(ue,{value:j.category,onValueChange:w=>m({...j,category:w}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select category"})}),e.jsxs(he,{children:[e.jsx(G,{value:"personal",children:"Personal Info"}),e.jsx(G,{value:"business",children:"Business Info"}),e.jsx(G,{value:"document",children:"Documents"}),e.jsx(G,{value:"contact",children:"Contact Details"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"required",checked:j.required,onChange:w=>m({...j,required:w.target.checked})}),e.jsx("label",{htmlFor:"required",className:"text-sm",children:"Required"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:j.active,onChange:w=>m({...j,active:w.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm",children:"Active"})]})]})]}),j.fieldType==="select"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Options (comma separated)"}),e.jsx(Q,{value:((h=j.options)==null?void 0:h.join(", "))||"",onChange:w=>m({...j,options:w.target.value.split(", ").filter(E=>(E??"").trim()!=="")}),placeholder:"Option 1, Option 2, Option 3"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(g,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsx(g,{onClick:b,className:"bg-[#C70000] hover:bg-[#A60000]",children:"Create Field"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Fields"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k.totalFields}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Verification fields"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Fields"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k.activeFields}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently in use"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Required Fields"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k.requiredFields}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mandatory fields"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Categories"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k.categoriesCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Field categories"})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(Q,{placeholder:"Search fields...",value:o,onChange:w=>f(w.target.value),className:"max-w-sm"}),e.jsxs(ue,{value:u,onValueChange:S,children:[e.jsx(xe,{className:"w-[180px]",children:e.jsx(pe,{placeholder:"Category"})}),e.jsxs(he,{children:[e.jsx(G,{value:"all",children:"All Categories"}),e.jsx(G,{value:"personal",children:"Personal Info"}),e.jsx(G,{value:"business",children:"Business Info"}),e.jsx(G,{value:"document",children:"Documents"}),e.jsx(G,{value:"contact",children:"Contact Details"})]})]}),e.jsxs(g,{variant:"outline",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter"]})]}),e.jsx(U,{children:e.jsx(_,{className:"p-0",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Field"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Category"}),e.jsx(te,{children:"Required"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[P.map(w=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:w.label}),e.jsx("p",{className:"text-sm text-gray-500",children:w.description}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:w.fieldName})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:"capitalize",children:w.fieldType})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",className:"capitalize",children:w.category})}),e.jsx(ee,{children:w.required?e.jsx(re,{className:"bg-red-100 text-red-800",children:"Required"}):e.jsx(re,{variant:"outline",children:"Optional"})}),e.jsx(ee,{children:e.jsx(re,{variant:w.active?"default":"secondary",className:w.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:w.active?"Active":"Inactive"})}),e.jsx(ee,{children:w.order}),e.jsx(ee,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>T(w._id,{active:!w.active}),className:w.active?"text-red-600":"text-green-600",children:w.active?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>C(w._id),className:"text-red-600 hover:text-red-700",children:e.jsx(De,{className:"h-4 w-4"})})]})})]},w._id)),P.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No verification fields found"})})]})]})})})]})}const Mr=()=>{const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(null),[n,o]=a.useState(null),[f,u]=a.useState(""),[S,x]=a.useState(""),[A,d]=a.useState(""),[v,j]=a.useState("");a.useEffect(()=>{m()},[]);const m=async()=>{try{const T=localStorage.getItem("token");if(!T){j("Authentication required");return}const C=await ce.get("admin/properties/pending",T);C.data.success&&t(C.data.data)}catch(T){console.error("Error fetching pending properties:",T),j("Failed to fetch pending properties")}finally{c(!1)}},l=async(T,C)=>{if(n){y(T),j(""),d("");try{const P={approvalStatus:C,adminComments:f.trim()||void 0};C==="rejected"&&S.trim()&&(P.rejectionReason=S.trim());const k=localStorage.getItem("token");if(!k){j("Authentication required");return}console.log("ðŸ“¤ Sending approval request:",{propertyId:T,payload:P});const h=await ce.put(`admin/properties/${T}/approval`,P,k);console.log("ðŸ“¨ Approval response received:",h),h.data.success?(d(`Property ${C} successfully`),t(s.filter(w=>w._id!==T)),o(null),u(""),x("")):j(h.data.error||"Failed to update property status")}catch(P){console.error("âŒ Approval error:",P),j(P.message||"Network error occurred")}finally{y(null)}}},b=T=>{o(T),u(""),x(""),j(""),d("")};return r?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 animate-pulse"}),[1,2,3].map(T=>e.jsx("div",{className:"h-32 bg-gray-200 rounded animate-pulse"},T))]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Pending Properties"}),e.jsx("p",{className:"text-gray-600",children:"Review and approve property listings"})]}),e.jsxs(re,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[s.length," Pending Review"]})]}),v&&e.jsx(vs,{className:"border-red-200 bg-red-50",children:e.jsx(Ns,{className:"text-red-800",children:v})}),A&&e.jsx(vs,{className:"border-green-200 bg-green-50",children:e.jsx(Ns,{className:"text-green-800",children:A})}),s.length===0?e.jsx(U,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Be,{className:"h-16 w-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All caught up!"}),e.jsx("p",{className:"text-gray-600",children:"No properties pending approval at the moment."})]})}):e.jsx("div",{className:"grid gap-6",children:s.map(T=>e.jsx(U,{className:"overflow-hidden",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:"w-full lg:w-80 h-48 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:T.images&&T.images.length>0?e.jsx("img",{src:T.images[0],alt:T.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-16 w-16 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:T.title}),e.jsx("p",{className:"text-gray-600 line-clamp-3",children:T.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mc,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"font-semibold text-lg",children:["â‚¹",T.price.toLocaleString()," ",T.priceType==="rent"?"/month":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:T.location.address})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:[T.propertyType," - ",T.subCategory]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{children:["Posted ",new Date(T.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[T.specifications.bedrooms&&e.jsxs(re,{variant:"outline",children:[T.specifications.bedrooms," Bedrooms"]}),T.specifications.bathrooms&&e.jsxs(re,{variant:"outline",children:[T.specifications.bathrooms," Bathrooms"]}),e.jsxs(re,{variant:"outline",children:[T.specifications.area," sq ft"]}),T.specifications.furnished&&e.jsx(re,{variant:"outline",children:T.specifications.furnished})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Owner Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:T.contactInfo.name}),e.jsx(re,{variant:"secondary",children:T.ownerType})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:T.contactInfo.phone})]}),T.contactInfo.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:T.contactInfo.email})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsxs(g,{onClick:()=>b(T),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Review"]}),e.jsxs(g,{onClick:()=>l(T._id,"approved"),disabled:N===T._id,className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),N===T._id?"Processing...":"Approve"]}),e.jsxs(g,{onClick:()=>b(T),variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Reject"]})]})]})]})})},T._id))}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Review Property"}),e.jsx(g,{onClick:()=>o(null),variant:"ghost",size:"sm",children:e.jsx(Ue,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:n.title}),e.jsx("p",{className:"text-gray-600",children:n.description})]}),n.images&&n.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Property Images"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.images.slice(0,4).map((T,C)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded overflow-hidden",children:e.jsx("img",{src:T,alt:`Property ${C+1}`,className:"w-full h-full object-cover"})},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Comments (Optional)"}),e.jsx($e,{value:f,onChange:T=>u(T.target.value),placeholder:"Add any comments about this property...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rejection Reason (Required for rejection)"}),e.jsx(Q,{value:S,onChange:T=>x(T.target.value),placeholder:"Specify reason for rejection..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(g,{onClick:()=>o(null),variant:"outline",children:"Cancel"}),e.jsxs(g,{onClick:()=>l(n._id,"rejected"),disabled:N===n._id||!S.trim(),variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),N===n._id?"Rejecting...":"Reject"]}),e.jsxs(g,{onClick:()=>l(n._id,"approved"),disabled:N===n._id,className:"bg-green-600 hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),N===n._id?"Approving...":"Approve"]})]})]})]})})})]})};function om(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState(""),[o,f]=a.useState(!1),[u,S]=a.useState(null),[x,A]=a.useState({name:"",slug:"",active:!0});a.useEffect(()=>{d()},[]);const d=async()=>{if(s)try{N(!0);const C=await fetch("/api/admin/os-categories",{headers:{Authorization:`Bearer ${s}`}}),{ok:P,status:k,data:h}=await Cs(C);P&&h.success?r(h.data.categories):n(Os(h,k,"fetch OS categories"))}catch(C){console.error("Error fetching OS categories:",C),n("Failed to fetch categories")}finally{N(!1)}},v=async()=>{if(!(!s||!x.name||!x.slug))try{const C=await fetch("/api/admin/os-categories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(x)}),{ok:P,status:k,data:h}=await Cs(C);P&&h.success?(await d(),f(!1),A({name:"",slug:"",active:!0}),n("")):n(Os(h,k,"create category"))}catch(C){console.error("Error creating category:",C),n("Failed to create category")}},j=async()=>{if(!(!s||!u||!x.name||!x.slug))try{const C=await fetch(`/api/admin/os-categories/${u._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(x)}),{ok:P,status:k,data:h}=await Cs(C);P&&h.success?(await d(),S(null),A({name:"",slug:"",active:!0}),n("")):n(Os(h,k,"update category"))}catch(C){console.error("Error updating category:",C),n("Failed to update category")}},m=async C=>{if(!(!s||!confirm("Are you sure you want to delete this category?")))try{const P=await fetch(`/api/admin/os-categories/${C}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),{ok:k,status:h,data:w}=await Cs(P);k&&w.success?(await d(),n("")):n(Os(w,h,"delete category"))}catch(P){console.error("Error deleting category:",P),n("Failed to delete category")}},l=C=>{S(C),A({name:C.name,slug:C.slug,active:C.active}),f(!1)},b=()=>{S(null),f(!1),A({name:"",slug:"",active:!0})},T=C=>C.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Service Categories"}),e.jsx("p",{className:"text-gray-600",children:"Manage other services categories"})]}),e.jsxs(g,{onClick:()=>f(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Category"]})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-600",children:y})}),o&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Create New Category"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx(Q,{value:x.name,onChange:C=>{const P=C.target.value;A({...x,name:P,slug:T(P)})},placeholder:"Category name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug"}),e.jsx(Q,{value:x.slug,onChange:C=>A({...x,slug:C.target.value}),placeholder:"category-slug"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:x.active,onChange:C=>A({...x,active:C.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:v,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Category"]}),e.jsxs(g,{variant:"outline",onClick:()=>f(!1),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(C=>e.jsx(U,{children:e.jsx(_,{className:"p-6",children:(u==null?void 0:u._id)===C._id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx(Q,{value:x.name,onChange:P=>A({...x,name:P.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug"}),e.jsx(Q,{value:x.slug,onChange:P=>A({...x,slug:P.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`active-${C._id}`,checked:x.active,onChange:P=>A({...x,active:P.target.checked})}),e.jsx("label",{htmlFor:`active-${C._id}`,className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:j,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Update"]}),e.jsxs(g,{variant:"outline",onClick:b,children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:C.name}),e.jsxs("p",{className:"text-gray-600",children:["Slug: ",C.slug]}),e.jsx(re,{variant:C.active?"default":"secondary",className:"mt-2",children:C.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>l(C),children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>m(C._id),className:"text-red-600 hover:text-red-700",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})},C._id))}),t.length===0&&!c&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No categories found. Create your first category above."})})]})}function dm(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState([]),[y,n]=a.useState(!0),[o,f]=a.useState(""),[u,S]=a.useState(!1),[x,A]=a.useState(null),[d,v]=a.useState({category:"",name:"",slug:"",active:!0});a.useEffect(()=>{m(),j()},[]);const j=async()=>{if(s)try{const w=await fetch("/api/admin/os-categories",{headers:{Authorization:`Bearer ${s}`}}),{ok:E,status:L,data:q}=await Cs(w);E&&q.success&&N(q.data.categories)}catch(w){console.error("Error fetching categories:",w)}},m=async()=>{if(s)try{n(!0);const w=await fetch("/api/admin/os-subcategories",{headers:{Authorization:`Bearer ${s}`}}),{ok:E,status:L,data:q}=await Cs(w);E&&q.success?r(q.data.subcategories):f(Os(q,L,"fetch OS subcategories"))}catch(w){console.error("Error fetching OS subcategories:",w),f("Failed to fetch subcategories")}finally{n(!1)}},l=async()=>{if(!(!s||!d.name||!d.slug||!d.category))try{const w=await fetch("/api/admin/os-subcategories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(d)}),{ok:E,status:L,data:q}=await Cs(w);E&&q.success?(await m(),S(!1),v({category:"",name:"",slug:"",active:!0}),f("")):f(Os(q,L,"create subcategory"))}catch(w){console.error("Error creating subcategory:",w),f("Failed to create subcategory")}},b=async()=>{if(!(!s||!x||!d.name||!d.slug||!d.category))try{const w=await fetch(`/api/admin/os-subcategories/${x._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(d)}),{ok:E,status:L,data:q}=await Cs(w);E&&q.success?(await m(),A(null),v({category:"",name:"",slug:"",active:!0}),f("")):f(Os(q,L,"update subcategory"))}catch(w){console.error("Error updating subcategory:",w),f("Failed to update subcategory")}},T=async w=>{if(!(!s||!confirm("Are you sure you want to delete this subcategory?")))try{const E=await fetch(`/api/admin/os-subcategories/${w}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),{ok:L,status:q,data:V}=await Cs(E);L&&V.success?(await m(),f("")):f(Os(V,q,"delete subcategory"))}catch(E){console.error("Error deleting subcategory:",E),f("Failed to delete subcategory")}},C=w=>{A(w),v({category:w.category,name:w.name,slug:w.slug,active:w.active}),S(!1)},P=()=>{A(null),S(!1),v({category:"",name:"",slug:"",active:!0})},k=w=>w.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),h=w=>{const E=c.find(L=>L.slug===w);return E?E.name:w};return y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading subcategories..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Service Subcategories"}),e.jsx("p",{className:"text-gray-600",children:"Manage subcategories for service categories"})]}),e.jsxs(g,{onClick:()=>S(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Subcategory"]})]}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-600",children:o})}),u&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Create New Subcategory"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs(ue,{value:d.category,onValueChange:w=>v({...d,category:w}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select a category"})}),e.jsx(he,{children:c.filter(w=>w.active).map(w=>e.jsx(G,{value:w.slug,children:w.name},w.slug))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx(Q,{value:d.name,onChange:w=>{const E=w.target.value;v({...d,name:E,slug:k(E)})},placeholder:"Subcategory name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug"}),e.jsx(Q,{value:d.slug,onChange:w=>v({...d,slug:w.target.value}),placeholder:"subcategory-slug"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:d.active,onChange:w=>v({...d,active:w.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:l,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Subcategory"]}),e.jsxs(g,{variant:"outline",onClick:()=>S(!1),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(w=>e.jsx(U,{children:e.jsx(_,{className:"p-6",children:(x==null?void 0:x._id)===w._id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs(ue,{value:d.category,onValueChange:E=>v({...d,category:E}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select a category"})}),e.jsx(he,{children:c.filter(E=>E.active).map(E=>e.jsx(G,{value:E.slug,children:E.name},E.slug))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),e.jsx(Q,{value:d.name,onChange:E=>v({...d,name:E.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug"}),e.jsx(Q,{value:d.slug,onChange:E=>v({...d,slug:E.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`active-${w._id}`,checked:d.active,onChange:E=>v({...d,active:E.target.checked})}),e.jsx("label",{htmlFor:`active-${w._id}`,className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:b,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Update"]}),e.jsxs(g,{variant:"outline",onClick:P,children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:w.name}),e.jsxs("p",{className:"text-gray-600",children:["Category: ",h(w.category)," | Slug:"," ",w.slug]}),e.jsx(re,{variant:w.active?"default":"secondary",className:"mt-2",children:w.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>C(w),children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>T(w._id),className:"text-red-600 hover:text-red-700",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})},w._id))}),t.length===0&&!y&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No subcategories found. Create your first subcategory above."})})]})}function mm(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState([]),[y,n]=a.useState([]),[o,f]=a.useState(!0),[u,S]=a.useState(""),[x,A]=a.useState(!1),[d,v]=a.useState(null),[j,m]=a.useState({category:"",subcategory:"",name:"",phone:"",address:"",photos:["","","",""],geo:{lat:0,lng:0},open:"09:00",close:"18:00",active:!0});a.useEffect(()=>{T(),l(),b()},[]);const l=async()=>{if(s)try{const V=await fetch("/api/admin/os-categories",{headers:{Authorization:`Bearer ${s}`}}),{ok:p,status:i,data:F}=await Cs(V);p&&F.success&&N(F.data.categories)}catch(V){console.error("Error fetching categories:",V)}},b=async()=>{if(s)try{const V=await fetch("/api/admin/os-subcategories",{headers:{Authorization:`Bearer ${s}`}}),{ok:p,status:i,data:F}=await Cs(V);p&&F.success&&n(F.data.subcategories)}catch(V){console.error("Error fetching subcategories:",V)}},T=async()=>{if(s)try{f(!0);const V=await fetch("/api/admin/os-listings",{headers:{Authorization:`Bearer ${s}`}}),{ok:p,status:i,data:F}=await Cs(V);p&&F.success?r(F.data.listings):S(Os(F,i,"fetch OS listings"))}catch(V){console.error("Error fetching OS listings:",V),S("Failed to fetch listings")}finally{f(!1)}},C=async()=>{if(!(!s||!j.name||!j.phone||!j.category||!j.subcategory))try{const V={...j,photos:j.photos.filter(D=>(D??"").trim()!=="")},p=await fetch("/api/admin/os-listings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(V)}),{ok:i,status:F,data:I}=await Cs(p);i&&I.success?(await T(),A(!1),m({category:"",subcategory:"",name:"",phone:"",address:"",photos:["","","",""],geo:{lat:0,lng:0},open:"09:00",close:"18:00",active:!0}),S("")):S(Os(I,F,"create listing"))}catch(V){console.error("Error creating listing:",V),S("Failed to create listing")}},P=async()=>{if(!(!s||!d||!j.name||!j.phone))try{const V={...j,photos:j.photos.filter(D=>(D??"").trim()!=="")},p=await fetch(`/api/admin/os-listings/${d._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(V)}),{ok:i,status:F,data:I}=await Cs(p);i&&I.success?(await T(),v(null),m({category:"",subcategory:"",name:"",phone:"",address:"",photos:["","","",""],geo:{lat:0,lng:0},open:"09:00",close:"18:00",active:!0}),S("")):S(Os(I,F,"update listing"))}catch(V){console.error("Error updating listing:",V),S("Failed to update listing")}},k=async V=>{if(!(!s||!confirm("Are you sure you want to delete this listing?")))try{const p=await fetch(`/api/admin/os-listings/${V}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}}),{ok:i,status:F,data:I}=await Cs(p);i&&I.success?(await T(),S("")):S(Os(I,F,"delete listing"))}catch(p){console.error("Error deleting listing:",p),S("Failed to delete listing")}},h=V=>{v(V),m({category:V.category,subcategory:V.subcategory,name:V.name,phone:V.phone,address:V.address,photos:[...V.photos,"","","",""].slice(0,4),geo:V.geo,open:V.open,close:V.close,active:V.active}),A(!1)},w=()=>{v(null),A(!1),m({category:"",subcategory:"",name:"",phone:"",address:"",photos:["","","",""],geo:{lat:0,lng:0},open:"09:00",close:"18:00",active:!0})},E=V=>{const p=c.find(i=>i.slug===V);return p?p.name:V},L=V=>{const p=y.find(i=>i.slug===V);return p?p.name:V},q=()=>y.filter(V=>V.category===j.category&&V.active);return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading listings..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Service Listings"}),e.jsx("p",{className:"text-gray-600",children:"Manage service provider listings"})]}),e.jsxs(g,{onClick:()=>A(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Listing"]})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-600",children:u})}),x&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Create New Listing"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs(ue,{value:j.category,onValueChange:V=>m({...j,category:V,subcategory:""}),children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select a category"})}),e.jsx(he,{children:c.filter(V=>V.active).map(V=>e.jsx(G,{value:V.slug,children:V.name},V.slug))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcategory"}),e.jsxs(ue,{value:j.subcategory,onValueChange:V=>m({...j,subcategory:V}),disabled:!j.category,children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Select a subcategory"})}),e.jsx(he,{children:q().map(V=>e.jsx(G,{value:V.slug,children:V.name},V.slug))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Name"}),e.jsx(Q,{value:j.name,onChange:V=>m({...j,name:V.target.value}),placeholder:"Business name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx(Q,{value:j.phone,onChange:V=>m({...j,phone:V.target.value}),placeholder:"Phone number"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx($e,{value:j.address,onChange:V=>m({...j,address:V.target.value}),placeholder:"Full address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude"}),e.jsx(Q,{type:"number",step:"any",value:j.geo.lat,onChange:V=>m({...j,geo:{...j.geo,lat:parseFloat(V.target.value)||0}}),placeholder:"28.8955"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude"}),e.jsx(Q,{type:"number",step:"any",value:j.geo.lng,onChange:V=>m({...j,geo:{...j.geo,lng:parseFloat(V.target.value)||0}}),placeholder:"76.6066"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opening Time"}),e.jsx(Q,{type:"time",value:j.open,onChange:V=>m({...j,open:V.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Closing Time"}),e.jsx(Q,{type:"time",value:j.close,onChange:V=>m({...j,close:V.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photos (up to 4)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:j.photos.map((V,p)=>e.jsx(Q,{value:V,onChange:i=>{const F=[...j.photos];F[p]=i.target.value,m({...j,photos:F})},placeholder:`Photo ${p+1} URL`},p))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:j.active,onChange:V=>m({...j,active:V.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:C,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Listing"]}),e.jsxs(g,{variant:"outline",onClick:()=>A(!1),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(V=>e.jsx(U,{children:e.jsx(_,{className:"p-6",children:(d==null?void 0:d._id)===V._id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs(ue,{value:j.category,onValueChange:p=>m({...j,category:p,subcategory:""}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsx(he,{children:c.filter(p=>p.active).map(p=>e.jsx(G,{value:p.slug,children:p.name},p.slug))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcategory"}),e.jsxs(ue,{value:j.subcategory,onValueChange:p=>m({...j,subcategory:p}),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsx(he,{children:q().map(p=>e.jsx(G,{value:p.slug,children:p.name},p.slug))})]})]})]}),e.jsx(Q,{value:j.name,onChange:p=>m({...j,name:p.target.value}),placeholder:"Business name"}),e.jsx(Q,{value:j.phone,onChange:p=>m({...j,phone:p.target.value}),placeholder:"Phone"}),e.jsx($e,{value:j.address,onChange:p=>m({...j,address:p.target.value}),placeholder:"Address"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:P,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Update"]}),e.jsxs(g,{variant:"outline",onClick:w,children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:V.name}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[E(V.category)," â†’"," ",L(V.subcategory)]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ge,{className:"h-4 w-4 mr-1"}),V.phone]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),V.address]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(cs,{className:"h-4 w-4 mr-1"}),V.open," - ",V.close]})]}),e.jsx(re,{variant:V.active?"default":"secondary",className:"mt-2",children:V.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>h(V),children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>k(V._id),className:"text-red-600 hover:text-red-700",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})},V._id))}),t.length===0&&!o&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No listings found. Create your first listing above."})})]})}function xm(){var j;const{token:s}=je(),[t,r]=a.useState(null),[c,N]=a.useState(!1),[y,n]=a.useState(null),[o,f]=a.useState(""),[u,S]=a.useState(""),x=m=>{var b;const l=(b=m.target.files)==null?void 0:b[0];l&&(l.type==="text/csv"||l.name.endsWith(".csv")?(r(l),f(""),n(null)):(f("Please select a CSV file"),r(null)))};async function A(m){S(""),f(""),N(!0);try{const l=new FormData;l.append("file",m);const b=await fetch("/api/admin/os-listings/import",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:l}),T=await b.json().catch(()=>({}));if(!b.ok){S((T==null?void 0:T.error)||"Import failed"),f((T==null?void 0:T.error)||`Import failed (${b.status})`);return}n({created:T.created,updated:T.updated,errors:T.errors}),r(null);const C=document.getElementById("csv-file");C&&(C.value="")}catch(l){S("Network error"),f(`Failed to upload file: ${l.message}`)}finally{N(!1)}}const d=async()=>{!t||!s||await A(t)},v=()=>{const m=`catSlug,subSlug,name,phone,address,lat,lng,photo1,photo2,photo3,photo4,open,close,active
repairs,plumber,Rohtak Plumbing Services,9999999999,Sector 3 Rohtak,28.8955,76.6066,https://example.com/photo1.jpg,,,09:00,18:00,true
repairs,electrician,City Electrical Works,9876543210,Model Town Rohtak,28.8955,76.6066,https://example.com/photo2.jpg,,,08:00,19:00,true`,l=new Blob([m],{type:"text/csv"}),b=window.URL.createObjectURL(l),T=document.createElement("a");T.style.display="none",T.href=b,T.download="other-services-template.csv",document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(b),document.body.removeChild(T)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Bulk Import Service Listings"}),e.jsx("p",{className:"text-gray-600",children:"Import multiple service listings from a CSV file"})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(Ss,{className:"h-5 w-5 mr-2"}),"CSV Format Instructions"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Required Columns:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"catSlug"})," ","or"," ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"categorySlug"})," ","- Category slug (will be auto-created if missing)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"subSlug"})," - Subcategory slug (will be auto-created if missing)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"name"})," - Business name"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"phone"})," - Contact phone number"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"address"})," - Full address"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"lat"})," - Latitude coordinate"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"lng"})," - Longitude coordinate"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"photo1, photo2, photo3, photo4"})," ","- Photo URLs (optional)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"open"})," - Opening time (format: HH:MM)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"close"})," - Closing time (format: HH:MM)"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded",children:"active"})," - true/false for active status"]})]})]}),e.jsx("div",{children:e.jsxs(g,{onClick:v,variant:"outline",className:"w-full",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Download CSV Template"]})})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(lt,{className:"h-5 w-5 mr-2"}),"Upload CSV File"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{id:"csv-file",type:"file",accept:".csv",onChange:x,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[#C70000] file:text-white hover:file:bg-[#A60000]"})}),t&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsxs("p",{className:"text-green-600",children:["Selected file: ",e.jsx("strong",{children:t.name})," (",Math.round(t.size/1024)," KB)"]})}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-600",children:o})}),u&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:u}),e.jsx(g,{onClick:d,disabled:!t||c,className:"w-full bg-[#C70000] hover:bg-[#A60000]",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Upload and Import"]})})]})]}),y&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center",children:[e.jsx(Le,{className:"h-5 w-5 mr-2 text-green-600"}),"Import Results"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsxs("p",{className:"text-green-600 font-medium",children:["Import completed: ",y.created," created,"," ",y.updated||0," updated!"]})}),y.errors&&y.errors.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[e.jsxs("h4",{className:"text-red-600 font-medium mb-2",children:[e.jsx(fs,{className:"h-4 w-4 inline mr-1"}),"Errors during import:"]}),e.jsx("ul",{className:"text-red-600 text-sm space-y-1",children:y.errors.map((m,l)=>e.jsxs("li",{children:["â€¢ ",typeof m=="string"?m:m.error]},l))})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:e.jsx("strong",{children:"Summary:"})}),e.jsxs("ul",{className:"list-disc list-inside",children:[e.jsxs("li",{children:["Created: ",y.created," listings"]}),e.jsxs("li",{children:["Updated: ",y.updated||0," listings"]}),e.jsxs("li",{children:["Errors: ",((j=y.errors)==null?void 0:j.length)||0]})]})]})]})]}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 bg-blue-50 border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Important Notes:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Categories and subcategories will be auto-created if they don't exist"}),e.jsx("li",{children:"â€¢ All coordinates should be in decimal format (e.g., 28.8955, 76.6066)"}),e.jsx("li",{children:"â€¢ Times should be in 24-hour format (e.g., 09:00, 18:00)"}),e.jsx("li",{children:"â€¢ Photo URLs should be publicly accessible"}),e.jsx("li",{children:"â€¢ Duplicate entries will create separate listings"})]})]})})]})}function la({activeTab:s="categories"}){const[t,r]=a.useState(s);return ur.useEffect(()=>{r(s)},[s]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Other Services Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage service categories, subcategories, and listings"})]}),e.jsxs(Ls,{value:t,onValueChange:r,className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-4",children:[e.jsxs(Se,{value:"categories",className:"flex items-center",children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),"Service Categories"]}),e.jsxs(Se,{value:"subcategories",className:"flex items-center",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"Service Subcategories"]}),e.jsxs(Se,{value:"listings",className:"flex items-center",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Service Listings"]}),e.jsxs(Se,{value:"bulk-import",className:"flex items-center",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Bulk Import"]})]}),e.jsx(ke,{value:"categories",className:"mt-6",children:e.jsx(om,{})}),e.jsx(ke,{value:"subcategories",className:"mt-6",children:e.jsx(dm,{})}),e.jsx(ke,{value:"listings",className:"mt-6",children:e.jsx(mm,{})}),e.jsx(ke,{value:"bulk-import",className:"mt-6",children:e.jsx(xm,{})})]})]})}function hm(){const{token:s}=je(),[t,r]=a.useState([]),[c,N]=a.useState(!0),[y,n]=a.useState("");a.useEffect(()=>{o()},[]);const o=async()=>{try{N(!0),n(""),console.log("Fetching conversations...");const u=await window.api("/admin/conversations?limit=20");if(console.log("API result:",u),u.ok){const S=u.json;console.log("Response data:",S),S&&S.success?r(S.data.conversations||[]):S&&S.error?n(S.error):n("Invalid response format")}else{const S=u.json;u.status===401?n("Authentication required. Please login as admin."):u.status===403?n("Access denied. Admin permissions required."):u.status===404?n("API endpoint not found."):n((S==null?void 0:S.error)||`Server error: ${u.status}`)}}catch(u){console.error("Error fetching conversations:",u),n(`Network error: ${u.message}`)}finally{N(!1)}},f=u=>{const S=new Date(u),A=new Date().getTime()-S.getTime(),d=Math.floor(A/(1e3*60*60)),v=Math.floor(A/(1e3*60*60*24));return d<1?"Just now":d<24?`${d}h ago`:v===1?"Yesterday":v<7?`${v}d ago`:S.toLocaleDateString()};return c?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]","data-testid":"support-inbox",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full"})}):e.jsx("div",{className:"space-y-6","data-testid":"support-inbox",children:e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ce,{className:"h-6 w-6 text-[#C70000]"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Support Inbox"})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-red-700",children:y})}),t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No tickets"}),e.jsx("p",{className:"text-gray-500",children:"No support conversations found."})]}):e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:t.map(u=>{var S,x;return e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:((S=u.property)==null?void 0:S.title)||"Property Chat"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Participants:"," ",(u.participantDetails??[]).filter(A=>A&&A.userType!=="admin").map(A=>A.name).join(", ")||"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Last message:"," ",((x=u.lastMessage)==null?void 0:x.message)||"No messages yet"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xs text-gray-400",children:f(u.lastMessageAt||u.createdAt)}),u.hasUnreadAdminMessages&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full ml-auto mt-1"})]})]})},u._id)})})})]})})}function zr(){const{user:s,token:t,isAuthenticated:r,loading:c}=je(),N=window.location.pathname==="/admin/support"?"support-inbox":"dashboard",[y,n]=a.useState(N),[o,f]=a.useState({totalUsers:0,totalProperties:0,activeProperties:0,usersByType:[]}),[u,S]=a.useState([]),[x,A]=a.useState([]),[d,v]=a.useState(!0),[j,m]=a.useState(""),[l,b]=a.useState([]),[T,C]=a.useState(!1),[P,k]=a.useState(!1),[h,w]=a.useState(!1),[E,L]=a.useState([]),q=async()=>{const I=[];try{const D=window.location.hostname.includes(".fly.dev")?"fly.dev":window.location.hostname.includes(".netlify.app")?"netlify":window.location.hostname==="localhost"?"localhost":"unknown";I.push(`Environment: ${D}`),I.push(`URL: ${window.location.href}`);try{const R=await fetch(window.location.origin+"/api/ping",{method:"GET",cache:"no-cache",timeout:5e3});I.push(`Health check: ${R.status} ${R.statusText}`)}catch(R){I.push(`Health check failed: ${R.message}`)}I.push(`Fetch API: ${typeof fetch<"u"?"Available":"Not available"}`),I.push(`Online status: ${navigator.onLine?"Online":"Offline"}`)}catch(D){I.push(`Diagnostics error: ${D.message}`)}return L(I),I},V=()=>{f({totalUsers:150,totalProperties:85,activeProperties:72,usersByType:[{_id:"buyer",count:80},{_id:"seller",count:45},{_id:"agent",count:20},{_id:"admin",count:5}]}),S([{_id:"1",name:"John Doe",email:"john@example.com",userType:"buyer",status:"active"},{_id:"2",name:"Jane Smith",email:"jane@example.com",userType:"seller",status:"active"},{_id:"3",name:"Mike Johnson",email:"mike@example.com",userType:"agent",status:"active"}]),A([{_id:"1",title:"Modern Apartment",location:{city:"Mumbai"},price:5e6,status:"active"},{_id:"2",title:"Villa in Suburbs",location:{city:"Delhi"},price:8e6,status:"active"},{_id:"3",title:"Commercial Space",location:{city:"Bangalore"},price:12e6,status:"pending"}]),v(!1),C(!0),b([])};a.useEffect(()=>{if(c)return;if(!r){console.log("Not authenticated, redirecting to admin login"),window.location.href="/admin/login";return}if((s==null?void 0:s.userType)!=="admin"){console.log("User is not admin:",s==null?void 0:s.userType,"redirecting to admin login"),window.location.href="/admin/login";return}if(console.log("Admin user authenticated, checking data loading mode"),h){console.log("Force offline mode enabled, loading mock data"),V();return}(async()=>{var D,R;try{console.log("ðŸ” Starting connectivity test..."),console.log("ðŸ“ Current environment:",window.location.href);const M=Js("ping");console.log("ðŸŽ¯ Testing API endpoint:",M);const W=new AbortController,J=setTimeout(()=>{console.log("â° Request timeout after 10 seconds"),W.abort()},1e4),H=await fetch(M,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"},signal:W.signal,cache:"no-cache",credentials:"include"});if(clearTimeout(J),console.log("ðŸ“¡ Response received:",{status:H.status,statusText:H.statusText,ok:H.ok,url:H.url}),!H.ok)throw new Error(`HTTP ${H.status}: ${H.statusText}`);console.log("âœ… Connectivity test passed (ping)"),P?(v(!1),C(!0)):t?await p():(console.log("No token present; loading mock admin data (safe mode)"),V())}catch(M){const W={message:(M==null?void 0:M.message)||String(M),name:M==null?void 0:M.name,stack:typeof(M==null?void 0:M.stack)=="string"?M.stack.split(`
`)[0]:void 0,url:Js("admin/stats"),type:typeof M};if(console.error("âš ï¸ Connectivity test failed: "+JSON.stringify(W)),M.name==="AbortError"?console.log("ðŸ”„ Request timed out, enabling offline mode"):(D=M.message)!=null&&D.includes("Failed to fetch")?console.log("ðŸŒ Network connectivity issue detected"):console.log("âŒ Unknown connectivity error"),console.log("ðŸ”„ Enabling graceful offline mode with retry capability"),C(!0),await q(),(R=M.message)!=null&&R.includes("Failed to fetch")||M.name==="TypeError"){console.log("ðŸ­ Network error detected, switching to mock data immediately"),V();return}if(window.location.hostname.includes(".fly.dev")||window.location.hostname.includes(".netlify.app")||window.location.hostname!=="localhost")console.log("ðŸ­ Production environment detected, using mock data"),V();else if(P)v(!1);else try{await p()}catch{console.log("ðŸ“¡ Data fetch also failed, using mock data"),V()}}})()},[r,s,t,c,h,P]);const p=async()=>{var R;if(!t){console.log("No token available - switching to safe offline mode"),V();return}v(!0),m(""),b([]);const I=[];console.log("Fetching admin data with token:",t.substring(0,20)+"...");try{console.log("Fetching admin stats...");const M=Js("admin/stats");console.log("ðŸ“Š Stats URL:",M);const W=await fetch(M,{headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"});if(console.log("ðŸ“Š Stats response:",{status:W.status,statusText:W.statusText,ok:W.ok}),W.ok){const J=await W.json();console.log("Stats data received:",J),J.success?f(J.data):(console.error("Stats fetch failed:",J.error),I.push("Stats API failed"))}else if(W.status===401||W.status===403){console.warn("Stats unauthorized; switching to safe mode"),V();return}else W.status===503?(console.log("Database still connecting, will retry..."),I.push("Database connecting")):(console.error("Stats response not ok:",W.status,W.statusText),I.push(`Stats API error: ${W.status}`))}catch(M){console.error("Error fetching stats:",{error:M.message||M,name:M.name,stack:M.stack}),M.name==="TypeError"&&((R=M.message)!=null&&R.includes("Failed to fetch"))?I.push("Network connectivity issue"):I.push("Stats API unreachable")}try{console.log("Fetching admin users...");const M=await fetch(Js("admin/users?limit=10"),{credentials:"include"});if(M.ok){const W=await M.json();console.log("Users data received:",W),W.success?S(W.data.users):(console.error("Users fetch failed:",W.error),I.push("Users API failed"))}else if(M.status===401||M.status===403){console.warn("Users unauthorized; switching to safe mode"),V();return}else M.status===503?(console.log("Database still connecting for users API, will retry..."),I.push("Database connecting")):(console.error("Users response not ok:",M.status,M.statusText),I.push(`Users API error: ${M.status}`))}catch(M){console.error("Error fetching users:",M),I.push("Users API unreachable")}try{console.log("Fetching admin properties...");const M=await fetch(Js("admin/properties?limit=10"),{credentials:"include"});if(M.ok){const W=await M.json();console.log("Properties data received:",W),W.success?A(W.data.properties):(console.error("Properties fetch failed:",W.error),I.push("Properties API failed"))}else if(M.status===401||M.status===403){console.warn("Properties unauthorized; switching to safe mode"),V();return}else console.error("Properties response not ok:",M.status,M.statusText),I.push(`Properties API error: ${M.status}`)}catch(M){console.error("Error fetching properties:",M),I.push("Properties API unreachable")}if(b(I),I.some(M=>M.includes("Database connecting"))){console.log("Database still connecting, retrying in 3 seconds..."),setTimeout(()=>{d||(console.log("Retrying admin data fetch..."),p())},3e3),v(!1);return}if(I.length>=3){console.log("All APIs failing, auto-enabling force offline mode"),w(!0),V();return}I.length>=2&&(C(!0),console.log("Enabling offline mode due to API failures")),v(!1)};if(c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});(!r||(s==null?void 0:s.userType)!=="admin")&&!T&&d&&V();const i=()=>{var I;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${h?"bg-blue-500":T||l.length>0?"bg-yellow-500":"bg-green-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:h?"Force Offline (Mock Data)":T?"Offline Mode":l.length>0?"Limited Connectivity":"Online"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[T&&e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>{C(!1),b([]),p()},children:[e.jsx(Oe,{className:"h-4 w-4 mr-1"}),"Reconnect"]}),!T&&l.length===0&&e.jsx(g,{variant:"outline",size:"sm",onClick:()=>C(!0),children:"Offline Mode"}),l.length>0&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{w(!0),V()},className:"text-green-600 border-green-300 hover:bg-green-50",children:"Force Offline Mode"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{k(!0),C(!0),b([]),v(!1)},className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:"Skip Data Loading"})]})]})]}),j&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:j})]}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{m(""),p()},className:"mt-2",children:"Retry"})]}),l.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(rs,{className:"h-5 w-5 text-yellow-500"}),e.jsx("p",{className:"text-yellow-700 font-medium",children:"Some services are unavailable"})]}),e.jsx("ul",{className:"text-sm text-yellow-600 ml-7",children:l.map((D,R)=>e.jsxs("li",{children:["â€¢ ",D]},R))}),E.length>0&&e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"text-sm text-yellow-700 cursor-pointer hover:text-yellow-800",children:"Show Network Diagnostics"}),e.jsx("ul",{className:"text-xs text-yellow-600 ml-4 mt-2",children:E.map((D,R)=>e.jsxs("li",{children:["â€¢ ",D]},R))})]}),e.jsxs("div",{className:"flex space-x-2 mt-3",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{b([]),p()},children:"Retry"}),e.jsx(g,{variant:"outline",size:"sm",onClick:async()=>{const D=await q();console.log("Network diagnostics:",D)},children:"Run Diagnostics"})]})]}),d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."}),e.jsxs("div",{className:"mt-6",children:[e.jsx(g,{onClick:()=>{w(!0),V()},variant:"outline",className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:"Load Dashboard Now (Mock Data)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use this if loading takes too long"})]})]}):T||l.length>2?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rs,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Dashboard - Safe Mode"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Some services are temporarily unavailable. You can still access admin functions using the sidebar menu."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl mx-auto",children:[e.jsxs(g,{onClick:()=>n("users"),className:"bg-[#C70000] hover:bg-[#A60000] p-6 h-auto flex flex-col",children:[e.jsx(Ae,{className:"h-8 w-8 mb-2"}),e.jsx("span",{children:"Manage Users"})]}),e.jsxs(g,{onClick:()=>n("properties"),className:"bg-[#C70000] hover:bg-[#A60000] p-6 h-auto flex flex-col",children:[e.jsx(js,{className:"h-8 w-8 mb-2"}),e.jsx("span",{children:"Manage Properties"})]}),e.jsxs(g,{onClick:()=>n("content-management"),className:"bg-[#C70000] hover:bg-[#A60000] p-6 h-auto flex flex-col",children:[e.jsx(as,{className:"h-8 w-8 mb-2"}),e.jsx("span",{children:"Manage Content"})]})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.totalUsers||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered users"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Listings"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.activeProperties||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active properties"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.totalProperties||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All properties"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"User Types"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((I=o.usersByType)==null?void 0:I.length)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Different user types"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Recent Users"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[u.slice(0,5).map((D,R)=>{var M;return e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:((M=D.name)==null?void 0:M.charAt(0))||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:D.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[D.email," â€¢ ",D.userType]})]}),e.jsx(re,{variant:D.status==="active"?"default":"outline",className:D.status==="active"?"bg-green-100 text-green-800":"",children:D.status||"New"})]},D._id)}),u.length===0&&e.jsx("p",{className:"text-gray-500 text-sm",children:"No users found"})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Quick Actions"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Create New Page"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Add About Us, Privacy Policy, etc."})]}),e.jsx(sm,{})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Seed System Data"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Initialize default admin, categories and packages in the DB"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{onClick:async()=>{v(!0),m("");try{const R=await(await fetch("/api/fix/initialize-system",{method:"POST",headers:{"Content-Type":"application/json"}})).json();R.success?window.alert("Initialization completed: "+(R.message||"success")):window.alert("Initialization returned errors: "+JSON.stringify(R.data||R.error||R))}catch(D){console.error("Initialization failed:",D),window.alert("Initialization failed: "+((D==null?void 0:D.message)||D))}finally{v(!1)}},className:"bg-[#C70000] hover:bg-[#A60000]",children:"Initialize System"}),e.jsx(g,{onClick:()=>{n("categories")},variant:"outline",children:"Manage Categories"})]})]}),[{type:"Seller Verification",count:12},{type:"Advertisement Request",count:5},{type:"User Reports",count:3},{type:"Bank Transfers",count:8}].map((D,R)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium",children:D.type}),e.jsx(re,{variant:"destructive",children:D.count})]},R))]})})]})]})]})},F=()=>{try{switch(y){case"dashboard":return i();case"all-users":return e.jsx(mr,{});case"user-analytics":return e.jsx(zi,{});case"ads-listing":return e.jsx($i,{});case"seller-verification":return e.jsx(Oi,{});case"user-reports":return e.jsx(pa,{});case"categories":return e.jsx(_i,{});case"custom-fields":return e.jsx(Ui,{});case"ad-management":return e.jsx(cm,{});case"ad-requested":return e.jsx(Mr,{});case"pending-approval":return e.jsx(Mr,{});case"premium-approvals":return e.jsx(Yi,{});case"ad-tips":return e.jsx(wt,{});case"package-management":return e.jsx(Ri,{});case"listing-package":return e.jsx(Hi,{});case"feature-package":return e.jsx(Gi,{});case"transactions":return e.jsx(Wi,{});case"manual-payment-approval":return e.jsx(Ki,{});case"bank-transfer":return e.jsx(Qi,{});case"seller-management":return e.jsx(ma,{});case"verification-fields":return e.jsx(Zi,{});case"seller-review":return e.jsx(ar,{});case"seller-review-report":return e.jsx(ar,{});case"slider":return e.jsx(tm,{});case"new-projects":return e.jsx(im,{});case"maps":return e.jsx(lm,{});case"banners":return e.jsx(am,{token:t});case"feature-section":return e.jsx(La,{});case"countries":return e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Countries"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This section moved to dedicated page."}),e.jsx("a",{className:"text-[#C70000] underline",href:"/admin/locations/countries",children:"Go to Countries"})]});case"states":return e.jsx(Ct,{});case"cities":return e.jsx(Ct,{});case"areas":return e.jsx(Ct,{});case"report-reasons":return e.jsx(pa,{});case"send-notification":return e.jsx(Bi,{});case"customers":return e.jsx(mr,{});case"role":return e.jsx(Ma,{});case"staff-management":return e.jsx(Ma,{});case"blog-management":return e.jsx(wt,{});case"blogs":return e.jsx(wt,{});case"faq":return e.jsx(wt,{});case"faqs":return e.jsx(wt,{});case"web-queries":return e.jsx(ar,{});case"settings":return e.jsx(Mi,{});case"testing":return e.jsx(Xd,{});case"test-seller-notifications":return e.jsx(Zd,{});case"system-update":return e.jsx(qi,{});case"auth-debug":return e.jsx(Xi,{});case"system-status":return e.jsx(hr,{});case"content-management":return e.jsx(Qs,{});case"pages":return e.jsx(Qs,{});case"static-pages":return e.jsx(Qs,{});case"footer-management":return e.jsx(Ji,{});case"database-diagnostics":return e.jsx(Or,{});case"db-test":return e.jsx(Or,{});case"other-services":return e.jsx(la,{});case"service-categories":return e.jsx(la,{activeTab:"categories"});case"service-subcategories":return e.jsx(la,{activeTab:"subcategories"});case"service-listings":return e.jsx(la,{activeTab:"listings"});case"bulk-import":return e.jsx(la,{activeTab:"bulk-import"});case"support-inbox":return e.jsx(hm,{});default:return i()}}catch(I){return console.error("Error rendering admin section:",I),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rs,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There was an error loading this admin section."}),e.jsx(g,{onClick:()=>n("dashboard"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Go to Dashboard"})]})}};try{return e.jsx(Xt,{activeSection:y,onSectionChange:n,children:F()})}catch(I){return console.error("Error rendering admin page:",I),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Error Loading Admin Panel"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"An error occurred while loading the admin panel."}),e.jsx(g,{onClick:()=>window.location.reload(),className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Refresh Page"})]})})}}function um(){const{login:s}=je(),[t,r]=a.useState("email"),[c,N]=a.useState(""),[y,n]=a.useState(""),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState(!1),d=async v=>{var j,m;v.preventDefault(),S(""),A(!0);try{const l={password:o,userType:"admin"};t==="email"?l.email=c:l.phone=y;const b=await yt.post("auth/login",l);if(!b||b.success===!1)throw new Error((b==null?void 0:b.error)||"Login failed");const T=((j=b==null?void 0:b.data)==null?void 0:j.token)||(b==null?void 0:b.accessToken)||(b==null?void 0:b.token),C=((m=b==null?void 0:b.data)==null?void 0:m.user)||(b==null?void 0:b.user)||null;if(!T)throw new Error("Token missing in response");if(localStorage.setItem("adminToken",T),yt.setToken(T),typeof s=="function")try{s(T,C)}catch{}window.location.href="/admin"}catch(l){S((l==null?void 0:l.message)||"Network error. Please try again.")}finally{A(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center text-gray-600 hover:text-gray-800 mb-4",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("div",{className:"mx-auto h-16 w-16 bg-[#C70000] rounded-full flex items-center justify-center mb-4",children:e.jsx(Ys,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Admin Login"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Sign in to access the admin panel"})]}),u&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:u})]}),e.jsxs("form",{onSubmit:d,className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex border border-gray-300 rounded-lg p-1",children:[e.jsxs("button",{type:"button",onClick:()=>r("email"),className:`flex-1 flex items-center justify-center py-2 px-3 rounded-md text-sm font-medium transition-colors ${t==="email"?"bg-[#C70000] text-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Email"]}),e.jsxs("button",{type:"button",onClick:()=>r("phone"),className:`flex-1 flex items-center justify-center py-2 px-3 rounded-md text-sm font-medium transition-colors ${t==="phone"?"bg-[#C70000] text-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Phone"]})]}),t==="email"?e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"email",children:"Email Address"}),e.jsx(Q,{id:"email",type:"email",placeholder:"admin@aashishproperty.com",value:c,onChange:v=>N(v.target.value),required:!0,className:"mt-1"})]}):e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phone",children:"Phone Number"}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx("div",{className:"flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-md",children:e.jsx("span",{className:"text-gray-600",children:"+91"})}),e.jsx(Q,{id:"phone",type:"tel",placeholder:"9876543210",value:y,onChange:v=>n(v.target.value),className:"rounded-l-none",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"password",children:"Password"}),e.jsx(Q,{id:"password",type:"password",placeholder:"Enter your password",value:o,onChange:v=>f(v.target.value),required:!0,className:"mt-1"})]})]}),e.jsx(g,{type:"submit",disabled:x,className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:x?"Signing in...":"Sign in"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Demo Credentials:"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," admin@aashishproperty.com"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," +919876543210"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," admin123"]})]})]}),e.jsx("div",{className:"text-center text-sm text-gray-600",children:e.jsx("p",{children:"Admin access only. Unauthorized access is prohibited."})})]})})}function pm(){return e.jsx(Xt,{activeSection:"categories",onSectionChange:s=>{s==="categories"?window.location.href="/admin/ads/categories":s==="countries"?window.location.href="/admin/locations/countries":window.location.href="/admin"},children:e.jsx(_i,{})})}function gm(){const{token:s}=je(),{categoryId:t}=zs(),[r,c]=a.useState(""),[N,y]=a.useState([]),[n,o]=a.useState(!0),[f,u]=a.useState(""),[S,x]=a.useState(!1),[A,d]=a.useState(null),[v,j]=a.useState({name:"",slug:"",icon:"",order:0,active:!0}),[m,l]=a.useState(!1);a.useEffect(()=>{const L=()=>b();return window.addEventListener("subcategories:updated",L),window.addEventListener("categories:updated",L),()=>{window.removeEventListener("subcategories:updated",L),window.removeEventListener("categories:updated",L)}},[]),a.useEffect(()=>{b()},[s,t]);const b=async()=>{var L,q,V,p,i,F;if(!(!s||!t))try{o(!0),u("");const I=await ce.get(`admin/subcategories?categoryId=${t}`,s),D=((q=(L=I==null?void 0:I.data)==null?void 0:L.data)==null?void 0:q.subcategories)||((V=I==null?void 0:I.data)==null?void 0:V.data)||(I==null?void 0:I.data),R=(Array.isArray(D)?D:[]).map(H=>{var se,B;return{_id:((B=(se=H._id)==null?void 0:se.toString)==null?void 0:B.call(se))||H._id,categoryId:H.categoryId,name:H.name,slug:H.slug,iconUrl:H.iconUrl,sortOrder:H.sortOrder??H.order??0,isActive:typeof H.isActive=="boolean"?H.isActive:!!H.active}});y(R);const M=await ce.get("admin/categories",s),J=(((i=(p=M==null?void 0:M.data)==null?void 0:p.data)==null?void 0:i.categories)||((F=M==null?void 0:M.data)==null?void 0:F.data)||[]||[]).find(H=>{var se,B;return((B=(se=H._id)==null?void 0:se.toString)==null?void 0:B.call(se))===t||H._id===t});c((J==null?void 0:J.name)||"Category")}catch(I){console.error("Error loading subcategories:",(I==null?void 0:I.message)||I),u((I==null?void 0:I.message)||"Failed to load subcategories")}finally{o(!1)}},T=()=>{j({name:"",slug:"",icon:"",order:0,active:!0}),d(null)},C=()=>{T(),x(!0)},P=L=>{const q=L.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");j(V=>({...V,name:L,slug:q}))},k=async()=>{var L,q,V,p,i,F,I;if(!(!s||!t||!v.name.trim()))try{l(!0);const D={categoryId:t,name:v.name.trim(),slug:((L=v.slug)==null?void 0:L.trim())||void 0,icon:v.icon||void 0,order:Number(v.order)||0,active:!!v.active};if(A)await ce.put(`admin/subcategories/${A._id}`,D,s);else{let R=0,M={...D},W=await ce.post("admin/subcategories",M,s).catch(J=>({error:J}));if(((q=W==null?void 0:W.data)==null?void 0:q.success)!==!0){const J=((V=W==null?void 0:W.data)==null?void 0:V.error)||((p=W==null?void 0:W.error)==null?void 0:p.message)||"";if(/409|exists|already/i.test(J)&&D.slug&&(R=1,M.slug=`${D.slug}-2`,W=await ce.post("admin/subcategories",M,s).catch(H=>({error:H})),((i=W==null?void 0:W.data)==null?void 0:i.success)!==!0&&(R=2,M.slug=`${D.slug}-3`,W=await ce.post("admin/subcategories",M,s).catch(H=>({error:H})))),((F=W==null?void 0:W.data)==null?void 0:F.success)!==!0)throw new Error(((I=W==null?void 0:W.data)==null?void 0:I.error)||"Failed to save")}}x(!1),T(),await b(),window.dispatchEvent(new Event("subcategories:updated")),window.dispatchEvent(new Event("categories:updated"))}catch(D){console.error("Save failed:",(D==null?void 0:D.message)||D),u((D==null?void 0:D.message)||"Failed to save subcategory")}finally{l(!1)}},h=async L=>{const q=[...N];y(V=>V.map(p=>p._id===L._id?{...p,isActive:!p.isActive}:p));try{await ce.put(`admin/subcategories/${L._id}`,{active:!L.isActive},s),window.dispatchEvent(new Event("subcategories:updated"))}catch{y(q)}},w=async L=>{if(s&&confirm("Delete this subcategory? This cannot be undone."))try{await ce.delete(`admin/subcategories/${L}`,s),await b(),window.dispatchEvent(new Event("subcategories:updated")),window.dispatchEvent(new Event("categories:updated"))}catch(q){u((q==null?void 0:q.message)||"Failed to delete subcategory")}},E=a.useMemo(()=>{const L=N.length;return`${r||"Category"} â€¢ ${L} subcategor${L===1?"y":"ies"}`},[r,N.length]);return e.jsx(Xt,{activeSection:"categories",onSectionChange:L=>{window.location.href=L==="categories"?"/admin/ads/categories":"/admin"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:E}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(be,{to:"/admin/ads/categories",className:"text-sm underline",children:"Back to Categories"}),e.jsxs(g,{onClick:C,"aria-label":"Add Subcategory",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Subcategory"]})]})]}),f&&e.jsx("div",{className:"text-red-600",children:f}),e.jsx("div",{className:"bg-white rounded-lg border",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Subcategory"}),e.jsx(te,{children:"Icon"}),e.jsx(te,{children:"Order"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[N.map(L=>e.jsxs(de,{children:[e.jsxs(ee,{children:[e.jsx("div",{className:"font-medium",children:L.name}),e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:L.slug})]}),e.jsx(ee,{children:L.iconUrl?e.jsx("img",{src:L.iconUrl,alt:"icon",className:"w-6 h-6 rounded"}):e.jsx("span",{className:"text-gray-400",children:"â€”"})}),e.jsx(ee,{children:e.jsx("span",{className:"font-mono text-sm",children:L.sortOrder??0})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{checked:L.isActive,onCheckedChange:()=>h(L),"aria-label":`Toggle ${L.name}`}),e.jsx("span",{className:"text-sm",children:L.isActive?"Active":"Inactive"})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{size:"sm",variant:"outline","aria-label":`Edit ${L.name}`,onClick:()=>{d(L),j({name:L.name,slug:L.slug,icon:L.iconUrl,order:L.sortOrder??0,active:L.isActive}),x(!0)},children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",className:"text-red-600","aria-label":`Delete ${L.name}`,onClick:()=>w(L._id),children:e.jsx(De,{className:"h-4 w-4"})})]})})]},L._id)),!n&&N.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:5,className:"text-center text-gray-500 py-6",children:"No subcategories yet"})})]})]})}),e.jsx(Re,{open:S,onOpenChange:L=>{x(L),L||d(null)},children:e.jsxs(Ee,{className:"max-w-lg",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:A?"Edit Subcategory":"Add Subcategory"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name *"}),e.jsx(Q,{value:v.name,onChange:L=>P(L.target.value),placeholder:"Subcategory name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),e.jsx(Q,{value:v.slug,onChange:L=>j(q=>({...q,slug:L.target.value})),placeholder:"slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Icon (URL)"}),e.jsx(Q,{value:v.icon||"",onChange:L=>j(q=>({...q,icon:L.target.value})),placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Order"}),e.jsx(Q,{type:"number",value:v.order,onChange:L=>j(q=>({...q,order:parseInt(L.target.value)||0}))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{checked:v.active,onCheckedChange:L=>j(q=>({...q,active:!!L})),"aria-label":"Toggle active"}),e.jsx("span",{className:"text-sm",children:v.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs(g,{variant:"outline",onClick:()=>x(!1),"aria-label":"Cancel",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsx(g,{onClick:k,disabled:m,"aria-label":"Save Subcategory",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save"]})})]})]})]})})]})})}function jm(){const{token:s}=je(),{toast:t}=ct(),[r,c]=a.useState([]),[N,y]=a.useState(!1),[n,o]=a.useState(null),[f,u]=a.useState(null),[S,x]=a.useState(""),A=a.useMemo(()=>{const m=S.trim().toLowerCase();return m?r.filter(l=>{var b;return l.name.toLowerCase().includes(m)||((b=l.isoCode)==null?void 0:b.toLowerCase().includes(m))}):r},[r,S]),d=async()=>{var m;if(s){y(!0);try{const l=await Ps("admin/locations/countries",{method:"GET",headers:{Authorization:`Bearer ${s}`}});l.ok&&Array.isArray((m=l.data)==null?void 0:m.data)?c(l.data.data):l.ok&&Array.isArray(l.data)?c(l.data):c([])}catch(l){console.warn("Countries fetch failed:",(l==null?void 0:l.message)||l),c([])}finally{y(!1)}}};a.useEffect(()=>{d()},[s]);const v=async(m,l)=>{const b=[...r];c(T=>T.map(C=>C._id===m?{...C,active:l}:C));try{o(m);const T=Js(`admin/locations/countries/${m}/status`);let C=!1;try{C=(await fetch(T,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({active:l}),credentials:"include"})).ok}catch{}if(C||(C=(await Ps(`admin/locations/countries/${m}`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({active:l})})).ok),!C)throw new Error("Failed to update status");t({title:"Status updated"})}catch(T){c(b),t({title:"Error",description:(T==null?void 0:T.message)||"Failed to update",variant:"destructive"})}finally{o(null)}},j=async m=>{var b;if(!window.confirm("Delete this country?"))return;const l=[...r];c(T=>T.filter(C=>C._id!==m));try{u(m);const T=await Ps(`admin/locations/countries/${m}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!T.ok)throw new Error(((b=T.data)==null?void 0:b.error)||"Delete failed");t({title:"Country deleted"})}catch(T){c(l),t({title:"Error",description:(T==null?void 0:T.message)||"Failed to delete",variant:"destructive"})}finally{u(null)}};return e.jsx(Xt,{activeSection:"countries",onSectionChange:m=>{m==="categories"?window.location.href="/admin/ads/categories":m==="countries"?window.location.href="/admin/locations/countries":window.location.href="/admin"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Countries"}),e.jsx("p",{className:"text-gray-600",children:"Manage countries list and status"})]}),e.jsxs(g,{"aria-label":"Add Country",disabled:!0,className:"bg-[#C70000] hover:bg-[#A60000]",children:[" ",e.jsx(we,{className:"h-4 w-4 mr-2"})," Add Country"]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"All Countries"})}),e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Q,{placeholder:"Search countries...",value:S,onChange:m=>x(m.target.value),"aria-label":"Search countries"}),e.jsx(g,{variant:"outline",onClick:()=>d(),"aria-label":"Refresh countries",disabled:N,children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Country"}),e.jsx(te,{children:"ISO Code"}),e.jsx(te,{children:"States"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Actions"})]})}),e.jsxs(es,{children:[A.map(m=>e.jsxs(de,{children:[e.jsx(ee,{className:"font-medium",children:m.name}),e.jsx(ee,{children:m.isoCode||"-"}),e.jsx(ee,{children:m.statesCount??0}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{checked:!!m.active,onCheckedChange:l=>v(m._id,l),disabled:n===m._id,"aria-label":`Toggle status for ${m.name}`}),e.jsx("span",{className:"text-sm",children:m.active?"Active":"Inactive"})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{size:"sm",variant:"outline","aria-label":`Edit ${m.name}`,disabled:!0,children:e.jsx(as,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700","aria-label":`Delete ${m.name}`,onClick:()=>j(m._id),disabled:f===m._id,children:e.jsx(De,{className:"h-4 w-4"})})]})})]},m._id)),A.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:5,className:"text-center text-sm text-gray-500",children:N?"Loading...":"No countries found"})})]})]})})]})]})]})})}const Br={priceType:"",minPrice:"",maxPrice:"",bedrooms:"",bathrooms:"",minArea:"",maxArea:"",sector:"",mohalla:"",sortBy:"date_desc"},Vr=["Sector 1","Sector 2","Sector 3","Sector 4","Sector 5","Sector 6","Sector 7","Sector 8","Sector 9","Sector 10"],fm=["Prem Nagar","Shastri Nagar","DLF Colony","Model Town","Subhash Nagar","Civil Lines","Ram Nagar","Industrial Area"];function dt(){const{category:s,subcategory:t,propertyType:r,slug:c}=zs();Na();const[N,y]=a.useState([]),[n,o]=a.useState(!0),[f,u]=a.useState("list"),[S,x]=a.useState(!1),[A,d]=a.useState(Br),[v,j]=a.useState(null),m=()=>{const h=window.location.pathname;return h.startsWith("/buy/")?"buy":h.startsWith("/sale/")?"sale":h.startsWith("/rent/")?"rent":h.startsWith("/lease/")?"lease":h.startsWith("/pg/")?"pg":s};a.useEffect(()=>{l(),b()},[s,t,c]),a.useEffect(()=>{b()},[A]);const l=async()=>{try{const w=await(await fetch("/api/categories")).json();if(w.success){const E=w.data.find(L=>L.slug===s);j(E)}}catch(h){console.error("Error fetching category data:",h)}},b=async()=>{try{o(!0);const h=new URLSearchParams;h.append("status","active");const w=m();w&&(w==="buy"||w==="sale"?h.append("priceType","sale"):w==="rent"?h.append("priceType","rent"):w==="lease"?h.append("priceType","lease"):w==="pg"&&h.append("propertyType","pg")),c?h.append("subCategory",c):t&&h.append("subCategory",t),s&&!c&&h.append("propertyType",s),r&&h.append("propertyTypeSlug",r),Object.entries(A).forEach(([q,V])=>{V&&h.append(q,V)});const E=await window.api(`properties?${h}`),L=E.ok?E.json:{success:!1,error:"Failed to fetch properties"};L.success&&y(L.data.properties||[])}catch(h){console.error("Error fetching properties:",h)}finally{o(!1)}},T=(h,w)=>{d(E=>({...E,[h]:w}))},C=()=>{d(Br)},P=()=>Object.entries(A).filter(([h,w])=>w&&h!=="sortBy").length,k=()=>{const h=m();if(c){const w=c.replace(/-/g," ").replace(/\b\w/g,L=>L.toUpperCase()),E=h==null?void 0:h.replace(/\b\w/g,L=>L.toUpperCase());return`${w} for ${E}`}return r?r.replace(/-/g," ").replace(/\b\w/g,w=>w.toUpperCase()):t?t.replace(/-/g," ").replace(/\b\w/g,w=>w.toUpperCase()):s?s.replace(/-/g," ").replace(/\b\w/g,w=>w.toUpperCase()):"Properties"};return n?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading properties..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 md:hidden",children:e.jsxs("div",{className:"bg-white h-full w-80 p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:()=>x(!1),className:"p-2",children:e.jsx(Ue,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property For"}),e.jsxs("select",{value:A.priceType,onChange:h=>T("priceType",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"sale",children:"Sale"}),e.jsx("option",{value:"rent",children:"Rent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min Price",value:A.minPrice,onChange:h=>T("minPrice",h.target.value),className:"p-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"number",placeholder:"Max Price",value:A.maxPrice,onChange:h=>T("maxPrice",h.target.value),className:"p-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bedrooms"}),e.jsxs("select",{value:A.bedrooms,onChange:h=>T("bedrooms",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"1",children:"1 BHK"}),e.jsx("option",{value:"2",children:"2 BHK"}),e.jsx("option",{value:"3",children:"3 BHK"}),e.jsx("option",{value:"4",children:"4+ BHK"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bathrooms"}),e.jsxs("select",{value:A.bathrooms,onChange:h=>T("bathrooms",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Area (sq ft)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min Area",value:A.minArea,onChange:h=>T("minArea",h.target.value),className:"p-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"number",placeholder:"Max Area",value:A.maxArea,onChange:h=>T("maxArea",h.target.value),className:"p-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sector"}),e.jsxs("select",{value:A.sector,onChange:h=>T("sector",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Any Sector"}),Vr.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mohalla"}),e.jsxs("select",{value:A.mohalla,onChange:h=>T("mohalla",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Any Mohalla"}),fm.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sort By"}),e.jsxs("select",{value:A.sortBy,onChange:h=>T("sortBy",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"date_desc",children:"Newest First"}),e.jsx("option",{value:"date_asc",children:"Oldest First"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"area_desc",children:"Area: Large to Small"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:C,variant:"outline",className:"flex-1",children:"Clear All"}),e.jsx(g,{onClick:()=>x(!1),className:"flex-1 bg-[#C70000] hover:bg-[#A60000] text-white",children:"Apply Filters"})]})]})]})}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"hidden md:block w-64 bg-white h-screen sticky top-0 border-r border-gray-200 p-4 overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property For"}),e.jsxs("select",{value:A.priceType,onChange:h=>T("priceType",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"sale",children:"Sale"}),e.jsx("option",{value:"rent",children:"Rent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",placeholder:"Min Price",value:A.minPrice,onChange:h=>T("minPrice",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm"}),e.jsx("input",{type:"number",placeholder:"Max Price",value:A.maxPrice,onChange:h=>T("maxPrice",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bedrooms"}),e.jsxs("select",{value:A.bedrooms,onChange:h=>T("bedrooms",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"1",children:"1 BHK"}),e.jsx("option",{value:"2",children:"2 BHK"}),e.jsx("option",{value:"3",children:"3 BHK"}),e.jsx("option",{value:"4",children:"4+ BHK"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sector"}),e.jsxs("select",{value:A.sector,onChange:h=>T("sector",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"Any Sector"}),Vr.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sort By"}),e.jsxs("select",{value:A.sortBy,onChange:h=>T("sortBy",h.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"date_desc",children:"Newest First"}),e.jsx("option",{value:"date_asc",children:"Oldest First"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"area_desc",children:"Area: Large to Small"})]})]}),e.jsx(g,{onClick:C,variant:"outline",className:"w-full",children:"Clear All Filters"})]})]}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"mr-4 p-2 bg-white rounded-full shadow-md",children:e.jsx(Qe,{className:"h-5 w-5 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:k()}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N.length," properties found"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"hidden md:flex border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:()=>u("list"),className:`p-2 ${f==="list"?"bg-gray-100":""}`,children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>u("grid"),className:`p-2 ${f==="grid"?"bg-gray-100":""}`,children:e.jsx(Lt,{className:"h-4 w-4"})})]}),e.jsxs(g,{onClick:()=>x(!0),variant:"outline",size:"sm",className:"md:hidden border-[#C70000] text-[#C70000]",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Filter",P()>0&&e.jsx("span",{className:"ml-1 bg-[#C70000] text-white text-xs rounded-full px-1.5 py-0.5",children:P()})]})]})]}),e.jsx("div",{"data-testid":"listing-page",children:N.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Properties Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No properties match your current filters. Try adjusting your search criteria."}),e.jsx(g,{onClick:C,variant:"outline",className:"border-[#C70000] text-[#C70000]",children:"Clear Filters"})]})}):e.jsx("div",{className:f==="grid"?"prop-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:N.map(h=>{var w,E,L,q,V,p,i,F,I;return e.jsxs("div",{className:`prop-card bg-white rounded-lg shadow-sm overflow-hidden ${f==="grid"?"flex flex-col":"flex"}`,children:[e.jsxs("div",{className:`relative ${f==="grid"?"w-full h-48":"w-32 h-32 flex-shrink-0"}`,children:[e.jsx("img",{"data-wm":"1",src:h.coverImageUrl??((E=(w=h.images)==null?void 0:w[0])==null?void 0:E.url)??((L=h.images)==null?void 0:L[0])??"/placeholder.png",alt:h.title,className:"w-full h-full object-cover",onError:D=>{const R=D.target;R.src="/placeholder.png"}}),e.jsx("button",{onClick:D=>{D.stopPropagation()},className:"absolute top-2 right-2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md hover:bg-gray-50",children:e.jsx(xs,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:`p-4 ${f==="grid"?"flex-1":""}`,children:[e.jsxs("div",{className:`${f==="grid"?"mb-2":"flex justify-between items-start mb-2"}`,children:[e.jsx("h3",{className:"font-semibold text-gray-900 leading-tight",children:h.title}),e.jsxs("span",{className:`text-lg font-bold text-[#C70000] ${f==="list"?"ml-2":""}`,children:["â‚¹",((q=h.price)==null?void 0:q.toLocaleString())||"0",h.priceType==="rent"&&"/month"]})]}),e.jsxs("div",{className:"flex items-center text-gray-500 mb-2",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:((V=h.location)==null?void 0:V.address)||"Location not available"})]}),e.jsxs("div",{className:"flex items-center text-gray-500 mb-3 text-sm",children:[((p=h.specifications)==null?void 0:p.bedrooms)&&e.jsxs("span",{className:"mr-4",children:[h.specifications.bedrooms," BHK"]}),((i=h.specifications)==null?void 0:i.bathrooms)&&e.jsxs("span",{className:"mr-4",children:[h.specifications.bathrooms," Bath"]}),e.jsxs("span",{children:[((F=h.specifications)==null?void 0:F.area)||0," sq ft"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-400",children:((I=h.contactInfo)==null?void 0:I.name)||"Owner"}),e.jsxs(g,{size:"sm",className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(Ge,{className:"h-3 w-3 mr-1"}),"Call"]})]})]})]},h._id)})})})]})]}),e.jsx(ve,{})]})}function el(){a.useEffect(()=>{const s="ashishproperties.in",r=['[data-role="property-hero"] img',".property-hero img",".property-gallery img",".lightbox img",'[role="dialog"] img','img[data-wm="1"]'],c=v=>{if(!v||v.dataset.noWm==="true"||v.classList.contains("no-wm"))return!0;const j=v.naturalWidth||v.width||0,m=v.naturalHeight||v.height||0;return j<120||m<120},N=v=>v.dataset.wmProcessed==="1",y=v=>{v.dataset.wmProcessed="1"},n=v=>new Promise((j,m)=>{if(v.complete&&v.naturalWidth>0)return j();const l=()=>{T(),j()},b=()=>{T(),m(new Error("img-error"))},T=()=>{v.removeEventListener("load",l),v.removeEventListener("error",b)};v.addEventListener("load",l),v.addEventListener("error",b)}),o=(v,j,m)=>{let l=0;const b=j.toUpperCase();for(let T=0;T<b.length;T++){const C=v.measureText(b[T]);l+=C.width,T!==b.length-1&&(l+=m)}return l},f=async v=>{await n(v);const j=v.naturalWidth,m=v.naturalHeight;if(!j||!m)throw new Error("no-size");const l=v.currentSrc||v.src,b=new Image;b.crossOrigin="anonymous",b.decoding="async",b.loading="eager";const T=new Promise((M,W)=>{b.onload=()=>M(),b.onerror=()=>W(new Error("cors-blocked"))});b.src=l,await T;const C=document.createElement("canvas");C.width=j,C.height=m;const P=C.getContext("2d");if(!P)throw new Error("ctx");P.clearRect(0,0,j,m),P.drawImage(b,0,0,j,m);const k=v.getBoundingClientRect(),h=Math.max(1,k.width||v.width||j),w=Math.max(1,k.height||v.height||m),E=Math.min(h,w);let L=Math.max(24,Math.round(E*.16));const q=Math.round(L*.06);P.font=`800 ${L}px Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif`;const V=s.toUpperCase();let p=o(P,V,q);const i=j*.7;if(p>i){const M=i/p;L=Math.max(18,Math.floor(L*M)),P.font=`800 ${L}px Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif`,p=o(P,V,Math.round(L*.06))}const F=Math.max(12,Math.round(Math.min(j,m)*.035)),I=Math.max(0,j-p-F),D=Math.max(L+F,m-F);P.save(),P.textAlign="left",P.textBaseline="alphabetic",P.fillStyle="rgba(255,255,255,0.72)",P.strokeStyle="rgba(0,0,0,0.25)",P.lineWidth=Math.max(1,Math.round(L*.06));let R=I;for(let M=0;M<V.length;M++){const W=V[M];P.strokeText(W,R,D),P.fillText(W,R,D),R+=P.measureText(W).width+Math.round(L*.06)}return P.restore(),await new Promise((M,W)=>{try{C.toBlob(J=>{if(J){const H=URL.createObjectURL(J);M(H)}else try{const H=C.toDataURL();M(H)}catch{W(new Error("toDataURL"))}},"image/png",.92)}catch{W(new Error("tainted"))}})},u=v=>{const j=v.closest("[data-role=property-hero], .property-hero, .lightbox, [role=dialog], [role='dialog']")||v.parentElement;if(!j)return;const m=j;if(m.querySelector("[data-wm-overlay='1']"))return;const b=v.getBoundingClientRect(),T=Math.max(1,b.width||v.width),C=Math.max(1,b.height||v.height);getComputedStyle(m).position==="static"&&(m.style.position="relative");const P=document.createElement("div");P.setAttribute("data-wm-overlay","1"),P.setAttribute("aria-hidden","true"),P.style.position="absolute",P.style.inset="0",P.style.pointerEvents="none",P.style.zIndex="60",P.style.display="flex",P.style.flexWrap="wrap",P.style.alignItems="center",P.style.justifyContent="center",P.style.gap="2rem",P.style.opacity="0.18";const k=Math.max(3,Math.round(T/160)),h=Math.max(2,Math.round(C/120)),w=Math.max(12,Math.round(Math.min(T,C)*.06));for(let E=0;E<h;E++)for(let L=0;L<k;L++){const q=document.createElement("div");q.textContent=s,q.style.font=`800 ${w}px Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif`,q.style.textTransform="lowercase",q.style.color="rgba(0,0,0,0.24)",q.style.transform="rotate(-25deg)",q.style.userSelect="none",q.style.pointerEvents="none",q.style.whiteSpace="nowrap",q.style.letterSpacing="1px",P.appendChild(q)}m.appendChild(P)},S=async v=>{if(!(N(v)||c(v))){try{const j=await f(v);if(j){const m=v.dataset.wmUrl;if(v.src=j,v.dataset.wmUrl=j,m&&m.startsWith("blob:"))try{URL.revokeObjectURL(m)}catch{}y(v);return}}catch{}u(v),y(v)}},x=new IntersectionObserver(v=>{for(const j of v)j.isIntersecting&&j.target instanceof HTMLImageElement&&(S(j.target),x.unobserve(j.target))},{root:null,rootMargin:"0px",threshold:.1}),A=()=>{document.querySelectorAll(r.join(",")).forEach(j=>{!N(j)&&!c(j)&&x.observe(j)})},d=new MutationObserver(v=>{for(const j of v)if(j.type==="childList")j.addedNodes.forEach(m=>{m instanceof HTMLImageElement?!N(m)&&!c(m)&&x.observe(m):m instanceof HTMLElement&&m.querySelectorAll(r.join(",")).forEach(b=>{!N(b)&&!c(b)&&x.observe(b)})});else if(j.type==="attributes"&&j.target instanceof HTMLImageElement&&j.attributeName==="src"){const m=j.target;m.dataset.wmProcessed="",c(m)||x.observe(m)}});return A(),d.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),()=>{try{x.disconnect()}catch{}try{d.disconnect()}catch{}document.querySelectorAll("[data-wm-overlay='1']").forEach(v=>v.remove())}},[])}function vm(){const[s,t]=a.useState([]),[r,c]=a.useState(!1),[N,y]=a.useState(null),n=[{path:"/api/ping",name:"Health Check"},{path:"/api/plans",name:"Plans/Packages"},{path:"/api/banners?active=true",name:"Banners"},{path:"/api/categories",name:"Categories"}],o=async()=>{c(!0),t([]);const A=[];for(const d of n){const v=Date.now();try{console.log(`ðŸ” Testing: ${d.path}`);const j=await fetch(d.path,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(8e3)}),m=Date.now()-v;let l;try{l=await j.json()}catch{l=null}const b={endpoint:d.path,success:j.ok,status:j.status,responseTime:m,data:j.ok?l:null,error:j.ok?void 0:`HTTP ${j.status}: ${j.statusText}`};A.push(b),t([...A])}catch(j){const m=Date.now()-v,l={endpoint:d.path,success:!1,responseTime:m,error:j.message||"Network error"};A.push(l),t([...A])}}y(new Date),c(!1)};a.useEffect(()=>{o()},[]);const f=A=>A.success?e.jsx(Le,{className:"h-5 w-5 text-green-500"}):e.jsx(fs,{className:"h-5 w-5 text-red-500"}),u=A=>A.success?e.jsx(re,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Success"}):e.jsx(re,{variant:"destructive",children:"Failed"}),S=s.filter(A=>A.success).length,x=s.length;return e.jsxs(U,{className:"w-full max-w-4xl mx-auto",children:[e.jsxs(K,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ra,{className:"h-5 w-5"}),"API Diagnostics"]}),e.jsx(g,{onClick:o,disabled:r,variant:"outline",size:"sm",children:r?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Run Test"]})})]}),N&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Last run: ",N.toLocaleTimeString()]})]}),e.jsxs(_,{children:[s.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[S===x?e.jsx(Le,{className:"h-5 w-5 text-green-500"}):S===0?e.jsx(fs,{className:"h-5 w-5 text-red-500"}):e.jsx(rs,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("span",{className:"font-medium",children:[S,"/",x," endpoints working"]})]}),S===0&&e.jsx("p",{className:"text-red-600 text-sm",children:"ðŸš¨ All API endpoints failed. This indicates a serious connectivity issue. Check your internet connection or server status."}),S>0&&S<x&&e.jsx("p",{className:"text-yellow-600 text-sm",children:"âš ï¸ Some endpoints are failing. This may indicate intermittent issues. Try refreshing the page or check the failing endpoints below."}),S===x&&e.jsx("p",{className:"text-green-600 text-sm",children:"âœ… All API endpoints are working correctly."})]}),e.jsx("div",{className:"space-y-3",children:n.map((A,d)=>{var j;const v=s.find(m=>m.endpoint===A.path);return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v?f(v):r&&d<=s.length?e.jsx(cs,{className:"h-5 w-5 text-gray-400 animate-pulse"}):e.jsx("div",{className:"h-5 w-5 bg-gray-200 rounded-full"}),e.jsx("span",{className:"font-medium",children:A.name}),e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:A.path})]}),v&&u(v)]}),v&&e.jsx("div",{className:"ml-8 text-sm text-gray-600",children:v.success?e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("span",{children:["Status: ",v.status]}),e.jsxs("span",{children:["Response time: ",v.responseTime,"ms"]}),v.data&&e.jsxs("span",{children:["Data:"," ",Array.isArray((j=v.data)==null?void 0:j.data)?`${v.data.data.length} items`:"Available"]})]}):e.jsxs("div",{className:"text-red-600",children:["Error: ",v.error,v.responseTime&&e.jsxs("span",{className:"ml-2",children:["(",v.responseTime,"ms)"]})]})}),r&&!v&&d===s.length&&e.jsx("div",{className:"ml-8 text-sm text-gray-500",children:"Testing..."})]},A.path)})}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Debug Information"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:["Current URL: ",window.location.href]}),e.jsxs("div",{children:["Origin: ",window.location.origin]}),e.jsxs("div",{children:["Online: ",navigator.onLine?"Yes":"No"]}),e.jsxs("div",{children:["Global API:"," ",typeof window.api=="function"?"Available":"Not Available"]})]})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:e.jsxs("p",{children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"}),` If you're seeing "Failed to fetch" errors in your components, run this test to identify which endpoints are failing. You can also open browser DevTools and use`," ",e.jsx("code",{children:"window.apiDiagnostics.runFull()"})," for more detailed debugging."]})})]})]})}function Nm({propertyId:s}){const[t,r]=a.useState([]),[c,N]=a.useState(!0);a.useEffect(()=>{s&&(async()=>{try{N(!0);const o=await fetch(`/api/testimonials?propertyId=${encodeURIComponent(s)}`);if(o.ok){const f=await o.json();f.success&&Array.isArray(f.data)?r(f.data):r([])}else r([])}catch{r([])}finally{N(!1)}})()},[s]);const y=a.useMemo(()=>{if(!t.length)return 0;const n=t.reduce((o,f)=>o+(f.rating||0),0);return Math.round(n/t.length*10)/10},[t]);return c?null:e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold",children:"Reviews"}),e.jsxs("div",{className:"flex items-center space-x-1 text-yellow-600",children:[e.jsx(ns,{className:"w-4 h-4 fill-current"}),e.jsx("span",{className:"text-sm font-medium",children:y||"0"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.length,")"]})]})]}),t.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"No reviews yet."}):e.jsx("div",{className:"space-y-3",children:t.map(n=>e.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"font-medium text-sm",children:n.name||"User"}),e.jsx("div",{className:"flex items-center space-x-1 text-yellow-600",children:Array.from({length:5}).map((o,f)=>e.jsx(ns,{className:`w-4 h-4 ${f<(n.rating||0)?"fill-current":""}`},f))})]}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:n.comment}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:n.createdAt?new Date(n.createdAt).toLocaleDateString():""})]},n._id))})]})}function sl(){try{return localStorage.getItem("token")||window.__JWT__||null}catch{return window.__JWT__||null}}function Zt(){const s=sl(),t={"Content-Type":"application/json"};return s&&(t.Authorization=`Bearer ${s}`),t}async function bm({targetId:s,targetType:t="property",limit:r=20,signal:c}){var N,y,n;try{const o=`reviews?targetId=${encodeURIComponent(s)}&targetType=${encodeURIComponent(t)}&status=approved&limit=${r}`,f=await Ps(o,{method:"GET",signal:c});if(f.ok){const A=Array.isArray(f.data)?f.data:(N=f.data)==null?void 0:N.data;return Array.isArray(A)?A:[]}const u=await Ps(`testimonials?propertyId=${encodeURIComponent(s)}`,{method:"GET",signal:c});if(!u.ok)return[];const S=Array.isArray((y=u.data)==null?void 0:y.data)?u.data.data:((n=u.data)==null?void 0:n.testimonials)||u.data;return(Array.isArray(S)?S:[]).map(A=>({id:A._id||A.id,targetId:s,targetType:t,userName:A.name,rating:A.rating,title:A.title,comment:A.comment,status:A.status||"approved",createdAt:A.createdAt,updatedAt:A.updatedAt}))}catch{return[]}}async function ym(s,{signal:t}={}){var r,c,N;try{const y=await Ps("reviews",{method:"POST",headers:Zt(),body:JSON.stringify(s),signal:t});if(y.ok)return{ok:!0,status:((c=(r=y.data)==null?void 0:r.data)==null?void 0:c.status)||((N=y.data)==null?void 0:N.status)||"pending"};const n={rating:s.rating,comment:s.comment};s.targetType==="property"&&(n.propertyId=s.targetId),s.targetType==="seller"&&(n.sellerId=s.targetId);const o=await Ps("testimonials",{method:"POST",headers:Zt(),body:JSON.stringify(n),signal:t});return o.ok?{ok:!0,status:"pending"}:{ok:!1,status:String(o.status)}}catch{return{ok:!1,status:"error"}}}async function wm({limit:s=50,signal:t}){var r,c,N,y,n;try{const o=await Ps(`admin/reviews?status=pending&limit=${s}`,{method:"GET",headers:Zt(),signal:t});if(o.ok){const x=Array.isArray(o.data)?o.data:(r=o.data)==null?void 0:r.data;return Array.isArray(x)?x:[]}const f=await Ps(`admin/testimonials?status=pending&limit=${s}`,{method:"GET",headers:Zt(),signal:t});if(!f.ok)return[];const u=((N=(c=f.data)==null?void 0:c.data)==null?void 0:N.testimonials)||((y=f.data)==null?void 0:y.testimonials)||((n=f.data)==null?void 0:n.data)||f.data;return(Array.isArray(u)?u:[]).map(x=>({id:x._id||x.id,targetId:x.propertyId||x.sellerId,targetType:x.propertyId?"property":"seller",userName:x.name,rating:x.rating,title:x.title,comment:x.comment,createdAt:x.createdAt,updatedAt:x.updatedAt,status:x.status}))}catch{return[]}}async function Cm(s,t,r){try{return(await Ps(`admin/reviews/${s}`,{method:"PATCH",headers:Zt(),body:JSON.stringify({status:t,adminNote:r})})).ok?!0:!!(await Ps(`admin/testimonials/${s}`,{method:"PUT",headers:Zt(),body:JSON.stringify({status:t})})).ok}catch{return!1}}function Sm({targetId:s,targetType:t="property",limit:r=20}){const[c,N]=a.useState([]),[y,n]=a.useState(!0),o=a.useRef(null),f=async()=>{var S;try{(S=o.current)==null||S.abort(),o.current=new AbortController;const x=await bm({targetId:s,targetType:t,limit:r,signal:o.current.signal});N(Array.isArray(x)?x.filter(A=>A.status==="approved"):[])}catch{}finally{n(!1)}};a.useEffect(()=>{n(!0),f();const S=setInterval(f,2.5*60*1e3);return()=>{var x;clearInterval(S),(x=o.current)==null||x.abort()}},[s,t,r]);const u=a.useMemo(()=>{if(!c.length)return 0;const S=c.reduce((x,A)=>x+(Number(A.rating)||0),0);return Math.round(S/c.length*10)/10},[c]);return y?null:e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold",children:"Reviews"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-amber-400 mr-1",children:["â˜… ",u||0]}),e.jsxs("span",{className:"text-gray-500",children:["(",c.length,")"]})]})]}),c.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"Be the first to review."}):e.jsx("div",{className:"space-y-3",children:c.map(S=>e.jsxs("div",{className:"rounded-xl shadow-sm border p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"font-medium text-sm",children:S.userName||"User"}),e.jsx("div",{className:"text-amber-400 text-sm",children:"â˜…".repeat(Math.max(1,Math.min(5,Number(S.rating)||0)))})]}),S.title&&e.jsx("div",{className:"text-sm font-semibold mb-1",children:S.title}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:S.comment}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:S.createdAt?xc(new Date(S.createdAt),{addSuffix:!0}):""})]},S.id))})]})}function km({targetId:s,targetType:t="property"}){const r=a.useMemo(()=>sl(),[]),{toast:c}=ct(),[N,y]=a.useState(0),[n,o]=a.useState(""),[f,u]=a.useState(""),[S,x]=a.useState(!1),[A,d]=a.useState("");if(!r)return e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Login to write a review. "}),e.jsx(be,{to:"/user-login",className:"text-[#C70000] hover:underline",children:"Login"})]});const v=async j=>{if(j.preventDefault(),!N||N<1||N>5){c({title:"Rating required",description:"Please select 1-5 stars"});return}if(f.trim().length<10||f.trim().length>600){c({title:"Comment length",description:"Please write 10â€“600 characters"});return}x(!0);try{const m=await ym({targetId:s,targetType:t,rating:N,title:n.trim()||void 0,comment:f.trim()});if(m.ok)c({title:"Submitted for approval",description:"Your review will appear after approval."}),y(0),o(""),u(""),d("Your review is pending approval.");else{const l=m.status==="401"||m.status==="403"?"Please login to submit a review.":"Please try again later.";c({title:"Submission failed",description:l})}}finally{x(!1)}};return e.jsxs("div",{className:"mt-4",children:[A&&e.jsx("div",{className:"text-xs text-gray-500 mb-2","aria-live":"polite",children:A}),e.jsxs("form",{onSubmit:v,className:"rounded-xl shadow-sm border p-4 bg-white",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Rating"}),e.jsx("div",{className:"flex items-center space-x-2 mb-3",children:[1,2,3,4,5].map(j=>e.jsx("button",{type:"button","aria-label":`Rate ${j}`,onClick:()=>y(j),className:`text-2xl ${j<=N?"text-amber-400":"text-gray-300"}`,children:"â˜…"},j))}),e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"title",children:"Title (optional)"}),e.jsx("input",{id:"title",value:n,onChange:j=>o(j.target.value.slice(0,80)),className:"w-full border rounded-md px-3 py-2 mb-3",placeholder:"e.g., Great experience"}),e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"comment",children:"Comment"}),e.jsx("textarea",{id:"comment",value:f,onChange:j=>u(j.target.value.slice(0,600)),className:"w-full border rounded-md px-3 py-2 h-24 mb-3",placeholder:"Share details about your experience"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:S,className:"bg-[#C70000] hover:bg-red-700 disabled:opacity-50 text-white px-4 py-2 rounded-md",children:S?"Submitting...":"Submit Review"})})]})]})}function qr(){var h,w,E;el();const{id:s}=zs(),t=Ve(),[r,c]=a.useState(null),[N,y]=a.useState(!0),[n,o]=a.useState(""),[f,u]=a.useState(0),[S,x]=a.useState(!1),[A,d]=a.useState(!1),[v,j]=a.useState(!1);a.useEffect(()=>{s&&(m(),l())},[s]);const m=async(L=0)=>{try{if(y(!0),o(""),!s){o("Property ID is required"),y(!1);return}if(s.length!==24){o("Invalid property ID format"),y(!1);return}const q=await window.api(`properties/${s}`);if(q.ok){const V=q.json;V.success?c(V.data):o(V.error||"Property not found")}else if(q.status===404)o("Property not found");else if(q.status===400)o("Invalid property ID");else{const V=q.json;o(V.error||"Failed to load property")}}catch(q){let V="Failed to load property";if(q.name==="TypeError"&&String(q.message).includes("Failed to fetch"))if(L<2){setTimeout(()=>m(L+1),1e3*(L+1));return}else V="Network error. Please check your internet connection and try again.";else String(q.message).includes("Invalid JSON")?V="Server error. Please try again later.":q.message&&(V=q.message);o(V)}finally{y(!1)}},l=async()=>{try{const L=`/api/analytics/view/${s}`;if(navigator.sendBeacon){const p=new Blob([JSON.stringify({ts:Date.now()})],{type:"application/json"});navigator.sendBeacon(L,p);return}const q=new AbortController,V=setTimeout(()=>{try{q.abort("timeout")}catch{}},3e3);await fetch(L,{method:"POST",keepalive:!0,signal:q.signal,headers:{"Content-Type":"application/json"},body:JSON.stringify({ts:Date.now()})}),clearTimeout(V)}catch{}},b=L=>{const q=`/api/analytics/phone/${s}`;try{if(navigator.sendBeacon){const V=new Blob([JSON.stringify({ts:Date.now()})],{type:"application/json"});navigator.sendBeacon(q,V)}else fetch(q,{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify({ts:Date.now()})}).catch(()=>{})}catch{}window.open(`tel:${L}`,"_self")},T=L=>{const q=`Hi, I'm interested in your property: ${r==null?void 0:r.title}`,V=`https://wa.me/${L.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(q)}`;window.open(V,"_blank")},C=async()=>{var L,q,V,p,i,F;try{const I=localStorage.getItem("token");if(!I){t("/login",{state:{redirectTo:`/property/${s}`,message:"Please login to start chat"}});return}if(!(r!=null&&r._id)){is({title:"Error",description:"Property information not available",variant:"destructive"});return}j(!0);let D=await window.api("conversations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I}`},body:{propertyId:r._id}});if(D.success||(D=await window.api("conversations/find-or-create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I}`},body:{propertyId:r._id}})),D.success){const R=((L=D.data)==null?void 0:L._id)||((q=D.data)==null?void 0:q.conversationId)||((p=(V=D.json)==null?void 0:V.data)==null?void 0:p._id)||((F=(i=D.json)==null?void 0:i.data)==null?void 0:F.conversationId),M=typeof R=="string"?R:(R==null?void 0:R.$oid)||(R==null?void 0:R.oid)||(R!=null&&R.toString?R.toString():String(R));if(!M||M==="undefined"){is({title:"Error",description:"Invalid conversation id",variant:"destructive"});return}t(`/conversation/${M}`)}else is({title:"Error",description:D.error||"Failed to start chat",variant:"destructive"})}catch(I){console.error("Error starting chat:",I),is({title:"Error",description:"Failed to start chat. Please try again.",variant:"destructive"})}finally{j(!1)}},P=()=>{r!=null&&r.images&&u(L=>L===r.images.length-1?0:L+1)},k=()=>{r!=null&&r.images&&u(L=>L===0?r.images.length-1:L-1)};return N?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading property details..."})]})}):n||!r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-4xl w-full space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Property Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n}),e.jsxs(g,{onClick:()=>t(-1),variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Go Back"]})]}),e.jsx(vm,{propertyId:s})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(g,{variant:"ghost",onClick:()=>t(-1),className:"flex items-center",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>x(!S),className:S?"text-red-500":"",children:e.jsx(xs,{className:`h-4 w-4 ${S?"fill-current":""}`})}),e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsxs(g,{size:"sm",disabled:v,className:"bg-[#C70000] hover:bg-[#A60000] text-white",onClick:C,children:[v?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-1"}):e.jsx(Mt,{className:"h-4 w-4 mr-1"}),v?"Starting...":"Message Owner"]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.images.length>0&&e.jsx(U,{children:e.jsxs(_,{className:"p-0",children:[e.jsxs("div",{className:"relative aspect-video","data-role":"property-hero",children:[e.jsx("img",{src:r.coverImageUrl??((w=(h=r.images)==null?void 0:h[f])==null?void 0:w.url)??((E=r.images)==null?void 0:E[f])??"/placeholder.png",alt:r.title,className:"w-full h-full rounded-t-lg object-center",onError:L=>{const q=L.target;q.src="/placeholder.png"}}),e.jsx(dr,{variant:"pattern"}),r.images.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"ghost",size:"sm",className:"absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 text-white hover:bg-black/70",onClick:k,children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 text-white hover:bg-black/70",onClick:P,children:e.jsx(ws,{className:"h-4 w-4"})}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:[f+1," / ",r.images.length]})]}),r.featured&&e.jsx(re,{className:"absolute top-4 left-4 bg-orange-500 text-white",children:"Featured"}),r.premium&&e.jsx(re,{className:"absolute top-4 right-4 bg-purple-500 text-white",children:"Premium"})]}),r.images.length>1&&e.jsx("div",{className:"flex gap-2 p-4 overflow-x-auto",children:r.images.map((L,q)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:typeof L=="string"?L:(L==null?void 0:L.url)??"/placeholder.png",alt:`${r.title} ${q+1}`,className:`w-20 h-16 rounded cursor-pointer border-2 ${q===f?"border-[#C70000]":"border-transparent"}`,onClick:()=>u(q),onError:V=>{const p=V.target;p.src="/placeholder.png"}}),e.jsx(dr,{variant:"pattern"})]},q))})]})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"text-2xl text-gray-900",children:r.title}),e.jsxs("div",{className:"flex items-center text-gray-600 mt-2",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[r.location.area,", ",r.location.city]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-[#C70000]",children:["â‚¹",r.price.toLocaleString(),r.priceType==="rent"&&e.jsx("span",{className:"text-lg",children:"/month"})]}),e.jsxs("div",{className:"text-sm text-gray-600 capitalize",children:["For ",r.priceType]})]})]})}),e.jsxs(_,{className:"space-y-6",children:[r.specifications&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Property Details"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.specifications.bedrooms&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[r.specifications.bedrooms," Bedrooms"]})]}),r.specifications.bathrooms&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Jt,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[r.specifications.bathrooms," Bathrooms"]})]}),r.specifications.area&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fa,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:r.specifications.area})]}),r.specifications.parking&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(jn,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:"Parking"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Description"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:r.description})]}),r.amenities&&r.amenities.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.amenities.map((L,q)=>e.jsx(re,{variant:"outline",className:"bg-gray-50",children:L},q))})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.views," views"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs("span",{children:["Listed ",new Date(r.createdAt).toLocaleDateString()]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Nm,{propertyId:r._id})}),e.jsxs("div",{className:"mt-6",children:[e.jsx(Sm,{targetId:r._id,targetType:"property"}),e.jsx(km,{targetId:r._id,targetType:"property"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Contact Information"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.contactInfo.name}),e.jsx("p",{className:"text-sm text-gray-600",children:r.contactInfo.email})]}),e.jsxs("div",{className:"space-y-3 hidden md:block",children:[e.jsxs(g,{className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white flex items-center justify-center space-x-2 py-3",onClick:C,disabled:v,children:[v?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(Mt,{className:"h-4 w-4"}),e.jsx("span",{children:v?"Starting...":"Message Owner"})]}),e.jsxs(g,{variant:"outline",className:"w-full border-[#C70000] text-[#C70000] hover:bg-[#C70000] hover:text-white flex items-center justify-center space-x-2 py-3",onClick:()=>b(r.contactInfo.phone),children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Call Now"})]}),e.jsxs(g,{className:"w-full bg-green-500 hover:bg-green-600 text-white flex items-center justify-center space-x-2 py-3",onClick:()=>T(r.contactInfo.whatsappNumber||r.contactInfo.phone),children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.309"})}),e.jsx("span",{children:"WhatsApp"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 md:hidden",children:[e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white flex flex-col items-center justify-center space-y-1 py-4",onClick:C,disabled:v,children:[v?e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}):e.jsx(Mt,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:v?"Starting":"Message"})]}),e.jsxs(g,{variant:"outline",className:"border-[#C70000] text-[#C70000] hover:bg-[#C70000] hover:text-white flex flex-col items-center justify-center space-y-1 py-4",onClick:()=>b(r.contactInfo.phone),children:[e.jsx(Ge,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Call"})]}),e.jsxs(g,{className:"bg-green-500 hover:bg-green-600 text-white flex flex-col items-center justify-center space-y-1 py-4",onClick:()=>T(r.contactInfo.whatsappNumber||r.contactInfo.phone),children:[e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347"})}),e.jsx("span",{className:"text-xs",children:"WhatsApp"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Contact details are verified by our team"})})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Location"})}),e.jsxs(_,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Address:"})," ",r.location.address]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Area:"})," ",r.location.area]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"City:"})," ",r.location.city,", ",r.location.state]})]}),e.jsx("div",{className:"mt-4 h-48 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Map view (Coming soon)"})})]})]})]})]})}),r&&e.jsx(Ni,{isOpen:A,onClose:()=>d(!1),propertyId:r._id,propertyTitle:r.title,ownerName:r.contactInfo.name})]})}function Hr(){const{slug:s}=zs(),[t,r]=a.useState(null),[c,N]=a.useState(!0),[y,n]=a.useState("");a.useEffect(()=>{const f=s||window.location.pathname.replace(/^\//,"");if(f){if(f==="terms-conditions"){const u="Terms & Conditions | Ashish Property",S="Terms of using Ashish Propertyâ€™s website and services. Read service scope, pricing, liability and dispute policy.";document.title=u;const x=document.querySelector("meta[name='description']");x&&x.setAttribute("content",S);const A=`
        <p><strong>Effective Date:</strong> 15 September 2025</p>
        <h2>1. Acceptance</h2>
        <p>By using ashishproperty.in (â€œSiteâ€) or our services, you agree to these Terms.</p>
        <h2>2. Service Scope</h2>
        <p>We are a real-estate facilitator/consultant. Availability of listings and final transactions depend on owners, developers, and regulatory approvals.</p>
        <h2>3. Listings &amp; Accuracy</h2>
        <p>We strive for accuracy but details (area, price, availability) may change or be approximate. Always verify on site.</p>
        <h2>4. Appointments &amp; Site Visits</h2>
        <p>Appointments are subject to owner/tenant availability. Government holidays/strikes may affect schedules.</p>
        <h2>5. Pricing &amp; Payments</h2>
        <p>Quotes are indicative; final price depends on inspection and negotiation. Taxes, stamp duty, and registration charges are extra as applicable.</p>
        <h2>6. Brokerage/Service Fee</h2>
        <p>Fees vary by service and deal size and will be disclosed before proceeding.</p>
        <h2>7. Documentation &amp; Loans</h2>
        <p>We assist with paperwork and finance but final approval rests with relevant authorities and banks.</p>
        <h2>8. User Conduct</h2>
        <p>Do not misuse the Site, submit false documents, or violate any law.</p>
        <h2>9. Reviews &amp; Media</h2>
        <p>By sharing reviews/photos for listings, you grant us a non-exclusive license to display them on our platforms.</p>
        <h2>10. Liability</h2>
        <p>To the extent permitted by law, we are not liable for indirect or consequential losses. Our total liability is limited to fees paid to us in the 3 months preceding a claim.</p>
        <h2>11. Indemnity</h2>
        <p>You agree to indemnify us for losses arising from your breach of these Terms or applicable laws.</p>
        <h2>12. IP Rights</h2>
        <p>All trademarks, logos, and content on the Site belong to Ashish Property or their owners.</p>
        <h2>13. Termination</h2>
        <p>We may suspend or terminate access for misuse or non-compliance.</p>
        <h2>14. Governing Law &amp; Dispute</h2>
        <p>These Terms are governed by Indian law; courts at ðŸ“Œ Rohtak (or your chosen jurisdiction) shall have exclusive jurisdiction.</p>
        <h2>15. Contact</h2>
        <p>Email: <a href="mailto:info@aashishproperty.com">info@aashishproperty.com</a><br />Phone: +91 9876543210<br />Address: ðŸ“Œ Full address</p>
      `,d=new Date("2025-09-15T00:00:00.000Z").toISOString();r({_id:"static-terms-conditions",title:"Terms & Conditions",slug:"terms-conditions",content:A,metaTitle:u,metaDescription:S,type:"terms",status:"published",createdAt:d,updatedAt:d}),n(""),N(!1);return}o()}},[s]);const o=async()=>{try{N(!0);const f=s||window.location.pathname.replace(/^\//,""),u=await fetch(`/api/pages/${f}`);if(u.ok){const S=await u.json();if(S.success){if(r(S.data),S.data.metaTitle?document.title=S.data.metaTitle:document.title=`${S.data.title} - Ashish Property`,S.data.metaDescription){const x=document.querySelector('meta[name="description"]');x&&x.setAttribute("content",S.data.metaDescription)}}else n(S.error||"Page not found")}else n("Page not found")}catch(f){console.error("Error fetching page:",f),n("Failed to load page")}finally{N(!1)}};return c?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}):y||!t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:y}),e.jsx(g,{asChild:!0,variant:"outline",children:e.jsxs(be,{to:"/",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Go Home"]})})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsx(g,{asChild:!0,variant:"ghost",className:"mb-4",children:e.jsxs(be,{to:"/",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("article",{className:"bg-white rounded-lg shadow-sm p-8",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs("span",{children:["Updated ",new Date(t.updatedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:"Aashish Property"})]})]})]}),e.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:t.content}}),e.jsx("footer",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["This page was last updated on"," ",new Date(t.updatedAt).toLocaleDateString()]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(g,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(be,{to:"/contact-us",children:"Contact Support"})}),e.jsx(g,{asChild:!0,size:"sm",className:"bg-[#C70000] hover:bg-[#A60000]",children:e.jsx(be,{to:"/",children:"Browse Properties"})})]})]})})]})}),e.jsx(Fs,{})]})}function Gr(){const{isAuthenticated:s,token:t,user:r}=je(),{toast:c}=ct(),[N,y]=a.useState("contact@aashishproperty.com"),[n,o]=a.useState("+91 9876543210"),[f,u]=a.useState("Rohtak, Haryana"),[S,x]=a.useState(""),[A,d]=a.useState(""),[v,j]=a.useState(""),[m,l]=a.useState("General Enquiry"),[b,T]=a.useState(""),[C,P]=a.useState(!1);a.useEffect(()=>{s&&r&&(x(h=>h||r.name||""),d(h=>h||r.email||""),j(h=>h||r.phone||""))},[s,r]),a.useEffect(()=>{(async()=>{var w,E,L,q,V,p,i,F;try{const D=await(await fetch("/api/settings",{cache:"no-store"})).json(),R=((E=(w=D==null?void 0:D.data)==null?void 0:w.footer)==null?void 0:E.contact)||{email:(q=(L=D==null?void 0:D.data)==null?void 0:L.general)==null?void 0:q.contactEmail,phone:(p=(V=D==null?void 0:D.data)==null?void 0:V.general)==null?void 0:p.contactPhone,address:(F=(i=D==null?void 0:D.data)==null?void 0:i.general)==null?void 0:F.address};R!=null&&R.email&&y(R.email),R!=null&&R.phone&&o(R.phone),R!=null&&R.address&&u(R.address)}catch{}})()},[]);const k=async h=>{if(h.preventDefault(),!m.trim()||!b.trim()){c({title:"Please fill subject and message",variant:"destructive"});return}if(s&&t){try{P(!0);const L=await fetch("/api/tickets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({subject:m,message:`${b}

â€” Contact details â€”
Name: ${S||""}
Email: ${A||""}
Phone: ${v||""}`,category:"contact",priority:"medium"})}),q=await L.json();if(L.ok&&(q!=null&&q.success))c({title:"Message sent",description:"Our team will contact you soon."}),T("");else throw new Error((q==null?void 0:q.error)||"Failed to send")}catch{c({title:"Failed to send message",variant:"destructive"})}finally{P(!1)}return}const w=`${b}

â€” Contact details â€”
Name: ${S}
Email: ${A}
Phone: ${v}`,E=`mailto:${encodeURIComponent(N)}?subject=${encodeURIComponent(m||"General Enquiry")}&body=${encodeURIComponent(w)}`;window.location.href=E,c({title:"Opening your email app..."})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between",children:[e.jsx(g,{asChild:!0,variant:"ghost",className:"",children:e.jsxs(be,{to:"/",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"})," Back to Home"]})}),e.jsx("div",{className:"text-sm text-gray-500",children:"We're here to help"})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10 grid gap-8 md:grid-cols-5",children:[e.jsxs("aside",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Contact Information"}),e.jsxs("div",{className:"space-y-3 text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ge,{className:"h-5 w-5 text-[#C70000] mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Phone"}),e.jsx("a",{className:"text-[#C70000]",href:`tel:${n}`,children:n})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ms,{className:"h-5 w-5 text-[#C70000] mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Email"}),e.jsx("a",{className:"text-[#C70000]",href:`mailto:${N}`,children:N})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(He,{className:"h-5 w-5 text-[#C70000] mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Address"}),e.jsx("div",{className:"text-gray-600",children:f})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Business Hours"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monâ€“Sat: 9:30 AM â€“ 6:30 PM"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sun: Closed"})]})]}),e.jsx("section",{className:"md:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-1",children:"Contact Us"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Send us a message and weâ€™ll get back to you shortly."}),e.jsxs("form",{onSubmit:k,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"name",children:"Name"}),e.jsx(Q,{id:"name",value:S,onChange:h=>x(h.target.value),placeholder:"Your name"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"email",children:"Email"}),e.jsx(Q,{id:"email",type:"email",value:A,onChange:h=>d(h.target.value),placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phone",children:"Phone"}),e.jsx(Q,{id:"phone",value:v,onChange:h=>j(h.target.value),placeholder:"+91 XXXXX XXXXX"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"subject",children:"Subject"}),e.jsx(Q,{id:"subject",value:m,onChange:h=>l(h.target.value),placeholder:"Subject"})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"message",children:"Message"}),e.jsx($e,{id:"message",value:b,onChange:h=>T(h.target.value),rows:6,placeholder:"How can we help you?"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(g,{type:"submit",disabled:C,className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Us,{className:"h-4 w-4 mr-2"}),s?C?"Sending...":"Send Message":"Open Email App"]}),e.jsx("span",{className:"text-xs text-gray-500",children:s?"Creates a support ticket":"Youâ€™re not logged in; weâ€™ll open your email app to send"})]})]})]})})]}),e.jsx(Fs,{})]})}function Jr(){var A,d,v,j,m;const[s,t]=a.useState(null),[r,c]=a.useState("");a.useEffect(()=>{(async()=>{try{const T=await(await fetch("/api/settings",{cache:"no-store"})).json();T!=null&&T.success&&(T!=null&&T.data)&&(t(T.data),c(T.data.updatedAt||new Date().toISOString()))}catch{}})()},[]);const N=((A=s==null?void 0:s.general)==null?void 0:A.siteName)||"Aashish Property",y=((d=s==null?void 0:s.contact)==null?void 0:d.address)||((v=s==null?void 0:s.general)==null?void 0:v.address)||"Rohtak, Haryana",n=((j=s==null?void 0:s.contact)==null?void 0:j.phone)||((m=s==null?void 0:s.general)==null?void 0:m.contactPhone)||"+91 9876543210";a.useMemo(()=>y.split(",").map(b=>(b??"").trim()).filter(Boolean)[0]||"Rohtak",[y]),a.useMemo(()=>y.split(",").map(b=>(b??"").trim()).filter(Boolean)[1]||"Haryana",[y]);const f=new Date().getFullYear()-2021,u=1e3,S=4.8,x=a.useMemo(()=>{const l=n.replace(/[^0-9]/g,"");return l?`https://wa.me/${l}`:"https://wa.me/919876543210"},[n]);return a.useEffect(()=>{const l="About Ashish Property | Real Estate in Rohtak",b="Learn about Ashish Propertyâ€”Rohtakâ€™s trusted real-estate partner for buying, selling, and renting residential & commercial properties. Transparent deals, verified listings, and end-to-end support.";document.title=l;let T=document.querySelector('meta[name="description"]');T||(T=document.createElement("meta"),T.setAttribute("name","description"),document.head.appendChild(T)),T.setAttribute("content",b)},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"About Ashish Property"}),e.jsx("p",{className:"mt-3 text-lg text-gray-600",children:"Ashish Property is a hyperlocal real-estate partner helping families and businesses in Rohtak and nearby areas discover the right homes, plots, and commercial spacesâ€”quickly and transparently. Our mission is simple: trust, clarity, and speed in every real-estate transaction."})]})}),e.jsx("section",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 items-start",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"What we do"}),e.jsxs("div",{className:"space-y-4 text-gray-700 leading-relaxed",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Buy & Sell:"})," Verified residential homes, floors, plots, builder floors, and commercial units."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Rent & Lease:"})," Curated houses, flats, shops, offices, and godowns with clear terms."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Land & Development:"})," Residential plots, industrial land, farmhouses and collaboration projects."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Advisory & Documentation:"})," Pricing guidance, due-diligence, registry assistance, and bank loan support."]})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-8 mb-4",children:"Why Ashish Property"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2 text-gray-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Local Expertise:"})," Deep knowledge of Rohtak sectors, colonies, and emerging pockets."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Verified Listings:"})," Physical checks, owner validation, and requirement fitment."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Transparent Pricing:"})," Comparable sales data and clear cost breakdowns."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"End-to-End Support:"})," From site visits to paperwork and possession."]})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-8 mb-4",children:"How it works"}),e.jsxs("ol",{className:"list-decimal pl-6 space-y-2 text-gray-700",children:[e.jsx("li",{children:"Share your requirement (budget, location, size)."}),e.jsx("li",{children:"Get curated options with photos, videos, and pricing."}),e.jsx("li",{children:"Site visit & shortlist with honest guidance."}),e.jsx("li",{children:"Close confidently with documentation and loan assistance."})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-8 mb-2",children:"Service Areas"}),e.jsx("p",{className:"text-gray-700",children:"Rohtak city & outskirts (ðŸ“Œ add specific sectors/colonies here), with selective coverage across Sonipat | Jhajjar | Panipat (as per requirement)."}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-8 mb-2",children:"Contact"}),e.jsx("p",{className:"text-gray-700",children:"Call/WhatsApp: ðŸ“ž +91-XXXXXXXXXX â€¢ Email: info@ashishproperty.in â€¢ Office: ðŸ“Œ Full address here"})]}),e.jsxs("aside",{className:"bg-white rounded-lg shadow-sm p-6","aria-label":"Key numbers",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["+",f]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Years"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[u,"+"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Customers"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[S,"â˜…"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Rating"})]})]}),r&&e.jsxs("p",{className:"mt-4 text-xs text-gray-500",children:["Updated ",new Date(r).toLocaleDateString()]})]})]})}),e.jsx("section",{className:"bg-white border-t",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Our Values"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"p-5 rounded-lg border bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Integrity"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Honest guidance and transparent pricing every time."})]}),e.jsxs("div",{className:"p-5 rounded-lg border bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Speed"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Prompt responses, quick scheduling, and on-time visits."})]}),e.jsxs("div",{className:"p-5 rounded-lg border bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Quality"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Standard checklists and feedback-driven improvements."})]}),e.jsxs("div",{className:"p-5 rounded-lg border bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Support"}),e.jsx("p",{className:"text-gray-700 text-sm",children:"Friendly help through phone and WhatsApp when you need it."})]})]})]})}),e.jsx("section",{className:"bg-[#C70000]",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 text-white flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Need help now?"}),e.jsx("p",{className:"opacity-90",children:"Talk to our team in Rohtak. We are here to help."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("a",{"aria-label":`Call ${N}`,href:`tel:${n}`,className:"inline-flex items-center px-4 py-2 bg-white text-[#C70000] font-medium rounded-md hover:bg-gray-100 active:scale-98",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"})," Call"]}),e.jsxs("a",{"aria-label":`WhatsApp ${N}`,href:x,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 border border-white text-white font-medium rounded-md hover:bg-white hover:text-[#C70000] active:scale-98",children:[e.jsx(Mt,{className:"h-4 w-4 mr-2"})," WhatsApp"]})]})]})}),e.jsx(Fs,{})]})}function Wr(){return a.useEffect(()=>{const s="Privacy Policy | Ashish Property",t="How Ashish Property collects, uses, and safeguards your data. Read our privacy practices and your rights.";document.title=s;let r=document.querySelector('meta[name="description"]');r||(r=document.createElement("meta"),r.setAttribute("name","description"),document.head.appendChild(r)),r.setAttribute("content",t)},[]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Privacy Policy"}),e.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:"Last Updated: 15 September 2025"})]})}),e.jsx("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:e.jsxs("article",{className:"space-y-6 bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"1) Introduction"}),e.jsx("p",{className:"text-gray-700",children:'This Privacy Policy explains how Ashish Property ("we", "us") collects, uses, and protects information when you use our website and services in India.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"2) Information We Collect"}),e.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Provided by you:"})," Name, phone, email, requirements, location preferences, budget, and property details."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Automatic:"})," Device information, cookies, and basic analytics for improving experience."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"From third parties:"})," Lead portals, banking partners (with consent), and public records for verification."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"3) How We Use Information"}),e.jsxs("ul",{className:"list-disc pl-6 text-gray-700 space-y-1",children:[e.jsx("li",{children:"To provide and improve services, share curated listings, schedule site visits, and close transactions."}),e.jsx("li",{children:"To communicate updates, offers, and service notifications via call/SMS/WhatsApp/email."}),e.jsx("li",{children:"For fraud prevention, legal compliance, and analytics."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"4) Sharing of Information"}),e.jsx("p",{className:"text-gray-700",children:"We share information with property owners, buyers/tenants, service partners, and banks strictly for service fulfillment, compliance, or when required by law."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"5) Data Retention"}),e.jsx("p",{className:"text-gray-700",children:"We retain information as long as necessary to provide services, comply with legal obligations, and resolve disputes, after which it is deleted or anonymized."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"6) Your Rights"}),e.jsx("p",{className:"text-gray-700",children:"You may request access, correction, deletion, or withdrawal of consent by contacting us at privacy@ashishproperty.in."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"7) Security"}),e.jsx("p",{className:"text-gray-700",children:"We use reasonable technical and organizational measures to protect your data from unauthorized access, alteration, or misuse."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"8) Cookies"}),e.jsx("p",{className:"text-gray-700",children:"We use cookies to improve functionality and measure usage. You can control cookies through your browser settings."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"9) Contact / Grievance Officer"}),e.jsx("p",{className:"text-gray-700",children:"Email: privacy@ashishproperty.in â€¢ Phone: +91-9876543210 â€¢ Address: Rohtak, Haryana, India"})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"10) Changes"}),e.jsx("p",{className:"text-gray-700",children:'We may update this policy; the "Last Updated" date will change accordingly.'})]})]})}),e.jsx(Fs,{})]})}function Pm(s,t){let r=document.querySelector(`meta[name='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("name",s),document.head.appendChild(r)),r.setAttribute("content",t)}function Qr(){return a.useEffect(()=>{document.title="Terms & Conditions | Ashish Property",Pm("description","Terms of using Ashish Propertyâ€™s website and services. Read service scope, pricing, liability and dispute policy.")},[]),e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{}),e.jsxs("main",{className:"pb-16",children:[e.jsx(Rt,{}),e.jsx("div",{className:"px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"Terms & Conditions"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Effective Date: 15 September 2025"}),e.jsxs("ol",{className:"list-decimal pl-6 space-y-4 text-gray-700 leading-relaxed",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Acceptance:"})," By using ashishproperty.in (â€œSiteâ€) or our services, you agree to these Terms."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Service Scope:"})," We are a real-estate facilitator/consultant. Availability of listings and final transactions depend on owners, developers, and regulatory approvals."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Listings & Accuracy:"})," We strive for accuracy but details (area, price, availability) may change or be approximate. Always verify on site."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Appointments & Site Visits:"})," ","Appointments are subject to owner/tenant availability. Government holidays/strikes may affect schedules."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Pricing & Payments:"})," Quotes are indicative; final price depends on inspection and negotiation. Taxes, stamp duty, and registration charges are extra as applicable."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Brokerage/Service Fee:"})," Fees vary by service and deal size and will be disclosed before proceeding."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Documentation & Loans:"})," We assist with paperwork and finance but final approval rests with relevant authorities and banks."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"User Conduct:"})," Do not misuse the Site, submit false documents, or violate any law."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Reviews & Media:"})," By sharing reviews/photos for listings, you grant us a non-exclusive license to display them on our platforms."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Liability:"})," To the extent permitted by law, we are not liable for indirect or consequential losses. Our total liability is limited to fees paid to us in the 3 months preceding a claim."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Indemnity:"})," You agree to indemnify us for losses arising from your breach of these Terms or applicable laws."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"IP Rights:"})," All trademarks, logos, and content on the Site belong to Ashish Property or their owners."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Termination:"})," We may suspend or terminate access for misuse or non-compliance."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Governing Law & Dispute:"})," ","These Terms are governed by Indian law; courts at ðŸ“Œ Rohtak (or your chosen jurisdiction) shall have exclusive jurisdiction."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Contact:"})," Email: legal@ashishproperty.in â€¢ Phone: +91-XXXXXXXXXX â€¢ Address: ðŸ“Œ Full address"]})]})]})})]}),e.jsx(ve,{}),e.jsx(Fs,{})]})}function Am(){const[s,t]=a.useState({username:"",password:""}),[r,c]=a.useState(!1),[N,y]=a.useState(!1),[n,o]=a.useState(""),{login:f}=je(),u=Ve(),S=async A=>{A.preventDefault(),y(!0),o("");try{const v=await(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s.username,password:s.password,userType:"staff"})})).json();v.success?(f(v.data.token,v.data.user),u("/staff-admin")):o(v.error||"Login failed")}catch(d){console.error("Login error:",d),o("Network error. Please try again.")}finally{y(!1)}},x=A=>{const{name:d,value:v}=A.target;t(j=>({...j,[d]:v})),n&&o("")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#C70000] to-red-700 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-lg",children:e.jsx(Je,{className:"h-8 w-8 text-[#C70000]"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Staff Portal"}),e.jsx("p",{className:"text-red-100",children:"Sign in to your staff account"})]}),e.jsxs(U,{className:"shadow-2xl border-0",children:[e.jsx(K,{className:"text-center pb-6",children:e.jsxs(Y,{className:"text-2xl text-gray-800 flex items-center justify-center space-x-2",children:[e.jsx(Ae,{className:"h-6 w-6 text-[#C70000]"}),e.jsx("span",{children:"Staff Login"})]})}),e.jsxs(_,{children:[n&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2",children:[e.jsx(ds,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:n})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(hs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx(Q,{type:"text",name:"username",value:s.username,onChange:x,placeholder:"Enter your username",className:"pl-10 h-12 border-gray-300 focus:border-[#C70000] focus:ring-[#C70000]",required:!0,autoComplete:"username"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use the username provided by your administrator"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx(Q,{type:r?"text":"password",name:"password",value:s.password,onChange:x,placeholder:"Enter your password",className:"pl-10 pr-10 h-12 border-gray-300 focus:border-[#C70000] focus:ring-[#C70000]",required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>c(!r),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:r?e.jsx(Wt,{className:"h-5 w-5"}):e.jsx(Ne,{className:"h-5 w-5"})})]})]}),e.jsx(g,{type:"submit",disabled:N,className:"w-full h-12 bg-[#C70000] hover:bg-[#A60000] text-white font-semibold text-lg shadow-lg",children:N?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:"Signing in..."})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hc,{className:"h-5 w-5"}),e.jsx("span",{children:"Sign In"})]})})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Don't have access? Contact your administrator"}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Staff Portal - Secure access for authorized personnel only"})})]})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs("p",{className:"text-red-100 text-sm",children:["Â© ",new Date().getFullYear()," POSTTRR. All rights reserved."]})})]})})}function Tm(){var j,m,l,b,T;const{user:s,logout:t,isAuthenticated:r}=je(),c=Ve(),[N,y]=a.useState({totalTasks:0,completedTasks:0,pendingTasks:0,todaysActivity:0}),[n,o]=a.useState(!0);a.useEffect(()=>{if(!r){c("/staff/login");return}if((s==null?void 0:s.userType)!=="staff"&&(s==null?void 0:s.role)!=="admin"){c("/staff/login");return}f()},[r,s,c]);const f=async()=>{try{o(!0),y({totalTasks:25,completedTasks:18,pendingTasks:7,todaysActivity:12})}catch(C){console.error("Error fetching staff stats:",C)}finally{o(!1)}},u=C=>{switch(C){case"super_admin":return We;case"content_manager":return as;case"sales_manager":return Hs;case"support_executive":return hs;default:return Je}},S=C=>{switch(C){case"super_admin":return"bg-purple-100 text-purple-800";case"content_manager":return"bg-blue-100 text-blue-800";case"sales_manager":return"bg-green-100 text-green-800";case"support_executive":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},x=C=>{const P=[{icon:bs,label:"Admin Panel",path:"/staff-admin"}];switch(C){case"super_admin":return[...P,{icon:Ae,label:"Manage Users",path:"/staff-admin"},{icon:bs,label:"System Settings",path:"/staff-admin"},{icon:Ws,label:"Analytics",path:"/staff-admin"},{icon:Je,label:"Permissions",path:"/staff-admin"}];case"content_manager":return[...P,{icon:Ss,label:"Manage Content",path:"/staff-admin"},{icon:as,label:"Create Page",path:"/staff-admin"},{icon:Ss,label:"Manage Blog",path:"/staff-admin"},{icon:Ce,label:"FAQs",path:"/staff-admin"}];case"sales_manager":return[...P,{icon:Ae,label:"Manage Leads",path:"/staff-admin"},{icon:js,label:"Properties",path:"/staff-admin"},{icon:Ws,label:"Sales Analytics",path:"/staff-admin"},{icon:ys,label:"Transactions",path:"/staff-admin"}];case"support_executive":return[...P,{icon:Ce,label:"User Queries",path:"/staff-admin"},{icon:Ae,label:"User Management",path:"/staff-admin"},{icon:ds,label:"Reports",path:"/staff-admin"},{icon:Ce,label:"Live Chat",path:"/staff-admin"}];default:return[...P,{icon:Ss,label:"View Content",path:"/staff-admin"},{icon:Ae,label:"View Users",path:"/staff-admin"},{icon:Ws,label:"View Analytics",path:"/staff-admin"}]}},A=()=>{t(),c("/staff/login")};if(n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});const d=u((s==null?void 0:s.role)||"admin"),v=x((s==null?void 0:s.role)||"admin");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"P"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"POSTTRR Staff"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Es,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Notifications"})]}),e.jsxs(g,{onClick:A,variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{children:"Logout"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"bg-gradient-to-r from-[#C70000] to-red-700 rounded-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",s==null?void 0:s.name,"!"]}),e.jsx("p",{className:"text-red-100 mb-4",children:"Here's what's happening with your work today."}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(re,{className:`${S((s==null?void 0:s.role)||"admin")} flex items-center space-x-2 px-3 py-1`,children:[e.jsx(d,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:((j=s==null?void 0:s.roleInfo)==null?void 0:j.displayName)||(s==null?void 0:s.role)||"Staff"})]}),(s==null?void 0:s.username)&&e.jsxs(re,{variant:"outline",className:"bg-white/10 text-white border-white/20",children:["@",s.username]}),(s==null?void 0:s.isFirstLogin)&&e.jsxs(re,{className:"bg-yellow-100 text-yellow-800",children:[e.jsx(ds,{className:"h-3 w-3 mr-1"}),"First Login"]})]})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsx("div",{className:"text-red-100 text-sm",children:"Today"}),e.jsx("div",{className:"text-2xl font-bold",children:new Date().toLocaleDateString()}),e.jsxs(g,{onClick:()=>c("/staff-admin"),variant:"outline",size:"sm",className:"bg-white/10 text-white border-white/20 hover:bg-white/20",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),"Admin Panel"]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Tasks"}),e.jsx(ut,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.totalTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All assigned tasks"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Completed"}),e.jsx(Le,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N.completedTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tasks completed"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending"}),e.jsx(cs,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:N.pendingTasks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tasks pending"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Today's Activity"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.todaysActivity}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actions today"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(d,{className:"h-5 w-5 text-[#C70000]"}),e.jsx("span",{children:"Quick Actions"})]})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:v.map((C,P)=>e.jsxs(g,{variant:"outline",className:"h-20 flex flex-col items-center justify-center space-y-2 hover:bg-red-50 hover:border-red-200",onClick:()=>c(C.path),children:[e.jsx(C.icon,{className:"h-6 w-6 text-[#C70000]"}),e.jsx("span",{className:"text-sm font-medium",children:C.label})]},P))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Je,{className:"h-5 w-5 text-[#C70000]"}),e.jsx("span",{children:"Role Information"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(d,{className:"h-5 w-5 text-[#C70000]"}),e.jsx("span",{className:"font-semibold",children:((m=s==null?void 0:s.roleInfo)==null?void 0:m.displayName)||(s==null?void 0:s.role)||"Staff"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[(s==null?void 0:s.role)==="super_admin"&&"Full access to all features and settings",(s==null?void 0:s.role)==="content_manager"&&"Manage pages, blogs, and content",(s==null?void 0:s.role)==="sales_manager"&&"Manage leads, properties, and sales",(s==null?void 0:s.role)==="support_executive"&&"Handle user queries and support",(!(s!=null&&s.role)||(s==null?void 0:s.role)==="admin")&&"General admin access"]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Your Permissions:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(l=s==null?void 0:s.permissions)==null?void 0:l.slice(0,6).map((C,P)=>e.jsx(re,{variant:"outline",className:"text-xs",children:C.replace("."," ").replace("_"," ")},P)),(((b=s==null?void 0:s.permissions)==null?void 0:b.length)||0)>6&&e.jsxs(re,{variant:"outline",className:"text-xs",children:["+",(((T=s==null?void 0:s.permissions)==null?void 0:T.length)||0)-6," more"]})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsxs("span",{children:["Last login: ",s!=null&&s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"]})]})})]})]})]})]})]})}const za={super_admin:["dashboard.view","content.manage","content.create","content.view","ads.manage","ads.view","ads.approve","categories.manage","packages.manage","payments.manage","payments.view","payments.approve","users.manage","users.view","sellers.manage","sellers.verify","sellers.view","locations.manage","reports.manage","reports.view","promotions.manage","notifications.send","staff.manage","roles.manage","blog.manage","blog.view","support.view","system.manage","system.view","system.test","system.update","system.debug","analytics.view"],content_manager:["dashboard.view","content.manage","content.create","content.view","blog.manage","blog.view","ads.view","support.view"],sales_manager:["dashboard.view","users.view","sellers.manage","sellers.verify","sellers.view","payments.view","packages.manage","ads.view","analytics.view"],support_executive:["dashboard.view","users.view","support.view","reports.view","content.view"],admin:["dashboard.view","content.view","users.view","ads.view","analytics.view"]},Em=(s,t)=>(za[s]||za.admin).includes(t),tl=(s,t)=>t.some(r=>Em(s,r)),Im=s=>za[s]||za.admin,al=s=>({super_admin:"Super Admin",content_manager:"Content Manager",sales_manager:"Sales Manager",support_executive:"Support Executive",admin:"Admin"})[s]||"Staff",rl=(s,t)=>{const c={dashboard:["dashboard.view"],"content-management":["content.create"],"static-pages":["content.view"],pages:["content.manage"],"ads-listing":["ads.view"],categories:["categories.manage"],"custom-fields":["ads.manage"],"ad-management":["ads.manage"],"ad-requested":["ads.approve"],"pending-approval":["ads.approve"],"premium-approvals":["ads.approve"],"ad-tips":["content.manage"],"package-management":["packages.manage"],"listing-package":["packages.manage"],"feature-package":["packages.manage"],transactions:["payments.view"],"manual-payment-approval":["payments.approve"],"bank-transfer":["payments.manage"],"all-users":["users.view"],"user-analytics":["analytics.view"],"seller-management":["sellers.manage"],"verification-fields":["sellers.manage"],"seller-verification":["sellers.verify"],"seller-review":["sellers.view"],"seller-review-report":["sellers.view"],slider:["content.manage"],"feature-section":["content.manage"],countries:["locations.manage"],states:["locations.manage"],cities:["locations.manage"],areas:["locations.manage"],"report-reasons":["reports.manage"],"user-reports":["reports.view"],"send-notification":["notifications.send"],customers:["users.view"],role:["roles.manage"],"staff-management":["staff.manage"],"footer-management":["content.manage"],"blog-management":["blog.manage"],blogs:["blog.view"],faq:["content.manage"],faqs:["content.view"],"web-queries":["support.view"],"system-status":["system.view"],"login-test":["system.test"],settings:["system.manage"],"system-update":["system.update"],"auth-debug":["system.debug"]}[t]||[];return tl(s,c)},Fm=[{id:"dashboard",label:"Dashboard",icon:Ln,permissions:["dashboard.view"]},{id:"advertisements",label:"Advertisement Management",icon:ha,permissions:["ads.manage"],children:[{id:"ads-listing",label:"Ads Listing",icon:Ks,permissions:["ads.view"]},{id:"categories",label:"Categories",icon:tt,permissions:["categories.manage"]},{id:"custom-fields",label:"Custom Fields",icon:bs,permissions:["ads.manage"]},{id:"ad-management",label:"Advertisement Management",icon:ha,permissions:["ads.manage"]},{id:"pending-approval",label:"Pending Approvals",icon:rs,badge:"new",permissions:["ads.approve"]},{id:"premium-approvals",label:"Premium Listing Approvals",icon:We,badge:"3",permissions:["ads.approve"]},{id:"ad-tips",label:"Advertisement Tips",icon:st,permissions:["content.manage"]}]},{id:"packages",label:"Package Management",icon:js,permissions:["packages.manage"],children:[{id:"package-management",label:"Package Management",icon:js,permissions:["packages.manage"]},{id:"listing-package",label:"Advertisement Listing Package",icon:Ks,permissions:["packages.manage"]},{id:"feature-package",label:"Feature Advertisement Package",icon:ns,permissions:["packages.manage"]}]},{id:"payments",label:"Payment Management",icon:ys,permissions:["payments.manage"],children:[{id:"transactions",label:"Payment Transactions",icon:ys,permissions:["payments.view"]},{id:"manual-payment-approval",label:"Manual Payment Approval",icon:Je,badge:"5",permissions:["payments.approve"]},{id:"bank-transfer",label:"Bank Transfer",icon:ys,permissions:["payments.manage"]}]},{id:"users",label:"User Management",icon:Ae,permissions:["users.manage"],children:[{id:"all-users",label:"All Users",icon:Ae,permissions:["users.view"]},{id:"user-analytics",label:"User Analytics",icon:Ws,permissions:["analytics.view"]}]},{id:"sellers",label:"Seller Management",icon:Ae,permissions:["sellers.manage"],children:[{id:"seller-management",label:"Seller Management",icon:Ae,permissions:["sellers.manage"]},{id:"verification-fields",label:"Verification Fields",icon:Je,permissions:["sellers.manage"]},{id:"seller-verification",label:"Seller Verification",icon:Hs,badge:"12",permissions:["sellers.verify"]},{id:"seller-review",label:"Seller Review",icon:ns,permissions:["sellers.view"]},{id:"seller-review-report",label:"Seller Review Report",icon:Ua,permissions:["sellers.view"]}]},{id:"home-screen",label:"Home Screen Management",icon:Pe,permissions:["content.manage"],children:[{id:"slider",label:"Slider",icon:jr,permissions:["content.manage"]},{id:"feature-section",label:"Feature Section",icon:ns,permissions:["content.manage"]}]},{id:"locations",label:"Place/Location Management",icon:He,permissions:["locations.manage"],children:[{id:"countries",label:"Countries",icon:Xs,permissions:["locations.manage"]},{id:"states",label:"States",icon:He,permissions:["locations.manage"]},{id:"cities",label:"Cities",icon:He,permissions:["locations.manage"]},{id:"areas",label:"Areas",icon:He,permissions:["locations.manage"]}]},{id:"reports",label:"Reports Management",icon:Ws,permissions:["reports.manage"],children:[{id:"report-reasons",label:"Report Reasons",icon:rs,permissions:["reports.manage"]},{id:"user-reports",label:"User Reports",icon:Ua,badge:"3",permissions:["reports.view"]}]},{id:"promotional",label:"Promotional Management",icon:Us,permissions:["promotions.manage"],children:[{id:"send-notification",label:"Send Notification",icon:Us,permissions:["notifications.send"]},{id:"customers",label:"Customers",icon:Ae,permissions:["users.view"]}]},{id:"staff",label:"Staff Management",icon:We,permissions:["staff.manage"],children:[{id:"role",label:"Role",icon:Je,permissions:["roles.manage"]},{id:"staff-management",label:"Staff Management",icon:We,permissions:["staff.manage"]}]},{id:"content",label:"Page Management",icon:Ss,permissions:["content.manage"],children:[{id:"content-management",label:"Create New Page",icon:we,permissions:["content.create"]},{id:"static-pages",label:"All Pages",icon:Ss,permissions:["content.view"]},{id:"footer-management",label:"Footer Settings",icon:Xs,permissions:["content.manage"]},{id:"blog-management",label:"Blog Management",icon:Ss,permissions:["blog.manage"]},{id:"faq",label:"FAQ Management",icon:st,permissions:["content.manage"]},{id:"web-queries",label:"Web User Queries",icon:Ce,badge:"7",permissions:["support.view"]}]},{id:"system",label:"System Settings",icon:rt,permissions:["system.manage"],children:[{id:"system-status",label:"System Status",icon:ut,permissions:["system.view"]},{id:"login-test",label:"Login Test Suite",icon:Ae,permissions:["system.test"]},{id:"settings",label:"Settings",icon:bs,permissions:["system.manage"]},{id:"system-update",label:"System Update",icon:Oe,permissions:["system.update"]},{id:"auth-debug",label:"Auth Debug",icon:Je,permissions:["system.debug"]},{id:"role-debug",label:"Role Debug",icon:Je,permissions:["dashboard.view"]}]}];function Lm({children:s,activeSection:t,onSectionChange:r}){var b,T;const{user:c,logout:N}=je();if(!c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-600",children:"Loading user data..."})})});const[y,n]=a.useState(!1),[o,f]=a.useState(["dashboard"]),[u,S]=a.useState(!1),x=C=>!C||C.length===0?!0:tl((c==null?void 0:c.role)||"admin",C),A=C=>C.filter(P=>{if(!x(P.permissions))return!1;if(P.children){const k=A(P.children);if(k.length===0)return!1;P.children=k}return!0}),d=A(Fm),v=C=>{f(P=>P.includes(C)?P.filter(k=>k!==C):[...P,C])},j=()=>{N(),window.location.href="/staff/login"},m=()=>al((c==null?void 0:c.role)||"admin"),l=(C,P=0)=>{var E;const k=C.children&&C.children.length>0,h=o.includes(C.id),w=t===C.id;return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{k?v(C.id):(r(C.id),S(!1))},className:me("w-full flex items-center justify-between px-3 py-2 text-left rounded-lg transition-colors",P===0?"font-medium":"text-sm font-normal",P>0&&"ml-4",w?"bg-[#C70000] text-white":"text-gray-700 hover:bg-gray-100",y&&P===0&&"justify-center px-2"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(C.icon,{className:me("flex-shrink-0",P===0?"h-5 w-5":"h-4 w-4")}),!y&&e.jsx("span",{className:"truncate",children:C.label})]}),!y&&e.jsxs("div",{className:"flex items-center space-x-2",children:[C.badge&&e.jsx(re,{variant:"destructive",className:"h-5 px-1.5 text-xs",children:C.badge}),k&&e.jsx(ws,{className:me("h-4 w-4 transition-transform",h&&"rotate-90")})]})]}),k&&h&&!y&&e.jsx("div",{className:"mt-1 space-y-1",children:(E=C.children)==null?void 0:E.map(L=>l(L,P+1))})]},C.id)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>S(!1)}),e.jsxs("div",{className:me("fixed inset-y-0 left-0 z-50 bg-white border-r border-gray-200 transition-all duration-300 lg:relative lg:translate-x-0",y?"w-16":"w-64",u?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[!y&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"A"})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Staff Panel"})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>n(!y),className:"p-1 lg:flex hidden",children:y?e.jsx(ws,{className:"h-4 w-4"}):e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>S(!1),className:"p-1 lg:hidden",children:e.jsx(Dt,{className:"h-4 w-4"})})]}),!y&&e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold",children:((b=c==null?void 0:c.name)==null?void 0:b.charAt(0))||"S"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(c==null?void 0:c.name)||"Staff User"}),e.jsx("p",{className:"text-xs text-gray-500",children:m()})]})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:d.map(C=>l(C))}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs(g,{variant:"ghost",onClick:j,className:me("w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50",y&&"justify-center px-2"),children:[e.jsx(Ms,{className:"h-5 w-5"}),!y&&e.jsx("span",{className:"ml-3",children:"Logout"})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>S(!0),className:"lg:hidden",children:e.jsx(Ba,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 capitalize",children:t.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(re,{variant:"outline",children:m()}),e.jsx("div",{className:"w-8 h-8 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:((T=c==null?void 0:c.name)==null?void 0:T.charAt(0))||"S"})})]})]})}),e.jsx("main",{className:"flex-1 p-6 overflow-y-auto",children:s})]})]})}function Kr(){const{token:s}=je(),[t,r]=a.useState({users:{total:0,active:0,sellers:0,buyers:0,newThisMonth:0},properties:{total:0,active:0,pending:0,sold:0,featured:0},packages:{total:0,activeSubscriptions:0,revenue:0,pendingPayments:0},verifications:{pendingSellerVerifications:0,pendingBankTransfers:0,pendingReports:0}}),[c,N]=a.useState(!0),[y,n]=a.useState("");a.useEffect(()=>{o()},[s]);const o=async()=>{if(s)try{N(!0),n(""),r({users:{total:1247,active:1089,sellers:342,buyers:905,newThisMonth:68},properties:{total:856,active:723,pending:45,sold:88,featured:156},packages:{total:8,activeSubscriptions:423,revenue:275400,pendingPayments:12},verifications:{pendingSellerVerifications:23,pendingBankTransfers:8,pendingReports:5}})}catch(f){console.error("Error fetching dashboard stats:",f),n("Failed to fetch dashboard statistics")}finally{N(!1)}};return c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]}):y?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-700",children:y}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{n(""),o()},className:"mt-2",children:"Retry"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-red-600 rounded-lg p-6 text-white",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to Admin Dashboard"}),e.jsx("p",{className:"text-red-100",children:"Manage your property platform efficiently"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ae,{className:"h-5 w-5 mr-2"}),"User Statistics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.users.total.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All registered users"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.users.active.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active accounts"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Sellers"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.users.sellers.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Seller accounts"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Buyers"}),e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.users.buyers.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Buyer accounts"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"New This Month"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.users.newThisMonth}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"New registrations"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Pe,{className:"h-5 w-5 mr-2"}),"Property Statistics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.properties.total.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All listings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Listings"}),e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.properties.active.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live properties"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Approval"}),e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.properties.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting review"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Sold Properties"}),e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.properties.sold}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successful sales"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Featured Listings"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.properties.featured}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Premium listings"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(pt,{className:"h-5 w-5 mr-2"}),"Revenue & Packages"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(pt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¹",t.packages.revenue.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time earnings"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Packages"}),e.jsx(js,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.packages.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available packages"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Active Subscriptions"}),e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.packages.activeSubscriptions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current subscribers"})]})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending Payments"}),e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.packages.pendingPayments}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting payment"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(rs,{className:"h-5 w-5 mr-2"}),"Pending Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(U,{className:"border-l-4 border-l-yellow-500",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Seller Verifications"}),e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.verifications.pendingSellerVerifications}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Awaiting verification"}),e.jsx(g,{size:"sm",variant:"outline",className:"w-full",children:"Review Now"})]})]}),e.jsxs(U,{className:"border-l-4 border-l-blue-500",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Bank Transfers"}),e.jsx(ys,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.verifications.pendingBankTransfers}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Pending verification"}),e.jsx(g,{size:"sm",variant:"outline",className:"w-full",children:"Verify Now"})]})]}),e.jsxs(U,{className:"border-l-4 border-l-red-500",children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"User Reports"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.verifications.pendingReports}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Need attention"}),e.jsx(g,{size:"sm",variant:"outline",className:"w-full",children:"Review Reports"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ws,{className:"h-5 w-5 mr-2"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(g,{className:"h-20 flex flex-col space-y-2 bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Manage Users"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex flex-col space-y-2",children:[e.jsx(Pe,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"View Properties"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex flex-col space-y-2",children:[e.jsx(js,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Manage Packages"})]}),e.jsxs(g,{variant:"outline",className:"h-20 flex flex-col space-y-2",children:[e.jsx(Ws,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"View Analytics"})]})]})]})]})}function Dm(){const{user:s}=je();if(!s)return e.jsx("div",{children:"No user logged in"});const t=s.role||"admin",r=Im(t),c=al(t),N=["dashboard","content-management","ads-listing","staff-management","system-status","user-analytics","categories","packages"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Current User Information"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-lg",children:s.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-lg",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"User Type"}),e.jsx("p",{className:"text-lg",children:s.userType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Role"}),e.jsx("p",{className:"text-lg",children:e.jsx(re,{className:"bg-blue-100 text-blue-800",children:c})})]})]}),s.username&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Username"}),e.jsxs("p",{className:"text-lg",children:["@",s.username]})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{children:["Role Permissions (",r.length,")"]})}),e.jsx(_,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(y=>e.jsx(re,{variant:"outline",className:"text-xs",children:y},y))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Section Access Test"})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:N.map(y=>{const n=rl(t,y);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsx("span",{className:"font-medium",children:y.replace("-"," ")}),e.jsx(re,{variant:n?"default":"destructive",className:n?"bg-green-100 text-green-800":"",children:n?"âœ… Allowed":"âŒ Denied"})]},y)})})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Raw User Object"})}),e.jsx(_,{children:e.jsx("pre",{className:"bg-gray-100 p-4 rounded text-sm overflow-auto",children:JSON.stringify(s,null,2)})})]})]})}function Rm(){const{user:s,isAuthenticated:t}=je(),r=Ve(),[c,N]=a.useState("dashboard"),[y,n]=a.useState(!0);a.useEffect(()=>{if(!t){r("/staff/login");return}if((s==null?void 0:s.userType)!=="staff"&&(s==null?void 0:s.userType)!=="admin"){r("/staff/login");return}n(!1)},[t,s,r]);const o=()=>{if(!rl((s==null?void 0:s.role)||"admin",c))return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Je,{className:"h-8 w-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this section."})]})});switch(c){case"dashboard":return e.jsx(Kr,{});case"content-management":return e.jsx(Qs,{});case"static-pages":return e.jsx(Qs,{});case"pages":return e.jsx(Qs,{});case"ads-listing":return e.jsx($i,{});case"categories":return e.jsx(Ct,{});case"custom-fields":return e.jsx(Ui,{});case"ad-management":return e.jsx(La,{});case"ad-requested":return e.jsx(La,{});case"pending-approval":return e.jsx(La,{});case"premium-approvals":return e.jsx(Yi,{});case"ad-tips":return e.jsx(Qs,{});case"package-management":return e.jsx(Ri,{});case"listing-package":return e.jsx(Hi,{});case"feature-package":return e.jsx(Gi,{});case"transactions":return e.jsx(Wi,{});case"manual-payment-approval":return e.jsx(Ki,{});case"bank-transfer":return e.jsx(Qi,{});case"all-users":return e.jsx(mr,{});case"user-analytics":return e.jsx(zi,{});case"seller-management":return e.jsx(ma,{});case"verification-fields":return e.jsx(Zi,{});case"seller-verification":return e.jsx(Oi,{});case"seller-review":return e.jsx(ma,{});case"seller-review-report":return e.jsx(pa,{});case"slider":return e.jsx(Qs,{});case"feature-section":return e.jsx(Qs,{});case"countries":return e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Countries"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This section moved to dedicated page."}),e.jsx("a",{className:"text-[#C70000] underline",href:"/admin/locations/countries",children:"Go to Countries"})]});case"states":return e.jsx(Ct,{});case"cities":return e.jsx(Ct,{});case"areas":return e.jsx(Ct,{});case"report-reasons":return e.jsx(pa,{});case"user-reports":return e.jsx(pa,{});case"send-notification":return e.jsx(Bi,{});case"customers":return e.jsx(ma,{});case"role":return e.jsx(Ma,{});case"staff-management":return e.jsx(Ma,{});case"footer-management":return e.jsx(Ji,{});case"blog-management":return e.jsx(Qs,{});case"blogs":return e.jsx(Qs,{});case"faq":return e.jsx(wt,{});case"faqs":return e.jsx(wt,{});case"web-queries":return e.jsx(ma,{});case"system-status":return e.jsx(hr,{});case"login-test":return e.jsx(hr,{});case"settings":return e.jsx(Mi,{});case"system-update":return e.jsx(qi,{});case"auth-debug":return e.jsx(Xi,{});case"role-debug":return e.jsx(Dm,{});default:return e.jsx(Kr,{})}};return y?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading admin panel..."})]})}):e.jsx(Lm,{activeSection:c,onSectionChange:N,children:o()})}function $m(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),{toast:N}=ct(),y=a.useRef(null),n=async()=>{var f;try{(f=y.current)==null||f.abort(),y.current=new AbortController;const u=await wm({signal:y.current.signal});t(Array.isArray(u)?u:[])}catch{t([])}finally{c(!1)}};a.useEffect(()=>(n(),()=>{var f;return(f=y.current)==null?void 0:f.abort()}),[]);const o=async(f,u)=>{let S;u==="rejected"&&(S=window.prompt("Reason (optional)")||void 0),await Cm(f,u,S)?(t(A=>A.filter(d=>d.id!==f)),N({title:u==="approved"?"Approved":"Rejected"})):N({title:"Action failed",description:"Try again"})};return e.jsxs("div",{className:"max-w-5xl mx-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Reviews Moderation"}),r?e.jsx("div",{className:"text-sm text-gray-500",children:"Loadingâ€¦"}):s.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No pending reviews."}):e.jsx("div",{className:"grid gap-3",children:s.map(f=>e.jsxs("div",{className:"rounded-xl shadow-sm border p-4 bg-white",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("div",{className:"font-medium",children:f.userName||"User"}),e.jsx("div",{className:"text-amber-400",children:"â˜…".repeat(Math.max(1,Math.min(5,Number(f.rating)||0)))})]}),f.title&&e.jsx("div",{className:"text-sm font-semibold mb-1",children:f.title}),e.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-line mb-2",children:f.comment}),e.jsxs("div",{className:"text-xs text-gray-400 mb-3",children:["Target: ",f.targetType," â€¢ ",f.targetId]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{"aria-label":"Approve",onClick:()=>o(f.id,"approved"),className:"px-3 py-1 rounded-md bg-green-600 text-white text-sm",children:"Approve"}),e.jsx("button",{"aria-label":"Reject",onClick:()=>o(f.id,"rejected"),className:"px-3 py-1 rounded-md bg-red-600 text-white text-sm",children:"Reject"})]})]},f.id))})]})}async function et(){var t;let s=localStorage.getItem("userToken")||localStorage.getItem("adminToken")||localStorage.getItem("token")||localStorage.getItem("authToken")||localStorage.getItem("accessToken")||null;if(!s)try{const r=JSON.parse(localStorage.getItem("user")||"null")||JSON.parse(localStorage.getItem("adminUser")||"null");s=(r==null?void 0:r.token)||null}catch{}try{const r=(window==null?void 0:window.firebaseAuth)||void 0;(t=r==null?void 0:r.currentUser)!=null&&t.getIdToken&&(s=await r.currentUser.getIdToken(!0))}catch{}return s}function Yr(){const{user:s,logout:t}=je(),r=Ve(),[c,N]=a.useState("overview"),[y,n]=a.useState(!0),[o,f]=a.useState(""),[u,S]=a.useState([]),[x,A]=a.useState([]),[d,v]=a.useState([]),[j,m]=a.useState([]),[l,b]=a.useState([]),[T,C]=a.useState(!1),[P,k]=a.useState(null),[h,w]=a.useState(""),E=ie=>{k(ie),w(`Hi ${ie.buyerName}, regarding ${ie.propertyTitle}.`),C(!0)},L=()=>{C(!1),k(null),w("")},q=ie=>{if(ie.conversationId){r(`/conversation/${ie.conversationId}`);return}E(ie)},V=async()=>{var ie,fe,_e;try{const Te=await et();if(!Te||!P){Rs.error("Session expired or invalid target. Please login again.");return}const qe=h.trim();if(!qe){Rs.error("Please enter a reply message before sending.");return}const os={message:qe};P.source==="enquiry"&&(os.enquiryId=P._id),P.buyerId&&(os.buyerId=P.buyerId),P.buyerPhone&&(os.buyerPhone=P.buyerPhone),P.propertyId&&(os.propertyId=P.propertyId);const Gs=await ce.post("/seller/messages",os,Te);if((ie=Gs==null?void 0:Gs.data)!=null&&ie.success){Rs.success("Reply sent successfully");const Ye=(_e=(fe=Gs.data)==null?void 0:fe.data)==null?void 0:_e.conversationId;L(),await B(),Ye&&r(`/conversation/${Ye}`)}else Rs.error("Failed to send reply")}catch(Te){console.error("sendReply:",Te),Rs.error("Failed to send reply. Please try again.")}},[p,i]=a.useState(""),[F,I]=a.useState("all"),[D,R]=a.useState({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",currentPassword:"",newPassword:"",confirmPassword:"",emailNotifications:!0,pushNotifications:!0}),[M,W]=a.useState({totalProperties:0,pendingApproval:0,approved:0,rejected:0,totalViews:0,totalInquiries:0,unreadNotifications:0,unreadMessages:0,profileViews:0,premiumListings:0}),J=a.useRef(null),H=a.useRef(null);a.useEffect(()=>{if(!s){r("/auth",{replace:!0});return}if(s.userType!=="seller"){r("/user-dashboard",{replace:!0});return}B();const ie=()=>B();return window.addEventListener("properties:updated",ie),()=>window.removeEventListener("properties:updated",ie)},[s,r]),a.useEffect(()=>((async()=>{const ie=await et();if(ie){if(J.current){try{J.current.close()}catch{}J.current=null}try{const fe=new EventSource(`/api/seller/stream?token=${encodeURIComponent(ie)}`);J.current=fe,fe.addEventListener("open",()=>{}),fe.addEventListener("error",()=>{try{fe.close()}catch{}J.current=null,se()});const _e=()=>B();fe.addEventListener("property:updated",_e),fe.addEventListener("notification:new",_e),fe.addEventListener("message:new",_e)}catch{se()}}})(),()=>{if(J.current)try{J.current.close()}catch{}H.current&&window.clearInterval(H.current)}),[]);function se(){H.current||(H.current=window.setInterval(B,6e4))}async function B(){var ie,fe,_e,Te,qe,os,Gs;try{n(!0),f("");const Ye=await et();if(!Ye){r("/auth",{replace:!0});return}const[us,jt,ya,wa,Ca]=await Promise.all([ce.get("/seller/properties",Ye),ce.get("/seller/notifications",Ye),ce.get("/seller/messages",Ye),ce.get("/seller/packages",Ye),ce.get("/seller/payments",Ye)]);(ie=us==null?void 0:us.data)!=null&&ie.success&&S(us.data.data||[]),(fe=jt==null?void 0:jt.data)!=null&&fe.success&&A(jt.data.data||[]),(_e=ya==null?void 0:ya.data)!=null&&_e.success&&v(ya.data.data||[]),(Te=wa==null?void 0:wa.data)!=null&&Te.success&&m(wa.data.data||[]),(qe=Ca==null?void 0:Ca.data)!=null&&qe.success&&b(Ca.data.data||[])}catch(Ye){if(console.error("Dashboard load failed:",Ye),((os=Ye==null?void 0:Ye.response)==null?void 0:os.status)===401||((Gs=Ye==null?void 0:Ye.response)==null?void 0:Gs.status)===403){alert("Your session has expired. Please login again."),["token","authToken","accessToken","userToken","adminToken","user","adminUser"].forEach(us=>localStorage.removeItem(us)),r("/auth",{replace:!0});return}f("Failed to load dashboard data. Please try again.")}finally{n(!1)}}a.useEffect(()=>{const ie=u.reduce((qe,os)=>qe+(os.views||0),0),fe=u.reduce((qe,os)=>qe+(os.inquiries||0),0),_e=x.filter(qe=>!qe.isRead).length,Te=d.filter(qe=>!qe.isRead).length;W({totalProperties:u.length,pendingApproval:u.filter(qe=>qe.approvalStatus==="pending").length,approved:u.filter(qe=>qe.approvalStatus==="approved").length,rejected:u.filter(qe=>qe.approvalStatus==="rejected").length,totalViews:ie,totalInquiries:fe,unreadNotifications:_e,unreadMessages:Te,profileViews:0,premiumListings:u.filter(qe=>qe.isPremium).length})},[u,x,d]);const $=async ie=>{try{const fe=await et();await ce.put(`/seller/notifications/${ie}/read`,{},fe),A(_e=>_e.map(Te=>Te._id===ie?{...Te,isRead:!0}:Te))}catch(fe){console.error("markNotificationAsRead:",fe)}},O=async ie=>{try{const fe=await et();await ce.delete(`/seller/notifications/${ie}`,fe),A(_e=>_e.filter(Te=>Te._id!==ie))}catch(fe){console.error("deleteNotification:",fe)}},ae=async ie=>{var fe,_e,Te,qe,os,Gs;try{if(ie.conversationId){r(`/conversation/${ie.conversationId}`);return}if(!ie.propertyId){Rs.error("Chat link unavailable for this notification.");return}const Ye=await et(),us=await ce.post("/conversations/find-or-create",{propertyId:ie.propertyId},Ye),jt=((_e=(fe=us==null?void 0:us.data)==null?void 0:fe.data)==null?void 0:_e._id)||((Te=us==null?void 0:us.data)==null?void 0:Te._id)||((os=(qe=us==null?void 0:us.data)==null?void 0:qe.data)==null?void 0:os.conversationId)||((Gs=us==null?void 0:us.data)==null?void 0:Gs.conversationId);jt?r(`/conversation/${jt}`):Rs.error("Failed to open chat")}catch(Ye){console.error("openChatFromNotification:",Ye),Rs.error("Failed to open chat")}},X=async ie=>{if(confirm("Delete this property? This cannot be undone."))try{const fe=await et();await ce.delete(`/seller/properties/${ie}`,fe),S(_e=>_e.filter(Te=>(Te._id||Te.id)!==ie))}catch(fe){console.error("delete property:",fe),alert("Failed to delete property.")}},z=async ie=>{try{const fe=await et();await ce.post(`/seller/properties/${ie}/resubmit`,{},fe),await B(),alert("Resubmitted for review.")}catch(fe){console.error("resubmit:",fe),alert("Failed to resubmit.")}},le=()=>{t(),r("/")},Z=ie=>{switch(ie){case"pending":return e.jsx(re,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending Review"});case"approved":return e.jsx(re,{variant:"default",className:"bg-green-100 text-green-800",children:"Approved"});case"rejected":return e.jsx(re,{variant:"destructive",className:"bg-red-100 text-red-800",children:"Rejected"});default:return e.jsx(re,{variant:"outline",children:"Unknown"})}},ne=ie=>{switch(ie){case"approval":return e.jsx(Le,{className:"h-4 w-4 text-green-500"});case"rejection":return e.jsx(fs,{className:"h-4 w-4 text-red-500"});case"account":return e.jsx(hs,{className:"h-4 w-4 text-blue-500"});default:return e.jsx(Es,{className:"h-4 w-4 text-gray-500"})}},ye=a.useMemo(()=>{let ie=u.slice();if(F!=="all"&&(ie=ie.filter(fe=>fe.approvalStatus===F)),p.trim()){const fe=p.toLowerCase();ie=ie.filter(_e=>{var Te,qe,os;return _e.title.toLowerCase().includes(fe)||((os=(qe=(Te=_e.location)==null?void 0:Te.address)==null?void 0:qe.toLowerCase)==null?void 0:os.call(qe).includes(fe))})}return ie},[u,F,p]);return y?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seller Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",s==null?void 0:s.name,"!"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"relative",children:e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>N("notifications"),children:[e.jsx(Es,{className:"h-4 w-4"}),M.unreadNotifications>0&&e.jsx(re,{className:"absolute -top-2 -right-2 h-5 w-5 text-xs bg-red-500 text-white",children:M.unreadNotifications})]})}),e.jsxs(g,{onClick:B,variant:"outline",size:"sm",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:le,variant:"outline",size:"sm",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-700",children:o})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Properties"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.totalProperties})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Pending"}),e.jsx(cs,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:M.pendingApproval})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Approved"}),e.jsx(Le,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:M.approved})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Total Views"}),e.jsx(Ne,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:M.totalViews})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Messages"}),e.jsx(Ce,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:M.unreadMessages})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Profile Views"}),e.jsx(We,{className:"h-4 w-4 text-indigo-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:M.profileViews})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Premium"}),e.jsx(We,{className:"h-4 w-4 text-amber-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:M.premiumListings})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Y,{className:"text-sm font-medium",children:"Inquiries"}),e.jsx($s,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:M.totalInquiries})})]})]}),e.jsxs(Ls,{value:c,onValueChange:N,className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-8",children:[e.jsx(Se,{value:"overview",children:"Overview"}),e.jsxs(Se,{value:"notifications",className:"relative",children:["Notifications",M.unreadNotifications>0&&e.jsx(re,{className:"absolute -top-1 -right-1 h-4 w-4 text-xs bg-red-500 text-white",children:M.unreadNotifications})]}),e.jsx(Se,{value:"properties",children:"My Properties"}),e.jsxs(Se,{value:"messages",className:"relative",children:["Messages",M.unreadMessages>0&&e.jsx(re,{className:"absolute -top-1 -right-1 h-4 w-4 text-xs bg-red-500 text-white",children:M.unreadMessages})]}),e.jsx(Se,{value:"insights",children:"Insights"}),e.jsx(Se,{value:"payments",children:"Payments"}),e.jsx(Se,{value:"settings",children:"Settings"}),e.jsx(Se,{value:"blog",children:"Blog"})]}),e.jsxs(ke,{value:"overview",className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Quick Actions"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"w-full bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"})," Post New Property"]})}),e.jsxs(g,{variant:"outline",className:"w-full",onClick:()=>N("properties"),children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"})," Manage Properties"]}),e.jsxs(g,{variant:"outline",className:"w-full",onClick:()=>N("messages"),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"})," View Messages (",M.unreadMessages,")"]}),e.jsxs(g,{variant:"outline",className:"w-full",onClick:()=>N("payments"),children:[e.jsx(We,{className:"h-4 w-4 mr-2"})," Upgrade to Premium"]})]})})]}),e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between",children:[e.jsx(Y,{children:"Recent Properties"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>N("properties"),children:"View All"})]}),e.jsx(_,{children:u.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"You haven't posted any properties yet"}),e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:[e.jsx(we,{className:"h-4 w-4 mr-2"})," Post Your First Property"]})})]}):e.jsx("div",{className:"space-y-4",children:u.slice(0,3).map((ie,fe)=>{var _e;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:ie.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.jsx(He,{className:"inline h-3 w-3 mr-1"}),(_e=ie.location)==null?void 0:_e.address]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("span",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",Number(ie.price).toLocaleString()]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[ie.views||0," views"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(Ce,{className:"h-3 w-3"}),e.jsxs("span",{children:[ie.inquiries||0," inquiries"]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[Z(ie.approvalStatus),ie.isPremium&&e.jsxs(re,{className:"bg-amber-100 text-amber-800",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Premium"]})]})]})},ie._id||ie.id||ie.title||fe)})})})]})]}),e.jsx(ke,{value:"notifications",className:"space-y-4",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Es,{className:"h-5 w-5"}),e.jsx("span",{children:"Notifications"}),M.unreadNotifications>0&&e.jsxs(re,{className:"bg-red-500 text-white",children:[M.unreadNotifications," unread"]})]})}),e.jsx(_,{children:x.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No notifications yet"})]}):e.jsx("div",{className:"space-y-3",children:x.map((ie,fe)=>e.jsx("div",{className:`border rounded-lg p-4 ${ie.isRead?"bg-gray-50":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[ne(ie.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:ie.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ie.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(ie.createdAt).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(ie.conversationId||ie.propertyId)&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>ae(ie),children:"Open Chat"}),!ie.isRead&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>$(ie._id),children:e.jsx(Be,{className:"h-3 w-3"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>O(ie._id),children:e.jsx(Ue,{className:"h-3 w-3"})})]})]})},ie._id||ie.title||fe))})})]})}),e.jsx(ke,{value:"properties",className:"space-y-4",children:e.jsxs(U,{children:[e.jsxs(K,{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-5 w-5"}),e.jsx("span",{children:"My Posted Properties"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{value:p,onChange:ie=>i(ie.target.value),placeholder:"Search by title / address...",className:"pl-8"}),e.jsx(ts,{className:"h-4 w-4 absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{className:"border rounded-md px-2 py-1 text-sm",value:F,onChange:ie=>I(ie.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"})," Add New Property"]})})]})]}),e.jsx(_,{children:ye.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No properties found"})]}):e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Property"}),e.jsx(te,{children:"Price"}),e.jsx(te,{children:"Location"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Views"}),e.jsx(te,{children:"Inquiries"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:ye.map((ie,fe)=>{var Te;const _e=ie._id||ie.id;return e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:ie.title}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Posted"," ",new Date(ie.createdAt).toLocaleDateString()]})]})}),e.jsx(ee,{children:e.jsxs("span",{className:"font-bold text-[#C70000]",children:["â‚¹",Number(ie.price).toLocaleString()]})}),e.jsx(ee,{children:e.jsx("div",{className:"text-sm",children:(Te=ie.location)==null?void 0:Te.address})}),e.jsxs(ee,{children:[Z(ie.approvalStatus),ie.approvalStatus==="rejected"&&ie.rejectionReason&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Reason: ",ie.rejectionReason]})]}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsx("span",{children:ie.views||0})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),e.jsx("span",{children:ie.inquiries||0})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{to:`/property/${_e}`,target:"_blank",children:e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(Ne,{className:"h-3 w-3"})})}),e.jsx(be,{to:`/edit-property/${_e}`,children:e.jsx(g,{size:"sm",variant:"outline",children:e.jsx(as,{className:"h-3 w-3"})})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>X(_e),children:e.jsx(De,{className:"h-3 w-3"})}),ie.approvalStatus==="rejected"&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>z(_e),children:"Resubmit"}),ie.isPremium&&e.jsxs(re,{className:"ml-1 bg-amber-100 text-amber-800",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Premium"]})]})})]},_e||ie.title||fe)})})]})})]})}),e.jsx(ke,{value:"messages",className:"space-y-4",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Messages Center"}),M.unreadMessages>0&&e.jsxs(re,{className:"bg-red-500 text-white",children:[M.unreadMessages," unread"]})]})}),e.jsx(_,{children:d.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No messages yet"})]}):e.jsx("div",{className:"space-y-3",children:d.map((ie,fe)=>e.jsx("div",{className:`border rounded-lg p-4 ${ie.isRead?"bg-gray-50":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:ie.buyerName}),ie.buyerEmail&&e.jsx(re,{variant:"outline",className:"text-xs",children:ie.buyerEmail}),ie.buyerPhone&&e.jsx(re,{variant:"outline",className:"text-xs",children:ie.buyerPhone})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:ie.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400",children:[e.jsxs("span",{children:["Property: ",ie.propertyTitle]}),e.jsx("span",{children:new Date(ie.timestamp).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[ie.buyerPhone&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`tel:${ie.buyerPhone}`,className:"inline-flex",children:e.jsx(g,{size:"sm",variant:"outline",children:"Call"})}),e.jsx("a",{href:`https://wa.me/${(ie.buyerPhone||"").replace(/\D/g,"")}?text=${encodeURIComponent(`Hi ${ie.buyerName}, regarding ${ie.propertyTitle}`)}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex",children:e.jsx(g,{size:"sm",variant:"outline",children:"WhatsApp"})})]}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>q(ie),children:ie.conversationId?"Open Chat":"Reply"})]})]})},ie._id||ie.timestamp||fe))})})]})}),e.jsx(ke,{value:"insights",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-5 w-5"}),e.jsx("span",{children:"Post Insights"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Total Profile Views"}),e.jsx("span",{className:"font-bold text-blue-600",children:M.profileViews})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Property Views"}),e.jsx("span",{className:"font-bold text-green-600",children:M.totalViews})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Interested Buyers"}),e.jsx("span",{className:"font-bold text-purple-600",children:M.totalInquiries})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Premium Listings"}),e.jsx("span",{className:"font-bold text-amber-600",children:M.premiumListings})]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(nt,{className:"h-5 w-5"}),e.jsx("span",{children:"Enhance Visibility"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Upgrade to premium to get more visibility and better reach for your properties."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(We,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"text-sm",children:"Featured listings"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ns,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"text-sm",children:"Priority in search results"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"text-sm",children:"10x more visibility"})]})]}),e.jsxs(g,{className:"w-full bg-amber-500 hover:bg-amber-600",onClick:()=>N("payments"),children:[e.jsx(We,{className:"h-4 w-4 mr-2"})," Upgrade to Premium"]})]})})]})]})}),e.jsx(ke,{value:"blog",className:"space-y-4",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Blog"})}),e.jsx(_,{children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(be,{to:"/seller/blog",children:e.jsx(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:"Create Blog Post"})}),e.jsx(be,{to:"/seller/blog",children:e.jsx(g,{variant:"outline",children:"My Posts"})})]})})]})}),e.jsx(ke,{value:"payments",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(js,{className:"h-5 w-5"}),e.jsx("span",{children:"Available Packages"})]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:j.map((ie,fe)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-bold text-lg",children:ie.name}),e.jsx(re,{className:ie.type==="elite"?"bg-purple-100 text-purple-800":ie.type==="premium"?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800",children:ie.type.toUpperCase()})]}),e.jsxs("div",{className:"text-2xl font-bold text-[#C70000] mb-3",children:["â‚¹",ie.price.toLocaleString()," ",e.jsxs("span",{className:"text-sm text-gray-500",children:["/",ie.duration," days"]})]}),e.jsx("div",{className:"space-y-1 mb-4",children:ie.features.map((_e,Te)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-3 w-3 text-green-500"}),e.jsx("span",{className:"text-sm",children:_e})]},`${ie._id}-${_e}-${Te}`))}),e.jsx(g,{className:"w-full bg-[#C70000] hover:bg-[#A60000]",children:"Purchase Package"})]},ie._id||ie.name||fe))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(ys,{className:"h-5 w-5"}),e.jsx("span",{children:"Payment History"})]})}),e.jsx(_,{children:l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ys,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No payments yet"})]}):e.jsx("div",{className:"space-y-3",children:l.map((ie,fe)=>e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:ie.package}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(ie.date).toLocaleDateString()}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Transaction ID: ",ie.transactionId]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-[#C70000]",children:["â‚¹",ie.amount.toLocaleString()]}),e.jsx(re,{className:ie.status==="completed"?"bg-green-100 text-green-800":ie.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:ie.status})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsxs(g,{size:"sm",variant:"outline",children:[e.jsx(it,{className:"h-3 w-3 mr-1"}),"Invoice"]}),e.jsxs(g,{size:"sm",variant:"outline",children:[e.jsx(ja,{className:"h-3 w-3 mr-1"}),"Details"]})]})]},ie._id||ie.transactionId||fe))})})]})]})}),e.jsx(ke,{value:"settings",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-5 w-5"}),e.jsx("span",{children:"Profile Settings"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"name",children:"Full Name"}),e.jsx(Q,{id:"name",value:D.name,onChange:ie=>R(fe=>({...fe,name:ie.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"email",children:"Email"}),e.jsx(Q,{id:"email",type:"email",value:D.email,onChange:ie=>R(fe=>({...fe,email:ie.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phone",children:"Phone"}),e.jsx(Q,{id:"phone",value:D.phone,onChange:ie=>R(fe=>({...fe,phone:ie.target.value}))})]}),e.jsx(g,{onClick:async()=>{try{const ie=await et();await ce.put("/seller/profile",{name:D.name,email:D.email,phone:D.phone,emailNotifications:D.emailNotifications,pushNotifications:D.pushNotifications},ie),f(""),alert("Profile updated")}catch{f("Failed to update profile")}},className:"w-full",children:"Update Profile"})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{className:"flex items-center space-x-2",children:[e.jsx(nt,{className:"h-5 w-5"}),e.jsx("span",{children:"Security & Notifications"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(Q,{id:"currentPassword",type:"password",value:D.currentPassword,onChange:ie=>R(fe=>({...fe,currentPassword:ie.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"newPassword",children:"New Password"}),e.jsx(Q,{id:"newPassword",type:"password",value:D.newPassword,onChange:ie=>R(fe=>({...fe,newPassword:ie.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(Q,{id:"confirmPassword",type:"password",value:D.confirmPassword,onChange:ie=>R(fe=>({...fe,confirmPassword:ie.target.value}))})]}),e.jsx(g,{onClick:async()=>{if(D.newPassword!==D.confirmPassword)return f("New passwords do not match");try{const ie=await et();await ce.put("/seller/change-password",{currentPassword:D.currentPassword,newPassword:D.newPassword},ie),R(fe=>({...fe,currentPassword:"",newPassword:"",confirmPassword:""})),f(""),alert("Password changed")}catch{f("Failed to change password")}},className:"w-full mb-4",children:"Change Password"}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ge,{htmlFor:"emailNotifications",children:"Email Notifications"}),e.jsx(ze,{id:"emailNotifications",checked:D.emailNotifications,onCheckedChange:ie=>R(fe=>({...fe,emailNotifications:ie}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ge,{htmlFor:"pushNotifications",children:"Push Notifications"}),e.jsx(ze,{id:"pushNotifications",checked:D.pushNotifications,onCheckedChange:ie=>R(fe=>({...fe,pushNotifications:ie}))})]})]}),e.jsxs(g,{onClick:le,variant:"destructive",className:"w-full mt-4",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"})," Logout"]})]})]})]})})]})]}),e.jsx(Re,{open:T,onOpenChange:ie=>{ie?C(!!ie):L()},children:e.jsxs(Ee,{className:"max-w-lg",children:[e.jsx(Ie,{children:e.jsxs(Fe,{children:["Reply to ",P==null?void 0:P.buyerName]})}),e.jsxs("div",{className:"p-2",children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Property: ",P==null?void 0:P.propertyTitle]}),e.jsx("textarea",{value:h,onChange:ie=>w(ie.target.value),rows:6,className:"w-full border border-gray-300 rounded p-2"}),e.jsxs("div",{className:"flex justify-end mt-3 space-x-2",children:[e.jsx(g,{variant:"outline",onClick:L,children:"Cancel"}),e.jsx(g,{onClick:V,className:"bg-[#C70000] text-white",children:"Send Reply"})]})]})]})}),e.jsx(ve,{})]})}function Um(){var J,H,se,B;const{user:s,logout:t}=je(),r=Ve(),[c,N]=a.useState(!1),[y,n]=a.useState(!1),[o,f]=a.useState(""),[u,S]=a.useState(""),[x,A]=a.useState("profile"),[d,v]=a.useState(!1),[j,m]=a.useState(!1),[l,b]=a.useState({name:(s==null?void 0:s.name)||"",email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",bio:"",location:"",avatar:"",website:"",company:"",designation:""}),[T,C]=a.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[P,k]=a.useState({emailNotifications:!0,pushNotifications:!0,smsNotifications:!1,propertyAlerts:!0,priceDropAlerts:!1,newListingAlerts:!0,messageNotifications:!0,marketingEmails:!1}),[h,w]=a.useState({profileVisibility:"public",showEmail:!1,showPhone:!1,allowMessages:!0,allowCalls:!0,dataCollection:!0,analytics:!0}),[E,L]=a.useState("system"),[q,V]=a.useState("en");a.useEffect(()=>{if(!s){r("/login");return}p()},[s,r]);const p=async()=>{try{N(!0);const $=localStorage.getItem("token");if(!$)return;const O=await ce.get("/user/settings",$);if(O.data.success){const ae=O.data.data;b(X=>({...X,...ae.profile})),k(X=>({...X,...ae.notifications})),w(X=>({...X,...ae.privacy})),L(ae.theme||"system"),V(ae.language||"en")}}catch($){console.error("Error fetching settings:",$)}finally{N(!1)}},i=async()=>{try{n(!0);const $=localStorage.getItem("token");if(!$)return;(await ce.put("/user/profile",l,$)).data.success&&(f("Profile updated successfully!"),S(""))}catch($){console.error("Error updating profile:",$),S("Failed to update profile. Please try again.")}finally{n(!1)}},F=async()=>{if(T.newPassword!==T.confirmPassword){S("New passwords do not match");return}if(T.newPassword.length<6){S("Password must be at least 6 characters");return}try{n(!0);const $=localStorage.getItem("token");if(!$)return;(await ce.put("/user/change-password",{currentPassword:T.currentPassword,newPassword:T.newPassword},$)).data.success&&(f("Password changed successfully!"),S(""),C({currentPassword:"",newPassword:"",confirmPassword:""}))}catch($){console.error("Error changing password:",$),S("Failed to change password. Please check your current password.")}finally{n(!1)}},I=async()=>{try{n(!0);const $=localStorage.getItem("token");if(!$)return;await ce.put("/user/notifications-settings",P,$),f("Notification settings updated successfully!"),S("")}catch($){console.error("Error updating notification settings:",$),S("Failed to update notification settings.")}finally{n(!1)}},D=async()=>{try{n(!0);const $=localStorage.getItem("token");if(!$)return;await ce.put("/user/privacy-settings",h,$),f("Privacy settings updated successfully!"),S("")}catch($){console.error("Error updating privacy settings:",$),S("Failed to update privacy settings.")}finally{n(!1)}},R=async()=>{try{const $=localStorage.getItem("token");if(!$)return;const O=await ce.get("/user/export-data",$),ae=new Blob([JSON.stringify(O.data,null,2)],{type:"application/json"}),X=URL.createObjectURL(ae),z=document.createElement("a");z.href=X,z.download=`user-data-${new Date().toISOString().split("T")[0]}.json`,z.click(),URL.revokeObjectURL(X)}catch($){console.error("Error exporting data:",$),S("Failed to export data.")}},M=async()=>{if(confirm("Are you sure you want to delete your account? This action cannot be undone."))try{const $=localStorage.getItem("token");if(!$)return;await ce.delete("/user/account",$),t(),r("/")}catch($){console.error("Error deleting account:",$),S("Failed to delete account.")}},W=()=>{t(),r("/")};return c?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(bs,{className:"h-6 w-6"}),e.jsx("span",{children:"Settings"})]}),e.jsx("p",{className:"text-gray-600",children:"Manage your account preferences"})]}),e.jsxs(g,{onClick:W,variant:"outline",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Logout"]})]}),o&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-4 w-4 text-green-500 mr-2"}),e.jsx("p",{className:"text-green-700",children:o})]})}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 mr-2"}),e.jsx("p",{className:"text-red-700",children:u})]})}),e.jsxs(Ls,{value:x,onValueChange:A,className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-6",children:[e.jsxs(Se,{value:"profile",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Profile"]}),e.jsxs(Se,{value:"security",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Security"]}),e.jsxs(Se,{value:"notifications",children:[e.jsx(Es,{className:"h-4 w-4 mr-2"}),"Notifications"]}),e.jsxs(Se,{value:"privacy",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Privacy"]}),e.jsxs(Se,{value:"preferences",children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Preferences"]}),e.jsxs(Se,{value:"account",children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Account"]})]}),e.jsx(ke,{value:"profile",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Profile Information"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-[#C70000] rounded-full flex items-center justify-center",children:l.avatar?e.jsx("img",{src:l.avatar,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold text-white",children:(H=(J=s==null?void 0:s.name)==null?void 0:J.charAt(0))==null?void 0:H.toUpperCase()})}),e.jsxs("div",{children:[e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx($a,{className:"h-4 w-4 mr-2"}),"Change Photo"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"JPG, GIF or PNG. Max size 2MB."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"name",children:"Full Name"}),e.jsx(Q,{id:"name",value:l.name,onChange:$=>b(O=>({...O,name:$.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"email",children:"Email Address"}),e.jsx(Q,{id:"email",type:"email",value:l.email,onChange:$=>b(O=>({...O,email:$.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"phone",children:"Phone Number"}),e.jsx(Q,{id:"phone",value:l.phone,onChange:$=>b(O=>({...O,phone:$.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"location",children:"Location"}),e.jsx(Q,{id:"location",value:l.location,onChange:$=>b(O=>({...O,location:$.target.value})),placeholder:"City, State"})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"company",children:"Company"}),e.jsx(Q,{id:"company",value:l.company,onChange:$=>b(O=>({...O,company:$.target.value}))})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"designation",children:"Designation"}),e.jsx(Q,{id:"designation",value:l.designation,onChange:$=>b(O=>({...O,designation:$.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(ge,{htmlFor:"website",children:"Website"}),e.jsx(Q,{id:"website",value:l.website,onChange:$=>b(O=>({...O,website:$.target.value})),placeholder:"https://yourwebsite.com"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(ge,{htmlFor:"bio",children:"Bio"}),e.jsx($e,{id:"bio",value:l.bio,onChange:$=>b(O=>({...O,bio:$.target.value})),placeholder:"Tell us about yourself...",rows:3})]})]}),e.jsxs(g,{onClick:i,disabled:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[y?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Profile"]})]})]})}),e.jsxs(ke,{value:"security",className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Change Password"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"currentPassword",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{id:"currentPassword",type:d?"text":"password",value:T.currentPassword,onChange:$=>C(O=>({...O,currentPassword:$.target.value}))}),e.jsx(g,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>v(!d),children:d?e.jsx(Wt,{className:"h-4 w-4"}):e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{id:"newPassword",type:j?"text":"password",value:T.newPassword,onChange:$=>C(O=>({...O,newPassword:$.target.value}))}),e.jsx(g,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>m(!j),children:j?e.jsx(Wt,{className:"h-4 w-4"}):e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(Q,{id:"confirmPassword",type:"password",value:T.confirmPassword,onChange:$=>C(O=>({...O,confirmPassword:$.target.value}))})]}),e.jsxs(g,{onClick:F,disabled:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[y?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Change Password"]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Two-Factor Authentication"})}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Enable 2FA"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),e.jsx(re,{variant:"outline",className:"text-orange-600",children:"Coming Soon"})]})})]})]}),e.jsx(ke,{value:"notifications",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Notification Preferences"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"emailNotifications",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Receive notifications via email"})]}),e.jsx(ze,{id:"emailNotifications",checked:P.emailNotifications,onCheckedChange:$=>k(O=>({...O,emailNotifications:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"pushNotifications",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Receive push notifications in browser"})]}),e.jsx(ze,{id:"pushNotifications",checked:P.pushNotifications,onCheckedChange:$=>k(O=>({...O,pushNotifications:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"smsNotifications",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Receive notifications via SMS"})]}),e.jsx(ze,{id:"smsNotifications",checked:P.smsNotifications,onCheckedChange:$=>k(O=>({...O,smsNotifications:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"propertyAlerts",children:"Property Alerts"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get notified about new property matches"})]}),e.jsx(ze,{id:"propertyAlerts",checked:P.propertyAlerts,onCheckedChange:$=>k(O=>({...O,propertyAlerts:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"priceDropAlerts",children:"Price Drop Alerts"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get notified when property prices drop"})]}),e.jsx(ze,{id:"priceDropAlerts",checked:P.priceDropAlerts,onCheckedChange:$=>k(O=>({...O,priceDropAlerts:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"messageNotifications",children:"Message Notifications"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Get notified about new messages"})]}),e.jsx(ze,{id:"messageNotifications",checked:P.messageNotifications,onCheckedChange:$=>k(O=>({...O,messageNotifications:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"marketingEmails",children:"Marketing Emails"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Receive promotional emails and updates"})]}),e.jsx(ze,{id:"marketingEmails",checked:P.marketingEmails,onCheckedChange:$=>k(O=>({...O,marketingEmails:$}))})]})]}),e.jsxs(g,{onClick:I,disabled:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[y?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Preferences"]})]})]})}),e.jsx(ke,{value:"privacy",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Privacy Settings"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(ge,{children:"Profile Visibility"}),e.jsxs(ue,{value:h.profileVisibility,onValueChange:$=>w(O=>({...O,profileVisibility:$})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"public",children:"Public"}),e.jsx(G,{value:"private",children:"Private"}),e.jsx(G,{value:"contacts",children:"Contacts Only"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"showEmail",children:"Show Email"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Display your email on public profile"})]}),e.jsx(ze,{id:"showEmail",checked:h.showEmail,onCheckedChange:$=>w(O=>({...O,showEmail:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"showPhone",children:"Show Phone"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Display your phone number on public profile"})]}),e.jsx(ze,{id:"showPhone",checked:h.showPhone,onCheckedChange:$=>w(O=>({...O,showPhone:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"allowMessages",children:"Allow Messages"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow other users to send you messages"})]}),e.jsx(ze,{id:"allowMessages",checked:h.allowMessages,onCheckedChange:$=>w(O=>({...O,allowMessages:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"allowCalls",children:"Allow Calls"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow other users to call you"})]}),e.jsx(ze,{id:"allowCalls",checked:h.allowCalls,onCheckedChange:$=>w(O=>({...O,allowCalls:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"dataCollection",children:"Data Collection"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow data collection for personalized experience"})]}),e.jsx(ze,{id:"dataCollection",checked:h.dataCollection,onCheckedChange:$=>w(O=>({...O,dataCollection:$}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ge,{htmlFor:"analytics",children:"Analytics"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Allow analytics to improve our services"})]}),e.jsx(ze,{id:"analytics",checked:h.analytics,onCheckedChange:$=>w(O=>({...O,analytics:$}))})]})]}),e.jsxs(g,{onClick:D,disabled:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[y?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Privacy Settings"]})]})]})}),e.jsx(ke,{value:"preferences",className:"space-y-6",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"App Preferences"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(ge,{children:"Theme"}),e.jsxs(ue,{value:E,onValueChange:$=>L($),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"light",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(uc,{className:"h-4 w-4 mr-2"}),"Light"]})}),e.jsx(G,{value:"dark",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(pc,{className:"h-4 w-4 mr-2"}),"Dark"]})}),e.jsx(G,{value:"system",children:"System"})]})]})]}),e.jsxs("div",{children:[e.jsx(ge,{children:"Language"}),e.jsxs(ue,{value:q,onValueChange:V,children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"en",children:"English"}),e.jsx(G,{value:"hi",children:"à¤¹à¤¿à¤‚à¤¦à¥€"}),e.jsx(G,{value:"pa",children:"à¨ªà©°à¨œà¨¾à¨¬à©€"})]})]})]}),e.jsxs(g,{disabled:y,className:"bg-[#C70000] hover:bg-[#A60000]",children:[y?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Save Preferences"]})]})]})}),e.jsxs(ke,{value:"account",className:"space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Account Management"})}),e.jsx(_,{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Export Account Data"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Download a copy of your account data"})]}),e.jsxs(g,{onClick:R,variant:"outline",children:[e.jsx(it,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg border-red-200 bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-red-600",children:"Permanently delete your account and all data"})]}),e.jsxs(Re,{children:[e.jsx(ks,{asChild:!0,children:e.jsxs(g,{variant:"destructive",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete"]})}),e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Delete Account"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Are you sure you want to delete your account? This action cannot be undone and will permanently remove all your data."}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(g,{variant:"destructive",onClick:M,children:"Yes, Delete Account"})})]})]})]})]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Account Information"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"User Type:"}),e.jsx(re,{variant:"outline",children:((se=s==null?void 0:s.userType)==null?void 0:se.charAt(0).toUpperCase())+((B=s==null?void 0:s.userType)==null?void 0:B.slice(1))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Member Since:"}),e.jsx("span",{className:"text-sm",children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Last Login:"}),e.jsx("span",{className:"text-sm",children:new Date().toLocaleDateString()})]})]})})]})]})]})]}),e.jsx(ve,{})]})}const qt=jc,ga=fc,_m=gc,nl=a.forwardRef(({className:s,...t},r)=>e.jsx(si,{className:me("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:r}));nl.displayName=si.displayName;const St=a.forwardRef(({className:s,...t},r)=>e.jsxs(_m,{children:[e.jsx(nl,{}),e.jsx(ti,{ref:r,className:me("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));St.displayName=ti.displayName;const kt=({className:s,...t})=>e.jsx("div",{className:me("flex flex-col space-y-2 text-center sm:text-left",s),...t});kt.displayName="AlertDialogHeader";const Pt=({className:s,...t})=>e.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Pt.displayName="AlertDialogFooter";const At=a.forwardRef(({className:s,...t},r)=>e.jsx(ai,{ref:r,className:me("text-lg font-semibold",s),...t}));At.displayName=ai.displayName;const Tt=a.forwardRef(({className:s,...t},r)=>e.jsx(ri,{ref:r,className:me("text-sm text-muted-foreground",s),...t}));Tt.displayName=ri.displayName;const Et=a.forwardRef(({className:s,...t},r)=>e.jsx(ni,{ref:r,className:me(vr(),s),...t}));Et.displayName=ni.displayName;const It=a.forwardRef(({className:s,...t},r)=>e.jsx(ii,{ref:r,className:me(vr({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));It.displayName=ii.displayName;function Xr(){const{user:s}=je(),t=Ve(),[r,c]=a.useState(!0),[N,y]=a.useState([]),[n,o]=a.useState(""),[f,u]=a.useState("all"),[S,x]=a.useState("all"),[A,d]=a.useState("newest"),[v,j]=a.useState(null),[m,l]=a.useState(!1),[b,T]=a.useState(null),[C,P]=a.useState({total:0,pending:0,approved:0,rejected:0,premium:0,totalViews:0,totalInquiries:0});a.useEffect(()=>{if(!s){t("/login");return}k()},[s,t]);const k=async()=>{try{c(!0);const I=localStorage.getItem("token");if(!I)return;const D=await ce.get("/user/properties",I);if(D.data.success){const R=D.data.data;y(R),h(R)}}catch(I){console.error("Error fetching properties:",I)}finally{c(!1)}},h=I=>{const D=I.reduce((M,W)=>M+W.views,0),R=I.reduce((M,W)=>M+W.inquiries,0);P({total:I.length,pending:I.filter(M=>M.approvalStatus==="pending").length,approved:I.filter(M=>M.approvalStatus==="approved").length,rejected:I.filter(M=>M.approvalStatus==="rejected").length,premium:I.filter(M=>M.isPremium).length,totalViews:D,totalInquiries:R})},w=async I=>{try{const D=localStorage.getItem("token");if(!D)return;const R=await ce.get(`/properties/${I}/stats`,D);R.data.success&&T(R.data.data)}catch(D){console.error("Error fetching property stats:",D)}},E=async I=>{try{const D=localStorage.getItem("token");if(!D)return;(await ce.delete(`/properties/${I}`,D)).data.success&&k()}catch(D){console.error("Error deleting property:",D)}},L=async(I,D)=>{try{const R=localStorage.getItem("token");if(!R)return;const M=D==="active"?"inactive":"active";(await ce.put(`/properties/${I}/status`,{status:M},R)).data.success&&k()}catch(R){console.error("Error updating property status:",R)}},q=async I=>{try{const D=localStorage.getItem("token");if(!D)return;(await ce.put(`/properties/${I}/premium`,{},D)).data.success&&k()}catch(D){console.error("Error making property premium:",D)}},V=()=>{let I=N;return n&&(I=I.filter(D=>D.title.toLowerCase().includes(n.toLowerCase())||D.location.address.toLowerCase().includes(n.toLowerCase())||D.description.toLowerCase().includes(n.toLowerCase()))),f!=="all"&&(I=I.filter(D=>D.approvalStatus===f)),S==="premium"?I=I.filter(D=>D.isPremium):S==="regular"&&(I=I.filter(D=>!D.isPremium)),I.sort((D,R)=>{switch(A){case"newest":return new Date(R.createdAt).getTime()-new Date(D.createdAt).getTime();case"oldest":return new Date(D.createdAt).getTime()-new Date(R.createdAt).getTime();case"price":return R.price-D.price;case"views":return R.views-D.views;default:return 0}}),I},p=I=>{switch(I){case"pending":return e.jsxs(re,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(cs,{className:"h-3 w-3 mr-1"}),"Pending Review"]});case"approved":return e.jsxs(re,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(Le,{className:"h-3 w-3 mr-1"}),"Approved"]});case"rejected":return e.jsxs(re,{variant:"destructive",className:"bg-red-100 text-red-800",children:[e.jsx(fs,{className:"h-3 w-3 mr-1"}),"Rejected"]});default:return e.jsx(re,{variant:"outline",children:"Unknown"})}},i=I=>{const D=`${window.location.origin}/property/${I}`;navigator.clipboard.writeText(D)},F=I=>{navigator.share?navigator.share({title:I.title,text:I.description,url:`${window.location.origin}/property/${I._id}`}):i(I._id)};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your properties..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-6 w-6"}),e.jsx("span",{children:"My Properties"})]}),e.jsx("p",{className:"text-gray-600",children:"Manage and track your property listings"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:k,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Property"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:C.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Properties"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:C.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pending"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:C.approved}),e.jsx("div",{className:"text-sm text-gray-600",children:"Approved"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:C.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:"Rejected"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:C.premium}),e.jsx("div",{className:"text-sm text-gray-600",children:"Premium"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:C.totalViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Views"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:C.totalInquiries}),e.jsx("div",{className:"text-sm text-gray-600",children:"Inquiries"})]})})]}),e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search properties...",value:n,onChange:I=>o(I.target.value),className:"pl-10"})]}),e.jsxs("select",{value:f,onChange:I=>u(I.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:S,onChange:I=>x(I.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"regular",children:"Regular"})]}),e.jsxs("select",{value:A,onChange:I=>d(I.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"price",children:"Price High to Low"}),e.jsx("option",{value:"views",children:"Most Viewed"})]})]})})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{children:["Property Listings (",V().length,")"]})}),e.jsx(_,{children:V().length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Pe,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:N.length===0?"No properties yet":"No properties match your filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:N.length===0?"Start by posting your first property listing":"Try adjusting your search criteria"}),N.length===0&&e.jsx(be,{to:"/post-property",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Post Your First Property"]})})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Property"}),e.jsx(te,{children:"Price"}),e.jsx(te,{children:"Location"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Views"}),e.jsx(te,{children:"Inquiries"}),e.jsx(te,{children:"Posted"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:V().map(I=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded overflow-hidden",children:I.images&&I.images.length>0?e.jsx("img",{"data-wm":"1",src:I.images[0],alt:I.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-6 w-6 text-gray-400"})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[I.title,I.isPremium&&e.jsx(We,{className:"inline h-4 w-4 text-amber-500 ml-2"})]}),e.jsx("div",{className:"text-sm text-gray-500 max-w-[200px] truncate",children:I.description})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"font-bold text-[#C70000]",children:["â‚¹",I.price.toLocaleString(),I.priceType==="rent"&&"/month"]})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx(He,{className:"inline h-3 w-3 mr-1"}),I.location.address]})}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[p(I.approvalStatus),I.approvalStatus==="rejected"&&I.rejectionReason&&e.jsxs("div",{className:"text-xs text-red-600",children:["Reason: ",I.rejectionReason]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:I.views})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ce,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:I.inquiries})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx(Is,{className:"inline h-3 w-3 mr-1"}),new Date(I.createdAt).toLocaleDateString()]})}),e.jsx(ee,{children:e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ba,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsx(ss,{asChild:!0,children:e.jsxs(be,{to:`/property/${I._id}`,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Property"]})}),e.jsx(ss,{asChild:!0,children:e.jsxs(be,{to:`/property/${I._id}/edit`,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Edit Property"]})}),e.jsxs(ss,{onClick:()=>{j(I),w(I._id),l(!0)},children:[e.jsx(Ws,{className:"h-4 w-4 mr-2"}),"View Analytics"]}),e.jsxs(ss,{onClick:()=>i(I._id),children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"Copy Link"]}),e.jsxs(ss,{onClick:()=>F(I),children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Share Property"]}),!I.isPremium&&e.jsxs(ss,{onClick:()=>q(I._id),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Make Premium"]}),e.jsx(ss,{onClick:()=>L(I._id,I.status),children:I.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Activate"]})}),e.jsxs(qt,{children:[e.jsx(ga,{asChild:!0,children:e.jsxs(ss,{onSelect:D=>D.preventDefault(),className:"text-red-600",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete Property"]})}),e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Delete Property"}),e.jsxs(Tt,{children:['Are you sure you want to delete "',I.title,'"? This action cannot be undone.']})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:()=>E(I._id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]})})]},I._id))})]})})})]}),e.jsx(Re,{open:m,onOpenChange:l,children:e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Property Analytics"})}),v&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded overflow-hidden",children:v.images&&v.images.length>0?e.jsx("img",{"data-wm":"1",src:v.images[0],alt:v.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:v.title}),e.jsx("p",{className:"text-sm text-gray-500",children:v.location.address})]})]}),b&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.views}),e.jsx("div",{className:"text-sm text-blue-700",children:"Total Views"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.inquiries}),e.jsx("div",{className:"text-sm text-green-700",children:"Inquiries"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:b.favorites}),e.jsx("div",{className:"text-sm text-red-700",children:"Favorites"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b.shares}),e.jsx("div",{className:"text-sm text-purple-700",children:"Shares"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:b.clicks}),e.jsx("div",{className:"text-sm text-orange-700",children:"Profile Clicks"})]}),e.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-amber-600",children:[(b.inquiries/b.views*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-amber-700",children:"Conversion Rate"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(g,{onClick:()=>i(v._id),variant:"outline",className:"flex-1",children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"Copy Link"]}),e.jsxs(g,{onClick:()=>F(v),variant:"outline",className:"flex-1",children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsx(g,{asChild:!0,className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:e.jsxs(be,{to:`/property/${v._id}`,children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"View Live"]})})]})]})]})})]}),e.jsx(ve,{})]})}function Om(){var J,H,se,B,$;const{user:s}=je(),t=Ve(),[r,c]=a.useState(!0),[N,y]=a.useState([]),[n,o]=a.useState(""),[f,u]=a.useState("all"),[S,x]=a.useState("all"),[A,d]=a.useState("lastContact"),[v,j]=a.useState(null),[m,l]=a.useState(!1),[b,T]=a.useState(!1),[C,P]=a.useState(!1),[k,h]=a.useState({name:"",email:"",phone:"",userType:"buyer",source:"direct",budget:{min:0,max:0},notes:""}),[w,E]=a.useState({type:"call",description:"",outcome:"neutral",followupRequired:!1,nextAction:""}),[L,q]=a.useState({total:0,active:0,potential:0,closed:0,buyers:0,sellers:0,totalDeals:0,totalCommission:0});a.useEffect(()=>{if(!s){t("/login");return}if(s.userType!=="agent"){t("/user-dashboard");return}V()},[s,t]);const V=async()=>{try{c(!0);const O=localStorage.getItem("token");if(!O)return;const ae=await ce.get("/agent/clients",O);if(ae.data.success){const X=ae.data.data;y(X),p(X)}}catch(O){console.error("Error fetching clients:",O)}finally{c(!1)}},p=O=>{const ae=O.reduce((z,le)=>z+le.deals.length,0),X=O.reduce((z,le)=>z+le.deals.reduce((Z,ne)=>Z+ne.commission,0),0);q({total:O.length,active:O.filter(z=>z.status==="active").length,potential:O.filter(z=>z.status==="potential").length,closed:O.filter(z=>z.status==="closed").length,buyers:O.filter(z=>z.userType==="buyer").length,sellers:O.filter(z=>z.userType==="seller").length,totalDeals:ae,totalCommission:X})},i=async()=>{try{const O=localStorage.getItem("token");if(!O)return;(await ce.post("/agent/clients",k,O)).data.success&&(V(),l(!1),h({name:"",email:"",phone:"",userType:"buyer",source:"direct",budget:{min:0,max:0},notes:""}))}catch(O){console.error("Error adding client:",O)}},F=async()=>{if(v)try{const O=localStorage.getItem("token");if(!O)return;(await ce.post(`/agent/clients/${v._id}/interactions`,w,O)).data.success&&(V(),P(!1),E({type:"call",description:"",outcome:"neutral",followupRequired:!1,nextAction:""}))}catch(O){console.error("Error adding interaction:",O)}},I=async O=>{if(confirm("Are you sure you want to delete this client?"))try{const ae=localStorage.getItem("token");if(!ae)return;await ce.delete(`/agent/clients/${O}`,ae),V()}catch(ae){console.error("Error deleting client:",ae)}},D=()=>{let O=N;return n&&(O=O.filter(ae=>ae.name.toLowerCase().includes(n.toLowerCase())||ae.email.toLowerCase().includes(n.toLowerCase())||ae.phone.includes(n))),f!=="all"&&(O=O.filter(ae=>ae.status===f)),S!=="all"&&(O=O.filter(ae=>ae.userType===S)),O.sort((ae,X)=>{switch(A){case"name":return ae.name.localeCompare(X.name);case"lastContact":return new Date(X.lastContact).getTime()-new Date(ae.lastContact).getTime();case"rating":return X.rating-ae.rating;case"deals":return X.deals.length-ae.deals.length;default:return 0}}),O},R=O=>{switch(O){case"active":return e.jsx(re,{className:"bg-green-100 text-green-800",children:"Active"});case"potential":return e.jsx(re,{className:"bg-blue-100 text-blue-800",children:"Potential"});case"closed":return e.jsx(re,{className:"bg-gray-100 text-gray-800",children:"Closed"});case"inactive":return e.jsx(re,{className:"bg-red-100 text-red-800",children:"Inactive"});default:return e.jsx(re,{variant:"outline",children:"Unknown"})}},M=O=>{switch(O){case"call":return e.jsx(Ge,{className:"h-4 w-4"});case"email":return e.jsx(ms,{className:"h-4 w-4"});case"meeting":return e.jsx(Ae,{className:"h-4 w-4"});case"message":return e.jsx(Ce,{className:"h-4 w-4"});case"visit":return e.jsx(Pe,{className:"h-4 w-4"});default:return e.jsx(ut,{className:"h-4 w-4"})}},W=O=>{switch(O){case"positive":return e.jsx(re,{className:"bg-green-100 text-green-800",children:"Positive"});case"negative":return e.jsx(re,{className:"bg-red-100 text-red-800",children:"Negative"});default:return e.jsx(re,{className:"bg-gray-100 text-gray-800",children:"Neutral"})}};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading clients..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-6 w-6"}),e.jsx("span",{children:"Client Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Manage your client relationships and track interactions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:V,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:()=>l(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Qt,{className:"h-4 w-4 mr-2"}),"Add Client"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:L.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Clients"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:L.active}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L.potential}),e.jsx("div",{className:"text-sm text-gray-600",children:"Potential"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:L.closed}),e.jsx("div",{className:"text-sm text-gray-600",children:"Closed"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:L.buyers}),e.jsx("div",{className:"text-sm text-gray-600",children:"Buyers"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:L.sellers}),e.jsx("div",{className:"text-sm text-gray-600",children:"Sellers"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:L.totalDeals}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Deals"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚¹",(L.totalCommission/1e3).toFixed(0),"K"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Commission"})]})})]}),e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search clients...",value:n,onChange:O=>o(O.target.value),className:"pl-10"})]}),e.jsxs("select",{value:f,onChange:O=>u(O.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"potential",children:"Potential"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs("select",{value:S,onChange:O=>x(O.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"buyer",children:"Buyers"}),e.jsx("option",{value:"seller",children:"Sellers"})]}),e.jsxs("select",{value:A,onChange:O=>d(O.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"lastContact",children:"Last Contact"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"rating",children:"Rating"}),e.jsx("option",{value:"deals",children:"Deals"})]})]})})}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{children:["Clients (",D().length,")"]})}),e.jsx(_,{children:D().length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ae,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:N.length===0?"No clients yet":"No clients match your filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:N.length===0?"Start building your client base by adding your first client":"Try adjusting your search criteria"}),N.length===0&&e.jsxs(g,{onClick:()=>l(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(Qt,{className:"h-4 w-4 mr-2"}),"Add Your First Client"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Client"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Contact"}),e.jsx(te,{children:"Budget"}),e.jsx(te,{children:"Deals"}),e.jsx(te,{children:"Last Contact"}),e.jsx(te,{children:"Rating"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:D().map(O=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:O.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:O.name}),e.jsx("div",{className:"text-sm text-gray-500",children:O.email})]})]})}),e.jsx(ee,{children:e.jsx(re,{variant:"outline",children:O.userType.charAt(0).toUpperCase()+O.userType.slice(1)})}),e.jsx(ee,{children:R(O.status)}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(Ge,{className:"h-3 w-3"}),e.jsx("span",{children:O.phone})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(ms,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[120px]",children:O.email})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm",children:["â‚¹",O.budget.min.toLocaleString()," - â‚¹",O.budget.max.toLocaleString()]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(zt,{className:"h-3 w-3"}),e.jsx("span",{children:O.deals.length})]})}),e.jsx(ee,{children:e.jsx("div",{className:"text-sm text-gray-500",children:new Date(O.lastContact).toLocaleDateString()})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ns,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.jsx("span",{children:O.rating.toFixed(1)})]})}),e.jsx(ee,{children:e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ba,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsxs(ss,{onClick:()=>{j(O),T(!0)},children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(ss,{onClick:()=>{j(O),P(!0)},children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Add Interaction"]}),e.jsxs(ss,{children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Call Client"]}),e.jsxs(ss,{children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Send Email"]}),e.jsxs(ss,{onClick:()=>I(O._id),className:"text-red-600",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete Client"]})]})]})})]},O._id))})]})})})]}),e.jsx(Re,{open:m,onOpenChange:l,children:e.jsxs(Ee,{className:"max-w-2xl",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add New Client"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Full Name"}),e.jsx(Q,{value:k.name,onChange:O=>h(ae=>({...ae,name:O.target.value})),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsx(Q,{type:"email",value:k.email,onChange:O=>h(ae=>({...ae,email:O.target.value})),placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Phone"}),e.jsx(Q,{value:k.phone,onChange:O=>h(ae=>({...ae,phone:O.target.value})),placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Client Type"}),e.jsxs(ue,{value:k.userType,onValueChange:O=>h(ae=>({...ae,userType:O})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"buyer",children:"Buyer"}),e.jsx(G,{value:"seller",children:"Seller"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Min Budget"}),e.jsx(Q,{type:"number",value:k.budget.min,onChange:O=>h(ae=>({...ae,budget:{...ae.budget,min:parseInt(O.target.value)||0}})),placeholder:"Minimum budget"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Max Budget"}),e.jsx(Q,{type:"number",value:k.budget.max,onChange:O=>h(ae=>({...ae,budget:{...ae.budget,max:parseInt(O.target.value)||0}})),placeholder:"Maximum budget"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Source"}),e.jsxs(ue,{value:k.source,onValueChange:O=>h(ae=>({...ae,source:O})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"direct",children:"Direct"}),e.jsx(G,{value:"referral",children:"Referral"}),e.jsx(G,{value:"website",children:"Website"}),e.jsx(G,{value:"social",children:"Social Media"}),e.jsx(G,{value:"advertisement",children:"Advertisement"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx($e,{value:k.notes,onChange:O=>h(ae=>({...ae,notes:O.target.value})),placeholder:"Add any notes about the client...",rows:3})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:i,className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:"Add Client"}),e.jsx(g,{onClick:()=>l(!1),variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}),e.jsx(Re,{open:b,onOpenChange:T,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Client Details"})}),v&&e.jsxs(Ls,{defaultValue:"overview",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-4",children:[e.jsx(Se,{value:"overview",children:"Overview"}),e.jsx(Se,{value:"interactions",children:"Interactions"}),e.jsx(Se,{value:"deals",children:"Deals"}),e.jsx(Se,{value:"preferences",children:"Preferences"})]}),e.jsxs(ke,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Contact Information"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:v.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-4 w-4"}),e.jsx("span",{children:v.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:v.phone})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Client Details"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Type:"}),e.jsx(re,{variant:"outline",children:v.userType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),R(v.status)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rating:"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ns,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.jsx("span",{children:v.rating.toFixed(1)})]})]})]})]})]}),v.notes&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Notes"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm text-gray-600",children:v.notes})})]})]}),e.jsxs(ke,{value:"interactions",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Recent Interactions"}),e.jsxs(g,{onClick:()=>P(!0),size:"sm",className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Interaction"]})]}),e.jsx("div",{className:"space-y-3",children:(J=v.interactions)==null?void 0:J.map(O=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[M(O.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium capitalize",children:O.type}),W(O.outcome)]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.description}),O.nextAction&&e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Next: ",O.nextAction]})]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(O.date).toLocaleDateString()})]})})},O._id))})]}),e.jsxs(ke,{value:"deals",className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Active Deals"}),((H=v.deals)==null?void 0:H.length)===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No deals yet"}):e.jsx("div",{className:"space-y-3",children:(se=v.deals)==null?void 0:se.map(O=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:O.propertyTitle}),e.jsx("p",{className:"text-sm text-gray-500",children:O.type}),e.jsxs("p",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",O.amount.toLocaleString()]})]}),e.jsx(re,{children:O.status})]})})},O._id))})]}),e.jsxs(ke,{value:"preferences",className:"space-y-4",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Budget Range"})}),e.jsx(_,{children:e.jsxs("p",{className:"text-lg font-bold text-[#C70000]",children:["â‚¹",v.budget.min.toLocaleString()," - â‚¹",v.budget.max.toLocaleString()]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Preferred Locations"})}),e.jsx(_,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:($=(B=v.preferences)==null?void 0:B.locations)==null?void 0:$.map((O,ae)=>e.jsx(re,{variant:"outline",children:O},ae))})})]})]})]})]})}),e.jsx(Re,{open:C,onOpenChange:P,children:e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add Interaction"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Interaction Type"}),e.jsxs(ue,{value:w.type,onValueChange:O=>E(ae=>({...ae,type:O})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"call",children:"Phone Call"}),e.jsx(G,{value:"email",children:"Email"}),e.jsx(G,{value:"meeting",children:"Meeting"}),e.jsx(G,{value:"message",children:"Message"}),e.jsx(G,{value:"visit",children:"Property Visit"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx($e,{value:w.description,onChange:O=>E(ae=>({...ae,description:O.target.value})),placeholder:"Describe the interaction...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Outcome"}),e.jsxs(ue,{value:w.outcome,onValueChange:O=>E(ae=>({...ae,outcome:O})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"positive",children:"Positive"}),e.jsx(G,{value:"neutral",children:"Neutral"}),e.jsx(G,{value:"negative",children:"Negative"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Next Action"}),e.jsx(Q,{value:w.nextAction,onChange:O=>E(ae=>({...ae,nextAction:O.target.value})),placeholder:"What's the next step?"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:F,className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:"Add Interaction"}),e.jsx(g,{onClick:()=>P(!1),variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})})]}),e.jsx(ve,{})]})}function Zr(){const{user:s}=je(),t=Ve(),[r,c]=a.useState(!0),[N,y]=a.useState([]),[n,o]=a.useState([]),[f,u]=a.useState(""),[S,x]=a.useState("newest"),[A,d]=a.useState("all"),[v,j]=a.useState("grid"),[m,l]=a.useState("properties"),[b,T]=a.useState({totalFavorites:0,recentlyAdded:0,priceDropped:0,avgPrice:0,totalSavedSearches:0});a.useEffect(()=>{if(!s){t("/login");return}C(),P()},[s,t]);const C=async()=>{try{c(!0);const p=localStorage.getItem("token");if(!p)return;const i=await ce.get("/user/favorites",p);if(i.data.success){const F=i.data.data;y(F),k(F)}}catch(p){console.error("Error fetching favorites:",p)}finally{c(!1)}},P=async()=>{try{const p=localStorage.getItem("token");if(!p)return;const i=await ce.get("/user/saved-searches",p);i.data.success&&o(i.data.data)}catch(p){console.error("Error fetching saved searches:",p)}},k=p=>{const i=new Date,F=new Date(i.getTime()-10080*60*1e3),I=p.filter(M=>new Date(M.savedAt)>F).length,D=p.filter(M=>M.priceHistory&&M.priceHistory.length>1&&M.priceHistory[M.priceHistory.length-1].price<M.priceHistory[0].price).length,R=p.length>0?p.reduce((M,W)=>M+W.price,0)/p.length:0;T({totalFavorites:p.length,recentlyAdded:I,priceDropped:D,avgPrice:R,totalSavedSearches:n.length})},h=async p=>{try{const i=localStorage.getItem("token");if(!i)return;await ce.delete(`/user/favorites/${p}`,i),C()}catch(i){console.error("Error removing from favorites:",i)}},w=p=>{if(navigator.share)navigator.share({title:p.title,text:p.description,url:`${window.location.origin}/property/${p._id}`});else{const i=`${window.location.origin}/property/${p._id}`;navigator.clipboard.writeText(i)}},E=async p=>{try{const i=localStorage.getItem("token");if(!i)return;(await ce.post(`/user/saved-searches/${p}/run`,{},i)).data.success&&t(`/search?saved=${p}`)}catch(i){console.error("Error running saved search:",i)}},L=async p=>{try{const i=localStorage.getItem("token");if(!i)return;await ce.delete(`/user/saved-searches/${p}`,i),P()}catch(i){console.error("Error deleting saved search:",i)}},q=()=>{let p=N;switch(f&&(p=p.filter(i=>i.title.toLowerCase().includes(f.toLowerCase())||i.location.address.toLowerCase().includes(f.toLowerCase())||i.description.toLowerCase().includes(f.toLowerCase()))),A){case"sale":p=p.filter(F=>F.priceType==="sale");break;case"rent":p=p.filter(F=>F.priceType==="rent");break;case"priceDropped":p=p.filter(F=>F.priceHistory&&F.priceHistory.length>1&&F.priceHistory[F.priceHistory.length-1].price<F.priceHistory[0].price);break;case"new":const i=new Date(Date.now()-10080*60*1e3);p=p.filter(F=>new Date(F.savedAt)>i);break}return p.sort((i,F)=>{switch(S){case"newest":return new Date(F.savedAt).getTime()-new Date(i.savedAt).getTime();case"oldest":return new Date(i.savedAt).getTime()-new Date(F.savedAt).getTime();case"price":return F.price-i.price;case"priceChange":const I=i.priceHistory&&i.priceHistory.length>1?i.priceHistory[i.priceHistory.length-1].price-i.priceHistory[0].price:0;return(F.priceHistory&&F.priceHistory.length>1?F.priceHistory[F.priceHistory.length-1].price-F.priceHistory[0].price:0)-I;default:return 0}}),p},V=p=>{if(!p.priceHistory||p.priceHistory.length<2)return null;const i=p.priceHistory[p.priceHistory.length-1].price,F=p.priceHistory[0].price,I=i-F,D=(I/F*100).toFixed(1);return I>0?e.jsxs("div",{className:"flex items-center space-x-1 text-red-600",children:[e.jsx($s,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs",children:["+",D,"%"]})]}):I<0?e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[e.jsx(vc,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs",children:[D,"%"]})]}):e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(li,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"0%"})]})};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your favorites..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(xs,{className:"h-6 w-6 text-red-500"}),e.jsx("span",{children:"My Favorites"})]}),e.jsx("p",{className:"text-gray-600",children:"Your saved properties and searches"})]}),e.jsxs(g,{onClick:C,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:b.totalFavorites}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Favorites"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.recentlyAdded}),e.jsx("div",{className:"text-sm text-gray-600",children:"Recent"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.priceDropped}),e.jsx("div",{className:"text-sm text-gray-600",children:"Price Dropped"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["â‚¹",(b.avgPrice/1e5).toFixed(1),"L"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Price"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:b.totalSavedSearches}),e.jsx("div",{className:"text-sm text-gray-600",children:"Saved Searches"})]})})]}),e.jsxs(Ls,{value:m,onValueChange:l,children:[e.jsxs(As,{className:"mb-6",children:[e.jsx(Se,{value:"properties",children:"Favorite Properties"}),e.jsx(Se,{value:"searches",children:"Saved Searches"})]}),e.jsxs(ke,{value:"properties",children:[e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search favorites...",value:f,onChange:p=>u(p.target.value),className:"pl-10"})]}),e.jsxs("select",{value:A,onChange:p=>d(p.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Properties"}),e.jsx("option",{value:"sale",children:"For Sale"}),e.jsx("option",{value:"rent",children:"For Rent"}),e.jsx("option",{value:"priceDropped",children:"Price Dropped"}),e.jsx("option",{value:"new",children:"Recently Added"})]}),e.jsxs("select",{value:S,onChange:p=>x(p.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"price",children:"Price High to Low"}),e.jsx("option",{value:"priceChange",children:"Price Change"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{variant:v==="grid"?"default":"outline",size:"sm",onClick:()=>j("grid"),children:e.jsx(Lt,{className:"h-4 w-4"})}),e.jsx(g,{variant:v==="list"?"default":"outline",size:"sm",onClick:()=>j("list"),children:e.jsx(Ks,{className:"h-4 w-4"})})]})]})})}),q().length===0?e.jsx(U,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(xs,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:N.length===0?"No favorites yet":"No properties match your filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:N.length===0?"Start browsing properties and save your favorites":"Try adjusting your search criteria"}),N.length===0&&e.jsx(be,{to:"/properties",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Browse Properties"]})})]})}):v==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q().map(p=>e.jsxs(U,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video w-full bg-gray-200 rounded-t-lg overflow-hidden",children:p.images&&p.images.length>0?e.jsx("img",{"data-wm":"1",src:p.images[0],alt:p.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-12 w-12 text-gray-400"})})}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[p.isPremium&&e.jsxs(re,{className:"bg-amber-500 text-white",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),"Premium"]}),V(p)]})]}),e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:p.title}),e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ba,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsx(ss,{asChild:!0,children:e.jsxs(be,{to:`/property/${p._id}`,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Property"]})}),e.jsxs(ss,{onClick:()=>w(p),children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs(qt,{children:[e.jsx(ga,{asChild:!0,children:e.jsxs(ss,{onSelect:i=>i.preventDefault(),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Remove"]})}),e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Remove from Favorites"}),e.jsxs(Tt,{children:['Are you sure you want to remove "',p.title,'" from your favorites?']})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:()=>h(p._id),className:"bg-red-600 hover:bg-red-700",children:"Remove"})]})]})]})]})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:p.description}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 text-sm mb-3",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:p.location.address})]}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"text-2xl font-bold text-[#C70000]",children:["â‚¹",p.price.toLocaleString(),p.priceType==="rent"&&"/month"]})}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[p.bedrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-3 w-3"}),e.jsx("span",{children:p.bedrooms})]}),p.bathrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Jt,{className:"h-3 w-3"}),e.jsx("span",{children:p.bathrooms})]}),p.area&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fa,{className:"h-3 w-3"}),e.jsxs("span",{children:[p.area," sq ft"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(xs,{className:"h-3 w-3 text-red-500"}),e.jsxs("span",{children:["Saved"," ",new Date(p.savedAt).toLocaleDateString()]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{children:[p.views," views"]})})]}),p.notes&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:p.notes})})]})]},p._id))}):e.jsx("div",{className:"space-y-4",children:q().map(p=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-32 h-24 bg-gray-200 rounded overflow-hidden flex-shrink-0",children:p.images&&p.images.length>0?e.jsx("img",{"data-wm":"1",src:p.images[0],alt:p.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:p.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:p.description}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 text-sm mb-2",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:p.location.address})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-[#C70000]",children:["â‚¹",p.price.toLocaleString(),p.priceType==="rent"&&"/month"]}),V(p)]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[p.bedrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-3 w-3"}),e.jsxs("span",{children:[p.bedrooms," beds"]})]}),p.bathrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Jt,{className:"h-3 w-3"}),e.jsxs("span",{children:[p.bathrooms," baths"]})]}),p.area&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fa,{className:"h-3 w-3"}),e.jsxs("span",{children:[p.area," sq ft"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(be,{to:`/property/${p._id}`,children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),"View"]})}),e.jsxs(g,{onClick:()=>w(p),variant:"outline",size:"sm",children:[e.jsx(Yt,{className:"h-3 w-3 mr-1"}),"Share"]}),e.jsxs(qt,{children:[e.jsx(ga,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"Remove"]})}),e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Remove from Favorites"}),e.jsxs(Tt,{children:['Are you sure you want to remove "',p.title,'" from your favorites?']})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:()=>h(p._id),className:"bg-red-600 hover:bg-red-700",children:"Remove"})]})]})]})]})]})]})]})})},p._id))})]}),e.jsx(ke,{value:"searches",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Saved Searches"})}),e.jsx(_,{children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ts,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No saved searches yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Save your searches to get notified of new matches"})]}):e.jsx("div",{className:"space-y-4",children:n.map(p=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:p.name}),e.jsx("p",{className:"text-sm text-gray-500",children:p.query}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400 mt-1",children:[e.jsxs("span",{children:[p.matchCount," matches"]}),e.jsxs("span",{children:["Last run:"," ",new Date(p.lastRun).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:()=>E(p._id),variant:"outline",size:"sm",children:[e.jsx(ts,{className:"h-3 w-3 mr-1"}),"Run Search"]}),e.jsxs(qt,{children:[e.jsx(ga,{asChild:!0,children:e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(De,{className:"h-3 w-3"})})}),e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Delete Saved Search"}),e.jsxs(Tt,{children:['Are you sure you want to delete the saved search "',p.name,'"?']})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:()=>L(p._id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]})})},p._id))})})]})})]})]}),e.jsx(ve,{})]})}function Mm(){const[s,t]=a.useState([]),[r,c]=a.useState(!0);return a.useEffect(()=>{document.title="Blog | Ashish Properties",zm("description","Property tips, market updates, and project news."),rr("og:title","Blog | Ashish Properties"),rr("og:type","website"),rr("og:url",window.location.href)},[]),a.useEffect(()=>{(async()=>{var y;try{const o=await(await fetch("/api/blog")).json();o.success&&t(((y=o.data)==null?void 0:y.posts)??[])}catch{}finally{c(!1)}})()},[]),r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading blog..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("div",{className:"p-4 max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Blog"}),s.length===0?e.jsx("div",{className:"text-center text-gray-600 py-16",children:"No posts yet."}):e.jsx("div",{className:"space-y-4",children:s.map(N=>e.jsxs("a",{href:`/blog/${N.slug}`,className:"block bg-white rounded-lg p-4 shadow hover:shadow-md transition-shadow",children:[N.featuredImage&&e.jsx("img",{src:N.featuredImage,alt:N.title,loading:"lazy",decoding:"async",className:"w-full h-48 object-cover rounded mb-3"}),e.jsx("h2",{className:"text-xl font-semibold",children:N.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:N.excerpt}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[N.category||"General"," â€¢"," ",N.publishedAt?new Date(N.publishedAt).toLocaleDateString():""]})]},N.slug))})]}),e.jsx(ve,{})]})}function zm(s,t){let r=document.querySelector(`meta[name='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("name",s),document.head.appendChild(r)),r.setAttribute("content",t)}function rr(s,t){let r=document.querySelector(`meta[property='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("property",s),document.head.appendChild(r)),r.setAttribute("content",t)}function Bm(){const{slug:s}=zs(),[t,r]=a.useState(null),[c,N]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const o=await(await fetch(`/api/blog/${s}`)).json();o.success&&r(o.data)}catch{}finally{N(!1)}})()},[s]),a.useEffect(()=>{t&&(document.title=`${t.title} | Ashish Properties`,en("description",t.excerpt||t.title),ca("og:title",t.title),ca("og:description",t.excerpt||t.title),t.featuredImage&&ca("og:image",t.featuredImage),ca("og:type","article"),ca("og:url",window.location.href),t.publishedAt&&en("article:published_time",new Date(t.publishedAt).toISOString()))},[t]),c?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading post..."})]})}),e.jsx(ve,{})]}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("article",{className:"p-4 max-w-3xl mx-auto bg-white rounded-lg shadow mt-4",children:[t.featuredImage&&e.jsx("img",{src:t.featuredImage,alt:t.title,loading:"lazy",decoding:"async",className:"w-full h-64 object-cover rounded mb-4"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:t.title}),e.jsxs("div",{className:"text-sm text-gray-500 mb-6",children:[t.category||"General"," â€¢"," ",t.publishedAt?new Date(t.publishedAt).toLocaleDateString():""]}),e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:t.content}})]}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"p-4 max-w-3xl mx-auto",children:"Post not found."}),e.jsx(ve,{})]})}function en(s,t){let r=document.querySelector(`meta[name='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("name",s),document.head.appendChild(r)),r.setAttribute("content",t)}function ca(s,t){let r=document.querySelector(`meta[property='${s}']`);r||(r=document.createElement("meta"),r.setAttribute("property",s),document.head.appendChild(r)),r.setAttribute("content",t)}function Vm(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(""),n=async()=>{try{c(!0);const f=N?`?area=${encodeURIComponent(N)}`:"",u=await fetch(`/api/maps${f}`,{cache:"no-store"}),S=await u.json();if(!u.ok||(S==null?void 0:S.success)===!1)throw new Error((S==null?void 0:S.error)||"Failed to load maps");t(Array.isArray(S==null?void 0:S.data)?S.data:[])}catch{t([])}finally{c(!1)}};a.useEffect(()=>{n();const f=()=>n();return window.addEventListener("areaMapsUpdated",f),()=>window.removeEventListener("areaMapsUpdated",f)},[N]);const o=a.useMemo(()=>{const f=new Set;return s.forEach(u=>{u.area&&f.add(u.area)}),Array.from(f).sort((u,S)=>u.localeCompare(S))},[s]);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("main",{className:"p-4 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Maps"})}),o.length>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap mb-4",children:[e.jsx("button",{onClick:()=>y(""),className:`px-3 py-1.5 rounded-full text-sm border ${N===""?"bg-[#C70000] text-white border-[#C70000]":"bg-white text-gray-800 border-gray-200"}`,children:"All"}),o.map(f=>e.jsx("button",{onClick:()=>y(f),className:`px-3 py-1.5 rounded-full text-sm border ${N===f?"bg-[#C70000] text-white border-[#C70000]":"bg-white text-gray-800 border-gray-200"}`,children:f},f))]}),r&&e.jsx("div",{className:"text-center text-gray-600 py-10",children:"Loading maps..."}),!r&&s.length===0&&e.jsx("div",{className:"text-center text-gray-600 py-10",children:"No maps found."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(f=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("img",{src:f.imageUrl,alt:f.title||f.area||"map",className:"w-full h-56 object-cover"}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"text-sm text-gray-600",children:f.area||"â€”"}),e.jsx("div",{className:"font-semibold text-gray-900",children:f.title||"Map"}),f.description&&e.jsx("div",{className:"text-sm text-gray-700 mt-1 line-clamp-3",children:f.description})]})]},f._id))})]}),e.jsx(ve,{})]})}function qm(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=yn({loop:!0,skipSnaps:!1}),n=a.useCallback(async()=>{try{c(!0);const f=await(await fetch("/api/new-projects/banners",{cache:"no-store"})).json();if(f&&f.success){const u=(f.data||[]).filter(S=>S.isActive);t(u)}}catch(o){console.warn("Failed to load new project banners:",o)}finally{c(!1)}},[]);return a.useEffect(()=>{n();const o=()=>{n()};window.addEventListener("newProjectsUpdated",o);const f=setInterval(()=>{document.visibilityState==="visible"&&n()},15e3);return()=>{window.removeEventListener("newProjectsUpdated",o),clearInterval(f)}},[n]),a.useEffect(()=>{if(y)try{y.reInit()}catch{}},[s,y]),r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading new projects..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ke,{}),e.jsxs("main",{className:"p-4 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"New Projects"}),s.length>0?e.jsx("div",{className:"embla overflow-hidden rounded-lg",children:e.jsx("div",{className:"embla__viewport",ref:N,children:e.jsx("div",{className:"embla__container flex",children:s.map(o=>e.jsx("div",{className:"embla__slide min-w-full",children:e.jsx("a",{href:o.link,className:"block w-full",children:e.jsxs("div",{className:"relative w-full h-64 md:h-96 bg-gray-100 rounded-lg overflow-hidden",children:[e.jsx("img",{src:o.imageUrl,alt:o.title,className:"w-full h-full object-cover",loading:"lazy"}),e.jsxs("div",{className:"absolute left-4 bottom-4 bg-black bg-opacity-40 text-white p-3 rounded",children:[e.jsx("h3",{className:"text-lg font-semibold",children:o.title}),o.subtitle&&e.jsx("p",{className:"text-sm",children:o.subtitle})]})]})})},o._id))})})}):e.jsx("div",{className:"text-center py-12 text-gray-600",children:"No banners to display."}),e.jsx("section",{className:"mt-8",children:e.jsx("p",{className:"text-gray-700",children:"Explore upcoming and ongoing projects below."})})]}),e.jsx(ve,{})]})}function Hm(){const{user:s}=je(),t=Ve(),[r,c]=a.useState(!0),[N,y]=a.useState([]),[n,o]=a.useState([]),[f,u]=a.useState(""),[S,x]=a.useState("all"),[A,d]=a.useState("recent"),[v,j]=a.useState("list"),[m,l]=a.useState("properties"),[b,T]=a.useState({totalViews:0,uniqueProperties:0,avgTimeSpent:0,favoritesFromViews:0,todayViews:0,weekViews:0});a.useEffect(()=>{if(!s){t("/login");return}C(),P()},[s,t]);const C=async()=>{try{c(!0);const i=localStorage.getItem("token");if(!i)return;const F=await ce.get("/user/recent-views",i);if(F.data.success){const I=F.data.data;y(I),k(I)}}catch(i){console.error("Error fetching recent views:",i)}finally{c(!1)}},P=async()=>{try{const i=localStorage.getItem("token");if(!i)return;const F=await ce.get("/user/viewing-sessions",i);F.data.success&&o(F.data.data)}catch(i){console.error("Error fetching viewing sessions:",i)}},k=i=>{const F=new Date,I=new Date(F.getFullYear(),F.getMonth(),F.getDate()),D=new Date(F.getTime()-10080*60*1e3),R=i.filter(se=>new Date(se.viewedAt)>=I).length,M=i.filter(se=>new Date(se.viewedAt)>=D).length,W=i.reduce((se,B)=>se+B.timeSpent,0),J=i.length>0?W/i.length:0,H=i.filter(se=>se.isFavorited).length;T({totalViews:i.reduce((se,B)=>se+B.viewCount,0),uniqueProperties:i.length,avgTimeSpent:Math.round(J),favoritesFromViews:H,todayViews:R,weekViews:M})},h=async i=>{try{const F=localStorage.getItem("token");if(!F)return;await ce.post(`/user/favorites/${i}`,{},F),C()}catch(F){console.error("Error adding to favorites:",F)}},w=async i=>{try{const F=localStorage.getItem("token");if(!F)return;await ce.delete(`/user/recent-views/${i}`,F),C()}catch(F){console.error("Error removing from recent views:",F)}},E=async()=>{try{const i=localStorage.getItem("token");if(!i)return;await ce.delete("/user/recent-views",i),C()}catch(i){console.error("Error clearing recent views:",i)}},L=i=>{if(navigator.share)navigator.share({title:i.title,text:i.description,url:`${window.location.origin}/property/${i._id}`});else{const F=`${window.location.origin}/property/${i._id}`;navigator.clipboard.writeText(F)}},q=()=>{let i=N;f&&(i=i.filter(I=>I.title.toLowerCase().includes(f.toLowerCase())||I.location.address.toLowerCase().includes(f.toLowerCase())||I.description.toLowerCase().includes(f.toLowerCase())));const F=new Date;switch(S){case"today":const I=new Date(F.getFullYear(),F.getMonth(),F.getDate());i=i.filter(M=>new Date(M.viewedAt)>=I);break;case"week":const D=new Date(F.getTime()-10080*60*1e3);i=i.filter(M=>new Date(M.viewedAt)>=D);break;case"month":const R=new Date(F.getTime()-720*60*60*1e3);i=i.filter(M=>new Date(M.viewedAt)>=R);break}return i.sort((I,D)=>{switch(A){case"recent":return new Date(D.viewedAt).getTime()-new Date(I.viewedAt).getTime();case"timeSpent":return D.timeSpent-I.timeSpent;case"viewCount":return D.viewCount-I.viewCount;case"price":return D.price-I.price;default:return 0}}),i},V=i=>i<60?`${i}s`:i<3600?`${Math.floor(i/60)}m`:`${Math.floor(i/3600)}h ${Math.floor(i%3600/60)}m`,p=i=>{const F=new Date,I=new Date(i),D=F.getTime()-I.getTime(),R=Math.floor(D/(1e3*60)),M=Math.floor(D/(1e3*60*60)),W=Math.floor(D/(1e3*60*60*24));return R<60?`${R}m ago`:M<24?`${M}h ago`:`${W}d ago`};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your viewing history..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-6 w-6 text-blue-500"}),e.jsx("span",{children:"Recent Views"})]}),e.jsx("p",{className:"text-gray-600",children:"Your property viewing history and browsing patterns"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:C,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),N.length>0&&e.jsxs(qt,{children:[e.jsx(ga,{asChild:!0,children:e.jsxs(g,{variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Clear All"]})}),e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Clear All Recent Views"}),e.jsx(Tt,{children:"Are you sure you want to clear your entire viewing history? This action cannot be undone."})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:E,className:"bg-red-600 hover:bg-red-700",children:"Clear All"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:b.totalViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Views"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b.uniqueProperties}),e.jsx("div",{className:"text-sm text-gray-600",children:"Properties"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:V(b.avgTimeSpent)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Time"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b.favoritesFromViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"Favorited"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:b.todayViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"Today"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:b.weekViews}),e.jsx("div",{className:"text-sm text-gray-600",children:"This Week"})]})})]}),e.jsxs(Ls,{value:m,onValueChange:l,children:[e.jsxs(As,{className:"mb-6",children:[e.jsx(Se,{value:"properties",children:"Recent Properties"}),e.jsx(Se,{value:"sessions",children:"Viewing Sessions"})]}),e.jsxs(ke,{value:"properties",children:[e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search viewed properties...",value:f,onChange:i=>u(i.target.value),className:"pl-10"})]}),e.jsxs("select",{value:S,onChange:i=>x(i.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),e.jsxs("select",{value:A,onChange:i=>d(i.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"timeSpent",children:"Time Spent"}),e.jsx("option",{value:"viewCount",children:"View Count"}),e.jsx("option",{value:"price",children:"Price"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{variant:v==="grid"?"default":"outline",size:"sm",onClick:()=>j("grid"),children:e.jsx(Lt,{className:"h-4 w-4"})}),e.jsx(g,{variant:v==="list"?"default":"outline",size:"sm",onClick:()=>j("list"),children:e.jsx(Ks,{className:"h-4 w-4"})})]})]})})}),q().length===0?e.jsx(U,{children:e.jsxs(_,{className:"text-center py-12",children:[e.jsx(Ne,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:N.length===0?"No viewing history":"No properties match your filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:N.length===0?"Start browsing properties to build your viewing history":"Try adjusting your search criteria"}),N.length===0&&e.jsx(be,{to:"/properties",children:e.jsxs(g,{className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Browse Properties"]})})]})}):v==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q().map(i=>e.jsxs(U,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video w-full bg-gray-200 rounded-t-lg overflow-hidden",children:i.images&&i.images.length>0?e.jsx("img",{"data-wm":"1",src:i.images[0],alt:i.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-12 w-12 text-gray-400"})})}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[i.isPremium&&e.jsxs(re,{className:"bg-amber-500 text-white",children:[e.jsx(ns,{className:"h-3 w-3 mr-1"}),"Premium"]}),e.jsxs(re,{className:"bg-blue-500 text-white",children:[i.viewCount,"x viewed"]})]})]}),e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:i.title}),e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ba,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsx(ss,{asChild:!0,children:e.jsxs(be,{to:`/property/${i._id}`,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Property"]})}),!i.isFavorited&&e.jsxs(ss,{onClick:()=>h(i._id),children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Add to Favorites"]}),e.jsxs(ss,{onClick:()=>L(i),children:[e.jsx(Yt,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs(ss,{onClick:()=>w(i._id),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Remove from History"]})]})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 text-sm mb-3",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:i.location.address})]}),e.jsxs("div",{className:"text-2xl font-bold text-[#C70000] mb-3",children:["â‚¹",i.price.toLocaleString(),i.priceType==="rent"&&"/month"]}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[i.bedrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-3 w-3"}),e.jsx("span",{children:i.bedrooms})]}),i.bathrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Jt,{className:"h-3 w-3"}),e.jsx("span",{children:i.bathrooms})]}),i.area&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fa,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.area," sq ft"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(cs,{className:"h-3 w-3"}),e.jsx("span",{children:p(i.viewedAt)})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{children:["Spent ",V(i.timeSpent)]})})]}),i.isFavorited&&e.jsx("div",{className:"mt-2",children:e.jsxs(re,{className:"bg-red-100 text-red-800",children:[e.jsx(xs,{className:"h-3 w-3 mr-1 fill-current"}),"Favorited"]})})]})]},i._id))}):e.jsx("div",{className:"space-y-4",children:q().map(i=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-32 h-24 bg-gray-200 rounded overflow-hidden flex-shrink-0",children:i.images&&i.images.length>0?e.jsx("img",{"data-wm":"1",src:i.images[0],alt:i.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Pe,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:i.title}),i.isFavorited&&e.jsx(xs,{className:"h-4 w-4 text-red-500 fill-current"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:i.description}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 text-sm mb-2",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:i.location.address})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[i.bedrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Gt,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.bedrooms," beds"]})]}),i.bathrooms&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Jt,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.bathrooms," baths"]})]}),i.area&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(fa,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.area," sq ft"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-[#C70000] mb-2",children:["â‚¹",i.price.toLocaleString(),i.priceType==="rent"&&"/month"]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.viewCount,"x viewed"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(cs,{className:"h-3 w-3"}),e.jsx("span",{children:V(i.timeSpent)})]}),e.jsx("div",{className:"text-xs",children:p(i.viewedAt)})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(be,{to:`/property/${i._id}`,children:[e.jsx(Ne,{className:"h-3 w-3 mr-1"}),"View Again"]})}),!i.isFavorited&&e.jsxs(g,{onClick:()=>h(i._id),variant:"outline",size:"sm",children:[e.jsx(xs,{className:"h-3 w-3 mr-1"}),"Add to Favorites"]}),e.jsxs(g,{onClick:()=>L(i),variant:"outline",size:"sm",children:[e.jsx(Yt,{className:"h-3 w-3 mr-1"}),"Share"]})]}),e.jsxs(g,{onClick:()=>w(i._id),variant:"outline",size:"sm",children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"Remove"]})]})]})]})})},i._id))})]}),e.jsx(ke,{value:"sessions",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Viewing Sessions"})}),e.jsx(_,{children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Nc,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No viewing sessions yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Your browsing sessions will appear here"})]}):e.jsx("div",{className:"space-y-4",children:n.map(i=>e.jsx(U,{children:e.jsxs(_,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:new Date(i.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[i.properties.length," properties viewed"]}),e.jsxs("span",{children:[V(i.totalTimeSpent)," ","total time"]})]}),i.searchQuery&&e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:['Searched: "',i.searchQuery,'"']})]}),e.jsx(gt,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:e.jsxs("span",{children:["Session from"," ",new Date(i.date).toLocaleTimeString()]})})]})},i._id))})})]})})]})]}),e.jsx(ve,{})]})}function Gm(){var le;const{user:s}=je(),t=Ve(),[r,c]=a.useState(!0),[N,y]=a.useState([]),[n,o]=a.useState([]),[f,u]=a.useState(""),[S,x]=a.useState("all"),[A,d]=a.useState("all"),[v,j]=a.useState("all"),[m,l]=a.useState("score"),[b,T]=a.useState(null),[C,P]=a.useState(!1),[k,h]=a.useState(!1),[w,E]=a.useState(!1),[L,q]=a.useState({name:"",email:"",phone:"",source:"website",propertyInterest:{type:"buy",priceRange:{min:0,max:0},locations:[],urgency:"medium"},notes:""}),[V,p]=a.useState({type:"call",description:"",outcome:"neutral",nextAction:"",scoreChange:0}),[i,F]=a.useState({totalLeads:0,newLeads:0,hotLeads:0,converted:0,avgScore:0,conversionRate:0,totalValue:0,thisWeekContacts:0});a.useEffect(()=>{if(!s){t("/login");return}if(s.userType!=="agent"){t("/user-dashboard");return}I(),D()},[s,t]);const I=async()=>{try{c(!0);const Z=localStorage.getItem("token");if(!Z)return;const ne=await ce.get("/agent/leads",Z);if(ne.data.success){const ye=ne.data.data;y(ye),R(ye)}}catch(Z){console.error("Error fetching leads:",Z)}finally{c(!1)}},D=async()=>{try{const Z=localStorage.getItem("token");if(!Z)return;const ne=await ce.get("/agent/lead-sources",Z);ne.data.success&&o(ne.data.data)}catch(Z){console.error("Error fetching lead sources:",Z)}},R=Z=>{const ne=new Date,ye=new Date(ne.getTime()-10080*60*1e3),ie=Z.filter(Ye=>Ye.status==="new").length,fe=Z.filter(Ye=>Ye.score>=80).length,_e=Z.filter(Ye=>Ye.convertedToClient).length,Te=Z.length>0?Z.reduce((Ye,us)=>Ye+us.score,0)/Z.length:0,qe=Z.length>0?_e/Z.length*100:0,os=Z.reduce((Ye,us)=>Ye+us.estimatedValue,0),Gs=Z.filter(Ye=>new Date(Ye.lastContact)>=ye).length;F({totalLeads:Z.length,newLeads:ie,hotLeads:fe,converted:_e,avgScore:Math.round(Te),conversionRate:Math.round(qe),totalValue:os,thisWeekContacts:Gs})},M=async()=>{try{const Z=localStorage.getItem("token");if(!Z)return;(await ce.post("/agent/leads",L,Z)).data.success&&(I(),P(!1),q({name:"",email:"",phone:"",source:"website",propertyInterest:{type:"buy",priceRange:{min:0,max:0},locations:[],urgency:"medium"},notes:""}))}catch(Z){console.error("Error adding lead:",Z)}},W=async(Z,ne)=>{try{const ye=localStorage.getItem("token");if(!ye)return;await ce.put(`/agent/leads/${Z}/score`,{scoreChange:ne},ye),I()}catch(ye){console.error("Error updating lead score:",ye)}},J=async Z=>{try{const ne=localStorage.getItem("token");if(!ne)return;await ce.post(`/agent/leads/${Z}/convert`,{},ne),I()}catch(ne){console.error("Error converting lead to client:",ne)}},H=async()=>{if(b)try{const Z=localStorage.getItem("token");if(!Z)return;(await ce.post(`/agent/leads/${b._id}/interactions`,V,Z)).data.success&&(I(),E(!1),p({type:"call",description:"",outcome:"neutral",nextAction:"",scoreChange:0}))}catch(Z){console.error("Error adding interaction:",Z)}},se=async Z=>{if(confirm("Are you sure you want to delete this lead?"))try{const ne=localStorage.getItem("token");if(!ne)return;await ce.delete(`/agent/leads/${Z}`,ne),I()}catch(ne){console.error("Error deleting lead:",ne)}},B=()=>{let Z=N;switch(f&&(Z=Z.filter(ne=>ne.name.toLowerCase().includes(f.toLowerCase())||ne.email.toLowerCase().includes(f.toLowerCase())||ne.phone.includes(f))),S!=="all"&&(Z=Z.filter(ne=>ne.status===S)),A!=="all"&&(Z=Z.filter(ne=>ne.source===A)),v){case"hot":Z=Z.filter(ne=>ne.score>=80);break;case"warm":Z=Z.filter(ne=>ne.score>=50&&ne.score<80);break;case"cold":Z=Z.filter(ne=>ne.score<50);break}return Z.sort((ne,ye)=>{switch(m){case"score":return ye.score-ne.score;case"lastContact":return new Date(ye.lastContact).getTime()-new Date(ne.lastContact).getTime();case"nextFollowup":return new Date(ne.nextFollowup).getTime()-new Date(ye.nextFollowup).getTime();case"probability":return ye.probability-ne.probability;default:return 0}}),Z},$=Z=>{const ne={new:{color:"bg-blue-100 text-blue-800",label:"New"},contacted:{color:"bg-yellow-100 text-yellow-800",label:"Contacted"},qualified:{color:"bg-purple-100 text-purple-800",label:"Qualified"},proposal:{color:"bg-orange-100 text-orange-800",label:"Proposal"},negotiation:{color:"bg-indigo-100 text-indigo-800",label:"Negotiation"},closed:{color:"bg-green-100 text-green-800",label:"Closed"},lost:{color:"bg-red-100 text-red-800",label:"Lost"}},ye=ne[Z]||ne.new;return e.jsx(re,{className:ye.color,children:ye.label})},O=Z=>Z>=80?e.jsx(re,{className:"bg-red-100 text-red-800",children:"ðŸ”¥ Hot"}):Z>=50?e.jsx(re,{className:"bg-orange-100 text-orange-800",children:"ðŸŒŸ Warm"}):e.jsx(re,{className:"bg-blue-100 text-blue-800",children:"â„ï¸ Cold"}),ae=Z=>{const ne={high:{color:"bg-red-100 text-red-800",label:"High"},medium:{color:"bg-yellow-100 text-yellow-800",label:"Medium"},low:{color:"bg-green-100 text-green-800",label:"Low"}},ye=ne[Z]||ne.medium;return e.jsx(re,{className:ye.color,children:ye.label})},X=Z=>{switch(Z){case"call":return e.jsx(Ge,{className:"h-4 w-4"});case"email":return e.jsx(ms,{className:"h-4 w-4"});case"meeting":return e.jsx(Ae,{className:"h-4 w-4"});case"message":return e.jsx(Ce,{className:"h-4 w-4"});case"visit":return e.jsx(Pe,{className:"h-4 w-4"});default:return e.jsx(ut,{className:"h-4 w-4"})}},z=Z=>Z>0?e.jsx(bc,{className:"h-3 w-3 text-green-600"}):Z<0?e.jsx(yc,{className:"h-3 w-3 text-red-600"}):e.jsx(li,{className:"h-3 w-3 text-gray-400"});return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading leads..."})]})}),e.jsx(ve,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(zt,{className:"h-6 w-6"}),e.jsx("span",{children:"Lead Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Track and nurture your potential clients"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{onClick:I,variant:"outline",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(g,{onClick:()=>P(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Lead"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6",children:[e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:i.totalLeads}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Leads"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.newLeads}),e.jsx("div",{className:"text-sm text-gray-600",children:"New"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.hotLeads}),e.jsx("div",{className:"text-sm text-gray-600",children:"Hot Leads"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.converted}),e.jsx("div",{className:"text-sm text-gray-600",children:"Converted"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.avgScore}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Score"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[i.conversionRate,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Conversion"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:["ï¿½ï¿½",(i.totalValue/1e5).toFixed(1),"L"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Value"})]})}),e.jsx(U,{children:e.jsxs(_,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-teal-600",children:i.thisWeekContacts}),e.jsx("div",{className:"text-sm text-gray-600",children:"This Week"})]})})]}),e.jsx(U,{className:"mb-6",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ts,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{placeholder:"Search leads...",value:f,onChange:Z=>u(Z.target.value),className:"pl-10"})]}),e.jsxs("select",{value:S,onChange:Z=>x(Z.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"qualified",children:"Qualified"}),e.jsx("option",{value:"proposal",children:"Proposal"}),e.jsx("option",{value:"negotiation",children:"Negotiation"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"lost",children:"Lost"})]}),e.jsxs("select",{value:A,onChange:Z=>d(Z.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Sources"}),e.jsx("option",{value:"website",children:"Website"}),e.jsx("option",{value:"referral",children:"Referral"}),e.jsx("option",{value:"social",children:"Social Media"}),e.jsx("option",{value:"advertisement",children:"Advertisement"}),e.jsx("option",{value:"coldcall",children:"Cold Call"}),e.jsx("option",{value:"event",children:"Event"})]}),e.jsxs("select",{value:v,onChange:Z=>j(Z.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"all",children:"All Scores"}),e.jsx("option",{value:"hot",children:"Hot (80+)"}),e.jsx("option",{value:"warm",children:"Warm (50-79)"}),e.jsx("option",{value:"cold",children:"Cold (<50)"})]}),e.jsxs("select",{value:m,onChange:Z=>l(Z.target.value),className:"px-3 py-2 border border-gray-200 rounded-md",children:[e.jsx("option",{value:"score",children:"Score"}),e.jsx("option",{value:"lastContact",children:"Last Contact"}),e.jsx("option",{value:"nextFollowup",children:"Next Followup"}),e.jsx("option",{value:"probability",children:"Probability"})]})]})})}),e.jsxs(Ls,{defaultValue:"leads",className:"w-full",children:[e.jsxs(As,{className:"mb-6",children:[e.jsx(Se,{value:"leads",children:"Leads"}),e.jsx(Se,{value:"sources",children:"Sources"}),e.jsx(Se,{value:"pipeline",children:"Pipeline"})]}),e.jsx(ke,{value:"leads",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{children:["Leads (",B().length,")"]})}),e.jsx(_,{children:B().length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(zt,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:N.length===0?"No leads yet":"No leads match your filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:N.length===0?"Start building your lead pipeline":"Try adjusting your search criteria"}),N.length===0&&e.jsxs(g,{onClick:()=>P(!0),className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Your First Lead"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(de,{children:[e.jsx(te,{children:"Lead"}),e.jsx(te,{children:"Score"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Interest"}),e.jsx(te,{children:"Budget"}),e.jsx(te,{children:"Last Contact"}),e.jsx(te,{children:"Next Followup"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(es,{children:B().map(Z=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#C70000] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:Z.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:Z.name}),e.jsx("div",{className:"text-sm text-gray-500",children:Z.email}),e.jsx("div",{className:"text-sm text-gray-500",children:Z.phone})]})]})}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-lg font-bold",children:Z.score}),O(Z.score)]})}),e.jsx(ee,{children:$(Z.status)}),e.jsx(ee,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(re,{variant:"outline",children:Z.propertyInterest.type.toUpperCase()}),ae(Z.propertyInterest.urgency)]})}),e.jsx(ee,{children:e.jsxs("div",{className:"text-sm",children:["â‚¹",Z.propertyInterest.priceRange.min.toLocaleString()," ","- â‚¹",Z.propertyInterest.priceRange.max.toLocaleString()]})}),e.jsx(ee,{children:e.jsx("div",{className:"text-sm text-gray-500",children:new Date(Z.lastContact).toLocaleDateString()})}),e.jsx(ee,{children:e.jsx("div",{className:"text-sm text-gray-500",children:new Date(Z.nextFollowup).toLocaleDateString()})}),e.jsx(ee,{children:e.jsxs(sa,{children:[e.jsx(ta,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(ba,{className:"h-4 w-4"})})}),e.jsxs($t,{align:"end",children:[e.jsxs(ss,{onClick:()=>{T(Z),h(!0)},children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(ss,{onClick:()=>{T(Z),E(!0)},children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Add Interaction"]}),e.jsxs(ss,{children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Call Lead"]}),e.jsxs(ss,{children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Send Email"]}),!Z.convertedToClient&&e.jsxs(ss,{onClick:()=>J(Z._id),children:[e.jsx(Qt,{className:"h-4 w-4 mr-2"}),"Convert to Client"]}),e.jsxs(ss,{onClick:()=>se(Z._id),className:"text-red-600",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Delete Lead"]})]})]})})]},Z._id))})]})})})]})}),e.jsx(ke,{value:"sources",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Lead Sources Performance"})}),e.jsx(_,{children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($s,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No lead source data available"})]}):e.jsx("div",{className:"space-y-4",children:n.map((Z,ne)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium capitalize",children:Z.source}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[Z.count," leads"]}),e.jsxs("span",{children:[Z.conversionRate.toFixed(1),"% conversion"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-[#C70000]",children:["â‚¹",Z.avgValue.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg Value"})]})]},ne))})})]})}),e.jsx(ke,{value:"pipeline",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-center",children:"Pipeline Overview"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"New"}),e.jsx(re,{children:N.filter(Z=>Z.status==="new").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Qualified"}),e.jsx(re,{children:N.filter(Z=>Z.status==="qualified").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Proposal"}),e.jsx(re,{children:N.filter(Z=>Z.status==="proposal").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Negotiation"}),e.jsx(re,{children:N.filter(Z=>Z.status==="negotiation").length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Closed"}),e.jsx(re,{className:"bg-green-100 text-green-800",children:N.filter(Z=>Z.status==="closed").length})]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-center",children:"This Month"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#C70000]",children:N.filter(Z=>new Date(Z.assignedDate).getMonth()===new Date().getMonth()).length}),e.jsx("div",{className:"text-sm text-gray-500",children:"New Leads"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N.filter(Z=>Z.convertedToClient&&Z.conversionDate&&new Date(Z.conversionDate).getMonth()===new Date().getMonth()).length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Conversions"})]})]})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-center",children:"Performance"})}),e.jsx(_,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.avgScore}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg Lead Score"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[i.conversionRate,"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Conversion Rate"})]})]})})]})]})})]}),e.jsx(Re,{open:C,onOpenChange:P,children:e.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add New Lead"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Full Name"}),e.jsx(Q,{value:L.name,onChange:Z=>q(ne=>({...ne,name:Z.target.value})),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsx(Q,{type:"email",value:L.email,onChange:Z=>q(ne=>({...ne,email:Z.target.value})),placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Phone"}),e.jsx(Q,{value:L.phone,onChange:Z=>q(ne=>({...ne,phone:Z.target.value})),placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Source"}),e.jsxs(ue,{value:L.source,onValueChange:Z=>q(ne=>({...ne,source:Z})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"website",children:"Website"}),e.jsx(G,{value:"referral",children:"Referral"}),e.jsx(G,{value:"social",children:"Social Media"}),e.jsx(G,{value:"advertisement",children:"Advertisement"}),e.jsx(G,{value:"coldcall",children:"Cold Call"}),e.jsx(G,{value:"event",children:"Event"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Interest Type"}),e.jsxs(ue,{value:L.propertyInterest.type,onValueChange:Z=>q(ne=>({...ne,propertyInterest:{...ne.propertyInterest,type:Z}})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"buy",children:"Buy"}),e.jsx(G,{value:"sell",children:"Sell"}),e.jsx(G,{value:"rent",children:"Rent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Urgency"}),e.jsxs(ue,{value:L.propertyInterest.urgency,onValueChange:Z=>q(ne=>({...ne,propertyInterest:{...ne.propertyInterest,urgency:Z}})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"high",children:"High"}),e.jsx(G,{value:"medium",children:"Medium"}),e.jsx(G,{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Min Budget"}),e.jsx(Q,{type:"number",value:L.propertyInterest.priceRange.min,onChange:Z=>q(ne=>({...ne,propertyInterest:{...ne.propertyInterest,priceRange:{...ne.propertyInterest.priceRange,min:parseInt(Z.target.value)||0}}})),placeholder:"Minimum budget"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Max Budget"}),e.jsx(Q,{type:"number",value:L.propertyInterest.priceRange.max,onChange:Z=>q(ne=>({...ne,propertyInterest:{...ne.propertyInterest,priceRange:{...ne.propertyInterest.priceRange,max:parseInt(Z.target.value)||0}}})),placeholder:"Maximum budget"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx($e,{value:L.notes,onChange:Z=>q(ne=>({...ne,notes:Z.target.value})),placeholder:"Add any notes about the lead...",rows:3})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:M,className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:"Add Lead"}),e.jsx(g,{onClick:()=>P(!1),variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}),e.jsx(Re,{open:k,onOpenChange:h,children:e.jsxs(Ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Lead Details"})}),b&&e.jsxs(Ls,{defaultValue:"overview",className:"w-full",children:[e.jsxs(As,{className:"grid w-full grid-cols-3",children:[e.jsx(Se,{value:"overview",children:"Overview"}),e.jsx(Se,{value:"interactions",children:"Interactions"}),e.jsx(Se,{value:"scoring",children:"Scoring"})]}),e.jsxs(ke,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Contact Information"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:b.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ms,{className:"h-4 w-4"}),e.jsx("span",{children:b.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx("span",{children:b.phone})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Lead Details"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),$(b.status)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Score:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-bold",children:b.score}),O(b.score)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Source:"}),e.jsx(re,{variant:"outline",children:b.source})]})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Property Interest"})}),e.jsxs(_,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Type:"}),e.jsx(re,{variant:"outline",children:b.propertyInterest.type.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Budget:"}),e.jsxs("span",{children:["â‚¹",b.propertyInterest.priceRange.min.toLocaleString()," ","- â‚¹",b.propertyInterest.priceRange.max.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Urgency:"}),ae(b.propertyInterest.urgency)]})]})]}),b.notes&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Notes"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm text-gray-600",children:b.notes})})]})]}),e.jsxs(ke,{value:"interactions",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium",children:"Interaction History"}),e.jsxs(g,{onClick:()=>E(!0),size:"sm",className:"bg-[#C70000] hover:bg-[#A60000]",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Interaction"]})]}),e.jsx("div",{className:"space-y-3",children:(le=b.interactions)==null?void 0:le.map(Z=>e.jsx(U,{children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[X(Z.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium capitalize",children:Z.type}),e.jsx(re,{className:Z.outcome==="positive"?"bg-green-100 text-green-800":Z.outcome==="negative"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",children:Z.outcome}),Z.scoreChange!==0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[z(Z.scoreChange),e.jsx("span",{className:"text-sm",children:Math.abs(Z.scoreChange)})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Z.description}),Z.nextAction&&e.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Next: ",Z.nextAction]})]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(Z.date).toLocaleDateString()})]})})},Z._id))})]}),e.jsx(ke,{value:"scoring",className:"space-y-4",children:e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{className:"text-sm",children:"Lead Scoring"})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Current Score:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl font-bold",children:b.score}),O(b.score)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Probability:"}),e.jsxs("span",{className:"font-bold",children:[b.probability,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Estimated Value:"}),e.jsxs("span",{className:"font-bold text-[#C70000]",children:["â‚¹",b.estimatedValue.toLocaleString()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Adjust Score"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:()=>W(b._id,10),size:"sm",variant:"outline",children:"+10"}),e.jsx(g,{onClick:()=>W(b._id,5),size:"sm",variant:"outline",children:"+5"}),e.jsx(g,{onClick:()=>W(b._id,-5),size:"sm",variant:"outline",children:"-5"}),e.jsx(g,{onClick:()=>W(b._id,-10),size:"sm",variant:"outline",children:"-10"})]})]})]})})]})})]})]})}),e.jsx(Re,{open:w,onOpenChange:E,children:e.jsxs(Ee,{children:[e.jsx(Ie,{children:e.jsx(Fe,{children:"Add Interaction"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Interaction Type"}),e.jsxs(ue,{value:V.type,onValueChange:Z=>p(ne=>({...ne,type:Z})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"call",children:"Phone Call"}),e.jsx(G,{value:"email",children:"Email"}),e.jsx(G,{value:"meeting",children:"Meeting"}),e.jsx(G,{value:"message",children:"Message"}),e.jsx(G,{value:"visit",children:"Property Visit"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx($e,{value:V.description,onChange:Z=>p(ne=>({...ne,description:Z.target.value})),placeholder:"Describe the interaction...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Outcome"}),e.jsxs(ue,{value:V.outcome,onValueChange:Z=>p(ne=>({...ne,outcome:Z})),children:[e.jsx(xe,{children:e.jsx(pe,{})}),e.jsxs(he,{children:[e.jsx(G,{value:"positive",children:"Positive"}),e.jsx(G,{value:"neutral",children:"Neutral"}),e.jsx(G,{value:"negative",children:"Negative"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Score Change"}),e.jsx(Q,{type:"number",value:V.scoreChange,onChange:Z=>p(ne=>({...ne,scoreChange:parseInt(Z.target.value)||0})),placeholder:"Score change (-20 to +20)",min:"-20",max:"20"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Next Action"}),e.jsx(Q,{value:V.nextAction,onChange:Z=>p(ne=>({...ne,nextAction:Z.target.value})),placeholder:"What's the next step?"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(g,{onClick:H,className:"flex-1 bg-[#C70000] hover:bg-[#A60000]",children:"Add Interaction"}),e.jsx(g,{onClick:()=>E(!1),variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})})]}),e.jsx(ve,{})]})}function Jm(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(null),n=async()=>{try{c(!0);const u=localStorage.getItem("token"),S=await fetch("/api/user/notifications",{headers:u?{Authorization:`Bearer ${u}`}:{}}),x=await S.json();S.ok&&x.success?t(x.data||[]):y(x.error||"Failed to load notifications")}catch{y("Network error loading notifications")}finally{c(!1)}};a.useEffect(()=>{n()},[]);const o=async u=>{try{const S=localStorage.getItem("token");await fetch(`/api/user/notifications/${u}/read`,{method:"PUT",headers:S?{Authorization:`Bearer ${S}`}:{}}),t(x=>x.map(A=>A._id===u?{...A,isRead:!0}:A))}catch{}},f=async u=>{try{const S=localStorage.getItem("token");await fetch(`/api/user/notifications/${u}`,{method:"DELETE",headers:S?{Authorization:`Bearer ${S}`}:{}}),t(x=>x.filter(A=>A._id!==u))}catch{}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("main",{className:"max-w-3xl mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"Notifications"}),r?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading notifications..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(Es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No notifications yet"})]}):e.jsx("div",{className:"space-y-3",children:s.map(u=>e.jsxs("div",{className:`bg-white border rounded-lg p-4 flex items-start justify-between ${u.isRead?"":"border-[#C70000]"}`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:u.title||"Notification"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.message}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:new Date(u.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!u.isRead&&e.jsx("button",{onClick:()=>o(u._id),className:"p-2 rounded hover:bg-gray-100","aria-label":"Mark as read",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>f(u._id),className:"p-2 rounded hover:bg-gray-100","aria-label":"Delete",children:e.jsx(De,{className:"h-4 w-4"})})]})]},u._id))})]}),e.jsx(ve,{})]})}function Wm(){const{user:s}=je(),t=Ve(),[r,c]=a.useState(!1),[N,y]=a.useState([]),[n,o]=a.useState({title:"",slug:"",cover:"",category:"General",tags:"",excerpt:"",content:"",seoTitle:"",seoDescription:""});a.useEffect(()=>{if(!s){t("/login");return}if(s.userType!=="seller"){t("/user-dashboard");return}f()},[s]),a.useEffect(()=>{if(!n.title)return;const x=A=>A.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");o(A=>({...A,slug:x(A.title)}))},[n.title]);const f=async()=>{try{const x=localStorage.getItem("token"),A=await ce.get("seller/blog",x);y(A.data.data)}catch(x){console.warn("Failed to load posts",x)}},u=async(x=!1)=>{var A,d;try{c(!0);const v=localStorage.getItem("token"),j={title:n.title,slug:n.slug,content:n.content,excerpt:n.excerpt,featuredImage:n.cover,category:n.category,tags:n.tags.split(",").map(l=>(l??"").trim()).filter(Boolean),submit:x,seo:{title:n.seoTitle||n.title,description:n.seoDescription||n.excerpt}},m=await ce.post("seller/blog",j,v);((((A=m.data)==null?void 0:A.success)??!1)||(d=m.data)!=null&&d._id)&&(await f(),o({title:"",slug:"",cover:"",category:"General",tags:"",excerpt:"",content:"",seoTitle:"",seoDescription:""}),alert(x?"Submitted for review":"Saved as draft"))}catch(v){alert((v==null?void 0:v.message)||"Failed to submit")}finally{c(!1)}},S=x=>x==="published"?"bg-green-100 text-green-800":x==="pending_review"?"bg-yellow-100 text-yellow-800":x==="draft"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800";return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Create Blog Post"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Title"}),e.jsx(Q,{value:n.title,onChange:x=>o({...n,title:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Slug"}),e.jsx(Q,{value:n.slug,onChange:x=>o({...n,slug:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Cover Image URL"}),e.jsx(Q,{value:n.cover,onChange:x=>o({...n,cover:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Category"}),e.jsx(Q,{value:n.category,onChange:x=>o({...n,category:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Tags (comma separated)"}),e.jsx(Q,{value:n.tags,onChange:x=>o({...n,tags:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Excerpt"}),e.jsx($e,{value:n.excerpt,onChange:x=>o({...n,excerpt:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Content"}),e.jsx($e,{className:"min-h-[180px]",value:n.content,onChange:x=>o({...n,content:x.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"SEO Title"}),e.jsx(Q,{value:n.seoTitle,onChange:x=>o({...n,seoTitle:x.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"SEO Description"}),e.jsx(Q,{value:n.seoDescription,onChange:x=>o({...n,seoDescription:x.target.value})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{disabled:r,onClick:()=>u(!1),children:"Save Draft"}),e.jsx(g,{disabled:r,className:"bg-[#C70000] hover:bg-[#A60000] text-white",onClick:()=>u(!0),children:"Submit for Review"})]})]})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"My Posts"})}),e.jsx(_,{children:N.length===0?e.jsx("div",{className:"text-gray-500",children:"No posts yet."}):e.jsx("div",{className:"space-y-3",children:N.map(x=>e.jsxs("div",{className:"border rounded-lg p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:x.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["/",x.slug]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:S(x.status),children:x.status.replace("_"," ")}),e.jsx("a",{className:"text-sm text-blue-600 hover:underline",href:`/blog/${x.slug}`,target:"_blank",rel:"noreferrer",children:"Preview"})]})]},x._id))})})]})]})}const Qm=()=>{const s=Va();return a.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};function Km(){const[s,t]=a.useState([]),[r,c]=a.useState(!0),[N,y]=a.useState(null),n=Ve();a.useEffect(()=>{o()},[]);const o=async()=>{try{c(!0),y(null);const f=await window.api("/os/categories?active=1"),u=f.ok?f.json:{success:!1,error:"Failed to fetch categories"};u.success&&Array.isArray(u.data)?t(u.data):(y("Failed to load categories"),t([]))}catch(f){y(`Failed to load categories: ${f.message}`),t([])}finally{c(!1)}};return r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading categories..."})]})}):N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Unable to Load"}),e.jsx("p",{className:"text-gray-600 mb-6",children:N}),e.jsxs("div",{className:"space-x-3",children:[e.jsx(g,{onClick:o,variant:"outline",children:"Try Again"}),e.jsxs(g,{onClick:()=>n("/"),variant:"secondary",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"})," Back to Home"]})]})]})}),e.jsx(Fs,{})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2 flex-wrap",children:[e.jsx(rt,{className:"h-10 w-10 text-[#C70000]"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Other Services"}),e.jsx("div",{className:"inline-flex",children:e.jsxs(g,{variant:"outline",onClick:()=>n("/"),className:"min-w-[150px]",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl text-center mx-auto mb-10",children:"Find trusted service providers in Rohtak for all your needs. From repairs to maintenance, we've got you covered."}),s.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(rt,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No categories available"}),e.jsxs(g,{onClick:()=>n("/"),className:"mt-4",variant:"secondary",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"})," Back to Home"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:s.map(f=>e.jsx(be,{to:`/other-services/${f.slug}`,className:"group",children:e.jsx(U,{className:"h-full transition-all duration-200 hover:shadow-lg hover:scale-105 hover:border-[#C70000] bg-white",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#C70000] to-[#A60000] rounded-full mb-4 group-hover:scale-110 transition-transform duration-200",children:e.jsx(rt,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-[#C70000] transition-colors",children:f.name}),e.jsxs("div",{className:"flex items-center justify-center text-[#C70000] opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("span",{className:"text-sm font-medium mr-1",children:"View Subcategories"}),e.jsx(gt,{className:"h-4 w-4"})]})]})})},f._id))}),e.jsx("div",{className:"mt-16 text-center",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] rounded-xl text-white p-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Are you a service provider?"}),e.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Join our platform and connect with customers in Rohtak who need your services."}),e.jsx(g,{onClick:()=>window.location.href="/contact-us",className:"bg-white text-[#C70000] hover:bg-gray-100 px-8 py-3 text-lg font-semibold",children:"List Your Services"})]})})]})}),e.jsx(Fs,{})]})}function Ym(){const{cat:s}=zs(),t=Ve(),[r,c]=a.useState([]),[N,y]=a.useState(!0),[n,o]=a.useState(null),[f,u]=a.useState("");a.useEffect(()=>{s&&S()},[s]);const S=async()=>{try{y(!0),o(null);const x=await window.api(`/os/subcategories?cat=${s}&active=1`),A=x.ok?x.json:{success:!1,error:"Failed to fetch subcategories"};A.success&&Array.isArray(A.data)?(c(A.data),u((s==null?void 0:s.replace(/-/g," ").replace(/\b\w/g,d=>d.toUpperCase()))||"")):(o("Failed to load subcategories"),c([]))}catch(x){console.error("Error fetching subcategories:",x),o(`Failed to load subcategories: ${x.message}`),c([])}finally{y(!1)}};return N?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading subcategories..."})]})}):n?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Unable to Load Services"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(g,{onClick:S,variant:"outline",children:"Try Again"}),e.jsxs(g,{onClick:()=>t("/other-services"),variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to Services"]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex items-center mb-8",children:e.jsxs(g,{variant:"ghost",onClick:()=>t("/other-services"),className:"mr-4",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to Services"]})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(rt,{className:"h-10 w-10 text-[#C70000] mr-3"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:f})]}),e.jsxs("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:["Choose from our range of ",f.toLowerCase()," services in Rohtak."]})]}),r.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(rt,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No Subcategories Available"}),e.jsxs("p",{className:"text-gray-500",children:["Subcategories for ",f.toLowerCase()," will be available soon."]}),e.jsxs(g,{onClick:()=>t("/other-services"),className:"mt-6",variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Browse Other Services"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(x=>e.jsx(be,{to:`/other-services/${s}/${x.slug}`,className:"group",children:e.jsx(U,{"data-testid":"os-subcat-card",className:"h-full transition-all duration-200 hover:shadow-lg hover:scale-105 hover:border-[#C70000] bg-white",children:e.jsxs(_,{className:"p-6 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#C70000] to-[#A60000] rounded-full mb-4 group-hover:scale-110 transition-transform duration-200",children:e.jsx(rt,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-[#C70000] transition-colors",children:x.name}),e.jsxs("div",{className:"flex items-center justify-center text-[#C70000] opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("span",{className:"text-sm font-medium mr-1",children:"View Listings"}),e.jsx(gt,{className:"h-4 w-4"})]})]})})},x._id))}),e.jsx("div",{className:"mt-16 text-center",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] rounded-xl text-white p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Need ",f.toLowerCase()," services?"]}),e.jsxs("p",{className:"text-lg mb-6 opacity-90",children:["Browse our verified ",f.toLowerCase()," professionals in Rohtak."]}),e.jsx(g,{onClick:()=>window.location.href="/contact-us",className:"bg-white text-[#C70000] hover:bg-gray-100 px-8 py-3 text-lg font-semibold",children:"Contact Us for Help"})]})})]})})}function Xm(){const{cat:s,sub:t}=zs(),r=Ve(),[c,N]=a.useState([]),[y,n]=a.useState(!0),[o,f]=a.useState(null),[u,S]=a.useState(""),[x,A]=a.useState("");a.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{n(!0),f(null);const m=await window.api(`/os/listings?sub=${t}&active=1`),l=m.ok?m.json:{success:!1,error:"Failed to fetch listings"};l.success&&Array.isArray(l.data)?(N(l.data),S((t==null?void 0:t.replace(/-/g," ").replace(/\b\w/g,b=>b.toUpperCase()))||""),A((s==null?void 0:s.replace(/-/g," ").replace(/\b\w/g,b=>b.toUpperCase()))||"")):(f("Failed to load listings"),N([]))}catch(m){console.error("Error fetching listings:",m),f(`Failed to load listings: ${m.message}`),N([])}finally{n(!1)}},v=(m,l)=>{window.open(`tel:${m}`,"_self")},j=(m,l)=>{const b=`Hi, I found your contact through Rohtak Property Portal. I need ${u.toLowerCase()} services.`,T=`https://wa.me/${m.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(b)}`;window.open(T,"_blank")};return y?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#C70000] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading listings..."})]})}):o?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Unable to Load Listings"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(g,{onClick:d,variant:"outline",children:"Try Again"}),e.jsxs(g,{onClick:()=>r(`/other-services/${s}`),variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to ",x]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex items-center mb-8",children:e.jsxs(g,{variant:"ghost",onClick:()=>r(`/other-services/${s}`),className:"mr-4",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back to ",x]})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:u}),e.jsxs("p",{className:"text-lg text-gray-600",children:[c.length," ",u.toLowerCase()," ",c.length===1?"service":"services"," available in Rohtak"]})]}),c.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(ns,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No Listings Available"}),e.jsxs("p",{className:"text-gray-500 mb-6",children:[u," services will be available soon in this area."]}),e.jsxs(g,{onClick:()=>r(`/other-services/${s}`),variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Browse Other ",x," Services"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(m=>e.jsxs(U,{"data-testid":"service-card",className:"overflow-hidden hover:shadow-lg transition-shadow duration-200",children:[m.photos&&m.photos.length>0&&e.jsx("div",{className:"relative h-48 overflow-hidden",children:e.jsx("div",{className:"flex space-x-1",children:m.photos.slice(0,4).map((l,b)=>e.jsx("img",{src:l,alt:`${m.name} ${b+1}`,className:`object-cover ${m.photos.length===1?"w-full h-48":m.photos.length===2||m.photos.length===3&&b===0?"w-1/2 h-48":"w-1/4 h-48"}`,onError:T=>{const C=T.target;C.src="/placeholder.svg"}},b))})}),e.jsxs(_,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:m.name}),e.jsxs("div",{className:"flex items-start text-gray-600 mb-3",children:[e.jsx(He,{className:"h-4 w-4 mr-2 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:m.address})]}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-4",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{className:"text-sm",children:[m.open," - ",m.close]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(g,{onClick:()=>v(m.phone,m.name),className:"bg-[#C70000] hover:bg-[#A60000] text-white",size:"sm",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Call"]}),e.jsxs(g,{onClick:()=>j(m.phone,m.name),className:"bg-green-500 hover:bg-green-600 text-white",size:"sm",children:[e.jsx("svg",{className:"h-4 w-4 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.309"})}),"WhatsApp"]})]}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("span",{className:"text-sm text-gray-500",children:m.phone})})]})]},m._id))}),e.jsx("div",{className:"mt-16 text-center",children:e.jsxs("div",{className:"bg-gradient-to-r from-[#C70000] to-[#A60000] rounded-xl text-white p-8",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Are you a ",u.toLowerCase()," professional?"]}),e.jsx("p",{className:"text-lg mb-6 opacity-90",children:"Join our platform and get more customers in Rohtak."}),e.jsx(g,{onClick:()=>window.location.href="/contact-us",className:"bg-white text-[#C70000] hover:bg-gray-100 px-8 py-3 text-lg font-semibold",children:"List Your Business"})]})})]})})}function Zm(){var j,m;const{id:s}=zs(),t=Ve(),[r,c]=a.useState(null),[N,y]=a.useState([]),[n,o]=a.useState(!1),[f,u]=a.useState(!1),[S,x]=a.useState([]);a.useEffect(()=>{if(s){A(),d();const l=setInterval(d,5e3);return()=>clearInterval(l)}},[s]);const A=async()=>{try{const l=await window.api("/conversations/my");if(l.success){const b=l.data.find(T=>T._id===s);c(b)}}catch(l){console.error("Error fetching conversation:",l)}},d=async()=>{if(s)try{const l=await window.api(`/conversations/${s}/messages`);l.success&&y(l.data)}catch(l){console.error("Error fetching messages:",l)}},v=async()=>{if(!s)return;u(!0);const l=Date.now();try{const b=await window.api(`/conversations/${s}/messages`,{method:"POST",body:{text:"ping-test"}}),C=Date.now()-l;if(console.log("ðŸ“§ Test message response:",b),console.log("â±ï¸ Response time:",C,"ms"),b.success){const P={timestamp:new Date().toISOString(),status:b.success?"SUCCESS":"FAILED",statusCode:201,responseTime:`${C}ms`,messageId:b.data._id,response:b};x(k=>[P,...k]),is({title:"âœ… Test Message Sent Successfully",description:`Status: 201, Response Time: ${C}ms`}),setTimeout(d,1e3),console.log("âœ… PASS: STEP3")}else{const P={timestamp:new Date().toISOString(),status:"FAILED",statusCode:b.status||"unknown",responseTime:`${C}ms`,error:b.error,response:b};x(k=>[P,...k]),console.error("âŒ FAIL: STEP3"),console.error("URL:",`/api/conversations/${s}/messages`),console.error("Method: POST"),console.error("Status:",b.status||"unknown"),console.error("Body:",b),is({title:"âŒ Test Failed",description:b.error||"Failed to send test message",variant:"destructive"})}}catch(b){const C=Date.now()-l;console.error("âŒ FAIL: STEP3"),console.error("URL:",`/api/conversations/${s}/messages`),console.error("Method: POST"),console.error("Error:",b);const P={timestamp:new Date().toISOString(),status:"ERROR",statusCode:"network_error",responseTime:`${C}ms`,error:b.message,response:null};x(k=>[P,...k]),is({title:"âŒ Network Error",description:"Failed to connect to server",variant:"destructive"})}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"STEP 3: OLX-Style Chat Test"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Testing conversation ID: ",s]})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(g,{onClick:v,disabled:f||!s,className:"bg-[#C70000] hover:bg-[#A60000]",children:f?"Sending...":"Send Ping Test"}),e.jsx(g,{onClick:()=>t(-1),variant:"outline",children:"Back"})]}),r&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold",children:"Conversation Details:"}),e.jsxs("p",{className:"text-sm",children:["Property: ",(j=r.property)==null?void 0:j.title]}),e.jsxs("p",{className:"text-sm",children:["Participants: ",(m=r.participants)==null?void 0:m.length]}),e.jsxs("p",{className:"text-sm",children:["Created: ",new Date(r.createdAt).toLocaleString()]})]})]})]}),S.length>0&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Test Results"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:S.map((l,b)=>e.jsxs("div",{className:`p-3 rounded border ${l.status==="SUCCESS"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-semibold ${l.status==="SUCCESS"?"text-green-700":"text-red-700"}`,children:l.status}),e.jsx("span",{className:"text-sm text-gray-600 ml-2",children:l.timestamp})]}),e.jsx("div",{className:"text-sm text-gray-600",children:l.responseTime})]}),l.error&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:l.error}),l.messageId&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Message ID: ",l.messageId]})]},b))})})]}),e.jsxs(U,{children:[e.jsx(K,{children:e.jsxs(Y,{children:["Messages (",N.length,")"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:N.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No messages yet"}):N.map(l=>e.jsxs("div",{className:`p-3 rounded-lg max-w-xs ${l.message==="ping-test"?"bg-yellow-100 border-2 border-yellow-300":"bg-gray-100"}`,"data-testid":l.message==="ping-test"?"msg-outgoing":"message",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm font-medium",children:l.senderName}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(l.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm mt-1",children:l.message}),l.message==="ping-test"&&e.jsx("div",{className:"text-xs text-green-600 mt-1 font-semibold",children:"âœ… TEST MESSAGE"})]},l._id))})})]})]})})}function ex(){const s=Ve(),[t,r]=a.useState([]),[c,N]=a.useState(0),[y,n]=a.useState(!1),[o,f]=a.useState("674a9f20c2b70b4a34b76b65"),[u,S]=a.useState("674a9c9ac2b70b4a34b76b27"),[x,A]=a.useState(""),d=["Check authentication","Find or create conversation","Navigate to chat page","Send ping-test message","Verify message with data-testid","Complete STEP3"],v=(l,b,T)=>{const C={step:l,status:b,details:T,timestamp:new Date().toISOString()};return r(P=>[...P,C]),C},j=async()=>{n(!0),r([]),N(0);try{N(1);const l=localStorage.getItem("token");if(!l){v("Authentication","FAILED","No token found. Please login first."),n(!1);return}A(l),v("Authentication","SUCCESS","Token found"),N(2);const b=await window.api("/conversations/find-or-create",{method:"POST",body:{propertyId:o}});if(!b.success){v("Create Conversation","FAILED",`Error: ${b.error}`),console.error("âŒ FAIL: STEP3"),console.error("URL: /api/conversations/find-or-create"),console.error("Method: POST"),console.error("Status:",b.status||"unknown"),console.error("Body:",b),n(!1);return}const T=b.data._id;v("Create Conversation","SUCCESS",`Conversation ID: ${T}`),N(3),v("Navigation","SUCCESS",`Navigating to /chat/${T}`),await new Promise(k=>setTimeout(k,1e3)),N(4);const C=await window.api(`/conversations/${T}/messages`,{method:"POST",body:{text:"ping-test"}});if(!C.success){v("Send Message","FAILED",`Error: ${C.error}`),console.error("âŒ FAIL: STEP3"),console.error("URL:",`/api/conversations/${T}/messages`),console.error("Method: POST"),console.error("Status:",C.status||"unknown"),console.error("Body:",C),n(!1);return}v("Send Message","SUCCESS",`Message sent with ID: ${C.data._id}`),N(5),s(`/test-chat/${T}`),await new Promise(k=>setTimeout(k,2e3)),document.querySelector('[data-testid="msg-outgoing"]')?(v("Message Bubble","SUCCESS","Found message with data-testid='msg-outgoing'"),N(6),v("STEP3 Complete","SUCCESS","All tests passed!"),console.log("âœ… PASS: STEP3"),is({title:"âœ… STEP3 PASSED",description:"OLX-style chat functionality working correctly!"})):(v("Message Bubble","FAILED","Message bubble with data-testid='msg-outgoing' not found"),console.error("âŒ FAIL: STEP3"),console.error("Message bubble verification failed"))}catch(l){v("Test Error","ERROR",`Unexpected error: ${l.message}`),console.error("âŒ FAIL: STEP3"),console.error("Unexpected error:",l)}finally{n(!1)}},m=async()=>{try{const l=await window.api("/properties",{method:"POST",body:{title:"Test Property for Chat",description:"Test property for OLX-style chat functionality",propertyType:"apartment",category:"buy",subCategory:"apartment",price:1e6,priceType:"sale",location:{city:"Test City",state:"Test State",address:"123 Test Street",area:"Test Area"},contactInfo:{name:"Test Owner",phone:"1234567890",email:"test@example.com"},images:["/placeholder.png"],status:"active"}});l.success?(f(l.data._id),is({title:"Test Property Created",description:`Property ID: ${l.data._id}`})):is({title:"Failed to create test property",description:l.error,variant:"destructive"})}catch(l){is({title:"Error creating test property",description:l.message,variant:"destructive"})}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(Y,{children:"STEP 3: OLX-Style Chat Automated Test"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automated test for chat functionality with polling and message verification"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property ID"}),e.jsx(Q,{value:o,onChange:l=>f(l.target.value),disabled:y,placeholder:"Enter property ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"User ID"}),e.jsx(Q,{value:u,onChange:l=>S(l.target.value),disabled:y,placeholder:"Enter user ID"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(g,{onClick:j,disabled:y||!o,className:"bg-[#C70000] hover:bg-[#A60000]",children:y?`Running Step ${c}/6...`:"Run STEP3 Test"}),e.jsx(g,{onClick:m,disabled:y,variant:"outline",children:"Create Test Property"}),e.jsx(g,{onClick:()=>s("/"),variant:"outline",children:"Go to Home"})]}),y&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-[#C70000] h-2 rounded-full transition-all duration-300",style:{width:`${c/6*100}%`}})}),e.jsx("div",{className:"space-y-2",children:d.map((l,b)=>e.jsx("div",{className:`p-2 rounded border ${b+1===c?"bg-blue-50 border-blue-200":b+1<c?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:e.jsxs("span",{className:"text-sm",children:[b+1,". ",l]})},b))})]})]}),t.length>0&&e.jsxs(U,{children:[e.jsx(K,{children:e.jsx(Y,{children:"Test Results"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:t.map((l,b)=>e.jsxs("div",{className:`p-3 rounded border ${l.status==="SUCCESS"?"bg-green-50 border-green-200":l.status==="ERROR"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{children:e.jsxs("span",{className:`font-semibold ${l.status==="SUCCESS"?"text-green-700":l.status==="ERROR"?"text-red-700":"text-yellow-700"}`,children:[l.step,": ",l.status]})}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(l.timestamp).toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.details})]},b))})})]})]})})}const sx=()=>{const[s,t]=a.useState({isOnline:navigator.onLine,serverReachable:!1,lastChecked:new Date,connectionQuality:"good"}),[r,c]=a.useState(!1),[N,y]=a.useState(!1),n=async()=>{if(!N){y(!0);try{const S=new AbortController,x=setTimeout(()=>S.abort(),8e3),A=Date.now(),d=await fetch("/api/health",{method:"GET",signal:S.signal,cache:"no-cache",headers:{"Content-Type":"application/json"}});clearTimeout(x);const v=Date.now()-A;let j="good";navigator.onLine?d.ok?v<200?j="excellent":v<500?j="good":v<1e3?j="fair":j="poor":j="poor":j="offline",t({isOnline:navigator.onLine,serverReachable:d.ok,lastChecked:new Date,connectionQuality:j})}catch(S){S instanceof Error&&S.name==="AbortError"?console.warn("NetworkStatus: Connection check timed out"):console.warn("NetworkStatus: Connection check failed:",S),t({isOnline:navigator.onLine,serverReachable:!1,lastChecked:new Date,connectionQuality:navigator.onLine?"poor":"offline"})}finally{y(!1)}}};a.useEffect(()=>{n();const S=()=>{t(d=>({...d,isOnline:!0})),c(!0),n(),setTimeout(()=>c(!1),3e3)},x=()=>{t(d=>({...d,isOnline:!1,serverReachable:!1,connectionQuality:"offline"})),c(!0)};window.addEventListener("online",S),window.addEventListener("offline",x);const A=setInterval(n,6e4);return(!s.isOnline||!s.serverReachable||s.connectionQuality==="poor")&&c(!0),()=>{window.removeEventListener("online",S),window.removeEventListener("offline",x),clearInterval(A)}},[]);const o=()=>{if(!s.isOnline)return e.jsx(Cr,{className:"h-4 w-4 text-red-500"});if(!s.serverReachable)return e.jsx(rs,{className:"h-4 w-4 text-orange-500"});switch(s.connectionQuality){case"excellent":case"good":return e.jsx(Le,{className:"h-4 w-4 text-green-500"});case"fair":return e.jsx(gn,{className:"h-4 w-4 text-yellow-500"});case"poor":return e.jsx(rs,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(Cr,{className:"h-4 w-4 text-red-500"})}},f=()=>{if(!s.isOnline)return"Offline";if(!s.serverReachable)return"Server Unreachable";switch(s.connectionQuality){case"excellent":return"Excellent Connection";case"good":return"Good Connection";case"fair":return"Fair Connection";case"poor":return"Poor Connection";default:return"Unknown Status"}},u=()=>!s.isOnline||s.connectionQuality==="offline"?"bg-red-100 border-red-200 text-red-800":!s.serverReachable||s.connectionQuality==="poor"?"bg-orange-100 border-orange-200 text-orange-800":s.connectionQuality==="fair"?"bg-yellow-100 border-yellow-200 text-yellow-800":"bg-green-100 border-green-200 text-green-800";return r?e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm",children:e.jsx(U,{className:`border ${u()}`,children:e.jsxs(_,{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[o(),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:f()}),e.jsxs("p",{className:"text-xs opacity-75",children:["Last checked: ",s.lastChecked.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(g,{size:"sm",variant:"ghost",onClick:n,disabled:N,className:"h-6 w-6 p-0",children:e.jsx(Oe,{className:`h-3 w-3 ${N?"animate-spin":""}`})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>c(!1),className:"h-6 w-6 p-0",children:e.jsx(Ue,{className:"h-3 w-3"})})]})]})})}):null},tx="Ashish Properties";function ax(){const s=Va();return a.useEffect(()=>{const t=(document.title||"").trim(),r=t.toLowerCase();(!t||!r.includes("aashish"))&&(document.title=tx)},[s.pathname]),null}function rx(){const{slug:s}=zs(),t=Ve(),[r,c]=a.useState(null),[N,y]=a.useState(!0),[n,o]=a.useState("");a.useEffect(()=>{s&&f(s)},[s]);const f=async v=>{try{y(!0),o("");const j=await fetch(`/api/content/pages/slug/${v}`);if(j.ok){const m=await j.json();if(m.success&&m.data){if(c(m.data),m.data.metaTitle?document.title=m.data.metaTitle:document.title=`${m.data.title} - Ashish Properties`,m.data.metaDescription){let l=document.querySelector('meta[name="description"]');l||(l=document.createElement("meta"),l.setAttribute("name","description"),document.head.appendChild(l)),l.setAttribute("content",m.data.metaDescription)}u(m.data._id)}else o("Page not found")}else j.status===404?o("Page not found"):o("Failed to load page")}catch(j){console.error("Error fetching page:",j),o("Failed to load page")}finally{y(!1)}},u=async v=>{try{await fetch(`/api/content/pages/${v}/view`,{method:"POST"})}catch(j){console.warn("Failed to track page view:",j)}},S=async()=>{if(navigator.share&&r)try{await navigator.share({title:r.title,text:r.metaDescription||r.title,url:window.location.href})}catch{x()}else x()},x=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{console.log("URL copied to clipboard")})},A=v=>{switch(v){case"policy":return"Policy";case"terms":return"Terms";case"faq":return"FAQ";default:return"Page"}},d=v=>{switch(v){case"policy":return"bg-blue-100 text-blue-800";case"terms":return"bg-yellow-100 text-yellow-800";case"faq":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return N?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6"})]})]})})]}):n||!r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:n==="Page not found"?"Page Not Found":"Error Loading Page"}),e.jsx("p",{className:"text-gray-600 mb-8",children:n==="Page not found"?"The page you're looking for doesn't exist or has been moved.":"There was an error loading this page. Please try again."}),e.jsxs("div",{className:"space-x-4",children:[e.jsxs(g,{onClick:()=>t(-1),variant:"outline",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Go Back"]}),e.jsx(g,{onClick:()=>t("/"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Go Home"})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Me,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(g,{onClick:()=>t(-1),variant:"outline",className:"mb-6",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(re,{className:d(r.type),children:A(r.type)}),r.views&&e.jsxs(re,{variant:"outline",className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[r.views," views"]})]})]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:r.title}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsxs("span",{children:["Updated ",new Date(r.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),r.author&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:r.author})]})]})]}),e.jsxs(g,{onClick:S,variant:"outline",size:"sm",className:"ml-4",children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"Share"]})]})]}),r.featuredImage&&e.jsx("div",{className:"mb-8",children:e.jsx("img",{src:r.featuredImage,alt:r.title,className:"w-full h-64 md:h-96 object-cover rounded-lg shadow-lg"})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:e.jsx("div",{className:"prose prose-lg max-w-none prose-headings:text-gray-900 prose-p:text-gray-700 prose-a:text-[#C70000] prose-a:no-underline hover:prose-a:underline prose-strong:text-gray-900 prose-ul:text-gray-700 prose-ol:text-gray-700",dangerouslySetInnerHTML:{__html:r.content}})}),e.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"This page was created through our admin panel and is dynamically loaded."}),e.jsxs("p",{children:["Last updated: ",new Date(r.updatedAt).toLocaleString()]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(g,{onClick:S,variant:"outline",size:"sm",children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"Share Page"]}),e.jsx(g,{onClick:()=>t("/"),className:"bg-[#C70000] hover:bg-[#A60000]",children:"Explore Properties"})]})]})]})]})}function bt({className:s,...t}){return e.jsx("div",{className:me("animate-pulse rounded-md bg-muted",s),...t})}const nx=wc({name:Sr().min(2,"Name must be at least 2 characters"),slug:Sr().regex(/^[a-z0-9]+(?:-[a-z0-9]+)*$/,"Use lowercase kebab-case, e.g. 2-bhk"),status:Cc(["active","inactive"])});function Pa(){const{categoryId:s}=zs();Ve();const{toast:t}=ct(),[r,c]=a.useState(""),[N,y]=a.useState([]),[n,o]=a.useState(!0),[f,u]=a.useState(""),[S,x]=a.useState(""),[A,d]=a.useState(""),v=a.useRef(null),[j,m]=a.useState(1),[l,b]=a.useState(10),[T,C]=a.useState(!1),[P,k]=a.useState(null),[h,w]=a.useState(!1),[E,L]=a.useState({name:"",slug:"",status:"active"}),[q,V]=a.useState(null);a.useEffect(()=>(v.current&&window.clearTimeout(v.current),v.current=window.setTimeout(()=>d(S.trim().toLowerCase()),400),()=>{v.current&&window.clearTimeout(v.current)}),[S]),a.useEffect(()=>{(async()=>{var $,O,ae,X,z,le;if(s){o(!0),u("");try{const Z=await ce.get(`admin/subcategories?categoryId=${encodeURIComponent(s)}`),ne=((O=($=Z==null?void 0:Z.data)==null?void 0:$.data)==null?void 0:O.subcategories)||((ae=Z==null?void 0:Z.data)==null?void 0:ae.data)||(Z==null?void 0:Z.data),ye=(Array.isArray(ne)?ne:[]).map(Te=>{var qe,os;return{_id:((os=(qe=Te._id)==null?void 0:qe.toString)==null?void 0:os.call(qe))||Te._id,categoryId:Te.categoryId,name:Te.name,slug:Te.slug,isActive:typeof Te.isActive=="boolean"?Te.isActive:!!Te.active,sortOrder:Te.sortOrder??Te.order,updatedAt:Te.updatedAt,createdAt:Te.createdAt}});y(ye);const ie=await ce.get("admin/categories"),_e=(((z=(X=ie==null?void 0:ie.data)==null?void 0:X.data)==null?void 0:z.categories)||((le=ie==null?void 0:ie.data)==null?void 0:le.data)||[]).find(Te=>{var qe,os;return((os=(qe=Te._id)==null?void 0:qe.toString)==null?void 0:os.call(qe))===s||Te._id===s});c((_e==null?void 0:_e.name)||`Category #${s.substring(0,6)}`)}catch(Z){u((Z==null?void 0:Z.message)||"Failed to load subcategories")}finally{o(!1)}}})()},[s]);const p=a.useMemo(()=>{let B=N;return A&&(B=B.filter($=>`${$.name} ${$.slug}`.toLowerCase().includes(A))),B},[N,A]),i=Math.max(1,Math.ceil(p.length/l)),F=Math.min(j,i),I=a.useMemo(()=>{const B=(F-1)*l;return p.slice(B,B+l)},[p,F,l]),D=a.useMemo(()=>{let $=Math.max(1,F-3),O=Math.min(i,$+7-1);return $=Math.max(1,O-7+1),Array.from({length:O-$+1},(ae,X)=>$+X)},[F,i]),R=()=>{k(null),L({name:"",slug:"",status:"active"}),C(!0)},M=B=>{k(B),L({name:B.name,slug:B.slug,status:B.isActive?"active":"inactive"}),C(!0)},W=B=>{const $=B.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");L(O=>({...O,name:B,slug:$}))},J=async()=>{var $,O,ae;const B=nx.safeParse(E);if(!B.success){t({title:"Validation failed",description:B.error.errors.map(X=>X.message).join(`
`)});return}try{w(!0);const X={categoryId:s,name:B.data.name,slug:B.data.slug,active:B.data.status==="active"};P?(await ce.put(`admin/subcategories/${P._id}`,X),t({title:"Updated",description:`Subcategory â€œ${X.name}â€ updated`})):(await ce.post("admin/subcategories",X),t({title:"Created",description:`Subcategory â€œ${X.name}â€ created`}));const z=await ce.get(`admin/subcategories?categoryId=${encodeURIComponent(s||"")}`),le=((O=($=z==null?void 0:z.data)==null?void 0:$.data)==null?void 0:O.subcategories)||((ae=z==null?void 0:z.data)==null?void 0:ae.data)||(z==null?void 0:z.data),Z=(Array.isArray(le)?le:[]).map(ne=>{var ye,ie;return{_id:((ie=(ye=ne._id)==null?void 0:ye.toString)==null?void 0:ie.call(ye))||ne._id,categoryId:ne.categoryId,name:ne.name,slug:ne.slug,isActive:typeof ne.isActive=="boolean"?ne.isActive:!!ne.active,sortOrder:ne.sortOrder??ne.order,updatedAt:ne.updatedAt,createdAt:ne.createdAt}});y(Z),C(!1),k(null)}catch(X){t({title:"Save failed",description:(X==null?void 0:X.message)||"Could not save subcategory"})}finally{w(!1)}},H=async B=>{const $=N,O=N.map(ae=>ae._id===B._id?{...ae,isActive:!ae.isActive}:ae);y(O);try{await ce.put(`admin/subcategories/${B._id}`,{active:!B.isActive}),t({title:B.isActive?"Deactivated":"Activated",description:B.name})}catch(ae){y($),t({title:"Update failed",description:(ae==null?void 0:ae.message)||"Could not update status"})}},se=async B=>{try{await ce.delete(`admin/subcategories/${B}`),y($=>$.filter(O=>O._id!==B)),t({title:"Deleted",description:"Subcategory removed"})}catch($){t({title:"Delete failed",description:($==null?void 0:$.message)||"Could not delete"})}finally{V(null)}};return s?e.jsx(Xt,{activeSection:"categories",onSectionChange:B=>{window.location.href=B==="categories"?"/admin/ads/categories":"/admin"},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx(be,{to:"/",children:"Home"})," ",e.jsx("span",{className:"mx-1",children:"â€º"}),e.jsx(be,{to:"/admin/ads/categories",children:"Categories"})," ",e.jsx("span",{className:"mx-1",children:"â€º"}),e.jsx("span",{children:r||`Category #${s.substring(0,6)}`})," ",e.jsx("span",{className:"mx-1",children:"â€º"}),e.jsx("span",{className:"text-gray-800 font-medium",children:"Subcategories"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Subcategories â€“ ",r||`Category #${s.substring(0,6)}`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ts,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Q,{value:S,onChange:B=>{x(B.target.value),m(1)},placeholder:"Search subcategories...",className:"pl-8 w-64"})]}),e.jsxs(g,{onClick:R,"aria-label":"Add Subcategory",children:[e.jsx(we,{className:"h-4 w-4 mr-2"})," Add Subcategory"]})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Xe,{children:[e.jsx(Ze,{className:"sticky top-0 bg-white z-10",children:e.jsxs(de,{children:[e.jsx(te,{className:"w-12",children:"#"}),e.jsx(te,{children:"Name"}),e.jsx(te,{children:"Slug"}),e.jsx(te,{children:"Parent Category"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Updated At"}),e.jsx(te,{className:"text-right",children:"Actions"})]})}),e.jsxs(es,{children:[n&&e.jsx(e.Fragment,{children:Array.from({length:5}).map((B,$)=>e.jsxs(de,{children:[e.jsx(ee,{children:e.jsx(bt,{className:"h-4 w-6"})}),e.jsx(ee,{children:e.jsx(bt,{className:"h-4 w-40"})}),e.jsx(ee,{children:e.jsx(bt,{className:"h-4 w-28"})}),e.jsx(ee,{children:e.jsx(bt,{className:"h-4 w-40"})}),e.jsx(ee,{children:e.jsx(bt,{className:"h-6 w-16"})}),e.jsx(ee,{children:e.jsx(bt,{className:"h-4 w-32"})}),e.jsx(ee,{className:"text-right",children:e.jsx(bt,{className:"h-8 w-24 ml-auto"})})]},$))}),!n&&I.length===0&&e.jsx(de,{children:e.jsx(ee,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No subcategories found"})}),!n&&I.map((B,$)=>e.jsxs(de,{className:"[&>td]:align-middle",children:[e.jsx(ee,{children:(F-1)*l+$+1}),e.jsx(ee,{className:"font-medium",children:B.name}),e.jsx(ee,{children:e.jsx("code",{className:"text-xs bg-gray-100 px-1 py-0.5 rounded",children:B.slug})}),e.jsx(ee,{children:r||B.categoryId}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{checked:B.isActive,onCheckedChange:()=>H(B)}),e.jsx(re,{variant:B.isActive?"default":"secondary",children:B.isActive?"Active":"Inactive"})]})}),e.jsx(ee,{children:e.jsx("span",{className:"text-sm text-gray-600",children:B.updatedAt?new Date(B.updatedAt).toLocaleString():B.createdAt?new Date(B.createdAt).toLocaleString():"â€”"})}),e.jsx(ee,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>M(B),"aria-label":`Edit ${B.name}`,children:e.jsx(Sc,{className:"h-4 w-4"})}),e.jsx(g,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>V(B._id),"aria-label":`Delete ${B.name}`,children:e.jsx(De,{className:"h-4 w-4"})})]})})]},B._id))]})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{children:"Rows per page"}),e.jsxs("select",{className:"border rounded px-2 py-1",value:l,onChange:B=>{b(parseInt(B.target.value)||10),m(1)},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{children:["Page ",F," of ",i]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{variant:"outline",size:"icon",disabled:F===1,onClick:()=>m(B=>Math.max(1,B-1)),children:e.jsx(Dt,{className:"h-4 w-4"})}),D.map(B=>e.jsx(g,{variant:B===F?"default":"outline",size:"sm",onClick:()=>m(B),children:B},B)),e.jsx(g,{variant:"outline",size:"icon",disabled:F===i,onClick:()=>m(B=>Math.min(i,B+1)),children:e.jsx(ws,{className:"h-4 w-4"})})]})]})]})]}),e.jsx(Re,{open:T,onOpenChange:B=>{C(B),B||k(null)},children:e.jsxs(Ee,{className:"max-w-lg",children:[e.jsx(Ie,{children:e.jsx(Fe,{children:P?"Edit Subcategory":"Add Subcategory"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx(Q,{value:E.name,onChange:B=>W(B.target.value),placeholder:"e.g. 2 BHK"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug"}),e.jsx(Q,{value:E.slug,onChange:B=>L($=>({...$,slug:B.target.value})),placeholder:"e.g. 2-bhk"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{variant:E.status==="active"?"default":"outline",size:"sm",onClick:()=>L(B=>({...B,status:"active"})),children:"Active"}),e.jsx(g,{variant:E.status==="inactive"?"default":"outline",size:"sm",onClick:()=>L(B=>({...B,status:"inactive"})),children:"Inactive"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsxs(g,{variant:"outline",onClick:()=>C(!1),"aria-label":"Cancel",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"})," Cancel"]}),e.jsx(g,{onClick:J,disabled:h,"aria-label":"Save Subcategory",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border border-white border-t-transparent rounded-full mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"h-4 w-4 mr-2"})," Save"]})})]})]})]})}),e.jsx(qt,{open:!!q,onOpenChange:B=>!B&&V(null),children:e.jsxs(St,{children:[e.jsxs(kt,{children:[e.jsx(At,{children:"Delete subcategory?"}),e.jsx(Tt,{children:"This action cannot be undone. This will permanently delete the subcategory."})]}),e.jsxs(Pt,{children:[e.jsx(It,{children:"Cancel"}),e.jsx(Et,{onClick:()=>q&&se(q),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}):e.jsx(Xt,{activeSection:"categories",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Invalid category"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The category ID is missing or invalid."}),e.jsx(be,{to:"/admin/ads/categories",className:"text-primary underline",children:"Back to Categories"})]})})}function ix(){const{planId:s}=zs(),[t,r]=a.useState(null),[c,N]=a.useState(!0),y=Ve();return a.useEffect(()=>{(async()=>{try{const n=await fetch(`/api/plans/${s}`);if(!n.ok)throw new Error("Failed to load plan");const o=await n.json(),f=(o==null?void 0:o.data)||(o==null?void 0:o.plan);if(!f)throw new Error("Plan not found");r(f)}catch{y("/")}finally{N(!1)}})()},[s,y]),c?e.jsx("div",{className:"p-6",children:"Loading..."}):t?e.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-1",children:"Checkout"}),e.jsx("p",{className:"text-gray-600 mb-6",children:t.description||"Complete your plan purchase"}),e.jsx("div",{className:"rounded-lg border p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[t.duration," days"]})]}),e.jsx("div",{className:"text-2xl font-bold",children:t.price===0?"Free":`â‚¹${t.price}`})]})}),e.jsx(g,{className:"bg-[#C70000] hover:bg-[#A60000] text-white",children:t.price===0?"Start Free Listing":"Proceed to Pay"})]}):e.jsx("div",{className:"p-6",children:"Plan not found"})}const lx=new kc;function cx(){return el(),e.jsx(ro,{children:e.jsx(Pc,{client:lx,children:e.jsx(to,{children:e.jsx(Yc,{children:e.jsxs(Vc,{children:[e.jsx(zc,{}),e.jsx(Bc,{}),e.jsx(sx,{}),e.jsx(Uo,{}),e.jsxs(Ac,{children:[e.jsx(ax,{}),e.jsxs(Tc,{children:[e.jsx(oe,{path:"/",element:e.jsx(Mo,{})}),e.jsx(oe,{path:"/categories",element:e.jsx(Yo,{})}),e.jsx(oe,{path:"/categories/:category",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/checkout/:planId",element:e.jsx(ix,{})}),e.jsx(oe,{path:"/categories/:category/:subcategory",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/categories/:category/:subcategory/:propertyType",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/properties",element:e.jsx(Xo,{})}),e.jsx(oe,{path:"/buy",element:e.jsx(Zo,{})}),e.jsx(oe,{path:"/sale",element:e.jsx(ed,{})}),e.jsx(oe,{path:"/rent",element:e.jsx(sd,{})}),e.jsx(oe,{path:"/lease",element:e.jsx(td,{})}),e.jsx(oe,{path:"/pg",element:e.jsx(ad,{})}),e.jsx(oe,{path:"/services",element:e.jsx(nd,{})}),e.jsx(oe,{path:"/other-services",element:e.jsx(Km,{})}),e.jsx(oe,{path:"/other-services/:cat",element:e.jsx(Ym,{})}),e.jsx(oe,{path:"/other-services/:cat/:sub",element:e.jsx(Xm,{})}),e.jsx(oe,{path:"/advertise",element:e.jsx(id,{})}),e.jsx(oe,{path:"/buy/:slug",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/sale/:slug",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/rent/:slug",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/lease/:slug",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/pg/:slug",element:e.jsx(dt,{})}),e.jsx(oe,{path:"/property/:id",element:e.jsx(qr,{})}),e.jsx(oe,{path:"/properties/:id",element:e.jsx(qr,{})}),e.jsx(oe,{path:"/chat",element:e.jsx(ld,{})}),e.jsx(oe,{path:"/chat/:conversationId",element:e.jsx(cd,{})}),e.jsx(oe,{path:"/chats",element:e.jsx(Dr,{})}),e.jsx(oe,{path:"/conversation/:id",element:e.jsx(dd,{})}),e.jsx(oe,{path:"/test-chat/:id",element:e.jsx(Zm,{})}),e.jsx(oe,{path:"/dev/chat-test",element:e.jsx(hd,{})}),e.jsx(oe,{path:"/step3-test",element:e.jsx(ex,{})}),e.jsx(oe,{path:"/my-account",element:e.jsx(ud,{})}),e.jsx(oe,{path:"/agents",element:e.jsx(gd,{})}),e.jsx(oe,{path:"/login",element:e.jsx(fd,{})}),e.jsx(oe,{path:"/user-login",element:e.jsx(jd,{})}),e.jsx(oe,{path:"/auth",element:e.jsx(Nd,{})}),e.jsx(oe,{path:"/firebase-auth",element:e.jsx(Vo,{})}),e.jsx(oe,{path:"/firebase-auth-test",element:e.jsx(Ho,{})}),e.jsx(oe,{path:"/user",element:e.jsx(Fi,{})}),e.jsx(oe,{path:"/user-dashboard",element:e.jsx(bd,{})}),e.jsx(oe,{path:"/post-property",element:e.jsx(Td,{})}),e.jsx(oe,{path:"/seller",element:e.jsx(Ur,{children:e.jsx(pd,{})})}),e.jsx(oe,{path:"/seller-dashboard",element:e.jsx(Ur,{children:e.jsx(Yr,{})})}),e.jsx(oe,{path:"/support/:action",element:e.jsx(Rr,{})}),e.jsx(oe,{path:"/support/ticket/:ticketId",element:e.jsx(Rr,{})}),e.jsx(oe,{path:"/enhanced-seller-dashboard",element:e.jsx(Yr,{})}),e.jsx(oe,{path:"/buyer-dashboard",element:e.jsx(Ed,{})}),e.jsx(oe,{path:"/agent-dashboard",element:e.jsx(Id,{})}),e.jsx(oe,{path:"/seller/blog",element:e.jsx(Wm,{})}),e.jsx(oe,{path:"/admin",element:e.jsx(zr,{})}),e.jsx(oe,{path:"/admin/support",element:e.jsx(zr,{})}),e.jsx(oe,{path:"/admin/reviews",element:e.jsx($m,{})}),e.jsx(oe,{path:"/admin/login",element:e.jsx(um,{})}),e.jsx(oe,{path:"/admin/ads/categories",element:e.jsx(pm,{})}),e.jsx(oe,{path:"/admin/ads/categories/:categoryId/subcategories",element:e.jsx(gm,{})}),e.jsx(oe,{path:"/admin/ads/categories/:categoryId/subcategories",element:e.jsx(Pa,{})}),e.jsx(oe,{path:"/admin/ads/categories/:categoryId/subcategories/*",element:e.jsx(Pa,{})}),e.jsx(oe,{path:"/admin/categories/:categoryId/subcategories",element:e.jsx(Pa,{})}),e.jsx(oe,{path:"/admin/categories/:categoryId/subcategories/*",element:e.jsx(Pa,{})}),e.jsx(oe,{path:"/admin/locations/countries",element:e.jsx(jm,{})}),e.jsx(oe,{path:"/staff/login",element:e.jsx(Am,{})}),e.jsx(oe,{path:"/staff-dashboard",element:e.jsx(Tm,{})}),e.jsx(oe,{path:"/staff-admin",element:e.jsx(Rm,{})}),e.jsx(oe,{path:"/settings",element:e.jsx(Um,{})}),e.jsx(oe,{path:"/messages",element:e.jsx(Dr,{})}),e.jsx(oe,{path:"/my-properties",element:e.jsx(Xr,{})}),e.jsx(oe,{path:"/clients",element:e.jsx(Om,{})}),e.jsx(oe,{path:"/favorites",element:e.jsx(Zr,{})}),e.jsx(oe,{path:"/wishlist",element:e.jsx(Zr,{})}),e.jsx(oe,{path:"/account/my-ads",element:e.jsx(Xr,{})}),e.jsx(oe,{path:"/blog",element:e.jsx(Mm,{})}),e.jsx(oe,{path:"/blog/:slug",element:e.jsx(Bm,{})}),e.jsx(oe,{path:"/maps",element:e.jsx(Vm,{})}),e.jsx(oe,{path:"/new-projects",element:e.jsx(qm,{})}),e.jsx(oe,{path:"/recent-views",element:e.jsx(Hm,{})}),e.jsx(oe,{path:"/leads",element:e.jsx(Gm,{})}),e.jsx(oe,{path:"/notifications",element:e.jsx(Jm,{})}),e.jsx(oe,{path:"/about-us",element:e.jsx(Jr,{})}),e.jsx(oe,{path:"/privacy-policy",element:e.jsx(Wr,{})}),e.jsx(oe,{path:"/terms-conditions",element:e.jsx(Qr,{})}),e.jsx(oe,{path:"/refund-policy",element:e.jsx(Hr,{})}),e.jsx(oe,{path:"/contact-us",element:e.jsx(Gr,{})}),e.jsx(oe,{path:"/contact",element:e.jsx(Gr,{})}),e.jsx(oe,{path:"/page/:slug",element:e.jsx(rx,{})}),e.jsx(oe,{path:"/p/privacy-policy",element:e.jsx(Wr,{})}),e.jsx(oe,{path:"/p/about-us",element:e.jsx(Jr,{})}),e.jsx(oe,{path:"/p/terms-conditions",element:e.jsx(Qr,{})}),e.jsx(oe,{path:"/p/:slug",element:e.jsx(Hr,{})}),e.jsx(oe,{path:"*",element:e.jsx(Qm,{})})]})]}),e.jsx(no,{})]})})})})})}const sn=void 0;let ht=null;function il(){if(!(typeof window>"u"))try{ht=Ec(so)}catch(s){console.warn("Messaging init failed:",s),ht=null}}async function ox(){if(typeof window>"u"||!("Notification"in window))return null;try{return Notification.permission==="granted"?"granted":(setTimeout(()=>{Notification.permission==="default"&&Notification.requestPermission().catch(()=>{})},2e3),Notification.permission)}catch{return null}}async function dx(){if(ht||il(),!ht)return null;try{if(!sn)return console.warn("FCM VAPID key missing; skipping push registration"),null;const s=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return await Ic(ht,{vapidKey:sn,serviceWorkerRegistration:s})||null}catch(s){return console.warn("FCM getToken failed:",s),null}}function mx(){return ht||il(),ht?Fc(ht,s=>{var t,r,c;try{const N=((t=s.notification)==null?void 0:t.title)||"Notification",y=((r=s.notification)==null?void 0:r.body)||"";Notification.permission==="granted"&&new Notification(N,{body:y,icon:((c=s.notification)==null?void 0:c.icon)||"/favicon.ico"})}catch{}}):()=>{}}async function xx(s){try{await fetch("/api/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,topic:"general"})})}catch(t){console.warn("Topic subscribe failed (non-fatal):",t)}}const ll=document.getElementById("root");if(!ll)throw new Error("Root element not found");let nr=null;function hx(){nr||(nr=Lc.createRoot(ll)),nr.render(e.jsx(cx,{})),"serviceWorker"in navigator&&setTimeout(async()=>{await ox();const s=await dx();s&&(xx(s),mx())},1500)}hx();
//# sourceMappingURL=index-DWsvNVNZ.js.map
